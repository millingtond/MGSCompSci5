<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Year 9 Python Course - Section 2: Data Types</title>
    
    <!-- CodeMirror CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/solarized.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/show-hint.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/lint/lint.min.css">
    
    <!-- Pyodide -->
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    
    <!-- CodeMirror JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/show-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/hint/python-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/foldgutter.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/brace-fold.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/fold/indent-fold.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/addon/lint/lint.min.js"></script>
    
    <!-- Font for dyslexia support -->
    <link href="https://fonts.googleapis.com/css2?family=OpenDyslexic:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #22c55e;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --dark-bg: #1f2937;
            --sidebar-bg: #111827;
            --code-bg: #272822;
            --text-primary: #111827;
            --text-secondary: #6b7280;
            --bg-primary: #ffffff;
            --bg-secondary: #f9fafb;
            --border-color: #e5e7eb;
        }
        
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #f3f4f6;
            color: var(--text-primary);
        }
        
        body.dark-mode {
            --bg-primary: #1f2937;
            --bg-secondary: #111827;
            --text-primary: #f3f4f6;
            --text-secondary: #9ca3af;
            --border-color: #374151;
            background-color: #0f172a;
        }
        
        .dyslexic-font {
            font-family: 'OpenDyslexic', sans-serif !important;
        }
        
        .header {
            background-color: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            margin: 0;
            font-size: 1.5rem;
        }
        
        .progress-container {
            margin-top: 0.5rem;
        }
        
        .progress-bar {
            background-color: rgba(255, 255, 255, 0.3);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            background-color: white;
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .badges-preview {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .badge {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            filter: grayscale(100%);
            transition: all 0.3s ease;
        }
        
        .badge.earned {
            filter: grayscale(0%);
            background-color: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }
        
        .main-container {
            display: flex;
            height: calc(100vh - 120px);
        }
        
        .sidebar {
            width: 280px;
            background-color: var(--sidebar-bg);
            color: white;
            overflow-y: auto;
            padding: 1rem;
        }
        
        .section-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        
        .task-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .task-item {
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            background-color: rgba(255, 255, 255, 0.05);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .task-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
            transform: translateX(5px);
        }
        
        .task-item.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .task-status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #4b5563;
            margin-right: 0.5rem;
            display: inline-block;
            position: relative;
        }
        
        .task-status.completed::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--success-color);
            font-weight: bold;
        }
        
        .task-xp {
            font-size: 0.8rem;
            color: #9ca3af;
        }
        
        .extension-toggle {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .extension-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }
        
        .extension-icon {
            font-size: 20px;
        }
        
        .extension-text {
            flex: 1;
            font-weight: 600;
        }
        
        .extension-arrow {
            font-size: 14px;
            transition: transform 0.3s;
        }
        
        .extension-section {
            margin-top: 10px;
            background: #f3f4f6;
            border-radius: 8px;
            padding: 10px;
        }
        
        .extension-item {
            padding: 12px;
            margin: 5px 0;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            border: 1px solid #e5e7eb;
        }
        
        .extension-item:hover {
            background: #f9fafb;
            border-color: var(--primary-color);
        }
        
        .extension-item.active {
            background: #eff6ff;
            border-color: var(--primary-color);
            color: #1e40af;
        }
        
        .extension-status {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid #9ca3af;
            display: inline-block;
            position: relative;
        }
        
        .extension-status.completed::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #8b5cf6;
            font-weight: bold;
        }
        
        .topic-icon {
            font-size: 18px;
        }
        
        .extension-name {
            flex: 1;
        }
        
        .extension-xp {
            font-size: 0.8rem;
            color: #6b7280;
        }
        
        .daily-challenge {
            margin-top: 2rem;
            padding: 1rem;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border-radius: 0.5rem;
            color: white;
        }
        
        .daily-challenge h3 {
            margin: 0 0 0.5rem 0;
            font-size: 1.1rem;
        }
        
        .daily-challenge p {
            margin: 0;
            font-size: 0.9rem;
        }
        
        .settings-panel {
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            color: #d1d5db;
            font-size: 0.9rem;
        }
        
        .toggle-switch {
            width: 50px;
            height: 24px;
            background-color: #4b5563;
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .toggle-switch.active {
            background-color: var(--primary-color);
        }
        
        .toggle-slider {
            width: 20px;
            height: 20px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }
        
        .toggle-switch.active .toggle-slider {
            transform: translateX(26px);
        }
        
        .save-buttons {
            margin-top: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }
        
        .save-btn, .reset-section-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        
        .save-btn {
            background-color: var(--primary-color);
            color: white;
        }
        
        .save-btn:hover {
            background-color: #16a34a;
        }
        
        .reset-section-btn {
            background-color: #ef4444;
            color: white;
        }
        
        .reset-section-btn:hover {
            background-color: #dc2626;
        }
        
        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            background-color: var(--bg-primary);
        }
        
        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }
        
        .task-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--text-primary);
        }
        
        .xp-badge {
            background-color: var(--primary-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.9rem;
        }
        
        .concept-box {
            background-color: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .concept-box h3 {
            margin-top: 0;
            color: var(--text-primary);
        }
        
        .example-box {
            background-color: #dcfce7;
            border-left: 4px solid var(--primary-color);
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .dark-mode .example-box {
            background-color: rgba(34, 197, 94, 0.1);
        }
        
        .code-editor {
            border: 2px solid var(--border-color);
            border-radius: 0.5rem;
            overflow: hidden;
            margin: 1rem 0;
        }
        
        .editor-header {
            background-color: var(--dark-bg);
            color: white;
            padding: 0.5rem 1rem;
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .editor-title {
            font-weight: bold;
        }
        
        .CodeMirror {
            height: auto;
            min-height: 150px;
            max-height: 400px;
            font-size: 14px;
        }
        
        .controls {
            display: flex;
            gap: 0.5rem;
            margin: 1rem 0;
        }
        
        .btn {
            padding: 0.5rem 1.5rem;
            border: none;
            border-radius: 0.25rem;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }
        
        .run-btn {
            background-color: var(--primary-color);
            color: white;
        }
        
        .run-btn:hover {
            background-color: #16a34a;
            transform: translateY(-1px);
        }
        
        .check-btn {
            background-color: #8b5cf6;
            color: white;
        }
        
        .check-btn:hover {
            background-color: #7c3aed;
        }
        
        .hint-btn {
            background-color: #f59e0b;
            color: white;
        }
        
        .hint-btn:hover {
            background-color: #d97706;
        }
        
        .reset-btn {
            background-color: #6b7280;
            color: white;
        }
        
        .reset-btn:hover {
            background-color: #4b5563;
        }
        
        .output-box {
            background-color: var(--dark-bg);
            color: white;
            padding: 1rem;
            border-radius: 0.5rem;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            min-height: 80px;
            white-space: pre-wrap;
        }
        
        .output-label {
            font-weight: bold;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }
        
        .error {
            color: #ff6b6b;
        }
        
        .hint-box {
            background-color: #fef3c7;
            border-left: 4px solid var(--warning-color);
            padding: 1rem;
            margin: 1rem 0;
            display: none;
        }
        
        .dark-mode .hint-box {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--text-primary);
        }
        
        .feedback {
            margin: 1rem 0;
            padding: 1rem;
            border-radius: 0.5rem;
            display: none;
        }
        
        .feedback.success {
            background-color: #d1fae5;
            color: #065f46;
            border-left: 4px solid var(--success-color);
        }
        
        .feedback.error {
            background-color: #fee2e2;
            color: #991b1b;
            border-left: 4px solid var(--error-color);
        }
        
        /* Assessment Styles */
        .assessment-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .question-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .question-number {
            background: var(--primary-color);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .question-type {
            background: #e5e7eb;
            color: #374151;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.875rem;
        }
        
        .question-text {
            font-size: 1.1rem;
            margin-bottom: 20px;
            color: var(--text-primary);
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .option-label {
            display: flex;
            align-items: center;
            padding: 12px;
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .option-label:hover {
            border-color: var(--primary-color);
            background: #f0fdf4;
        }
        
        .dark-mode .option-label:hover {
            background: rgba(34, 197, 94, 0.1);
        }
        
        .option-label input[type="radio"] {
            margin-right: 10px;
        }
        
        .text-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        .text-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .submit-assessment-btn {
            background: var(--primary-color);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            display: block;
            margin: 30px auto;
            transition: all 0.3s;
        }
        
        .submit-assessment-btn:hover {
            background: #16a34a;
            transform: translateY(-2px);
        }
        
        .assessment-result {
            background: #f0fdf4;
            border: 2px solid var(--success-color);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .dark-mode .assessment-result {
            background: rgba(16, 185, 129, 0.1);
        }
        
        .test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 6px;
        }
        
        .test-pass {
            background: #d1fae5;
            color: #065f46;
        }
        
        .test-fail {
            background: #fee2e2;
            color: #991b1b;
        }
        
        .dark-mode .test-pass {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .dark-mode .test-fail {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        /* Extension content styles */
        .extension-header {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .extension-header h2 {
            margin: 0;
            color: var(--text-primary);
        }
        
        .back-btn {
            background: #6b7280;
        }
        
        .extension-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .concept-section {
            margin-bottom: 30px;
        }
        
        .try-it {
            background: #eff6ff;
            border: 1px solid #3b82f6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .dark-mode .try-it {
            background: rgba(59, 130, 246, 0.1);
        }
        
        .extension-output {
            margin-top: 15px;
            padding: 15px;
            background: #1f2937;
            color: #f3f4f6;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            min-height: 50px;
        }
        
        .challenge-box {
            background: #fef3c7;
            border: 1px solid #fcd34d;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .dark-mode .challenge-box {
            background: rgba(252, 211, 77, 0.1);
        }
        
        .fun-fact {
            background: #e0f2fe;
            border: 1px solid #0ea5e9;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .dark-mode .fun-fact {
            background: rgba(14, 165, 233, 0.1);
        }
        
        /* Celebration styles */
        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            text-align: center;
            z-index: 1000;
            display: none;
        }
        
        .celebration h2 {
            color: var(--success-color);
            margin-top: 0;
        }
        
        .celebration-badge {
            font-size: 4rem;
            margin: 1rem 0;
        }
        
        .achievement-popup {
            position: fixed;
            top: 100px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 1000;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .achievement-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .achievement-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .achievement-desc {
            color: #6b7280;
            font-size: 0.9rem;
        }
        
        .xp-gained {
            color: var(--success-color);
            font-weight: bold;
            margin-left: 10px;
        }
        
        /* Confetti canvas */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }
        
        /* Worksheet styles */
        .worksheet-section {
            margin-top: 40px;
            padding: 30px;
            background: var(--bg-secondary);
            border-radius: 8px;
            border: 2px solid var(--border-color);
        }
        
        .worksheet-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--text-primary);
        }
        
        .worksheet-question {
            margin-bottom: 25px;
            padding: 20px;
            background: var(--bg-primary);
            border-radius: 6px;
            border: 1px solid var(--border-color);
        }
        
        .worksheet-question h4 {
            margin-top: 0;
            color: var(--primary-color);
        }
        
        .worksheet-answer {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border: 2px solid var(--border-color);
            border-radius: 4px;
            font-size: 1rem;
            min-height: 60px;
            resize: vertical;
        }
        
        .worksheet-code {
            background: #f3f4f6;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
        
        .dark-mode .worksheet-code {
            background: rgba(0, 0, 0, 0.3);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 0.5s ease-in-out 3;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Year 9 Python Programming</h1>
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <p style="margin: 5px 0 0 0; font-size: 14px; color: white;">Progress: <span id="progressText">0/9 lessons, 0/5 extensions completed</span></p>
            <div class="badges-preview">
                <div class="badge" id="badge-string" title="String Master">üî§</div>
                <div class="badge" id="badge-integer" title="Number Ninja">üî¢</div>
                <div class="badge" id="badge-converter" title="Type Converter">üîÑ</div>
                <div class="badge" id="badge-error" title="Error Handler">‚ö†Ô∏è</div>
                <div class="badge" id="badge-complete" title="Data Types Expert">üèÜ</div>
            </div>
        </div>
    </div>

    <div class="main-container">
        <aside class="sidebar">
            <div class="section-title">Section 2 - Data Types</div>
            <ul class="task-list" id="taskList">
                <li class="task-item active" onclick="switchTask(1)">
                    <span class="task-status" id="status1"></span>
                    <span class="task-name">02.01 String Concatenation</span>
                    <span class="task-xp">+75 XP</span>
                </li>
                <li class="task-item" onclick="switchTask(2)">
                    <span class="task-status" id="status2"></span>
                    <span class="task-name">02.02 Integers</span>
                    <span class="task-xp">+100 XP</span>
                </li>
                <li class="task-item" onclick="switchTask(3)">
                    <span class="task-status" id="status3"></span>
                    <span class="task-name">02.03 Combining Data Types</span>
                    <span class="task-xp">+75 XP</span>
                </li>
                <li class="task-item" onclick="switchTask(4)">
                    <span class="task-status" id="status4"></span>
                    <span class="task-name">02.04 The str Function</span>
                    <span class="task-xp">+100 XP</span>
                </li>
                <li class="task-item" onclick="switchTask(5)">
                    <span class="task-status" id="status5"></span>
                    <span class="task-name">02.05 The int Function</span>
                    <span class="task-xp">+125 XP</span>
                </li>
                <li class="task-item" onclick="switchTask(6)">
                    <span class="task-status" id="status6"></span>
                    <span class="task-name">02.06 Int & Str Practice</span>
                    <span class="task-xp">+125 XP</span>
                </li>
                <li class="task-item" onclick="switchTask(7)">
                    <span class="task-status" id="status7"></span>
                    <span class="task-name">02.07 Multi-line Strings</span>
                    <span class="task-xp">+100 XP</span>
                </li>
                <li class="task-item" onclick="switchTask(8)">
                    <span class="task-status" id="status8"></span>
                    <span class="task-name">02.08 Inputting Numbers</span>
                    <span class="task-xp">+125 XP</span>
                </li>
                <li class="task-item" onclick="switchTask(9)">
                    <span class="task-status" id="status9"></span>
                    <span class="task-name">02.09 Challenge</span>
                    <span class="task-xp">+200 XP</span>
                </li>
                <li class="task-item" onclick="switchTask(10)">
                    <span class="task-status" id="status10"></span>
                    <span class="task-name">Section Assessment</span>
                    <span class="task-xp">+200 XP</span>
                </li>
            </ul>
            
            <div class="extension-toggle" onclick="toggleExtension()">
                <span class="extension-icon">üöÄ</span>
                <span class="extension-text">Extension Activities</span>
                <span class="extension-arrow" id="extensionArrow">‚ñ∂</span>
            </div>
            <div class="extension-section" id="extensionSection" style="display: none;">
                <div class="extension-item" onclick="showExtensionTopic('float-type')">
                    <span class="extension-status" id="ext-status-float-type"></span>
                    <span class="topic-icon">üî¢</span>
                    <span class="extension-name">Float Data Type</span>
                    <span class="extension-xp">+30 XP</span>
                </div>
                <div class="extension-item" onclick="showExtensionTopic('boolean-type')">
                    <span class="extension-status" id="ext-status-boolean-type"></span>
                    <span class="topic-icon">‚úÖ</span>
                    <span class="extension-name">Boolean Data Type</span>
                    <span class="extension-xp">+35 XP</span>
                </div>
                <div class="extension-item" onclick="showExtensionTopic('type-checking')">
                    <span class="extension-status" id="ext-status-type-checking"></span>
                    <span class="topic-icon">üîç</span>
                    <span class="extension-name">Type Checking</span>
                    <span class="extension-xp">+40 XP</span>
                </div>
                <div class="extension-item" onclick="showExtensionTopic('format-strings')">
                    <span class="extension-status" id="ext-status-format-strings"></span>
                    <span class="topic-icon">üìù</span>
                    <span class="extension-name">Format Strings</span>
                    <span class="extension-xp">+45 XP</span>
                </div>
                <div class="extension-item" onclick="showExtensionTopic('advanced-conversion')">
                    <span class="extension-status" id="ext-status-advanced-conversion"></span>
                    <span class="topic-icon">üîÑ</span>
                    <span class="extension-name">Advanced Type Conversion</span>
                    <span class="extension-xp">+50 XP</span>
                </div>
            </div>
            
            <div class="daily-challenge">
                <h3>üåü Challenge</h3>
                <p>Complete all tasks without using hints for bonus 300 XP!</p>
            </div>
            
            <div class="settings-panel">
                <div class="section-title">Settings</div>
                <div class="setting-item">
                    <span>Dyslexic Font</span>
                    <div class="toggle-switch" onclick="toggleDyslexicFont()" id="dyslexicToggle">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                <div class="setting-item">
                    <span>Audio Instructions</span>
                    <div class="toggle-switch" onclick="toggleAudioInstructions()" id="audioToggle">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                <div class="setting-item">
                    <span>Live Syntax Check</span>
                    <div class="toggle-switch" onclick="toggleSyntaxCheck()" id="syntaxToggle">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                <div class="setting-item">
                    <span>Dark Mode</span>
                    <div class="toggle-switch" onclick="toggleDarkMode()" id="darkModeToggle">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
            </div>
            
            <div class="save-buttons">
                <button class="save-btn" onclick="saveAllProgress()">üíæ Save Progress</button>
                <button class="reset-section-btn" onclick="resetSection()">üîÑ Reset Section</button>
            </div>
        </aside>

        <div class="content-area" id="taskContent">
            <!-- Task content will be loaded here dynamically -->
        </div>
        
        <div class="content-area" id="extensionContent" style="display: none;">
            <!-- Extension content will be loaded here dynamically -->
        </div>
    </div>

    <div class="celebration" id="celebration">
        <h2>Congratulations!</h2>
        <div class="celebration-badge">üéâ</div>
        <p id="celebrationMessage">You've earned a badge!</p>
        <button class="btn run-btn" onclick="closeCelebration()">Continue</button>
    </div>
    
    <div class="achievement-popup" id="achievementPopup">
        <div class="achievement-icon" id="achievementIcon">üèÜ</div>
        <div class="achievement-title" id="achievementTitle">Achievement Unlocked!</div>
        <div class="achievement-desc" id="achievementDesc">You've completed your first task!</div>
    </div>
    
    <canvas id="confetti-canvas"></canvas>

    <script>
        // Task content definitions
        const tasks = {
            1: {
                title: "String Concatenation",
                content: `
                    <div class="concept-box">
                        <h3>String Concatenation</h3>
                        <p>The '+' operator <strong>concatenates</strong> strings.</p>
                        <p>Concatenation is the process of joining strings in the order they are added (without spaces unless you add them!)</p>
                        <p>e.g. <strong>"10" + "20" = "1020"</strong></p>
                    </div>
                    
                    <div class="example-box">
                        <h4>Example:</h4>
                        <pre>a = "10"
b = "20"
print(a + b)  # This will print: 1020</pre>
                    </div>
                    
                    <h3>Task</h3>
                    <p>Add a third variable 'c' and store another number in it (as a string).</p>
                    <p>Change the print statement to also concatenate variable 'c'.</p>
                `,
                initialCode: `a = "10"
b = "20"

print(a + b)`,
                solution: `a = "10"
b = "20"
c = "30"

print(a + b + c)`,
                hint: "Remember to create variable c with a string value (in quotes), then add it to the print statement using the + operator",
                tests: [
                    {
                        description: "Variable c is created",
                        test: (code) => code.includes('c =') && code.includes('"')
                    },
                    {
                        description: "All three variables are concatenated",
                        test: (code, output) => {
                            return code.includes('a + b + c') || 
                                   (code.includes('a') && code.includes('b') && code.includes('c') && code.includes('+'));
                        }
                    }
                ]
            },
            2: {
                title: "Integers",
                content: `
                    <div class="concept-box">
                        <h3>Integers</h3>
                        <p>An <strong>integer</strong> is a whole number data type.</p>
                        <p>Integers do not have quotation marks around them and are used to perform mathematical operations.</p>
                        <p>The '+' operator produces the sum of the two integers, rather than concatenating as we saw before.</p>
                    </div>
                    
                    <h3>Task</h3>
                    <p>You buy a basket of fruits.</p>
                    <ol>
                        <li>Using the provided variables, calculate the total number of fruit in the basket and print it out.</li>
                        <li>You then share your bananas and 10 of them are eaten.</li>
                        <li>Using a Python statement, work out the new total number of fruit and print again.</li>
                    </ol>
                `,
                initialCode: `apples = 13
bananas = 15
oranges = 4
kiwis = 6`,
                solution: `apples = 13
bananas = 15
oranges = 4
kiwis = 6

# Calculate total
total = apples + bananas + oranges + kiwis
print(total)

# Update bananas
bananas = bananas - 10

# Calculate new total
new_total = apples + bananas + oranges + kiwis
print(new_total)`,
                hint: "First, add all the fruits together and print. Then subtract 10 from bananas and calculate the new total.",
                tests: [
                    {
                        description: "Initial total is calculated correctly",
                        test: (code, output) => output.includes("38")
                    },
                    {
                        description: "New total after eating bananas is calculated",
                        test: (code, output) => output.includes("28")
                    }
                ]
            },
            3: {
                title: "Combining Different Data Types",
                content: `
                    <div class="concept-box">
                        <h3>Combining Different Data Types</h3>
                        <p>Because strings and integers are different <strong>data types</strong>, they cannot be combined with the '+' operator.</p>
                        <p>Combining values of different data types will produce an error.</p>
                    </div>
                    
                    <h3>Task</h3>
                    <p>Run the code and observe the error. Do you understand what has happened?</p>
                    <p>Move on when you are ready.</p>
                `,
                initialCode: `string = "My age is "
integer = 12

print(string + integer)`,
                solution: `string = "My age is "
integer = 12

# This will cause an error!
print(string + integer)`,
                hint: "This code is meant to show an error. Run it to see what happens when you try to add a string and an integer.",
                tests: [
                    {
                        description: "Code has been run to see the error",
                        test: (code, output) => {
                            return output.includes("TypeError") || output.includes("Error") || code.includes("print(string + integer)");
                        }
                    }
                ]
            },
            4: {
                title: "The str Function",
                content: `
                    <div class="concept-box">
                        <h3>The str Function</h3>
                        <p>The <strong>str</strong> function converts its input into a string output. It does not alter the value of the variable permanently (unless overwritten).</p>
                        <p><strong>str(56)</strong> - this will convert the integer 56 into the string "56".</p>
                    </div>
                    
                    <h3>Task</h3>
                    <p>Add the code to concatenate the string form of 'a' and 'b' together, under the relevant comment.</p>
                `,
                initialCode: `a = 124
b = 816

# Add a and b as integers
total = a + b
print(total)

# Add a and b as strings`,
                solution: `a = 124
b = 816

# Add a and b as integers
total = a + b
print(total)

# Add a and b as strings
string_total = str(a) + str(b)
print(string_total)`,
                hint: "Use str(a) and str(b) to convert the integers to strings, then concatenate them with +",
                tests: [
                    {
                        description: "Integer addition works correctly",
                        test: (code, output) => output.includes("940")
                    },
                    {
                        description: "String concatenation is implemented",
                        test: (code, output) => output.includes("124816")
                    }
                ]
            },
            5: {
                title: "The int Function",
                content: `
                    <div class="concept-box">
                        <h3>The int Function</h3>
                        <p>The <strong>int</strong> function converts its input to an integer output.</p>
                    </div>
                    
                    <div class="example-box">
                        <h4>Example Code:</h4>
                        <pre>a = "456"
b = "789"

print(int(a) + int(b))</pre>
                    </div>
                    
                    <h3>Task</h3>
                    <p>Write the line of code that would calculate how many years ago the moon landing was, using the 'when' variable and the <strong>int</strong> function.</p>
                    <p>Can you also edit the final print outs so that all the information gets printed together on a single suitable line? Hint: you will have to use the <strong>str</strong> function.</p>
                `,
                initialCode: `#Example Code
a = "456"
b = "789"

print(int(a) + int(b))


# Your initial strings
event = "moon landing"
when = "1969"
currentYear = 2021

# How many years ago was it?
ago = _____

# Print the result
print("Years since " + event)
print(ago)`,
                solution: `#Example Code
a = "456"
b = "789"

print(int(a) + int(b))


# Your initial strings
event = "moon landing"
when = "1969"
currentYear = 2021

# How many years ago was it?
ago = currentYear - int(when)

# Print the result
print("Years since " + event + ": " + str(ago))`,
                hint: "Convert 'when' to an integer using int(when), then subtract from currentYear. For printing, concatenate the strings and use str(ago) to convert the number.",
                tests: [
                    {
                        description: "Years calculation is correct",
                        test: (code) => code.includes("currentYear - int(when)") || code.includes("2021 - int(when)")
                    },
                    {
                        description: "Output is formatted on one line",
                        test: (code, output) => output.includes("Years since moon landing") && output.includes("52")
                    }
                ]
            },
            6: {
                title: "Int & Str Practice",
                content: `
                    <div class="concept-box">
                        <h3>Int & Str Practice</h3>
                        <p>Use the <em>int</em> function to add the actual values of the variables 'a', 'b' and 'c' i.e. do not concatenate them. Store the result in a new variable.</p>
                        <p>Print the result in the following format:</p>
                        <p><strong>The result is x</strong></p>
                        <p>Hint: You will also need to use the <strong>str</strong> function to concatenate the printout sentence.</p>
                    </div>
                `,
                initialCode: `a = "10"
b = "20"
c = "30"`,
                solution: `a = "10"
b = "20"
c = "30"

# Convert strings to integers and add them
result = int(a) + int(b) + int(c)

# Print the result
print("The result is " + str(result))`,
                hint: "Convert each string to an integer using int(), add them together, then use str() to convert the result back to a string for printing.",
                tests: [
                    {
                        description: "Values are converted and added correctly",
                        test: (code, output) => output.includes("60")
                    },
                    {
                        description: "Output format is correct",
                        test: (code, output) => output.includes("The result is 60")
                    }
                ]
            },
            7: {
                title: "Multi-line String Output",
                content: `
                    <div class="concept-box">
                        <h3>Multi-line String Output</h3>
                        <p>A <strong>string</strong> is a sequence of characters. It can be a word, a phrase, a whole story - as long as it is enclosed in speech marks.</p>
                        <p>To print a string over multiple lines, the text needs to be enclosed within 3 apostrophes (''')</p>
                    </div>
                    
                    <div class="example-box">
                        <h4>Example:</h4>
                        <pre>print('''
# # #
# # #
# # #
''')</pre>
                    </div>
                    
                    <h3>Task</h3>
                    <p>Can you print a 5x5 square with asterisk ("*") characters using only one print statement, under the hash tag square?</p>
                    <p>Put a space between each asterisk.</p>
                `,
                initialCode: `word = "hello"
phrase = "hello, how are you?"
story = "The princess went to ..."

print(word)
print(phrase)
print(story)

print('''
This


    is a mult-line
    
    
    printout
    
''')

print('''
# # #
# # #
# # #
''')`,
                solution: `word = "hello"
phrase = "hello, how are you?"
story = "The princess went to ..."

print(word)
print(phrase)
print(story)

print('''
This


    is a mult-line
    
    
    printout
    
''')

print('''
# # #
# # #
# # #
''')

# square
print('''
* * * * *
* * * * *
* * * * *
* * * * *
* * * * *
''')`,
                hint: "Add a new print statement with triple quotes (''') and create 5 lines, each with 5 asterisks separated by spaces.",
                tests: [
                    {
                        description: "Square is printed using multi-line string",
                        test: (code) => code.includes("'''") && code.includes("*")
                    },
                    {
                        description: "Square has correct dimensions",
                        test: (code, output) => {
                            const lines = output.split('\n');
                            let starLines = 0;
                            for (const line of lines) {
                                if (line.includes('* * * * *')) starLines++;
                            }
                            return starLines >= 5;
                        }
                    }
                ]
            },
            8: {
                title: "Inputting Numbers",
                content: `
                    <div class="concept-box">
                        <h3>Inputting Numbers</h3>
                        <p>The input function returns a string. If this is then wrapped with the <strong>int</strong> function, it returns an integer, which can be stored in a variable.</p>
                    </div>
                    
                    <h3>Task</h3>
                    <ol>
                        <li>Add another input statement to allow the user to enter another integer.</li>
                        <li>Add the two variables together and print the result using a useful sentence.</li>
                    </ol>
                `,
                initialCode: `number = int(input("Enter a number: "))

print(number)`,
                solution: `number = int(input("Enter a number: "))
number2 = int(input("Enter another number: "))

total = number + number2
print("The sum of your numbers is " + str(total))`,
                hint: "Create a second variable with int(input(...)), then add both numbers and print with a descriptive message.",
                tests: [
                    {
                        description: "Second input is added",
                        test: (code) => {
                            const inputCount = (code.match(/input/g) || []).length;
                            return inputCount >= 2;
                        }
                    },
                    {
                        description: "Numbers are added and result is printed",
                        test: (code) => {
                            return (code.includes('+') && code.includes('print')) ||
                                   (code.includes('total') || code.includes('sum'));
                        }
                    }
                ]
            },
            9: {
                title: "Challenge - Data Types",
                content: `
                    <div class="concept-box">
                        <h3>Challenge - Data Types</h3>
                        <p>Write a program that:</p>
                        <ol>
                            <li>Asks the user to enter their age as an integer</li>
                            <li>Asks the user to enter their name</li>
                            <li>Prints out how old the person will be in 4 years time (using '+').</li>
                        </ol>
                        <p>It should be formatted as follows: "Joe will be 17 years old in 4 years time"</p>
                    </div>
                `,
                initialCode: `# Challenge - Data Types`,
                solution: `# Challenge - Data Types
age = int(input("Enter your age: "))
name = input("Enter your name: ")

future_age = age + 4
print(name + " will be " + str(future_age) + " years old in 4 years time")`,
                hint: "Get age as int(input(...)), get name as input(...), add 4 to age, then use string concatenation to create the output message.",
                tests: [
                    {
                        description: "Program asks for age and name",
                        test: (code) => {
                            const inputCount = (code.match(/input/g) || []).length;
                            return inputCount >= 2 && code.includes('int(input');
                        }
                    },
                    {
                        description: "Future age is calculated correctly",
                        test: (code) => code.includes('+ 4') || code.includes('+4')
                    },
                    {
                        description: "Output is formatted correctly",
                        test: (code) => code.includes('will be') && code.includes('years old in 4 years time')
                    }
                ]
            },
            10: {
                title: "Section Assessment",
                content: `
                    <div class="assessment-container">
                        <h2>Section 2 Assessment - Data Types</h2>
                        <p>Test your understanding of data types in Python!</p>
                        
                        <div class="question-card">
                            <div class="question-header">
                                <span class="question-number">Q1</span>
                                <span class="question-type">Multiple Choice</span>
                            </div>
                            <p class="question-text">Which of the following is a string?</p>
                            <div class="options-container">
                                <label class="option-label">
                                    <input type="radio" name="q1" value="0">
                                    <span>123</span>
                                </label>
                                <label class="option-label">
                                    <input type="radio" name="q1" value="1">
                                    <span>"123"</span>
                                </label>
                                <label class="option-label">
                                    <input type="radio" name="q1" value="2">
                                    <span>int(123)</span>
                                </label>
                                <label class="option-label">
                                    <input type="radio" name="q1" value="3">
                                    <span>123.0</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="question-card">
                            <div class="question-header">
                                <span class="question-number">Q2</span>
                                <span class="question-type">Text Input</span>
                            </div>
                            <p class="question-text">What is the result of "10" + "20"?</p>
                            <input type="text" class="text-input" id="q2-answer" placeholder="Enter your answer">
                        </div>
                        
                        <div class="question-card">
                            <div class="question-header">
                                <span class="question-number">Q3</span>
                                <span class="question-type">Multiple Choice</span>
                            </div>
                            <p class="question-text">What function converts a value to a string?</p>
                            <div class="options-container">
                                <label class="option-label">
                                    <input type="radio" name="q3" value="0">
                                    <span>int()</span>
                                </label>
                                <label class="option-label">
                                    <input type="radio" name="q3" value="1">
                                    <span>str()</span>
                                </label>
                                <label class="option-label">
                                    <input type="radio" name="q3" value="2">
                                    <span>print()</span>
                                </label>
                                <label class="option-label">
                                    <input type="radio" name="q3" value="3">
                                    <span>input()</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="question-card">
                            <div class="question-header">
                                <span class="question-number">Q4</span>
                                <span class="question-type">Code Challenge</span>
                            </div>
                            <p class="question-text">Write code to add the integers 15 and 25, then convert the result to a string and print it.</p>
                            <textarea id="q4-code" class="code-textarea" rows="4"></textarea>
                        </div>
                        
                        <button class="submit-assessment-btn" onclick="submitAssessment()">Submit Assessment</button>
                        
                        <div id="assessment-results" style="display: none;"></div>
                    </div>
                    
                    <div class="worksheet-section">
                        <h3 class="worksheet-title">üìù Worksheet Questions</h3>
                        
                        <div class="worksheet-question">
                            <h4>1. Define what a 'string' data type is</h4>
                            <textarea class="worksheet-answer" placeholder="Write your answer here..."></textarea>
                        </div>
                        
                        <div class="worksheet-question">
                            <h4>2. State which of the following variables is a string and explain how you know</h4>
                            <div class="worksheet-code">
num1 = 234
num2 = "234"</div>
                            <textarea class="worksheet-answer" placeholder="Write your answer here..."></textarea>
                        </div>
                        
                        <div class="worksheet-question">
                            <h4>3. The process of joining strings in the order they are added is called what?</h4>
                            <textarea class="worksheet-answer" placeholder="Write your answer here..."></textarea>
                        </div>
                        
                        <div class="worksheet-question">
                            <h4>4. State what an 'integer' datatype is</h4>
                            <textarea class="worksheet-answer" placeholder="Write your answer here..."></textarea>
                        </div>
                        
                        <div class="worksheet-question">
                            <h4>5. Explain why the 'str' function has been used here?</h4>
                            <div class="worksheet-code">
age = 15
message = "I am " + str(age) + " years old"</div>
                            <textarea class="worksheet-answer" placeholder="Write your answer here..."></textarea>
                        </div>
                    </div>
                `,
                initialCode: '',
                tests: []
            }
        };

        // Extension content
        const extensionTopics = {
            'float-type': {
                title: 'Float Data Type',
                content: `
                    <div class="extension-header">
                        <h2>Float Data Type</h2>
                        <button class="btn back-btn" onclick="backToExtensionList()">‚Üê Back</button>
                    </div>
                    
                    <div class="extension-content">
                        <div class="concept-section">
                            <h3>What are Floats?</h3>
                            <p>Floats (floating-point numbers) are numbers with decimal points. They allow us to work with fractional values!</p>
                            
                            <div class="example-box">
                                <h4>Example: Creating floats</h4>
                                <textarea class="extension-code" readonly>price = 19.99
pi = 3.14159
temperature = -5.5

print(price)
print(pi)
print(temperature)</textarea>
                            </div>
                            
                            <div class="try-it">
                                <h4>Try it yourself!</h4>
                                <p>Create variables for height (in meters) and weight (in kg), then calculate BMI:</p>
                                <textarea class="extension-code" id="tryFloat">height = 1.75
weight = 70.5

# Calculate BMI: weight / (height * height)
bmi = _____
print("Your BMI is: " + str(bmi))</textarea>
                                <button onclick="runExtensionCode('tryFloat')" class="btn run-btn">‚ñ∂ Run</button>
                                <div class="extension-output" id="output-tryFloat"></div>
                                <button onclick="checkExtensionComplete('float-type', 'tryFloat')" class="btn check-btn">‚úì Check</button>
                                <div id="feedback-tryFloat"></div>
                            </div>
                            
                            <div class="fun-fact">
                                <h4>üí° Fun Fact</h4>
                                <p>The name "float" comes from the decimal point that can "float" to different positions!</p>
                            </div>
                        </div>
                    </div>
                `
            },
            'boolean-type': {
                title: 'Boolean Data Type',
                content: `
                    <div class="extension-header">
                        <h2>Boolean Data Type</h2>
                        <button class="btn back-btn" onclick="backToExtensionList()">‚Üê Back</button>
                    </div>
                    
                    <div class="extension-content">
                        <div class="concept-section">
                            <h3>True or False?</h3>
                            <p>Booleans are the simplest data type - they can only be True or False!</p>
                            
                            <div class="example-box">
                                <h4>Example: Boolean values</h4>
                                <textarea class="extension-code" readonly>is_student = True
has_homework = False
likes_python = True

print(is_student)
print(has_homework)
print(likes_python)</textarea>
                            </div>
                            
                            <div class="try-it">
                                <h4>Try it yourself!</h4>
                                <p>Create a simple quiz question using booleans:</p>
                                <textarea class="extension-code" id="tryBoolean"># Set the correct answer
python_is_fun = _____  # Set this to True or False

# Check if the answer is correct
if python_is_fun == True:
    print("Correct! Python is indeed fun!")
else:
    print("Really? Give Python another chance!")</textarea>
                                <button onclick="runExtensionCode('tryBoolean')" class="btn run-btn">‚ñ∂ Run</button>
                                <div class="extension-output" id="output-tryBoolean"></div>
                                <button onclick="checkExtensionComplete('boolean-type', 'tryBoolean')" class="btn check-btn">‚úì Check</button>
                                <div id="feedback-tryBoolean"></div>
                            </div>
                        </div>
                    </div>
                `
            },
            'type-checking': {
                title: 'Type Checking',
                content: `
                    <div class="extension-header">
                        <h2>Type Checking</h2>
                        <button class="btn back-btn" onclick="backToExtensionList()">‚Üê Back</button>
                    </div>
                    
                    <div class="extension-content">
                        <div class="concept-section">
                            <h3>Finding Out Data Types</h3>
                            <p>Python has a built-in function called <code>type()</code> that tells you what type of data you're working with!</p>
                            
                            <div class="example-box">
                                <h4>Example: Using type()</h4>
                                <textarea class="extension-code" readonly>my_string = "Hello"
my_int = 42
my_float = 3.14

print(type(my_string))
print(type(my_int))
print(type(my_float))</textarea>
                            </div>
                            
                            <div class="try-it">
                                <h4>Try it yourself!</h4>
                                <p>Check the types of different values:</p>
                                <textarea class="extension-code" id="tryType">value1 = "100"
value2 = 100
value3 = 100.0
value4 = True

# Print the type of each value
print("Type of value1:", _____)
print("Type of value2:", _____)
print("Type of value3:", _____)
print("Type of value4:", _____)</textarea>
                                <button onclick="runExtensionCode('tryType')" class="btn run-btn">‚ñ∂ Run</button>
                                <div class="extension-output" id="output-tryType"></div>
                                <button onclick="checkExtensionComplete('type-checking', 'tryType')" class="btn check-btn">‚úì Check</button>
                                <div id="feedback-tryType"></div>
                            </div>
                        </div>
                    </div>
                `
            },
            'format-strings': {
                title: 'Format Strings',
                content: `
                    <div class="extension-header">
                        <h2>Format Strings</h2>
                        <button class="btn back-btn" onclick="backToExtensionList()">‚Üê Back</button>
                    </div>
                    
                    <div class="extension-content">
                        <div class="concept-section">
                            <h3>Better Way to Combine Strings</h3>
                            <p>F-strings make it easier to include variables in your strings!</p>
                            
                            <div class="example-box">
                                <h4>Example: Using f-strings</h4>
                                <textarea class="extension-code" readonly>name = "Alice"
age = 15
height = 1.65

# Old way
print("My name is " + name + " and I am " + str(age) + " years old")

# New way with f-string
print(f"My name is {name} and I am {age} years old")</textarea>
                            </div>
                            
                            <div class="try-it">
                                <h4>Try it yourself!</h4>
                                <p>Create a player stats display using f-strings:</p>
                                <textarea class="extension-code" id="tryFormat">player_name = "Alex"
score = 1250
level = 7
health = 85.5

# Create a stats display using f-strings
stats = f"Player: _____ | Score: _____ | Level: _____ | Health: _____"
print(stats)</textarea>
                                <button onclick="runExtensionCode('tryFormat')" class="btn run-btn">‚ñ∂ Run</button>
                                <div class="extension-output" id="output-tryFormat"></div>
                                <button onclick="checkExtensionComplete('format-strings', 'tryFormat')" class="btn check-btn">‚úì Check</button>
                                <div id="feedback-tryFormat"></div>
                            </div>
                        </div>
                    </div>
                `
            },
            'advanced-conversion': {
                title: 'Advanced Type Conversion',
                content: `
                    <div class="extension-header">
                        <h2>Advanced Type Conversion</h2>
                        <button class="btn back-btn" onclick="backToExtensionList()">‚Üê Back</button>
                    </div>
                    
                    <div class="extension-content">
                        <div class="concept-section">
                            <h3>Converting Between All Types</h3>
                            <p>Learn to convert between strings, integers, floats, and booleans!</p>
                            
                            <div class="example-box">
                                <h4>Example: Various conversions</h4>
                                <textarea class="extension-code" readonly># String to float
price_str = "19.99"
price_float = float(price_str)
print(f"Price as float: {price_float}")

# Float to int (removes decimal part!)
rounded_price = int(price_float)
print(f"Rounded price: {rounded_price}")

# Boolean to string
is_available = True
status = str(is_available)
print(f"Status: {status}")</textarea>
                            </div>
                            
                            <div class="try-it">
                                <h4>Challenge: Temperature Converter</h4>
                                <p>Complete the temperature converter:</p>
                                <textarea class="extension-code" id="tryAdvanced"># Get temperature as string
temp_str = "72.5"

# Convert to float
temp_f = float(_____)

# Convert Fahrenheit to Celsius: (F - 32) * 5/9
temp_c = (_____ - 32) * 5/9

# Round to nearest integer
temp_c_rounded = int(_____)

# Create output message
print(f"{temp_str}¬∞F is approximately {_____}¬∞C")</textarea>
                                <button onclick="runExtensionCode('tryAdvanced')" class="btn run-btn">‚ñ∂ Run</button>
                                <div class="extension-output" id="output-tryAdvanced"></div>
                                <button onclick="checkExtensionComplete('advanced-conversion', 'tryAdvanced')" class="btn check-btn">‚úì Check</button>
                                <div id="feedback-tryAdvanced"></div>
                            </div>
                        </div>
                    </div>
                `
            }
        };

        // Extension checks
        const extensionChecks = {
            'float-type': {
                check: (code, output) => {
                    return code.includes('weight / (height * height)') || code.includes('weight/(height*height)') ||
                           code.includes('70.5 / (1.75 * 1.75)') || code.includes('70.5/(1.75*1.75)');
                },
                hint: "Calculate BMI using: weight / (height * height)"
            },
            'boolean-type': {
                check: (code, output) => {
                    return code.includes('True') && output.includes('Correct!');
                },
                hint: "Set python_is_fun to True"
            },
            'type-checking': {
                check: (code, output) => {
                    const typeCount = (code.match(/type\(/g) || []).length;
                    return typeCount >= 4 && output.includes('str') && output.includes('int') && 
                           output.includes('float') && output.includes('bool');
                },
                hint: "Use type() function for each value"
            },
            'format-strings': {
                check: (code, output) => {
                    return code.includes('{player_name}') && code.includes('{score}') && 
                           code.includes('{level}') && code.includes('{health}');
                },
                hint: "Put variable names inside {} in the f-string"
            },
            'advanced-conversion': {
                check: (code, output) => {
                    return output.includes('72.5¬∞F is approximately 23¬∞C') || 
                           output.includes('72.5¬∞F is approximately 22¬∞C');
                },
                hint: "Use float(temp_str), then temp_f in the formula, then int() for rounding"
            }
        };

        // Global variables
        let currentTask = 1;
        let pyodide = null;
        let editors = {};
        let extensionEditors = {};
        let taskProgress = {};
        let extensionProgress = {};
        let taskStartTime = {};
        let userProfile = {
            xp: 0,
            badges: [],
            streak: 0,
            lastActive: new Date().toDateString()
        };
        let settings = {
            dyslexicFont: false,
            darkMode: false,
            audioInstructions: false,
            syntaxCheck: true
        };
        let memoryStorage = {};

        // Initialize extension progress
        Object.keys(extensionTopics).forEach(topic => {
            extensionProgress[topic] = {
                completed: false,
                xp: parseInt(document.querySelector(`[onclick="showExtensionTopic('${topic}')"] .extension-xp`).textContent.replace('+', '').replace(' XP', ''))
            };
        });

        // Initialize Pyodide
        async function initializePyodide() {
            const outputElements = document.querySelectorAll('.output-box');
            outputElements.forEach(el => {
                if (el) el.innerHTML = '<span style="color: #fbbf24;">Loading Python interpreter...</span>';
            });
            
            try {
                pyodide = await loadPyodide({
                    indexURL: "https://cdn.jsdelivr.net/pyodide/v0.24.1/full/"
                });
                
                // Set up input handling
                pyodide.globals.set("input", (prompt) => {
                    return window.prompt(prompt || "Enter input:");
                });
                
                outputElements.forEach(el => {
                    if (el) el.innerHTML = '<span style="color: #10b981;">Python ready! Click "Run" to execute your code.</span>';
                });
            } catch (error) {
                outputElements.forEach(el => {
                    if (el) el.innerHTML = '<span class="error">Failed to load Python. Please refresh.</span>';
                });
                console.error('Failed to load Pyodide:', error);
            }
        }

        // Initialize CodeMirror editor
        function initializeEditor(taskNum) {
            const textarea = document.getElementById(`code${taskNum}`);
            if (!textarea) return null;
            
            if (editors[taskNum]) {
                editors[taskNum].refresh();
                return editors[taskNum];
            }
            
            const editor = CodeMirror.fromTextArea(textarea, {
                mode: 'python',
                theme: settings.darkMode ? 'monokai' : 'default',
                lineNumbers: true,
                indentUnit: 4,
                lineWrapping: true,
                matchBrackets: true,
                autoCloseBrackets: true,
                extraKeys: {
                    'Tab': 'indentMore',
                    'Shift-Tab': 'indentLess',
                    'Ctrl-Space': 'autocomplete'
                }
            });
            
            editor.on('change', () => {
                saveProgress(taskNum);
                if (settings.syntaxCheck) {
                    // Basic syntax checking could be added here
                }
            });
            
            editors[taskNum] = editor;
            return editor;
        }

        // Run Python code
        async function runCode(taskNum) {
            if (!pyodide) {
                alert('Python is still loading. Please wait a moment.');
                return;
            }
            
            const editor = editors[taskNum];
            if (!editor) return;
            
            const code = editor.getValue();
            const outputElement = document.getElementById(`output${taskNum}`);
            
            outputElement.innerHTML = '<span style="color: #fbbf24;">Running...</span>';
            
            try {
                // Redirect stdout
                pyodide.runPython(`
                    import sys
                    from io import StringIO
                    sys.stdout = StringIO()
                `);
                
                // Run user code
                await pyodide.runPythonAsync(code);
                
                // Get output
                const output = pyodide.runPython("sys.stdout.getvalue()");
                outputElement.textContent = output || 'Code executed successfully (no output)';
                
                // Store output for checking
                outputElement.dataset.lastOutput = output;
                
            } catch (error) {
                outputElement.innerHTML = `<span class="error">Error: ${error.message}</span>`;
                outputElement.dataset.lastOutput = `Error: ${error.message}`;
            }
        }

        // Run extension code
        async function runExtensionCode(editorId) {
            if (!pyodide) {
                alert('Python is still loading. Please wait a moment.');
                return;
            }
            
            const textarea = document.getElementById(editorId);
            const outputElement = document.getElementById(`output-${editorId}`);
            
            // Get code from CodeMirror or textarea
            let code;
            const cm = textarea.nextSibling;
            if (cm && cm.CodeMirror) {
                code = cm.CodeMirror.getValue();
            } else {
                code = textarea.value;
            }
            
            outputElement.innerHTML = '<span style="color: #fbbf24;">Running...</span>';
            
            try {
                // Redirect stdout
                pyodide.runPython(`
                    import sys
                    from io import StringIO
                    sys.stdout = StringIO()
                `);
                
                // Run user code
                await pyodide.runPythonAsync(code);
                
                // Get output
                const output = pyodide.runPython("sys.stdout.getvalue()");
                outputElement.textContent = output || 'Code executed successfully (no output)';
                
            } catch (error) {
                outputElement.innerHTML = `<span class="error">Error: ${error.message}</span>`;
            }
        }

        // Check code
        function checkCode(taskNum) {
            const editor = editors[taskNum];
            if (!editor) return;
            
            const code = editor.getValue();
            const output = document.getElementById(`output${taskNum}`).dataset.lastOutput || '';
            const task = tasks[taskNum];
            const feedbackElement = document.getElementById(`feedback${taskNum}`);
            
            let allPassed = true;
            let feedback = '<div class="feedback success" style="display: block;">';
            
            task.tests.forEach((test, index) => {
                if (test.test(code, output)) {
                    feedback += `<p>‚úì ${test.description}</p>`;
                } else {
                    feedback += `<p style="color: #ef4444;">‚úó ${test.description}</p>`;
                    allPassed = false;
                }
            });
            
            feedback += '</div>';
            feedbackElement.innerHTML = feedback;
            
            if (allPassed) {
                completeTask(taskNum);
            }
        }

        // Check extension complete
        async function checkExtensionComplete(topic, editorId) {
            const textarea = document.getElementById(editorId);
            const feedbackDiv = document.getElementById(`feedback-${editorId}`);
            
            // Get code from CodeMirror or textarea
            let code;
            const cm = textarea.nextSibling;
            if (cm && cm.CodeMirror) {
                code = cm.CodeMirror.getValue();
            } else {
                code = textarea.value;
            }
            
            // Get the output
            const outputDiv = document.getElementById(`output-${editorId}`);
            const output = outputDiv.textContent || '';
            
            // Check if the task is completed correctly
            const check = extensionChecks[topic];
            if (check && check.check(code, output)) {
                // Success!
                if (!extensionProgress[topic].completed) {
                    extensionProgress[topic].completed = true;
                    const xpEarned = extensionProgress[topic].xp;
                    
                    feedbackDiv.innerHTML = `<div class="test-result test-pass">
                        ‚úì Excellent work! You've mastered ${topic.replace(/-/g, ' ')}!
                        <span class="xp-gained">+${xpEarned} XP</span>
                    </div>`;
                    
                    // Award XP
                    awardXP(xpEarned);
                    
                    // Update extension status in sidebar
                    updateExtensionStatus(topic);
                    
                    // Check for extension badge
                    checkExtensionBadges();
                    
                    // Save progress
                    saveExtensionProgress();
                    
                    // Show achievement for first extension
                    const completedCount = Object.values(extensionProgress).filter(e => e.completed).length;
                    if (completedCount === 1) {
                        showAchievement('üöÄ', 'Extension Explorer!', 'You completed your first extension activity!', 50);
                    } else if (completedCount === Object.keys(extensionProgress).length) {
                        showAchievement('üåü', 'Extension Master!', 'You completed all extension activities!', 100);
                    }
                } else {
                    feedbackDiv.innerHTML = `<div class="test-result test-pass">
                        ‚úì Correct! You've already completed this activity.
                    </div>`;
                }
            } else {
                feedbackDiv.innerHTML = `<div class="test-result test-fail">
                    Not quite right. ${check ? check.hint : 'Try again!'}
                </div>`;
            }
        }

        // Update extension status
        function updateExtensionStatus(topic) {
            const statusElement = document.getElementById(`ext-status-${topic}`);
            if (statusElement) {
                statusElement.classList.add('completed');
            }
        }

        // Show hint
        function showHint(taskNum) {
            const hintElement = document.getElementById(`hint${taskNum}`);
            hintElement.style.display = 'block';
            
            // Deduct XP for using hint
            taskProgress[taskNum] = taskProgress[taskNum] || {};
            taskProgress[taskNum].hintUsed = true;
        }

        // Reset code
        function resetCode(taskNum) {
            const editor = editors[taskNum];
            if (!editor) return;
            
            editor.setValue(tasks[taskNum].initialCode);
            document.getElementById(`output${taskNum}`).textContent = 'Output will appear here...';
            document.getElementById(`feedback${taskNum}`).innerHTML = '';
            document.getElementById(`hint${taskNum}`).style.display = 'none';
        }

        // Complete task
        function completeTask(taskNum) {
            if (!taskProgress[taskNum]) {
                taskProgress[taskNum] = {};
            }
            
            if (!taskProgress[taskNum].completed) {
                taskProgress[taskNum].completed = true;
                
                // Calculate time taken
                const timeTaken = taskStartTime[taskNum] ? 
                    Math.round((new Date() - taskStartTime[taskNum]) / 1000) : 0;
                taskProgress[taskNum].timeTaken = timeTaken;
                
                // Award XP
                const xpValues = [75, 100, 75, 100, 125, 125, 100, 125, 200, 200];
                const xpEarned = xpValues[taskNum - 1] * (taskProgress[taskNum].hintUsed ? 0.7 : 1);
                awardXP(Math.round(xpEarned));
                
                // Update UI
                document.getElementById(`status${taskNum}`).classList.add('completed');
                updateProgress();
                
                // Check for badges
                checkBadges();
                
                // Show celebration
                showCelebration(`Task completed! +${Math.round(xpEarned)} XP`);
                
                // Check for perfect run
                checkPerfectRun();
                
                // Auto-advance to next task after delay
                setTimeout(() => {
                    if (taskNum < 9) {  // Don't auto-advance from challenge to assessment
                        switchTask(taskNum + 1);
                    }
                }, 2000);
            }
        }

        // Award XP
        function awardXP(amount) {
            userProfile.xp += amount;
            updateProgress();
            saveAllProgress();
        }

        // Check and award badges
        function checkBadges() {
            const completedCount = Object.values(taskProgress).filter(t => t.completed).length;
            
            // String Master - complete task 1
            if (taskProgress[1]?.completed && !userProfile.badges.includes('string')) {
                awardBadge('string', 'String Master', 'üî§');
            }
            
            // Number Ninja - complete task 2
            if (taskProgress[2]?.completed && !userProfile.badges.includes('integer')) {
                awardBadge('integer', 'Number Ninja', 'üî¢');
            }
            
            // Type Converter - complete tasks 4 and 5
            if (taskProgress[4]?.completed && taskProgress[5]?.completed && !userProfile.badges.includes('converter')) {
                awardBadge('converter', 'Type Converter', 'üîÑ');
            }
            
            // Error Handler - complete task 3
            if (taskProgress[3]?.completed && !userProfile.badges.includes('error')) {
                awardBadge('error', 'Error Handler', '‚ö†Ô∏è');
            }
            
            // Data Types Expert - complete all main tasks
            if (completedCount >= 9 && !userProfile.badges.includes('complete')) {
                awardBadge('complete', 'Data Types Expert', 'üèÜ');
            }
        }

        // Check extension badges
        function checkExtensionBadges() {
            const completedExtensions = Object.values(extensionProgress).filter(e => e.completed).length;
            
            if (completedExtensions >= 3 && !userProfile.badges.includes('extension-enthusiast')) {
                awardBadge('extension-enthusiast', 'Extension Enthusiast', 'üí´');
            }
            
            if (completedExtensions === Object.keys(extensionProgress).length && !userProfile.badges.includes('extension-master')) {
                awardBadge('extension-master', 'Extension Master', 'üåü');
            }
        }

        // Award badge
        function awardBadge(badgeId, badgeName, icon) {
            userProfile.badges.push(badgeId);
            const badgeElement = document.getElementById(`badge-${badgeId}`);
            if (badgeElement) {
                badgeElement.classList.add('earned', 'pulse');
            }
            showAchievement(icon || 'üèÜ', badgeName, 'Badge earned!', 100);
            createConfetti();
            saveAllProgress();
        }

        // Check for perfect run
        function checkPerfectRun() {
            const noHints = Object.values(taskProgress).every(t => !t.hintUsed);
            const allCompleted = Object.values(taskProgress).filter(t => t.completed).length >= 9;
            
            if (noHints && allCompleted && !userProfile.badges.includes('perfect')) {
                setTimeout(() => {
                    awardBadge('perfect', 'Perfect Run!', '‚≠ê');
                    awardXP(300); // Bonus XP for perfect run
                    showAchievement('üåü', 'Perfect Run!', 'Completed all tasks without hints! +300 bonus XP', 200);
                }, 1000);
            }
        }

        // Show celebration
        function showCelebration(message, duration = 2000) {
            const celebration = document.getElementById('celebration');
            document.getElementById('celebrationMessage').textContent = message;
            celebration.style.display = 'block';
            
            setTimeout(() => {
                celebration.style.display = 'none';
            }, duration);
        }

        // Show achievement popup
        function showAchievement(icon, title, description, xp) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementIcon').textContent = icon;
            document.getElementById('achievementTitle').textContent = title;
            document.getElementById('achievementDesc').textContent = description + (xp ? ` +${xp} XP` : '');
            
            popup.style.display = 'block';
            
            setTimeout(() => {
                popup.style.display = 'none';
            }, 3000);
        }

        // Create confetti effect
        function createConfetti() {
            const canvas = document.getElementById('confetti-canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            canvas.style.display = 'block';
            
            const particles = [];
            const colors = ['#22c55e', '#3b82f6', '#f59e0b', '#ef4444', '#8b5cf6'];
            
            for (let i = 0; i < 100; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height - canvas.height,
                    vx: Math.random() * 2 - 1,
                    vy: Math.random() * 3 + 2,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    size: Math.random() * 5 + 5
                });
            }
            
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                particles.forEach((p, index) => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vy += 0.1;
                    
                    ctx.fillStyle = p.color;
                    ctx.fillRect(p.x, p.y, p.size, p.size);
                    
                    if (p.y > canvas.height) {
                        particles.splice(index, 1);
                    }
                });
                
                if (particles.length > 0) {
                    requestAnimationFrame(animate);
                } else {
                    canvas.style.display = 'none';
                }
            }
            
            animate();
        }

        // Close celebration
        function closeCelebration() {
            document.getElementById('celebration').style.display = 'none';
        }

        // Update progress
        function updateProgress() {
            const completedTasks = Object.values(taskProgress).filter(t => t.completed).length;
            const completedExtensions = Object.values(extensionProgress).filter(e => e.completed).length;
            const totalTasks = 9; // Excluding assessment
            const totalExtensions = Object.keys(extensionProgress).length;
            
            const taskPercentage = (completedTasks / totalTasks) * 70; // 70% for main tasks
            const extensionPercentage = (completedExtensions / totalExtensions) * 30; // 30% for extensions
            const totalPercentage = taskPercentage + extensionPercentage;
            
            document.getElementById('progressBar').style.width = totalPercentage + '%';
            document.getElementById('progressText').textContent = 
                `${completedTasks}/${totalTasks} lessons, ${completedExtensions}/${totalExtensions} extensions completed`;
            
            saveAllProgress();
        }

        // Switch between tasks
        function switchTask(taskNum) {
            currentTask = taskNum;
            
            // Hide extension content and show task content
            document.getElementById('extensionContent').style.display = 'none';
            document.getElementById('taskContent').style.display = 'block';
            
            // Update sidebar - remove active from all items
            document.querySelectorAll('.task-item').forEach((item, index) => {
                item.classList.toggle('active', index + 1 === taskNum);
            });
            document.querySelectorAll('.extension-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Destroy all existing editors to prevent display issues
            Object.keys(editors).forEach(key => {
                if (editors[key]) {
                    editors[key].toTextArea();
                    delete editors[key];
                }
            });
            
            // Load task content
            loadTaskContent(taskNum);
            
            // Create new editor after content is loaded
            setTimeout(() => {
                if (taskNum !== 10) { // Assessment doesn't have an editor
                    const editor = initializeEditor(taskNum);
                    loadProgress(taskNum);
                    
                    // Force multiple refreshes to ensure proper display
                    if (editor) {
                        editor.refresh();
                        setTimeout(() => {
                            editor.refresh();
                            editor.focus();
                            editor.setCursor(editor.lineCount(), 0);
                        }, 100);
                    }
                }
            }, 50);
            
            // Record task start time
            taskStartTime[taskNum] = new Date();
        }

        // Load task content
        function loadTaskContent(taskNum) {
            const task = tasks[taskNum];
            const contentArea = document.getElementById('taskContent');
            
            if (taskNum === 10) {
                // Assessment content is already in the task definition
                contentArea.innerHTML = `
                    <div class="task-header">
                        <h2 class="task-title">${task.title}</h2>
                        <span class="xp-badge">+200 XP</span>
                    </div>
                    ${task.content}
                `;
                
                // Initialize assessment code editor
                setTimeout(() => {
                    const assessmentCode = document.getElementById('q4-code');
                    if (assessmentCode && !assessmentCode.nextSibling || !assessmentCode.nextSibling.CodeMirror) {
                        CodeMirror.fromTextArea(assessmentCode, {
                            mode: 'python',
                            theme: settings.darkMode ? 'monokai' : 'default',
                            lineNumbers: true,
                            indentUnit: 4,
                            lineWrapping: true
                        });
                    }
                }, 100);
            } else {
                const xpValues = [75, 100, 75, 100, 125, 125, 100, 125, 200];
                contentArea.innerHTML = `
                    <div class="task-header">
                        <h2 class="task-title">${task.title}</h2>
                        <span class="xp-badge">+${xpValues[taskNum - 1]} XP</span>
                    </div>
                    
                    ${task.content}
                    
                    <div class="code-editor">
                        <div class="editor-header">
                            <span class="editor-title">Python Code Editor</span>
                            <span>üêç</span>
                        </div>
                        <textarea id="code${taskNum}" class="code-textarea">${task.initialCode}</textarea>
                    </div>
                    
                    <div class="controls">
                        <button class="btn run-btn" onclick="runCode(${taskNum})">‚ñ∂ Run</button>
                        <button class="btn check-btn" onclick="checkCode(${taskNum})">‚úì Check</button>
                        <button class="btn hint-btn" onclick="showHint(${taskNum})">üí° Hint</button>
                        <button class="btn reset-btn" onclick="resetCode(${taskNum})">‚Ü∫ Reset</button>
                    </div>
                    
                    <div class="output-label">Output</div>
                    <div class="output-box" id="output${taskNum}">Output will appear here...</div>
                    
                    <div id="feedback${taskNum}"></div>
                    
                    <div class="hint-box" id="hint${taskNum}">
                        <strong>Hint:</strong> ${task.hint}
                    </div>
                `;
            }
        }

        // Show extension topic
        function showExtensionTopic(topic) {
            // Update active states
            document.querySelectorAll('.extension-item').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
            
            // Show extension content
            document.getElementById('taskContent').style.display = 'none';
            document.getElementById('extensionContent').style.display = 'block';
            
            const content = extensionTopics[topic];
            document.getElementById('extensionContent').innerHTML = content.content;
            
            // Initialize extension code editors
            setTimeout(() => {
                document.querySelectorAll('.extension-code').forEach(textarea => {
                    if (!textarea.readOnly && (!textarea.nextSibling || !textarea.nextSibling.CodeMirror)) {
                        CodeMirror.fromTextArea(textarea, {
                            mode: 'python',
                            theme: settings.darkMode ? 'monokai' : 'default',
                            lineNumbers: true,
                            indentUnit: 4,
                            lineWrapping: true,
                            matchBrackets: true,
                            autoCloseBrackets: true
                        });
                    }
                });
            }, 50);
        }

        // Back to extension list
        function backToExtensionList() {
            document.getElementById('extensionContent').style.display = 'none';
            document.getElementById('taskContent').style.display = 'block';
            
            // Show the first incomplete task or the last task
            const incompleteTasks = Object.keys(tasks).filter(num => !taskProgress[num]?.completed);
            const taskToShow = incompleteTasks.length > 0 ? incompleteTasks[0] : currentTask;
            switchTask(parseInt(taskToShow));
        }

        // Toggle extension section
        function toggleExtension() {
            const section = document.getElementById('extensionSection');
            const arrow = document.getElementById('extensionArrow');
            
            if (section.style.display === 'none') {
                section.style.display = 'block';
                arrow.textContent = '‚ñº';
            } else {
                section.style.display = 'none';
                arrow.textContent = '‚ñ∂';
            }
        }

        // Submit assessment
        async function submitAssessment() {
            const results = {
                q1: document.querySelector('input[name="q1"]:checked')?.value,
                q2: document.getElementById('q2-answer').value.trim(),
                q3: document.querySelector('input[name="q3"]:checked')?.value,
                q4: ''
            };
            
            // Get code from Q4
            const q4textarea = document.getElementById('q4-code');
            if (q4textarea.nextSibling && q4textarea.nextSibling.CodeMirror) {
                results.q4 = q4textarea.nextSibling.CodeMirror.getValue();
            } else {
                results.q4 = q4textarea.value;
            }
            
            // Check answers
            let score = 0;
            const feedback = [];
            
            // Q1: Which is a string?
            if (results.q1 === '1') {
                score++;
                feedback.push('Q1: ‚úì Correct! "123" is a string because it has quotes.');
            } else {
                feedback.push('Q1: ‚úó Remember, strings have quotes around them.');
            }
            
            // Q2: "10" + "20"
            if (results.q2 === '1020') {
                score++;
                feedback.push('Q2: ‚úì Correct! String concatenation joins the strings.');
            } else {
                feedback.push('Q2: ‚úó String concatenation joins strings, not adds them.');
            }
            
            // Q3: str() function
            if (results.q3 === '1') {
                score++;
                feedback.push('Q3: ‚úì Correct! str() converts to string.');
            } else {
                feedback.push('Q3: ‚úó The str() function converts values to strings.');
            }
            
            // Q4: Code challenge
            let q4Correct = false;
            if (results.q4) {
                try {
                    // Check if code adds 15 and 25 and converts to string
                    if (results.q4.includes('15') && results.q4.includes('25') && 
                        (results.q4.includes('str(40)') || results.q4.includes('str(15 + 25)') || 
                         results.q4.includes('str(15+25)') || results.q4.includes('str(result)') ||
                         results.q4.includes('str(total)'))) {
                        q4Correct = true;
                    }
                } catch (e) {}
            }
            
            if (q4Correct) {
                score++;
                feedback.push('Q4: ‚úì Excellent! Your code correctly adds and converts to string.');
            } else {
                feedback.push('Q4: ‚úó Make sure to add 15 + 25, then convert the result to a string.');
            }
            
            // Display results
            const resultsDiv = document.getElementById('assessment-results');
            const percentage = Math.round((score / 4) * 100);
            
            resultsDiv.innerHTML = `
                <div class="assessment-result">
                    <h3>Assessment Complete!</h3>
                    <p style="font-size: 2rem; margin: 20px 0;">Score: ${score}/4 (${percentage}%)</p>
                    <div style="text-align: left; margin: 20px auto; max-width: 600px;">
                        ${feedback.map(f => `<p style="margin: 10px 0;">${f}</p>`).join('')}
                    </div>
                    ${percentage === 100 ? '<p style="color: #22c55e; font-weight: bold;">Perfect score! üéâ</p>' : ''}
                    ${percentage >= 75 ? '<p>Great job! You understand data types well.</p>' : '<p>Keep practicing! Review the lessons and try again.</p>'}
                </div>
            `;
            resultsDiv.style.display = 'block';
            
            // Complete assessment
            if (percentage >= 75 && !taskProgress[10]?.completed) {
                taskProgress[10] = { completed: true };
                awardXP(200);
                updateProgress();
                saveAllProgress();
                
                if (percentage === 100) {
                    showAchievement('üíØ', 'Perfect Assessment!', 'You aced the data types assessment!', 50);
                }
            }
            
            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Save/Load functions
        function saveProgress(taskNum) {
            if (!editors[taskNum]) return;
            
            const code = editors[taskNum].getValue();
            const progress = {
                code: code,
                timestamp: new Date().toISOString()
            };
            
            // Save to memory storage
            if (!memoryStorage.pythonDataTypes) {
                memoryStorage.pythonDataTypes = {};
            }
            memoryStorage.pythonDataTypes[`task${taskNum}`] = progress;
        }

        function loadProgress(taskNum) {
            if (memoryStorage.pythonDataTypes && memoryStorage.pythonDataTypes[`task${taskNum}`]) {
                const progress = memoryStorage.pythonDataTypes[`task${taskNum}`];
                if (editors[taskNum]) {
                    editors[taskNum].setValue(progress.code);
                }
            }
        }

        function saveAllProgress() {
            memoryStorage.pythonDataTypes_taskProgress = { ...taskProgress };
            memoryStorage.pythonDataTypes_userProfile = { ...userProfile };
            memoryStorage.pythonDataTypes_extensionProgress = { ...extensionProgress };
            
            // Update streak
            const today = new Date().toDateString();
            if (userProfile.lastActive !== today) {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                if (userProfile.lastActive === yesterday.toDateString()) {
                    userProfile.streak++;
                } else {
                    userProfile.streak = 1;
                }
                userProfile.lastActive = today;
            }
        }

        function loadAllProgress() {
            if (memoryStorage.pythonDataTypes_taskProgress) {
                taskProgress = { ...memoryStorage.pythonDataTypes_taskProgress };
                Object.keys(taskProgress).forEach(taskNum => {
                    if (taskProgress[taskNum].completed) {
                        document.getElementById(`status${taskNum}`).classList.add('completed');
                    }
                });
            }
            
            if (memoryStorage.pythonDataTypes_userProfile) {
                userProfile = { ...memoryStorage.pythonDataTypes_userProfile };
                userProfile.badges.forEach(badge => {
                    const badgeElement = document.getElementById(`badge-${badge}`);
                    if (badgeElement) {
                        badgeElement.classList.add('earned');
                    }
                });
            }
            
            if (memoryStorage.pythonDataTypes_extensionProgress) {
                extensionProgress = { ...memoryStorage.pythonDataTypes_extensionProgress };
                Object.keys(extensionProgress).forEach(topic => {
                    if (extensionProgress[topic].completed) {
                        updateExtensionStatus(topic);
                    }
                });
            }
            
            updateProgress();
        }

        function saveExtensionProgress() {
            memoryStorage.pythonDataTypes_extensionProgress = { ...extensionProgress };
        }

        // Settings functions
        function toggleDyslexicFont() {
            settings.dyslexicFont = !settings.dyslexicFont;
            document.body.classList.toggle('dyslexic-font', settings.dyslexicFont);
            document.getElementById('dyslexicToggle').classList.toggle('active', settings.dyslexicFont);
            saveSettings();
        }

        function toggleDarkMode() {
            settings.darkMode = !settings.darkMode;
            document.body.classList.toggle('dark-mode', settings.darkMode);
            document.getElementById('darkModeToggle').classList.toggle('active', settings.darkMode);
            
            // Update all CodeMirror instances
            const newTheme = settings.darkMode ? 'monokai' : 'default';
            
            // Update task editors
            Object.values(editors).forEach(editor => {
                editor.setOption('theme', newTheme);
            });
            
            // Update all CodeMirror instances on the page
            document.querySelectorAll('.CodeMirror').forEach(cm => {
                if (cm.CodeMirror) {
                    cm.CodeMirror.setOption('theme', newTheme);
                }
            });
            
            saveSettings();
        }

        function toggleAudioInstructions() {
            settings.audioInstructions = !settings.audioInstructions;
            document.getElementById('audioToggle').classList.toggle('active', settings.audioInstructions);
            
            if (settings.audioInstructions) {
                // Could implement text-to-speech here
                showAchievement('üîä', 'Audio Enabled', 'Audio instructions are now active', 0);
            }
            
            saveSettings();
        }

        function toggleSyntaxCheck() {
            settings.syntaxCheck = !settings.syntaxCheck;
            document.getElementById('syntaxToggle').classList.toggle('active', settings.syntaxCheck);
            
            if (settings.syntaxCheck) {
                showAchievement('‚úÖ', 'Syntax Check Enabled', 'Live syntax checking is now active', 0);
            }
            
            saveSettings();
        }

        function saveSettings() {
            memoryStorage.pythonDataTypes_settings = { ...settings };
        }

        function loadSettings() {
            if (memoryStorage.pythonDataTypes_settings) {
                settings = { ...memoryStorage.pythonDataTypes_settings };
                
                if (settings.dyslexicFont) {
                    document.body.classList.add('dyslexic-font');
                    document.getElementById('dyslexicToggle').classList.add('active');
                }
                
                if (settings.darkMode) {
                    document.body.classList.add('dark-mode');
                    document.getElementById('darkModeToggle').classList.add('active');
                }
                
                if (settings.audioInstructions) {
                    document.getElementById('audioToggle').classList.add('active');
                }
                
                if (settings.syntaxCheck) {
                    document.getElementById('syntaxToggle').classList.add('active');
                }
            }
        }

        // Reset section
        function resetSection() {
            if (confirm('Are you sure you want to reset all progress in this section? This cannot be undone!')) {
                // Clear all progress
                taskProgress = {};
                extensionProgress = {};
                Object.keys(extensionTopics).forEach(topic => {
                    extensionProgress[topic] = {
                        completed: false,
                        xp: parseInt(document.querySelector(`[onclick="showExtensionTopic('${topic}')"] .extension-xp`).textContent.replace('+', '').replace(' XP', ''))
                    };
                });
                
                // Reset UI
                document.querySelectorAll('.task-status').forEach(status => {
                    status.classList.remove('completed');
                });
                document.querySelectorAll('.extension-status').forEach(status => {
                    status.classList.remove('completed');
                });
                
                // Reset user XP and badges for this section
                userProfile.xp = Math.max(0, userProfile.xp - 1225); // Remove section XP
                userProfile.badges = userProfile.badges.filter(b => 
                    !['string', 'integer', 'converter', 'error', 'complete', 'extension-enthusiast', 'extension-master', 'perfect'].includes(b)
                );
                
                // Update badges UI
                document.querySelectorAll('.badge').forEach(badge => {
                    badge.classList.remove('earned', 'pulse');
                });
                
                // Clear memory storage for this section
                delete memoryStorage.pythonDataTypes;
                delete memoryStorage.pythonDataTypes_taskProgress;
                delete memoryStorage.pythonDataTypes_extensionProgress;
                
                // Update progress
                updateProgress();
                saveAllProgress();
                
                // Switch to first task
                switchTask(1);
                
                showAchievement('üîÑ', 'Section Reset', 'All progress has been cleared', 0);
            }
        }

        // Initialize on page load
        window.addEventListener('load', async () => {
            loadSettings();
            loadAllProgress();
            await initializePyodide();
            switchTask(1);
        });
    </script>
</body>
</html>