<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 1: Binary - The Language of Computers</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        
        /* Disable all text selection and copy/paste */
        * {
            -webkit-user-select: none !important;
            -moz-user-select: none !important;
            -ms-user-select: none !important;
            user-select: none !important;
        }
        
        /* Disable copy/paste in input areas too */
        input, textarea, select {
            -webkit-user-select: none !important;
            -moz-user-select: none !important;
            -ms-user-select: none !important;
            user-select: none !important;
        }
        
        /* Enable selection for canvas only */
        canvas {
            -webkit-user-select: auto !important;
            -moz-user-select: auto !important;
            -ms-user-select: auto !important;
            user-select: auto !important;
        }
        
        .binary-glow {
            animation: binaryGlow 2s ease-in-out infinite;
        }
        
        @keyframes binaryGlow {
            0%, 100% {
                box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
            }
            50% {
                box-shadow: 0 0 40px rgba(59, 130, 246, 0.8);
            }
        }
        
        .bit-switch {
            width: 60px;
            height: 30px;
            background-color: #e5e7eb;
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .bit-switch.on {
            background-color: #3b82f6;
        }
        
        .bit-switch-handle {
            width: 26px;
            height: 26px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .bit-switch.on .bit-switch-handle {
            transform: translateX(30px);
        }
        
        .draggable {
            cursor: move;
            transition: all 0.3s ease;
            user-select: none;
        }
        
        .draggable:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .drop-zone {
            min-height: 50px;
            transition: all 0.3s ease;
        }
        
        .drop-zone.drag-over {
            background-color: #dbeafe;
            border-color: #3b82f6;
            transform: scale(1.02);
        }
        
        @keyframes correct-pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }
        
        .correct-answer {
            animation: correct-pulse 0.6s ease;
        }
        
        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-5px);
            }
            75% {
                transform: translateX(5px);
            }
        }
        
        .wrong-answer {
            animation: shake 0.5s ease;
        }
        
        .achievement-unlock {
            animation: achievementPop 0.5s ease-out;
        }
        
        @keyframes achievementPop {
            0% {
                transform: scale(0) rotate(0deg);
                opacity: 0;
            }
            50% {
                transform: scale(1.2) rotate(5deg);
            }
            100% {
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }
        
        .pulse {
            animation: pulse 1.5s ease-in-out infinite;
        }
        
        .binary-rain {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            opacity: 0.1;
        }
        
        .binary-drop {
            position: absolute;
            color: #3b82f6;
            font-family: monospace;
            font-size: 20px;
            animation: fall linear infinite;
        }
        
        @keyframes fall {
            to {
                transform: translateY(100vh);
            }
        }
        
        .working-canvas {
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background-color: #fafafa;
            cursor: crosshair;
            touch-action: none;
            display: block;
            margin: 0 auto;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-purple-50 to-indigo-50 min-h-screen p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header with Binary Animation -->
        <header class="text-center mb-8 relative">
            <div class="binary-rain" id="binaryRain"></div>
            <h1 class="text-4xl md:text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600 mb-2 relative z-10">
                Binary: The Language of Computers üî¢
            </h1>
            <p class="text-gray-600 text-lg relative z-10">Master the fundamental language of digital systems!</p>
            
            <!-- XP and Level Bar -->
            <div class="mt-6 bg-white rounded-full p-2 shadow-lg max-w-md mx-auto relative z-10">
                <div class="flex items-center justify-between">
                    <span class="text-sm font-bold text-gray-700 ml-3" id="levelText">Level 1: Binary Rookie</span>
                    <span class="text-sm font-bold text-blue-600 mr-3"><span id="xpPoints">0</span> XP</span>
                </div>
                <div class="bg-gray-200 rounded-full h-3 mt-2">
                    <div id="xpBar" class="bg-gradient-to-r from-blue-500 to-purple-500 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>
        </header>

        <!-- Starter: Quick Knowledge Check and Recap -->
        <section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6 relative overflow-hidden">
            <div class="absolute top-0 right-0 p-4">
                <span class="text-4xl">üîç</span>
            </div>
            <h2 class="text-2xl md:text-3xl font-bold text-purple-600 mb-4">üöÄ Starter: Knowledge Check & Recap</h2>
            <p class="text-gray-700 mb-6">Let's review what you already know about number systems and computers!</p>
            
            <!-- Quick Fire Questions -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                <div class="bg-purple-50 p-4 rounded-lg">
                    <h3 class="font-bold text-purple-700 mb-2">Question 1: Number Systems</h3>
                    <p class="text-sm mb-3">What base number system do we use in everyday life?</p>
                    <div class="space-y-2">
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="q1" value="2" class="mr-2">
                            <span>Base 2 (Binary)</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="q1" value="10" class="mr-2">
                            <span>Base 10 (Decimal)</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="q1" value="16" class="mr-2">
                            <span>Base 16 (Hexadecimal)</span>
                        </label>
                    </div>
                    <button onclick="checkQ1()" class="mt-3 bg-purple-500 text-white px-4 py-1 rounded text-sm hover:bg-purple-600">Check</button>
                    <div id="q1-feedback" class="mt-2 text-sm"></div>
                </div>
                
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-bold text-blue-700 mb-2">Question 2: Computer Components</h3>
                    <p class="text-sm mb-3">Which of these uses electricity that's either ON or OFF?</p>
                    <div class="space-y-2">
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="q2" value="paper" class="mr-2">
                            <span>Paper and pencil</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="q2" value="transistor" class="mr-2">
                            <span>Transistors in CPUs</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input type="radio" name="q2" value="water" class="mr-2">
                            <span>Water pipes</span>
                        </label>
                    </div>
                    <button onclick="checkQ2()" class="mt-3 bg-blue-500 text-white px-4 py-1 rounded text-sm hover:bg-blue-600">Check</button>
                    <div id="q2-feedback" class="mt-2 text-sm"></div>
                </div>
            </div>
            
            <!-- Prior Knowledge Activation -->
            <div class="bg-gray-50 p-4 rounded-lg mb-6">
                <h3 class="font-bold text-gray-700 mb-3">üß† Quick Think: What Do You Already Know?</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white p-3 rounded shadow">
                        <label class="text-sm font-semibold block mb-2">How many different digits are in our decimal system?</label>
                        <input type="number" id="decimal-digits" class="w-full p-2 border rounded" placeholder="Your answer...">
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <label class="text-sm font-semibold block mb-2">How many different digits would binary have?</label>
                        <input type="number" id="binary-digits" class="w-full p-2 border rounded" placeholder="Your answer...">
                    </div>
                    <div class="bg-white p-3 rounded shadow">
                        <label class="text-sm font-semibold block mb-2">What digits would binary use?</label>
                        <input type="text" id="binary-values" class="w-full p-2 border rounded" placeholder="Your answer...">
                    </div>
                </div>
                <button onclick="checkPriorKnowledge()" class="mt-4 bg-gray-600 text-white px-6 py-2 rounded hover:bg-gray-700">Check All Answers</button>
                <div id="prior-feedback" class="mt-3"></div>
            </div>
            
            <!-- Learning Objectives -->
            <div class="bg-green-50 p-4 rounded-lg">
                <h3 class="font-bold text-green-700 mb-2">üìö Today's Learning Objectives</h3>
                <p class="text-sm mb-2">By the end of this lesson, you will be able to:</p>
                <ul class="text-sm space-y-1 list-disc list-inside">
                    <li>Explain why computers use binary</li>
                    <li>Convert between binary and decimal numbers</li>
                    <li>Identify how binary is used in real-world applications</li>
                </ul>
            </div>
        </section>

        <!-- Task 1: Binary Light Switch Simulator -->
        <section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6">
            <h2 class="text-2xl md:text-3xl font-bold text-blue-600 mb-4">üí° Task 1: Binary Light Switch Simulator</h2>
            <p class="text-gray-700 mb-6">Each switch represents a binary digit (bit). ON = 1, OFF = 0. Explore how binary numbers work!</p>
            
            <!-- Binary Display -->
            <div class="bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-6 mb-6">
                <div class="text-center mb-4">
                    <h3 class="text-lg font-bold text-gray-700 mb-2">Binary Number:</h3>
                    <div class="text-4xl font-mono font-bold text-blue-600" id="binaryDisplay">00000000</div>
                    <h3 class="text-lg font-bold text-gray-700 mt-4 mb-2">Decimal Value:</h3>
                    <div class="text-4xl font-bold text-purple-600" id="decimalDisplay">0</div>
                </div>
                
                <!-- Light Switches -->
                <div class="grid grid-cols-8 gap-2 md:gap-4 mt-6">
                    <div class="text-center">
                        <p class="text-sm font-bold text-gray-600 mb-2">128</p>
                        <div class="bit-switch" onclick="toggleBit(7)" data-bit="7">
                            <div class="bit-switch-handle"></div>
                        </div>
                        <p class="text-2xl mt-2" id="bit-7">0</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm font-bold text-gray-600 mb-2">64</p>
                        <div class="bit-switch" onclick="toggleBit(6)" data-bit="6">
                            <div class="bit-switch-handle"></div>
                        </div>
                        <p class="text-2xl mt-2" id="bit-6">0</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm font-bold text-gray-600 mb-2">32</p>
                        <div class="bit-switch" onclick="toggleBit(5)" data-bit="5">
                            <div class="bit-switch-handle"></div>
                        </div>
                        <p class="text-2xl mt-2" id="bit-5">0</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm font-bold text-gray-600 mb-2">16</p>
                        <div class="bit-switch" onclick="toggleBit(4)" data-bit="4">
                            <div class="bit-switch-handle"></div>
                        </div>
                        <p class="text-2xl mt-2" id="bit-4">0</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm font-bold text-gray-600 mb-2">8</p>
                        <div class="bit-switch" onclick="toggleBit(3)" data-bit="3">
                            <div class="bit-switch-handle"></div>
                        </div>
                        <p class="text-2xl mt-2" id="bit-3">0</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm font-bold text-gray-600 mb-2">4</p>
                        <div class="bit-switch" onclick="toggleBit(2)" data-bit="2">
                            <div class="bit-switch-handle"></div>
                        </div>
                        <p class="text-2xl mt-2" id="bit-2">0</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm font-bold text-gray-600 mb-2">2</p>
                        <div class="bit-switch" onclick="toggleBit(1)" data-bit="1">
                            <div class="bit-switch-handle"></div>
                        </div>
                        <p class="text-2xl mt-2" id="bit-1">0</p>
                    </div>
                    <div class="text-center">
                        <p class="text-sm font-bold text-gray-600 mb-2">1</p>
                        <div class="bit-switch" onclick="toggleBit(0)" data-bit="0">
                            <div class="bit-switch-handle"></div>
                        </div>
                        <p class="text-2xl mt-2" id="bit-0">0</p>
                    </div>
                </div>
                
                <button onclick="resetBits()" class="mt-4 bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition-all">
                    Reset All
                </button>
            </div>
            
            <!-- Pattern Detective -->
            <div class="bg-green-50 p-4 rounded-lg">
                <h3 class="font-bold text-green-700 mb-3">üîç Pattern Detective</h3>
                <p class="text-sm mb-3">What do you notice about these binary numbers?</p>
                <div class="font-mono text-sm space-y-1">
                    <p>00000001 = 1</p>
                    <p>00000010 = 2</p>
                    <p>00000100 = 4</p>
                    <p>00001000 = 8</p>
                </div>
                <input type="text" id="patternAnswer" class="w-full mt-2 p-2 border-2 border-green-200 rounded-md focus:border-green-400 focus:outline-none" 
                    placeholder="What's the pattern?">
                <button onclick="checkPattern()" class="w-full mt-2 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-all">
                    Submit Pattern
                </button>
                <div id="patternFeedback" class="mt-2 text-center"></div>
            </div>
        </section>

        <!-- Task 2: Binary Conversion Academy -->
        <section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6">
            <h2 class="text-2xl md:text-3xl font-bold text-green-600 mb-4">üéì Task 2: Binary Conversion Academy</h2>
            
            <!-- Part A: Binary to Decimal -->
            <div class="mb-8">
                <h3 class="text-xl font-bold text-blue-600 mb-4">Part A: Binary to Decimal Training</h3>
                <div class="bg-blue-50 p-6 rounded-lg">
                    <p class="text-gray-700 mb-4">Add up the values where there's a 1!</p>
                    
                    <!-- Interactive Conversion Table -->
                    <div class="overflow-x-auto mb-6">
                        <table class="w-full max-w-2xl mx-auto">
                            <tr class="bg-blue-100">
                                <th class="p-2 border border-blue-300">Position Value</th>
                                <th class="p-2 border border-blue-300">128</th>
                                <th class="p-2 border border-blue-300">64</th>
                                <th class="p-2 border border-blue-300">32</th>
                                <th class="p-2 border border-blue-300">16</th>
                                <th class="p-2 border border-blue-300">8</th>
                                <th class="p-2 border border-blue-300">4</th>
                                <th class="p-2 border border-blue-300">2</th>
                                <th class="p-2 border border-blue-300">1</th>
                            </tr>
                            <tr>
                                <td class="p-2 border border-blue-300 font-bold">Binary Digit</td>
                                <td class="p-2 border border-blue-300 text-center">1</td>
                                <td class="p-2 border border-blue-300 text-center">0</td>
                                <td class="p-2 border border-blue-300 text-center">1</td>
                                <td class="p-2 border border-blue-300 text-center">1</td>
                                <td class="p-2 border border-blue-300 text-center">0</td>
                                <td class="p-2 border border-blue-300 text-center">1</td>
                                <td class="p-2 border border-blue-300 text-center">0</td>
                                <td class="p-2 border border-blue-300 text-center">1</td>
                            </tr>
                            <tr>
                                <td class="p-2 border border-blue-300 font-bold">Value if 1</td>
                                <td class="p-2 border border-blue-300 text-center">128</td>
                                <td class="p-2 border border-blue-300 text-center">0</td>
                                <td class="p-2 border border-blue-300 text-center">32</td>
                                <td class="p-2 border border-blue-300 text-center">16</td>
                                <td class="p-2 border border-blue-300 text-center">0</td>
                                <td class="p-2 border border-blue-300 text-center">4</td>
                                <td class="p-2 border border-blue-300 text-center">0</td>
                                <td class="p-2 border border-blue-300 text-center">1</td>
                            </tr>
                        </table>
                    </div>
                    
                    <div class="text-center mb-4">
                        <p class="text-lg font-semibold">128 + 32 + 16 + 4 + 1 = 181</p>
                    </div>
                    
                    <!-- Practice Problems with Working Space -->
                    <div class="mt-6">
                        <h4 class="font-bold mb-3">Practice Problems: Convert these binary numbers to decimal</h4>
                        <div class="space-y-6" id="btdPractice">
                            <!-- Problems will be generated dynamically -->
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Part B: Decimal to Binary -->
            <div>
                <h3 class="text-xl font-bold text-purple-600 mb-4">Part B: Decimal to Binary Training</h3>
                <div class="bg-purple-50 p-6 rounded-lg">
                    <p class="text-gray-700 mb-4">Use the subtraction method - subtract the largest power of 2 that fits!</p>
                    
                    <!-- Subtraction Method Example -->
                    <div class="bg-white p-4 rounded-lg mb-6">
                        <h4 class="font-bold mb-3">Example: Convert 75 to Binary</h4>
                        <div class="space-y-2">
                            <p>75 - 64 = 11 (so we use the 64 column)</p>
                            <p>11 - 8 = 3 (so we use the 8 column)</p>
                            <p>3 - 2 = 1 (so we use the 2 column)</p>
                            <p>1 - 1 = 0 (so we use the 1 column)</p>
                            <p class="font-bold mt-3">Answer: 01001011</p>
                        </div>
                    </div>
                    
                    <!-- Practice Problems with Working Space -->
                    <div class="mt-6">
                        <h4 class="font-bold mb-3">Your Turn! Convert these decimal numbers to binary:</h4>
                        <div class="space-y-6" id="dtbPractice">
                            <!-- Problems will be generated dynamically -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Task 3: Binary Message Decoder -->
        <section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6">
            <h2 class="text-2xl md:text-3xl font-bold text-orange-600 mb-4">üì® Task 3: Binary Message Decoder</h2>
            <p class="text-gray-700 mb-6">Watch as secret messages decode in real-time using ASCII!</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Decoder -->
                <div class="bg-orange-50 p-4 rounded-lg">
                    <h3 class="font-bold text-orange-700 mb-3">üîì Live Message Decoder</h3>
                    <p class="text-sm mb-3">Watch each 8-bit group transform into a letter:</p>
                    <div class="bg-white p-3 rounded mb-3 font-mono text-sm min-h-[60px]" id="binaryMessage">
                        <!-- Binary will appear here -->
                    </div>
                    <div id="decodedMessage" class="mt-3 text-center font-bold text-xl min-h-[40px]">
                        <!-- Decoded message appears here -->
                    </div>
                    
                    <button onclick="startNewMessage()" class="w-full mt-4 bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition-all">
                        Start New Message
                    </button>
                </div>
                
                <!-- Encoder -->
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-bold text-blue-700 mb-3">üîí Message Encoder</h3>
                    <p class="text-sm mb-3">Create your own binary message:</p>
                    <input type="text" id="messageToEncode" class="w-full p-2 border-2 border-blue-300 rounded-md mb-3" 
                        placeholder="Type a short message (letters only)" maxlength="10">
                    <button onclick="encodeMessage()" class="w-full bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-all">
                        Encode to Binary
                    </button>
                    <div id="encodedMessage" class="mt-3 bg-white p-3 rounded font-mono text-xs break-all min-h-[60px]"></div>
                </div>
            </div>
            
            <!-- ASCII Reference -->
            <div class="mt-6 bg-gray-50 p-4 rounded-lg">
                <h3 class="font-bold text-gray-700 mb-3">üìñ Quick ASCII Reference</h3>
                <div class="grid grid-cols-3 md:grid-cols-6 gap-2 text-sm">
                    <div class="bg-white p-2 rounded text-center">
                        <p class="font-mono">A = 65</p>
                        <p class="text-xs text-gray-600">01000001</p>
                    </div>
                    <div class="bg-white p-2 rounded text-center">
                        <p class="font-mono">B = 66</p>
                        <p class="text-xs text-gray-600">01000010</p>
                    </div>
                    <div class="bg-white p-2 rounded text-center">
                        <p class="font-mono">C = 67</p>
                        <p class="text-xs text-gray-600">01000011</p>
                    </div>
                    <div class="bg-white p-2 rounded text-center">
                        <p class="font-mono">H = 72</p>
                        <p class="text-xs text-gray-600">01001000</p>
                    </div>
                    <div class="bg-white p-2 rounded text-center">
                        <p class="font-mono">I = 73</p>
                        <p class="text-xs text-gray-600">01001001</p>
                    </div>
                    <div class="bg-white p-2 rounded text-center">
                        <p class="font-mono">Space = 32</p>
                        <p class="text-xs text-gray-600">00100000</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Exam Practice Section -->
        <section class="bg-gradient-to-r from-red-100 to-orange-100 rounded-xl shadow-lg p-6 md:p-8 mb-6">
            <h2 class="text-2xl md:text-3xl font-bold text-red-700 mb-4">üìù Exam Style Questions</h2>
            <p class="text-gray-700 mb-6">Practice exam questions. Write your answer and self-assess before viewing the mark scheme!</p>
            
            <!-- Question 1 -->
            <div class="bg-white p-6 rounded-lg shadow mb-6">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold text-gray-800">Question 1</h3>
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm font-semibold">[3 marks]</span>
                </div>
                <p class="text-gray-700 mb-4">Convert the binary number 10110101 to decimal. Show your working.</p>
                
                <!-- Working Space -->
                <div class="mb-4">
                    <p class="text-sm font-semibold mb-2">Working space (use your stylus):</p>
                    <canvas id="q1-canvas" class="working-canvas" width="600" height="200"></canvas>
                    <button onclick="clearCanvas('q1-canvas')" class="mt-2 text-sm bg-gray-400 text-white px-3 py-1 rounded hover:bg-gray-500">
                        Clear Working
                    </button>
                </div>
                
                <textarea id="q1-answer" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-400 focus:outline-none h-32 mb-4" 
                    placeholder="Write your answer here..."></textarea>
                
                <div class="flex gap-4 mb-4">
                    <div class="flex-1">
                        <label class="block text-sm font-semibold mb-2">How many marks do you think you earned?</label>
                        <select id="q1-marks" class="w-full p-2 border rounded">
                            <option value="">Select...</option>
                            <option value="0">0 marks</option>
                            <option value="1">1 mark</option>
                            <option value="2">2 marks</option>
                            <option value="3">3 marks</option>
                        </select>
                    </div>
                </div>
                
                <button onclick="checkExamAnswer(1)" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-all mb-4">
                    Show Mark Scheme
                </button>
                
                <div id="q1-markscheme" class="hidden bg-green-50 p-4 rounded-lg">
                    <h4 class="font-bold text-green-700 mb-2">Mark Scheme:</h4>
                    <ul class="text-sm space-y-2 list-disc list-inside">
                        <li><strong>[1 mark]</strong> Correct identification of place values: 128, 32, 16, 4, 1</li>
                        <li><strong>[1 mark]</strong> Correct addition shown: 128 + 32 + 16 + 4 + 1</li>
                        <li><strong>[1 mark]</strong> Correct final answer: 181</li>
                    </ul>
                </div>
            </div>
            
            <!-- Question 2 -->
            <div class="bg-white p-6 rounded-lg shadow mb-6">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold text-gray-800">Question 2</h3>
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm font-semibold">[4 marks]</span>
                </div>
                <p class="text-gray-700 mb-4">Convert the decimal number 156 to binary. Show your working.</p>
                
                <!-- Working Space -->
                <div class="mb-4">
                    <p class="text-sm font-semibold mb-2">Working space (use your stylus):</p>
                    <canvas id="q2-canvas" class="working-canvas" width="600" height="200"></canvas>
                    <button onclick="clearCanvas('q2-canvas')" class="mt-2 text-sm bg-gray-400 text-white px-3 py-1 rounded hover:bg-gray-500">
                        Clear Working
                    </button>
                </div>
                
                <textarea id="q2-answer" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-400 focus:outline-none h-40 mb-4" 
                    placeholder="Write your answer here..."></textarea>
                
                <div class="flex gap-4 mb-4">
                    <div class="flex-1">
                        <label class="block text-sm font-semibold mb-2">How many marks do you think you earned?</label>
                        <select id="q2-marks" class="w-full p-2 border rounded">
                            <option value="">Select...</option>
                            <option value="0">0 marks</option>
                            <option value="1">1 mark</option>
                            <option value="2">2 marks</option>
                            <option value="3">3 marks</option>
                            <option value="4">4 marks</option>
                        </select>
                    </div>
                </div>
                
                <button onclick="checkExamAnswer(2)" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-all mb-4">
                    Show Mark Scheme
                </button>
                
                <div id="q2-markscheme" class="hidden bg-green-50 p-4 rounded-lg">
                    <h4 class="font-bold text-green-700 mb-2">Mark Scheme:</h4>
                    <ul class="text-sm space-y-2 list-disc list-inside">
                        <li><strong>[1 mark]</strong> Shows subtraction method OR division by 2 method</li>
                        <li><strong>[1 mark]</strong> Correct working shown</li>
                        <li><strong>[1 mark]</strong> All steps clearly shown</li>
                        <li><strong>[1 mark]</strong> Correct final answer: 10011100</li>
                    </ul>
                </div>
            </div>
            
            <!-- Question 3 -->
            <div class="bg-white p-6 rounded-lg shadow mb-6">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold text-gray-800">Question 3</h3>
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm font-semibold">[2 marks]</span>
                </div>
                <p class="text-gray-700 mb-4">Explain why computers use binary instead of decimal.</p>
                
                <textarea id="q3-answer" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-400 focus:outline-none h-32 mb-4" 
                    placeholder="Write your answer here..."></textarea>
                
                <div class="flex gap-4 mb-4">
                    <div class="flex-1">
                        <label class="block text-sm font-semibold mb-2">How many marks do you think you earned?</label>
                        <select id="q3-marks" class="w-full p-2 border rounded">
                            <option value="">Select...</option>
                            <option value="0">0 marks</option>
                            <option value="1">1 mark</option>
                            <option value="2">2 marks</option>
                        </select>
                    </div>
                </div>
                
                <button onclick="checkExamAnswer(3)" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-all mb-4">
                    Show Mark Scheme
                </button>
                
                <div id="q3-markscheme" class="hidden bg-green-50 p-4 rounded-lg">
                    <h4 class="font-bold text-green-700 mb-2">Mark Scheme:</h4>
                    <ul class="text-sm space-y-2 list-disc list-inside">
                        <li><strong>[1 mark]</strong> Electricity/transistors can be ON or OFF (two states)</li>
                        <li><strong>[1 mark]</strong> Binary has two digits (0 and 1) matching these states OR Easy to distinguish between two states</li>
                    </ul>
                </div>
            </div>
            
            <!-- Question 4 -->
            <div class="bg-white p-6 rounded-lg shadow">
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-lg font-bold text-gray-800">Question 4</h3>
                    <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm font-semibold">[3 marks]</span>
                </div>
                <p class="text-gray-700 mb-4">A computer stores the letter 'M' as 01001101. What decimal number does this represent?</p>
                
                <!-- Working Space -->
                <div class="mb-4">
                    <p class="text-sm font-semibold mb-2">Working space (use your stylus):</p>
                    <canvas id="q4-canvas" class="working-canvas" width="600" height="150"></canvas>
                    <button onclick="clearCanvas('q4-canvas')" class="mt-2 text-sm bg-gray-400 text-white px-3 py-1 rounded hover:bg-gray-500">
                        Clear Working
                    </button>
                </div>
                
                <textarea id="q4-answer" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:border-blue-400 focus:outline-none h-32 mb-4" 
                    placeholder="Write your answer here..."></textarea>
                
                <div class="flex gap-4 mb-4">
                    <div class="flex-1">
                        <label class="block text-sm font-semibold mb-2">How many marks do you think you earned?</label>
                        <select id="q4-marks" class="w-full p-2 border rounded">
                            <option value="">Select...</option>
                            <option value="0">0 marks</option>
                            <option value="1">1 mark</option>
                            <option value="2">2 marks</option>
                            <option value="3">3 marks</option>
                        </select>
                    </div>
                </div>
                
                <button onclick="checkExamAnswer(4)" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-all mb-4">
                    Show Mark Scheme
                </button>
                
                <div id="q4-markscheme" class="hidden bg-green-50 p-4 rounded-lg">
                    <h4 class="font-bold text-green-700 mb-2">Mark Scheme:</h4>
                    <ul class="text-sm space-y-2 list-disc list-inside">
                        <li><strong>[1 mark]</strong> Correct identification of place values: 64, 8, 4, 1</li>
                        <li><strong>[1 mark]</strong> Correct addition shown: 64 + 8 + 4 + 1</li>
                        <li><strong>[1 mark]</strong> Correct final answer: 77</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Extension Activities -->
        <section class="bg-gradient-to-r from-purple-100 to-blue-100 rounded-xl shadow-lg p-6 md:p-8 mb-6">
            <h2 class="text-2xl md:text-3xl font-bold text-purple-700 mb-4">üöÄ Extension Activities</h2>
            
            <!-- Extension 1 -->
            <div class="mb-6 bg-white p-4 rounded-lg">
                <h3 class="text-xl font-bold text-purple-600 mb-3">Extension 1: Binary in the Real World</h3>
                <p class="text-gray-700 mb-3">Research and match where binary is used:</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <h4 class="font-semibold mb-2">Devices:</h4>
                        <div id="deviceList" class="space-y-2">
                            <div class="draggable bg-purple-100 p-2 rounded" draggable="true" data-match="storage">Hard Drive</div>
                            <div class="draggable bg-purple-100 p-2 rounded" draggable="true" data-match="network">Router</div>
                            <div class="draggable bg-purple-100 p-2 rounded" draggable="true" data-match="display">Monitor</div>
                            <div class="draggable bg-purple-100 p-2 rounded" draggable="true" data-match="input">Keyboard</div>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-2">Binary Use:</h4>
                        <div class="space-y-2">
                            <div class="drop-zone bg-gray-100 p-2 rounded border-2 border-dashed border-gray-300" data-answer="storage">
                                Stores data as magnetic 0s and 1s
                            </div>
                            <div class="drop-zone bg-gray-100 p-2 rounded border-2 border-dashed border-gray-300" data-answer="network">
                                Transmits data packets in binary
                            </div>
                            <div class="drop-zone bg-gray-100 p-2 rounded border-2 border-dashed border-gray-300" data-answer="display">
                                Pixel colors stored as binary
                            </div>
                            <div class="drop-zone bg-gray-100 p-2 rounded border-2 border-dashed border-gray-300" data-answer="input">
                                Key presses converted to binary codes
                            </div>
                        </div>
                    </div>
                </div>
                <button onclick="checkRealWorldMatches()" class="mt-4 bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 transition-all">
                    Check Matches
                </button>
                <div id="realWorldFeedback" class="mt-2"></div>
            </div>
            
            <!-- Extension 2 -->
            <div class="mb-6 bg-white p-4 rounded-lg">
                <h3 class="text-xl font-bold text-blue-600 mb-3">Extension 2: Negative Numbers & Two's Complement</h3>
                <p class="text-gray-700 mb-3">How do computers store negative numbers?</p>
                <div class="bg-blue-50 p-4 rounded">
                    <p class="text-sm mb-2">To get -5 in binary:</p>
                    <ol class="text-sm space-y-1 list-decimal list-inside">
                        <li>Start with 5: 00000101</li>
                        <li>Flip all bits: 11111010</li>
                        <li>Add 1: 11111011</li>
                    </ol>
                    <p class="text-sm mt-2 font-semibold">Result: 11111011 represents -5!</p>
                </div>
                <div class="mt-4">
                    <label class="block font-semibold mb-2">Try it! Convert -12 to binary:</label>
                    <input type="text" id="twosCompAnswer" class="w-full p-2 border-2 border-blue-300 rounded-md font-mono" 
                        placeholder="Your answer (8 bits)">
                    <button onclick="checkTwosComplement()" class="mt-2 bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-all">
                        Check Answer
                    </button>
                    <div id="twosCompFeedback" class="mt-2"></div>
                </div>
            </div>
            
            <!-- Binary Game Link -->
            <div class="bg-white p-4 rounded-lg">
                <h3 class="text-xl font-bold text-green-600 mb-3">üéÆ Extension 3: Binary Game</h3>
                <p class="text-gray-700 mb-3">Ready for more practice? Try this interactive binary game!</p>
                <a href="https://learningcontent.cisco.com/games/binary/index.html" target="_blank" 
                   class="inline-block bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 transition-all">
                    Play the Cisco Binary Game ‚Üí
                </a>
            </div>
        </section>

        <!-- Achievement Gallery -->
        <section class="bg-gradient-to-r from-yellow-100 to-orange-100 rounded-xl shadow-lg p-6 md:p-8 mb-6">
            <h2 class="text-2xl md:text-3xl font-bold text-orange-700 mb-4">üèÜ Your Binary Achievements</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div id="achieve-beginner" class="achievement-unlock bg-white p-4 rounded-lg text-center shadow opacity-50">
                    <span class="text-3xl">üîç</span>
                    <p class="font-bold text-sm mt-2">Binary Beginner</p>
                    <p class="text-xs text-gray-600">Complete starter</p>
                </div>
                <div id="achieve-converter" class="achievement-unlock bg-white p-4 rounded-lg text-center shadow opacity-50">
                    <span class="text-3xl">üîÑ</span>
                    <p class="font-bold text-sm mt-2">Conversion Champion</p>
                    <p class="text-xs text-gray-600">Perfect conversions</p>
                </div>
                <div id="achieve-decoder" class="achievement-unlock bg-white p-4 rounded-lg text-center shadow opacity-50">
                    <span class="text-3xl">üì®</span>
                    <p class="font-bold text-sm mt-2">Message Master</p>
                    <p class="text-xs text-gray-600">Decode messages</p>
                </div>
                <div id="achieve-examready" class="achievement-unlock bg-white p-4 rounded-lg text-center shadow opacity-50">
                    <span class="text-3xl">üìù</span>
                    <p class="font-bold text-sm mt-2">Exam Ready</p>
                    <p class="text-xs text-gray-600">Complete exam questions</p>
                </div>
            </div>
        </section>

        <!-- Exam Tips Box -->
        <section class="bg-gradient-to-r from-green-100 to-blue-100 rounded-xl shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold text-green-700 mb-4">üí° Key Exam Tips</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-white p-4 rounded-lg">
                    <h3 class="font-bold text-blue-600 mb-2">Common Mistakes to Avoid:</h3>
                    <ul class="text-sm space-y-1 list-disc list-inside">
                        <li>Forgetting to show working (loses marks!)</li>
                        <li>Reading binary right-to-left (it's left-to-right!)</li>
                        <li>Not using 8 bits when asked</li>
                        <li>Forgetting place values double each time</li>
                    </ul>
                </div>
                <div class="bg-white p-4 rounded-lg">
                    <h3 class="font-bold text-green-600 mb-2">Quick Conversion Tips:</h3>
                    <ul class="text-sm space-y-1 list-disc list-inside">
                        <li>Binary to Decimal: Add place values with 1s</li>
                        <li>Decimal to Binary: Subtract largest powers of 2</li>
                        <li>Always double-check by converting back</li>
                        <li>Remember: 128 64 32 16 8 4 2 1</li>
                    </ul>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Disable copy, cut, and paste everywhere
        document.addEventListener('DOMContentLoaded', function() {
            // Disable copy
            document.addEventListener('copy', function(e) {
                e.preventDefault();
                return false;
            });
            
            // Disable cut
            document.addEventListener('cut', function(e) {
                e.preventDefault();
                return false;
            });
            
            // Disable paste
            document.addEventListener('paste', function(e) {
                e.preventDefault();
                alert('Copy and paste is disabled. Please type your answer.');
                return false;
            });
            
            // Disable context menu everywhere
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                return false;
            });
            
            // Disable keyboard shortcuts for copy/paste
            document.addEventListener('keydown', function(e) {
                // Disable Ctrl+A, Ctrl+C, Ctrl+V, Ctrl+X
                if (e.ctrlKey && (e.keyCode === 65 || e.keyCode === 67 || e.keyCode === 86 || e.keyCode === 88)) {
                    e.preventDefault();
                    return false;
                }
                // Disable Cmd+A, Cmd+C, Cmd+V, Cmd+X on Mac
                if (e.metaKey && (e.keyCode === 65 || e.keyCode === 67 || e.keyCode === 86 || e.keyCode === 88)) {
                    e.preventDefault();
                    return false;
                }
            });
            
            // Initialize
            initializeBinaryRain();
            initializeDragAndDrop();
            generateBinaryToDecimalPractice();
            generateDecimalToBinaryPractice();
            initializeCanvases();
            startNewMessage();
        });

        // XP and Achievement System
        let totalXP = 0;
        let achievements = {
            beginner: false,
            converter: false,
            decoder: false,
            examready: false
        };

        function addXP(points) {
            totalXP += points;
            document.getElementById('xpPoints').textContent = totalXP;
            const xpBar = document.getElementById('xpBar');
            const percentage = Math.min((totalXP / 400) * 100, 100);
            xpBar.style.width = percentage + '%';
            
            // Check for level up
            updateLevel();
        }

        function updateLevel() {
            const levelText = document.getElementById('levelText');
            if (totalXP >= 300) {
                levelText.textContent = 'Level 4: Digital Master';
            } else if (totalXP >= 200) {
                levelText.textContent = 'Level 3: Binary Expert';
            } else if (totalXP >= 100) {
                levelText.textContent = 'Level 2: Code Breaker';
            }
        }

        function unlockAchievement(name) {
            if (!achievements[name]) {
                achievements[name] = true;
                const achieveElement = document.getElementById(`achieve-${name}`);
                if (achieveElement) {
                    achieveElement.classList.remove('opacity-50');
                    achieveElement.classList.add('achievement-unlock');
                    addXP(50);
                }
            }
        }

        // Binary Rain Effect
        function initializeBinaryRain() {
            const rainContainer = document.getElementById('binaryRain');
            if (!rainContainer) return;
            
            for (let i = 0; i < 20; i++) {
                const drop = document.createElement('div');
                drop.className = 'binary-drop';
                drop.textContent = Math.random() > 0.5 ? '1' : '0';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.animationDuration = (Math.random() * 3 + 2) + 's';
                drop.style.animationDelay = Math.random() * 2 + 's';
                rainContainer.appendChild(drop);
            }
        }

        // Canvas Drawing for Working Out
        function initializeCanvases() {
            const canvases = ['q1-canvas', 'q2-canvas', 'q4-canvas'];
            
            canvases.forEach(canvasId => {
                const canvas = document.getElementById(canvasId);
                if (!canvas) return;
                
                const ctx = canvas.getContext('2d');
                let drawing = false;
                let lastX = 0;
                let lastY = 0;
                
                // Set drawing style
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';
                
                // Mouse events
                canvas.addEventListener('mousedown', startDrawing);
                canvas.addEventListener('mousemove', draw);
                canvas.addEventListener('mouseup', stopDrawing);
                canvas.addEventListener('mouseout', stopDrawing);
                
                // Touch events for tablets
                canvas.addEventListener('touchstart', handleTouch);
                canvas.addEventListener('touchmove', handleTouch);
                canvas.addEventListener('touchend', stopDrawing);
                
                function startDrawing(e) {
                    drawing = true;
                    const rect = canvas.getBoundingClientRect();
                    lastX = e.clientX - rect.left;
                    lastY = e.clientY - rect.top;
                }
                
                function draw(e) {
                    if (!drawing) return;
                    
                    const rect = canvas.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    
                    ctx.beginPath();
                    ctx.moveTo(lastX, lastY);
                    ctx.lineTo(x, y);
                    ctx.stroke();
                    
                    lastX = x;
                    lastY = y;
                }
                
                function stopDrawing() {
                    drawing = false;
                }
                
                function handleTouch(e) {
                    e.preventDefault();
                    const touch = e.touches[0];
                    const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                                     e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                        clientX: touch.clientX,
                        clientY: touch.clientY
                    });
                    canvas.dispatchEvent(mouseEvent);
                }
            });
        }

        function clearCanvas(canvasId) {
            const canvas = document.getElementById(canvasId);
            if (canvas) {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            }
        }

        // Starter activity functions
        function checkQ1() {
            const selected = document.querySelector('input[name="q1"]:checked');
            const feedback = document.getElementById('q1-feedback');
            
            if (!selected) {
                feedback.innerHTML = '<p class="text-orange-500">Please select an answer!</p>';
                return;
            }
            
            if (selected.value === '10') {
                feedback.innerHTML = '<p class="text-green-600 font-bold">‚úÖ Correct! We use Base 10 (0-9) in everyday life.</p>';
                addXP(10);
            } else {
                feedback.innerHTML = '<p class="text-red-600">‚ùå Not quite. Think about how we count normally: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9...</p>';
            }
        }

        function checkQ2() {
            const selected = document.querySelector('input[name="q2"]:checked');
            const feedback = document.getElementById('q2-feedback');
            
            if (!selected) {
                feedback.innerHTML = '<p class="text-orange-500">Please select an answer!</p>';
                return;
            }
            
            if (selected.value === 'transistor') {
                feedback.innerHTML = '<p class="text-green-600 font-bold">‚úÖ Correct! Transistors use electricity that\'s either ON (1) or OFF (0).</p>';
                addXP(10);
            } else {
                feedback.innerHTML = '<p class="text-red-600">‚ùå Not quite. Think about computer components that use electricity.</p>';
            }
        }

        function checkPriorKnowledge() {
            const decimalDigits = document.getElementById('decimal-digits').value;
            const binaryDigits = document.getElementById('binary-digits').value;
            const binaryValues = document.getElementById('binary-values').value.toLowerCase();
            const feedback = document.getElementById('prior-feedback');
            
            let score = 0;
            let messages = [];
            
            if (decimalDigits === '10') {
                score++;
                messages.push('‚úÖ Decimal has 10 digits (0-9)');
            } else {
                messages.push('‚ùå Decimal uses digits 0-9, so that\'s 10 digits');
            }
            
            if (binaryDigits === '2') {
                score++;
                messages.push('‚úÖ Binary has 2 digits');
            } else {
                messages.push('‚ùå Binary means "two" - it uses 2 digits');
            }
            
            if (binaryValues.includes('0') && binaryValues.includes('1')) {
                score++;
                messages.push('‚úÖ Binary uses 0 and 1');
            } else {
                messages.push('‚ùå Binary uses only 0 and 1');
            }
            
            feedback.innerHTML = `<p class="font-bold mb-2">You got ${score}/3 correct!</p>` + 
                messages.map(m => `<p class="text-sm">${m}</p>`).join('');
            
            if (score === 3) {
                addXP(30);
                unlockAchievement('beginner');
            } else {
                addXP(score * 5);
            }
        }

        // Binary Light Switch Simulator
        let binaryValue = [0, 0, 0, 0, 0, 0, 0, 0];

        function toggleBit(position) {
            binaryValue[7 - position] = binaryValue[7 - position] === 0 ? 1 : 0;
            updateBinaryDisplay();
            
            const bitSwitch = document.querySelector(`[data-bit="${position}"]`);
            const bitDisplay = document.getElementById(`bit-${position}`);
            
            if (binaryValue[7 - position] === 1) {
                bitSwitch.classList.add('on');
                bitDisplay.textContent = '1';
            } else {
                bitSwitch.classList.remove('on');
                bitDisplay.textContent = '0';
            }
        }

        function updateBinaryDisplay() {
            const binaryStr = binaryValue.join('');
            document.getElementById('binaryDisplay').textContent = binaryStr;
            
            const decimalValue = parseInt(binaryStr, 2);
            document.getElementById('decimalDisplay').textContent = decimalValue;
        }

        function resetBits() {
            binaryValue = [0, 0, 0, 0, 0, 0, 0, 0];
            for (let i = 0; i < 8; i++) {
                const bitSwitch = document.querySelector(`[data-bit="${i}"]`);
                const bitDisplay = document.getElementById(`bit-${i}`);
                bitSwitch.classList.remove('on');
                bitDisplay.textContent = '0';
            }
            updateBinaryDisplay();
        }

        // Pattern Detective
        function checkPattern() {
            const answer = document.getElementById('patternAnswer').value.toLowerCase().trim();
            const feedback = document.getElementById('patternFeedback');
            
            if (answer.includes('double') || answer.includes('power') || answer.includes('multiply') || answer.includes('2')) {
                feedback.innerHTML = '<p class="text-green-600 font-bold">‚úÖ Brilliant! Each position is double the previous one!</p>';
                addXP(30);
            } else {
                feedback.innerHTML = '<p class="text-orange-600">Hint: Look at how each number relates to the previous one...</p>';
            }
        }

        // Binary to Decimal Practice
        function generateBinaryToDecimalPractice() {
            const practice = document.getElementById('btdPractice');
            if (!practice) return;
            
            const problems = [
                { binary: '00001111', answer: 15 },
                { binary: '01010101', answer: 85 },
                { binary: '11000011', answer: 195 },
                { binary: '10101010', answer: 170 },
                { binary: '11111111', answer: 255 },
                { binary: '00110011', answer: 51 },
                { binary: '10001000', answer: 136 },
                { binary: '01100110', answer: 102 },
                { binary: '11110000', answer: 240 },
                { binary: '00101101', answer: 45 }
            ];
            
            practice.innerHTML = '';
            problems.forEach((problem, index) => {
                const div = document.createElement('div');
                div.className = 'bg-gray-50 p-4 rounded-lg';
                div.innerHTML = `
                    <p class="font-bold mb-2">Problem ${index + 1}: Convert ${problem.binary} to decimal</p>
                    <p class="text-sm text-gray-600 mb-2">Working space (use your stylus):</p>
                    <canvas id="btd-canvas-${index}" class="working-canvas mb-3" width="500" height="150"></canvas>
                    <button onclick="clearCanvas('btd-canvas-${index}')" class="text-sm bg-gray-400 text-white px-3 py-1 rounded hover:bg-gray-500 mb-2">
                        Clear Working
                    </button>
                    <div class="flex items-center gap-2 mt-2">
                        <span class="font-mono">${problem.binary} = </span>
                        <input type="number" id="btd-practice-${index}" class="p-1 border rounded w-20" data-answer="${problem.answer}">
                        <button onclick="checkBtdPractice(${index})" class="bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600">Check</button>
                        <span id="btd-feedback-${index}"></span>
                    </div>
                `;
                practice.appendChild(div);
            });
            
            // Initialize canvases for practice problems
            setTimeout(() => {
                problems.forEach((_, index) => {
                    initializeCanvas(`btd-canvas-${index}`);
                });
            }, 100);
        }

        function checkBtdPractice(index) {
            const input = document.getElementById(`btd-practice-${index}`);
            const feedback = document.getElementById(`btd-feedback-${index}`);
            const answer = parseInt(input.dataset.answer);
            
            if (parseInt(input.value) === answer) {
                feedback.innerHTML = '<span class="text-green-600 font-bold">‚úÖ Correct!</span>';
                addXP(10);
                
                // Check if enough problems solved for achievement
                const correctCount = document.querySelectorAll('#btdPractice .text-green-600').length;
                if (correctCount >= 5) {
                    unlockAchievement('converter');
                }
            } else {
                feedback.innerHTML = '<span class="text-red-600">‚ùå Try again</span>';
            }
        }

        // Decimal to Binary Practice
        function generateDecimalToBinaryPractice() {
            const practice = document.getElementById('dtbPractice');
            if (!practice) return;
            
            const problems = [
                { decimal: 25, answer: '00011001' },
                { decimal: 67, answer: '01000011' },
                { decimal: 100, answer: '01100100' },
                { decimal: 200, answer: '11001000' },
                { decimal: 255, answer: '11111111' },
                { decimal: 48, answer: '00110000' },
                { decimal: 127, answer: '01111111' },
                { decimal: 192, answer: '11000000' },
                { decimal: 84, answer: '01010100' },
                { decimal: 173, answer: '10101101' }
            ];
            
            practice.innerHTML = '';
            problems.forEach((problem, index) => {
                const div = document.createElement('div');
                div.className = 'bg-gray-50 p-4 rounded-lg';
                div.innerHTML = `
                    <p class="font-bold mb-2">Problem ${index + 1}: Convert ${problem.decimal} to binary</p>
                    <p class="text-sm text-gray-600 mb-2">Working space (use your stylus):</p>
                    <canvas id="dtb-canvas-${index}" class="working-canvas mb-3" width="500" height="150"></canvas>
                    <button onclick="clearCanvas('dtb-canvas-${index}')" class="text-sm bg-gray-400 text-white px-3 py-1 rounded hover:bg-gray-500 mb-2">
                        Clear Working
                    </button>
                    <div class="flex items-center gap-2 mt-2">
                        <span>${problem.decimal} = </span>
                        <input type="text" id="dtb-practice-${index}" class="p-1 border rounded w-32 font-mono" data-answer="${problem.answer}" maxlength="8">
                        <button onclick="checkDtbPractice(${index})" class="bg-purple-500 text-white px-3 py-1 rounded text-sm hover:bg-purple-600">Check</button>
                        <span id="dtb-feedback-${index}"></span>
                    </div>
                `;
                practice.appendChild(div);
            });
            
            // Initialize canvases for practice problems
            setTimeout(() => {
                problems.forEach((_, index) => {
                    initializeCanvas(`dtb-canvas-${index}`);
                });
            }, 100);
        }

        function checkDtbPractice(index) {
            const input = document.getElementById(`dtb-practice-${index}`);
            const feedback = document.getElementById(`dtb-feedback-${index}`);
            const answer = input.dataset.answer;
            
            // Allow answers without leading zeros
            const userAnswer = input.value.padStart(8, '0');
            
            if (userAnswer === answer) {
                feedback.innerHTML = '<span class="text-green-600 font-bold">‚úÖ Correct!</span>';
                addXP(10);
                
                // Check if enough problems solved for achievement
                const correctCount = document.querySelectorAll('#dtbPractice .text-green-600').length;
                if (correctCount >= 5) {
                    unlockAchievement('converter');
                }
            } else {
                feedback.innerHTML = '<span class="text-red-600">‚ùå Try again</span>';
            }
        }

        // Initialize individual canvas
        function initializeCanvas(canvasId) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            let drawing = false;
            let lastX = 0;
            let lastY = 0;
            
            // Set drawing style
            ctx.strokeStyle = '#333';
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events for tablets
            canvas.addEventListener('touchstart', handleTouch);
            canvas.addEventListener('touchmove', handleTouch);
            canvas.addEventListener('touchend', stopDrawing);
            
            function startDrawing(e) {
                drawing = true;
                const rect = canvas.getBoundingClientRect();
                lastX = e.clientX - rect.left;
                lastY = e.clientY - rect.top;
            }
            
            function draw(e) {
                if (!drawing) return;
                
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(x, y);
                ctx.stroke();
                
                lastX = x;
                lastY = y;
            }
            
            function stopDrawing() {
                drawing = false;
            }
            
            function handleTouch(e) {
                e.preventDefault();
                const touch = e.touches[0];
                const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                                 e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                    clientX: touch.clientX,
                    clientY: touch.clientY
                });
                canvas.dispatchEvent(mouseEvent);
            }
        }

        // Message Decoder with Real-time Animation
        const messages = [
            { binary: '01000011 01010011', text: 'CS' },
            { binary: '01001000 01101001', text: 'Hi' },
            { binary: '01000010 01101001 01110100', text: 'Bit' },
            { binary: '01000011 01101111 01100100 01100101', text: 'Code' },
            { binary: '01000100 01100001 01110100 01100001', text: 'Data' },
            { binary: '01001100 01101111 01110110 01100101', text: 'Love' },
            { binary: '01000111 01100001 01101101 01100101', text: 'Game' }
        ];
        let currentMessage = 0;
        let decodeInterval = null;

        function startNewMessage() {
            // Clear previous
            clearInterval(decodeInterval);
            document.getElementById('binaryMessage').textContent = '';
            document.getElementById('decodedMessage').textContent = '';
            
            const message = messages[currentMessage];
            const binaryDiv = document.getElementById('binaryMessage');
            const decodedDiv = document.getElementById('decodedMessage');
            
            // Split binary into groups
            const binaryGroups = message.binary.split(' ');
            let currentGroup = 0;
            
            // Start decoding animation
            decodeInterval = setInterval(() => {
                if (currentGroup < binaryGroups.length) {
                    // Add binary group
                    if (currentGroup > 0) binaryDiv.textContent += ' ';
                    binaryDiv.textContent += binaryGroups[currentGroup];
                    
                    // Add decoded letter
                    setTimeout(() => {
                        decodedDiv.textContent += message.text[currentGroup];
                    }, 500);
                    
                    currentGroup++;
                } else {
                    clearInterval(decodeInterval);
                    addXP(15);
                    
                    if (currentMessage === messages.length - 1) {
                        unlockAchievement('decoder');
                    }
                    
                    // Move to next message
                    currentMessage = (currentMessage + 1) % messages.length;
                }
            }, 1000);
        }

        // Message Encoder
        function encodeMessage() {
            const input = document.getElementById('messageToEncode').value.toUpperCase();
            const encoded = document.getElementById('encodedMessage');
            
            if (!input) {
                encoded.textContent = 'Please type a message!';
                return;
            }
            
            let binaryMessage = '';
            for (let i = 0; i < input.length; i++) {
                if (input[i] >= 'A' && input[i] <= 'Z') {
                    const charCode = input.charCodeAt(i);
                    const binary = charCode.toString(2).padStart(8, '0');
                    binaryMessage += binary + ' ';
                }
            }
            
            encoded.textContent = binaryMessage.trim();
            addXP(10);
        }

        // Extension Activities
        function initializeDragAndDrop() {
            const draggables = document.querySelectorAll('.draggable');
            const dropZones = document.querySelectorAll('.drop-zone');
            
            let draggedElement = null;

            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', function(e) {
                    draggedElement = this;
                    this.style.opacity = '0.5';
                });

                draggable.addEventListener('dragend', function(e) {
                    this.style.opacity = '';
                });
            });

            dropZones.forEach(zone => {
                zone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('drag-over');
                });

                zone.addEventListener('dragleave', function(e) {
                    this.classList.remove('drag-over');
                });

                zone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('drag-over');
                    
                    if (draggedElement && this.dataset.answer) {
                        // Check if there's already something in this drop zone
                        const existing = this.querySelector('.draggable');
                        if (existing) {
                            // Return existing to original location
                            document.getElementById('deviceList').appendChild(existing);
                        }
                        
                        this.appendChild(draggedElement);
                        draggedElement = null;
                    }
                });
            });
        }

        function checkRealWorldMatches() {
            const dropZones = document.querySelectorAll('.drop-zone[data-answer]');
            let correct = 0;
            
            dropZones.forEach(zone => {
                const device = zone.querySelector('.draggable');
                if (device && device.dataset.match === zone.dataset.answer) {
                    device.style.backgroundColor = '#dcfce7';
                    correct++;
                } else if (device) {
                    device.style.backgroundColor = '#fee2e2';
                }
            });
            
            const feedback = document.getElementById('realWorldFeedback');
            if (correct === 4) {
                feedback.innerHTML = '<p class="text-green-600 font-bold">‚úÖ Perfect! You understand how binary is used everywhere!</p>';
                addXP(30);
            } else {
                feedback.innerHTML = `<p class="text-orange-600">${correct}/4 correct. Think about how each device processes information.</p>`;
            }
        }

        // Two's Complement
        function checkTwosComplement() {
            const answer = document.getElementById('twosCompAnswer').value;
            const feedback = document.getElementById('twosCompFeedback');
            
            // -12: Start with 12 (00001100), flip (11110011), add 1 (11110100)
            if (answer === '11110100') {
                feedback.innerHTML = '<p class="text-green-600 font-bold">‚úÖ Excellent! You\'ve mastered two\'s complement!</p>';
                addXP(40);
            } else {
                feedback.innerHTML = '<p class="text-red-600">Not quite. Remember: 12 = 00001100, flip all bits, then add 1.</p>';
            }
        }

        // Exam answer checking with enhanced validation
        function checkExamAnswer(questionNum) {
            const answer = document.getElementById(`q${questionNum}-answer`).value.trim();
            const marks = document.getElementById(`q${questionNum}-marks`).value;
            const markscheme = document.getElementById(`q${questionNum}-markscheme`);
            
            // Enhanced validation
            const wordCount = answer.split(/\s+/).filter(word => word.length > 0).length;
            
            if (questionNum <= 2 || questionNum === 4) {
                // For calculation questions, need working shown
                if (wordCount < 10) {
                    alert('Please show your working! You need to demonstrate how you reached your answer.');
                    return;
                }
            } else {
                // For explanation questions
                if (wordCount < 15) {
                    alert('Please write a more detailed answer. Aim for at least 15 words.');
                    return;
                }
            }
            
            if (!marks) {
                alert('Please select how many marks you think you earned before viewing the mark scheme.');
                return;
            }
            
            // Check for sufficient attempt
            const hasNumbers = /\d/.test(answer);
            const hasWords = /[a-zA-Z]{3,}/.test(answer);
            
            if (!hasWords) {
                alert('Please write a proper answer using words, not just numbers.');
                return;
            }
            
            // Check for calculation questions that they've shown working
            if ((questionNum === 1 || questionNum === 2 || questionNum === 4) && !hasNumbers) {
                alert('This is a calculation question. Please include numbers in your working.');
                return;
            }
            
            // Show mark scheme
            markscheme.classList.remove('hidden');
            addXP(20);
            
            // Check if completed enough exam questions for achievement
            const completedQuestions = document.querySelectorAll('.bg-green-50:not(.hidden)').length;
            if (completedQuestions >= 3) {
                unlockAchievement('examready');
            }
        }
    </script>
</body>
</html>