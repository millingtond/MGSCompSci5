<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 2: How Machine Learning Works - Year 9 Computer Science</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        
        * {
            -webkit-user-select: none !important;
            -moz-user-select: none !important;
            -ms-user-select: none !important;
            user-select: none !important;
        }
        
        input, textarea, select {
            -webkit-user-select: none !important;
            -moz-user-select: none !important;
            -ms-user-select: none !important;
            user-select: none !important;
        }
        
        .pet-bounce {
            animation: petBounce 1s ease-in-out infinite;
        }
        
        @keyframes petBounce {
            0%, 100% { transform: translateY(0) rotate(-5deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }
        
        .data-flow {
            animation: dataFlow 2s linear infinite;
        }
        
        @keyframes dataFlow {
            0% { transform: translateX(-100%); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translateX(100%); opacity: 0; }
        }
        
        .training-image {
            animation: flowToAI 1.5s ease-in-out;
        }
        
        @keyframes flowToAI {
            0% { 
                transform: translateX(0) translateY(0) scale(1);
                opacity: 1;
            }
            50% {
                transform: translateX(-100px) translateY(-50px) scale(0.8);
                opacity: 1;
            }
            100% { 
                transform: translateX(-200px) translateY(-100px) scale(0.3);
                opacity: 0;
            }
        }
        
        .training-feed {
            position: relative;
            min-height: 100px;
            overflow: hidden;
        }
        
        .example-image {
            position: absolute;
            background: white;
            padding: 8px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            font-size: 48px;
        }
        
        .brain-glow {
            animation: brainGlow 2s ease-in-out infinite;
        }
        
        @keyframes brainGlow {
            0%, 100% { filter: drop-shadow(0 0 10px rgba(147, 51, 234, 0.5)); }
            50% { filter: drop-shadow(0 0 30px rgba(147, 51, 234, 0.8)); }
        }
        
        .draggable {
            cursor: move;
            transition: all 0.3s ease;
        }
        
        .draggable:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .draggable.dragging {
            opacity: 0.5;
        }
        
        .drop-zone {
            min-height: 80px;
            transition: all 0.3s ease;
        }
        
        .drop-zone.drag-over {
            background-color: #e0e7ff;
            border-color: #6366f1;
            transform: scale(1.02);
        }
        
        .neuron {
            transition: all 0.5s ease;
        }
        
        .neuron.active {
            fill: #8b5cf6;
            filter: drop-shadow(0 0 15px rgba(139, 92, 246, 0.8));
        }
        
        .weight-line {
            transition: all 0.5s ease;
        }
        
        .weight-line.strong {
            stroke: #10b981;
            stroke-width: 4;
        }
        
        .weight-line.weak {
            stroke: #ef4444;
            stroke-width: 1;
            stroke-dasharray: 5,5;
        }
        
        @keyframes learn {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        .learning {
            animation: learn 0.5s ease-in-out;
        }
        
        .accuracy-bar {
            transition: width 1s ease;
        }
        
        .correct-prediction {
            animation: correctPulse 0.6s ease;
        }
        
        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); background-color: #10b981; }
            100% { transform: scale(1); }
        }
        
        .training-example {
            transition: all 0.3s ease;
        }
        
        .training-example:hover {
            transform: scale(1.05);
        }
        
        .progress-step {
            transition: all 0.5s ease;
        }
        
        .progress-step.completed {
            background-color: #10b981;
            color: white;
        }
        
        /* Glossary tooltips */
        .glossary-term {
            border-bottom: 2px dotted #6366f1;
            cursor: help;
            position: relative;
            display: inline-block;
        }
        
        .glossary-tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #1e293b;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 1000;
            max-width: 250px;
            white-space: normal;
        }
        
        .glossary-term:hover .glossary-tooltip {
            opacity: 1;
        }
        
        .glossary-tooltip::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: #1e293b;
        }
        
        /* Checkpoint quiz styles */
        .checkpoint-quiz {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .quiz-option {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .quiz-option:hover {
            transform: translateX(5px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .quiz-option.correct {
            background-color: #10b981;
            color: white;
        }
        
        .quiz-option.incorrect {
            background-color: #ef4444;
            color: white;
        }
        
        /* Hint system */
        .hint-button {
            position: relative;
            overflow: hidden;
        }
        
        .hint-button::after {
            content: '💡';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 20px;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(-50%); }
            50% { transform: translateY(-50%) translateY(-5px); }
        }
        
        .hint-box {
            background-color: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 12px;
            margin: 10px 0;
            border-radius: 4px;
            display: none;
        }
        
        .hint-box.visible {
            display: block;
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* Live graph styles */
        .chart-container {
            position: relative;
            height: 300px;
            margin: 20px 0;
        }
        
        /* Sound toggle button */
        .sound-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #6366f1;
            color: white;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 100;
            transition: all 0.3s ease;
        }
        
        .sound-toggle:hover {
            transform: scale(1.1);
        }
        
        .sound-toggle.muted {
            background-color: #6b7280;
        }
        
        #learningMessage {
            transition: opacity 0.3s ease;
        }

        #testProcess {
    transition: all 0.3s ease;
}

#testSteps > div {
    animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.chart-container canvas {
    max-height: 300px !important;
}
#trainingFeed > div {
    transition: opacity 0.5s ease;
}

.animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

@keyframes pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: .5;
    }
}
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 min-h-screen p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="text-center mb-8 relative">
            <div class="absolute inset-0 flex justify-center items-center opacity-10">
                <div class="text-[200px] brain-glow">🧠</div>
            </div>
            <h1 class="text-4xl md:text-6xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600 mb-2 relative z-10">
                How Machine Learning Works 🤖
            </h1>
            <p class="text-gray-600 text-lg relative z-10">Train your own AI and watch it learn!</p>
            
            <!-- XP Bar -->
            <div class="mt-6 bg-white rounded-full p-2 shadow-lg max-w-md mx-auto relative z-10">
                <div class="flex items-center justify-between">
                    <span class="text-sm font-bold text-gray-700 ml-3" id="levelText">Level 1 ML Rookie</span>
                    <span class="text-sm font-bold text-indigo-600 mr-3"><span id="xpPoints">0</span> XP</span>
                </div>
                <div class="bg-gray-200 rounded-full h-3 mt-2">
                    <div id="xpBar" class="bg-gradient-to-r from-indigo-500 to-purple-500 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>
        </header>

        <!-- Starter: Pattern Detective -->
        <section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6 relative overflow-hidden">
            <div class="absolute top-0 right-0 p-4">
                <span class="text-4xl">🔍</span>
            </div>
            <h2 class="text-2xl md:text-3xl font-bold text-indigo-600 mb-4">🔍 Starter: Pattern Detective</h2>
            <p class="text-gray-700 mb-6">Can you spot the patterns? This is exactly how AI learns - by finding patterns in data!</p>
            
            <!-- Pattern Recognition Game -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="bg-indigo-50 p-6 rounded-lg">
                    <h3 class="font-bold text-indigo-700 mb-3">Pattern 1: Numbers</h3>
                    <div class="flex gap-2 mb-4 text-lg font-bold justify-center">
                        <span class="bg-white px-3 py-2 rounded shadow">2</span>
                        <span class="bg-white px-3 py-2 rounded shadow">4</span>
                        <span class="bg-white px-3 py-2 rounded shadow">6</span>
                        <span class="bg-white px-3 py-2 rounded shadow">8</span>
                        <span class="bg-gray-200 px-3 py-2 rounded shadow">?</span>
                    </div>
                    <input type="number" id="pattern1" class="w-full p-2 border-2 border-indigo-300 rounded-md focus:border-indigo-500 focus:outline-none mb-2" placeholder="What comes next?">
                    <button onclick="checkPattern(1, 10)" class="w-full bg-indigo-500 text-white px-4 py-2 rounded hover:bg-indigo-600 transition-all">
                        Check Pattern
                    </button>
                    <div id="pattern1-feedback" class="mt-2 text-sm"></div>
                </div>
                
                <div class="bg-purple-50 p-6 rounded-lg">
                    <h3 class="font-bold text-purple-700 mb-3">Pattern 2: Colors</h3>
                    <div class="flex gap-2 mb-4 text-lg justify-center">
                        <span class="bg-white px-3 py-2 rounded shadow">🔵</span>
                        <span class="bg-white px-3 py-2 rounded shadow">🔴</span>
                        <span class="bg-white px-3 py-2 rounded shadow">🔵</span>
                        <span class="bg-white px-3 py-2 rounded shadow">🔴</span>
                        <span class="bg-gray-200 px-3 py-2 rounded shadow">?</span>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="checkPattern(2, 'blue')" class="bg-blue-500 text-white px-3 py-2 rounded hover:bg-blue-600 transition-all text-sm">
                            🔵 Blue
                        </button>
                        <button onclick="checkPattern(2, 'red')" class="bg-red-500 text-white px-3 py-2 rounded hover:bg-red-600 transition-all text-sm">
                            🔴 Red
                        </button>
                    </div>
                    <div id="pattern2-feedback" class="mt-2 text-sm"></div>
                </div>
                
                <div class="bg-green-50 p-6 rounded-lg">
                    <h3 class="font-bold text-green-700 mb-3">Pattern 3: Growth</h3>
                    <div class="flex gap-2 mb-4 text-lg justify-center">
                        <span class="bg-white px-3 py-2 rounded shadow">1</span>
                        <span class="bg-white px-3 py-2 rounded shadow">2</span>
                        <span class="bg-white px-3 py-2 rounded shadow">4</span>
                        <span class="bg-white px-3 py-2 rounded shadow">8</span>
                        <span class="bg-gray-200 px-3 py-2 rounded shadow">?</span>
                    </div>
                    <input type="number" id="pattern3" class="w-full p-2 border-2 border-green-300 rounded-md focus:border-green-500 focus:outline-none mb-2" placeholder="What comes next?">
                    <button onclick="checkPattern(3, 16)" class="w-full bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-all">
                        Check Pattern
                    </button>
                    <button onclick="showHint('pattern3')" class="hint-button w-full mt-2 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-all">
                        Need a Hint?
                    </button>
                    <div id="pattern3-hint" class="hint-box">
                        <p class="text-sm"><strong>Hint 1:</strong> Look at how each number relates to the previous one...</p>
                    </div>
                    <div id="pattern3-hint2" class="hint-box">
                        <p class="text-sm"><strong>Hint 2:</strong> Each number is double the previous one!</p>
                    </div>
                    <div id="pattern3-feedback" class="mt-2 text-sm"></div>
                </div>
            </div>
            
            <div class="mt-6 bg-gray-50 p-4 rounded-lg">
                <p class="font-bold text-gray-700 mb-2">💡 How this relates to AI:</p>
                <p class="text-gray-600 text-sm">Just like you spotted these patterns, <span class="glossary-term">machine learning<span class="glossary-tooltip">A type of AI that learns patterns from data without being explicitly programmed</span></span> algorithms find patterns in massive amounts of data. The more examples they see, the better they get at recognizing patterns!</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Checkpoint Quiz 1 -->
        <section class="checkpoint-quiz mb-6">
            <h3 class="text-xl font-bold text-white mb-4">🎯 Checkpoint Quiz: Pattern Recognition</h3>
            <div id="quiz1" class="bg-white rounded-lg p-4">
                <p class="font-semibold mb-3">How does AI learn to recognize patterns?</p>
                <div class="space-y-2">
                    <div class="quiz-option bg-gray-100 p-3 rounded-lg hover:bg-gray-200" onclick="checkQuizAnswer(1, 'a', false)">
                        A) By memorizing every single example perfectly
                    </div>
                    <div class="quiz-option bg-gray-100 p-3 rounded-lg hover:bg-gray-200" onclick="checkQuizAnswer(1, 'b', true)">
                        B) By finding similarities and rules in many examples
                    </div>
                    <div class="quiz-option bg-gray-100 p-3 rounded-lg hover:bg-gray-200" onclick="checkQuizAnswer(1, 'c', false)">
                        C) By randomly guessing until it gets lucky
                    </div>
                </div>
                <div id="quiz1-feedback" class="mt-3 text-sm font-semibold"></div>
            </div>
        </section>

        <!-- Task 1: Smart AI Pet Classifier -->
<section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6">
    <h2 class="text-2xl md:text-3xl font-bold text-purple-600 mb-4">🐾 Task 1: Supervised Learning - Train a Smart <span class="glossary-term">Classifier<span class="glossary-tooltip">An AI model that sorts things into categories or classes</span></span></h2>
    <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded-lg mb-4">
        <p class="text-sm text-gray-700"><strong>🏷️ This is Supervised Learning!</strong> You're teaching the AI by showing it labeled examples - you tell it "this is a cat", "this is a dog", etc. The AI learns from these labeled examples to recognize patterns.</p>
    </div>
    <p class="text-gray-700 mb-6">Build an AI that learns to classify animals! Watch how its <span class="glossary-term">accuracy<span class="glossary-tooltip">How often the AI makes correct predictions, measured as a percentage</span></span> improves with more <span class="glossary-term">training data<span class="glossary-tooltip">Examples the AI learns from to understand patterns</span></span>.</p>
    
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Training Interface -->
        <div>
            <h3 class="font-bold text-lg mb-4">🎓 Supervised Training Center</h3>
            <p class="text-sm text-gray-600 mb-4">Click to feed <strong>labeled</strong> training examples to your AI. Each example has a correct answer!</p>
            
            <!-- Visual Training Feed -->
            <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-lg p-4 mb-4">
                <p class="text-sm font-semibold text-purple-700 mb-2">Labeled Training Data Stream →</p>
                <div id="trainingFeed" class="training-feed relative bg-white rounded-lg border-2 border-dashed border-purple-300 min-h-[120px] flex items-center justify-center">
                    <p class="text-center text-gray-400 text-sm py-8">Click train buttons to see labeled examples flow to the AI!</p>
                </div>
            </div>
            
            <!-- Training Examples -->
            <div class="space-y-3 mb-4">
                <div class="training-example bg-blue-50 p-4 rounded-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <span class="text-3xl">🐱</span>
                            <div>
                                <span class="font-semibold">Cat Examples (Labeled)</span>
                                <p class="text-xs text-gray-600">Teaching: "This is a CAT - it meows, purrs, has whiskers"</p>
                            </div>
                        </div>
                        <button onclick="trainClassifier('cat', '🐱')" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-all">
                            Train +1
                        </button>
                    </div>
                </div>
                
                <div class="training-example bg-green-50 p-4 rounded-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <span class="text-3xl">🐶</span>
                            <div>
                                <span class="font-semibold">Dog Examples (Labeled)</span>
                                <p class="text-xs text-gray-600">Teaching: "This is a DOG - it barks, wags tail, loyal"</p>
                            </div>
                        </div>
                        <button onclick="trainClassifier('dog', '🐶')" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-all">
                            Train +1
                        </button>
                    </div>
                </div>
                
                <div class="training-example bg-orange-50 p-4 rounded-lg">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <span class="text-3xl">🐦</span>
                            <div>
                                <span class="font-semibold">Bird Examples (Labeled)</span>
                                <p class="text-xs text-gray-600">Teaching: "This is a BIRD - it chirps, flies, has wings"</p>
                            </div>
                        </div>
                        <button onclick="trainClassifier('bird', '🐦')" class="bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition-all">
                            Train +1
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- What's Happening Box -->
            <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg">
                <h4 class="font-semibold text-yellow-800 mb-2">🤔 How Supervised Learning Works</h4>
                <div class="space-y-2 text-sm text-gray-700">
                    <p><strong>1. You provide labels:</strong> Each training example comes with the correct answer</p>
                    <p><strong>2. AI learns patterns:</strong> It figures out what features belong to each label</p>
                    <p><strong>3. AI makes predictions:</strong> Uses learned patterns to classify new, unlabeled data</p>
                    <div class="mt-2 p-2 bg-yellow-100 rounded">
                        <p class="text-xs"><strong>💡 Key Point:</strong> In supervised learning, we're the "teacher" showing correct answers during training!</p>
                    </div>
                </div>
            </div>

            <div class="bg-gray-50 p-4 rounded-lg mt-4">
    <h4 class="font-semibold mb-3">Training Progress</h4>
    <div class="space-y-2 text-sm">
        <div class="flex justify-between items-center">
            <span class="flex items-center gap-2">
                <span>🐱</span>
                <span>Cat examples:</span>
            </span>
            <div class="flex items-center gap-2">
                <div class="w-20 bg-gray-200 rounded-full h-2">
                    <div id="catProgress" class="bg-blue-500 h-full rounded-full transition-all" style="width: 0%"></div>
                </div>
                <span id="catCount" class="font-bold w-8 text-right">0</span>
            </div>
        </div>
        <div class="flex justify-between items-center">
            <span class="flex items-center gap-2">
                <span>🐶</span>
                <span>Dog examples:</span>
            </span>
            <div class="flex items-center gap-2">
                <div class="w-20 bg-gray-200 rounded-full h-2">
                    <div id="dogProgress" class="bg-green-500 h-full rounded-full transition-all" style="width: 0%"></div>
                </div>
                <span id="dogCount" class="font-bold w-8 text-right">0</span>
            </div>
        </div>
        <div class="flex justify-between items-center">
            <span class="flex items-center gap-2">
                <span>🐦</span>
                <span>Bird examples:</span>
            </span>
            <div class="flex items-center gap-2">
                <div class="w-20 bg-gray-200 rounded-full h-2">
                    <div id="birdProgress" class="bg-orange-500 h-full rounded-full transition-all" style="width: 0%"></div>
                </div>
                <span id="birdCount" class="font-bold w-8 text-right">0</span>
            </div>
        </div>
        <hr class="my-2">
        <div class="flex justify-between items-center font-bold">
            <span>Total examples:</span>
            <span id="totalExamples">0</span>
        </div>
    </div>
</div>
        </div>
        
        <!-- AI System Display -->
        <div class="bg-gradient-to-br from-purple-100 to-pink-100 p-6 rounded-lg">
            <div class="text-center">
                <h3 class="font-bold text-xl mb-2">🤖 Your AI Student</h3>
                <p class="text-sm text-gray-600 mb-4">Watch how your AI learns from examples!</p>
                
                <div id="aiSystem" class="text-6xl mb-4 pet-bounce relative inline-block">🤖</div>
                
                <!-- AI Thinking Process -->
                <div class="bg-white/80 rounded-lg p-3 mb-4 border-2 border-purple-300">
                    <p class="text-xs font-semibold text-purple-700 mb-1">AI's Pattern Recognition:</p>
                    <div id="aiThinking" class="text-sm text-gray-600">
                        <p>Waiting for training data...</p>
                    </div>
                </div>
                
                <!-- Current Prediction -->
<div class="bg-white p-4 rounded-lg shadow mb-4">
    <p class="text-sm font-semibold mb-2">Training Knowledge Base:</p>
    <div id="knowledgeBase" class="space-y-2">
        <p class="text-gray-500 text-sm">No training data yet...</p>
    </div>
    <div class="mt-3 pt-3 border-t border-gray-200">
        <p class="text-xs text-gray-600">💡 The AI stores patterns from your training examples</p>
        <p class="text-xs text-gray-600">🧪 Test mode will use this knowledge to make predictions</p>
    </div>
</div>
                
                <!-- Overall Accuracy -->
                <div class="bg-white p-4 rounded-lg shadow">
                    <p class="text-sm font-semibold mb-2">Training Quality:</p>
                    <div class="bg-gray-200 rounded-full h-6 relative">
                        <div id="accuracyBar" class="accuracy-bar bg-gradient-to-r from-red-400 via-yellow-400 to-green-500 h-full rounded-full" style="width: 0%"></div>
                        <span id="accuracyText" class="absolute inset-0 flex items-center justify-center text-sm font-bold text-gray-700">0%</span>
                    </div>
                    <p id="accuracyDescription" class="text-xs text-gray-600 mt-1">Need more training data</p>
                    <p id="accuracyFormula" class="text-xs text-gray-500 mt-1">Quality Score = Examples × Balance Factor</p>
                    <div class="text-xs text-gray-500 mt-2">
                        <p>🔴 0-30%: Just starting (need 5+ examples)</p>
                        <p>🟡 30-70%: Getting better (need 10+ balanced examples)</p>
                        <p>🟢 70-100%: Expert level (15+ well-balanced examples)</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Live Training Graph -->
    <div class="bg-gradient-to-br from-indigo-100 to-blue-100 p-6 rounded-lg mt-6">
        <h3 class="font-bold text-indigo-700 mb-4">📈 Live Training Progress</h3>
        <div class="chart-container">
            <canvas id="trainingChart"></canvas>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4 text-sm">
            <div class="bg-white/80 p-3 rounded">
                <span class="font-semibold">Sessions:</span> <span id="sessionCount" class="font-bold">0</span>
            </div>
            <div class="bg-white/80 p-3 rounded">
                <span class="font-semibold">Best Accuracy:</span> <span id="bestAccuracy" class="font-bold">0%</span>
            </div>
            <div class="bg-white/80 p-3 rounded">
                <span class="font-semibold">Balance Score:</span> <span id="balanceScore" class="font-bold">0%</span>
            </div>
        </div>
    </div>
    
    <!-- Test Section -->
    <div class="bg-yellow-50 p-6 rounded-lg mt-6">
        <h4 class="font-bold text-lg mb-3">🧪 Test Your AI's Learning</h4>
        <p class="text-sm text-gray-700 mb-4">Click a test button to see how your AI classifies that animal based on what it learned. The AI will compare the test input to its training data and make a prediction.</p>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
            <div class="bg-white p-4 rounded-lg border-2 border-yellow-300">
                <h5 class="font-semibold text-sm mb-2">Test Process:</h5>
                <ol class="text-xs text-gray-600 space-y-1">
                    <li>1. You click a test animal</li>
                    <li>2. AI compares to training data</li>
                    <li>3. AI makes prediction</li>
                    <li>4. We check if it's correct</li>
                </ol>
            </div>
            
            <div class="bg-white p-4 rounded-lg border-2 border-yellow-300">
                <h5 class="font-semibold text-sm mb-2">Why Test?</h5>
                <p class="text-xs text-gray-600">Testing shows if your AI can correctly identify animals it hasn't seen before, proving it learned patterns!</p>
            </div>
            
            <div class="bg-white p-4 rounded-lg border-2 border-yellow-300">
                <h5 class="font-semibold text-sm mb-2">Success Tips:</h5>
                <ul class="text-xs text-gray-600 space-y-1">
                    <li>• Train with 5+ examples each</li>
                    <li>• Keep training balanced</li>
                    <li>• More data = better results</li>
                </ul>
            </div>
        </div>
        
        <div class="grid grid-cols-3 gap-4">
            <button onclick="testClassifier('🐱', 'cat')" class="bg-yellow-500 text-white px-4 py-3 rounded hover:bg-yellow-600 transition-all">
                <span class="text-2xl">🐱</span>
                <p class="text-sm">Test Cat</p>
            </button>
            <button onclick="testClassifier('🐶', 'dog')" class="bg-yellow-500 text-white px-4 py-3 rounded hover:bg-yellow-600 transition-all">
                <span class="text-2xl">🐶</span>
                <p class="text-sm">Test Dog</p>
            </button>
            <button onclick="testClassifier('🐦', 'bird')" class="bg-yellow-500 text-white px-4 py-3 rounded hover:bg-yellow-600 transition-all">
                <span class="text-2xl">🐦</span>
                <p class="text-sm">Test Bird</p>
            </button>
        </div>
        
        <div id="testProcess" class="mt-4 hidden">
            <div class="bg-white p-4 rounded-lg border-2 border-purple-300">
                <p class="font-semibold text-sm mb-2">AI Decision Process:</p>
                <div id="testSteps" class="space-y-2 text-sm"></div>
            </div>
        </div>
        
        <div id="testResults" class="mt-4 text-sm"></div>
    </div>
</section>

<!-- Add this after the Test Section, before the closing </section> tag -->
<!-- Reflection Questions -->
<div class="bg-gradient-to-r from-indigo-50 to-purple-50 p-6 rounded-lg mt-6">
    <h4 class="font-bold text-lg text-indigo-700 mb-4">🤔 Reflection: What Did You Learn?</h4>
    <p class="text-sm text-gray-600 mb-4">Based on your AI training experience, answer these questions:</p>
    
    <div class="space-y-4">
        <!-- Question 1 -->
        <div class="bg-white p-4 rounded-lg border-l-4 border-indigo-400">
            <p class="font-semibold text-sm mb-3">1. What happened to your AI's accuracy when you trained it with only one type of animal (e.g., 20 cats, 0 dogs, 0 birds)?</p>
            <div class="space-y-2">
                <label class="flex items-start gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                    <input type="radio" name="q1" value="a" class="mt-1" onclick="checkReflectionAnswer(1, 'a', false)">
                    <span class="text-sm">A) The accuracy stayed high because it had lots of data</span>
                </label>
                <label class="flex items-start gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                    <input type="radio" name="q1" value="b" class="mt-1" onclick="checkReflectionAnswer(1, 'b', true)">
                    <span class="text-sm">B) The accuracy was lower because the AI couldn't learn to tell different animals apart</span>
                </label>
                <label class="flex items-start gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                    <input type="radio" name="q1" value="c" class="mt-1" onclick="checkReflectionAnswer(1, 'c', false)">
                    <span class="text-sm">C) It made no difference to the accuracy</span>
                </label>
            </div>
            <div id="reflection1-feedback" class="mt-2 text-sm"></div>
        </div>
        
        <!-- Question 2 -->
        <div class="bg-white p-4 rounded-lg border-l-4 border-purple-400">
            <p class="font-semibold text-sm mb-3">2. Why do you think the AI needs examples of ALL three animals to work well?</p>
            <div class="space-y-2">
                <label class="flex items-start gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                    <input type="radio" name="q2" value="a" class="mt-1" onclick="checkReflectionAnswer(2, 'a', false)">
                    <span class="text-sm">A) It looks better to have all three</span>
                </label>
                <label class="flex items-start gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                    <input type="radio" name="q2" value="b" class="mt-1" onclick="checkReflectionAnswer(2, 'b', true)">
                    <span class="text-sm">B) To learn the unique features that make each animal different from the others</span>
                </label>
                <label class="flex items-start gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                    <input type="radio" name="q2" value="c" class="mt-1" onclick="checkReflectionAnswer(2, 'c', false)">
                    <span class="text-sm">C) The AI gets bored with just one type</span>
                </label>
            </div>
            <div id="reflection2-feedback" class="mt-2 text-sm"></div>
        </div>
        
        <!-- Question 3 -->
        <div class="bg-white p-4 rounded-lg border-l-4 border-pink-400">
            <p class="font-semibold text-sm mb-3">3. When you clicked "Test Cat 🐱", what was the AI actually doing?</p>
            <div class="space-y-2">
                <label class="flex items-start gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                    <input type="radio" name="q3" value="a" class="mt-1" onclick="checkReflectionAnswer(3, 'a', false)">
                    <span class="text-sm">A) Adding more cat examples to its training</span>
                </label>
                <label class="flex items-start gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                    <input type="radio" name="q3" value="b" class="mt-1" onclick="checkReflectionAnswer(3, 'b', false)">
                    <span class="text-sm">B) Randomly guessing an animal</span>
                </label>
                <label class="flex items-start gap-2 cursor-pointer hover:bg-gray-50 p-2 rounded">
                    <input type="radio" name="q3" value="c" class="mt-1" onclick="checkReflectionAnswer(3, 'c', true)">
                    <span class="text-sm">C) Comparing the test input to its learned patterns to make a prediction</span>
                </label>
            </div>
            <div id="reflection3-feedback" class="mt-2 text-sm"></div>
        </div>
        
        <!-- Question 4 -->
        <div class="bg-white p-4 rounded-lg border-l-4 border-green-400">
            <p class="font-semibold text-sm mb-3">4. Think about real AI systems like Siri or Alexa. Based on your experiment, why might they sometimes give wrong answers?</p>
            <textarea id="reflection4" class="w-full p-3 border-2 border-gray-300 rounded-md text-sm" rows="3" placeholder="Type your answer here..."></textarea>
            <button onclick="checkOpenAnswer(4)" class="mt-2 bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 transition-all text-sm">
                Check My Answer
            </button>
            <div id="reflection4-feedback" class="mt-2 text-sm"></div>
        </div>
        
        <!-- Question 5 -->
        <div class="bg-white p-4 rounded-lg border-l-4 border-yellow-400">
            <p class="font-semibold text-sm mb-3">5. If you were training an AI to recognize your friends' faces, what would be important about your training data?</p>
            <textarea id="reflection5" class="w-full p-3 border-2 border-gray-300 rounded-md text-sm" rows="3" placeholder="Type your answer here..."></textarea>
            <button onclick="checkOpenAnswer(5)" class="mt-2 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-all text-sm">
                Check My Answer
            </button>
            <div id="reflection5-feedback" class="mt-2 text-sm"></div>
        </div>
    </div>
    
    <!-- Summary Box -->
    <div id="reflectionSummary" class="hidden mt-6 bg-gradient-to-r from-green-100 to-blue-100 p-4 rounded-lg">
        <h5 class="font-bold text-green-700 mb-2">🎉 Great Job!</h5>
        <p class="text-sm text-gray-700">You've discovered key principles of machine learning:</p>
        <ul class="text-sm text-gray-700 mt-2 space-y-1">
            <li>✅ AI needs diverse, balanced training data</li>
            <li>✅ More examples = better learning (but quality matters!)</li>
            <li>✅ Testing shows if AI truly learned patterns</li>
            <li>✅ Real-world AI faces similar challenges</li>
        </ul>
    </div>
</div>

        <!-- Task 2: Data Quality Experiment -->
        <section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6">
            <h2 class="text-2xl md:text-3xl font-bold text-green-600 mb-4">📊 Task 2: The Data Quality Experiment</h2>
            <p class="text-gray-700 mb-6">Discover how data quality affects AI performance through interactive experiments!</p>
            
            <!-- Data Quantity vs Quality -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="bg-gradient-to-br from-green-50 to-blue-50 p-6 rounded-lg">
                    <h3 class="font-bold text-green-700 mb-4">📈 Data Quantity Impact</h3>
                    
                    <div class="space-y-4">
                        <div class="bg-white p-4 rounded-lg border-l-4 border-red-400">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-sm">Small Dataset</span>
                                <span class="text-xs bg-red-100 text-red-700 px-2 py-1 rounded">10 examples</span>
                            </div>
                            <div class="text-lg mb-2">🚗🚗🚙🚗🚙</div>
                            <div class="bg-gray-200 rounded-full h-3 mb-1">
                                <div class="bg-red-500 h-full rounded-full" style="width: 60%"></div>
                            </div>
                            <p class="text-xs text-gray-600">Accuracy: 60% - Not enough examples!</p>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg border-l-4 border-yellow-400">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-sm">Medium Dataset</span>
                                <span class="text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded">100 examples</span>
                            </div>
                            <div class="text-sm mb-2">🚗🚙🚗🚙🚗🚙🚗🚙... (×100)</div>
                            <div class="bg-gray-200 rounded-full h-3 mb-1">
                                <div class="bg-yellow-500 h-full rounded-full" style="width: 85%"></div>
                            </div>
                            <p class="text-xs text-gray-600">Accuracy: 85% - Better learning!</p>
                        </div>
                        
                        <div class="bg-white p-4 rounded-lg border-l-4 border-green-400">
                            <div class="flex justify-between items-center mb-2">
                                <span class="font-semibold text-sm">Large Dataset</span>
                                <span class="text-xs bg-green-100 text-green-700 px-2 py-1 rounded">1000+ examples</span>
                            </div>
                            <div class="text-xs mb-2">🚗🚙🚗🚙🚗🚙... (×1000+)</div>
                            <div class="bg-gray-200 rounded-full h-3 mb-1">
                                <div class="bg-green-500 h-full rounded-full" style="width: 95%"></div>
                            </div>
                            <p class="text-xs text-gray-600">Accuracy: 95%+ - Excellent!</p>
                        </div>
                    </div>
                </div>
                
<div class="bg-gradient-to-br from-orange-50 to-red-50 p-6 rounded-lg">
    <h3 class="font-bold text-orange-700 mb-4">🎨 Data Quality Challenge</h3>
    <p class="text-sm text-gray-600 mb-3">An AI company needs to train a dog breed classifier. Rank these datasets from BEST (1) to WORST (6) quality.</p>
    <p class="text-xs text-gray-500 mb-4">Think carefully about: variety, real-world use, data balance, and potential problems!</p>
    
    <div id="qualityRanking" class="space-y-3">
        <div class="draggable bg-white p-4 rounded-lg shadow border-2 border-gray-200 cursor-move" draggable="true" data-quality="terrible" data-rank="6">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <p class="font-semibold text-sm">Dataset A</p>
                    <p class="text-xs text-gray-600 mb-1">1000 images: 🐕🐕🐕🐕🐕...</p>
                    <p class="text-xs text-gray-500">All golden retrievers, all facing forward, all in parks</p>
                </div>
                <span class="text-lg text-gray-400">?</span>
            </div>
        </div>
        
        <div class="draggable bg-white p-4 rounded-lg shadow border-2 border-gray-200 cursor-move" draggable="true" data-quality="poor" data-rank="5">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <p class="font-semibold text-sm">Dataset B</p>
                    <p class="text-xs text-gray-600 mb-1">10,000 images: 🐕🦮🐩🐕‍🦺</p>
                    <p class="text-xs text-gray-500">Many breeds, but 9,500 are poodles, rest are other breeds</p>
                </div>
                <span class="text-lg text-gray-400">?</span>
            </div>
        </div>
        
        <div class="draggable bg-white p-4 rounded-lg shadow border-2 border-gray-200 cursor-move" draggable="true" data-quality="misleading" data-rank="4">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <p class="font-semibold text-sm">Dataset C</p>
                    <p class="text-xs text-gray-600 mb-1">5,000 images: 🐕🦮🐩 + 📸</p>
                    <p class="text-xs text-gray-500">Professional photos only, perfect lighting, dogs groomed for shows</p>
                </div>
                <span class="text-lg text-gray-400">?</span>
            </div>
        </div>
        
        <div class="draggable bg-white p-4 rounded-lg shadow border-2 border-gray-200 cursor-move" draggable="true" data-quality="decent" data-rank="3">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <p class="font-semibold text-sm">Dataset D</p>
                    <p class="text-xs text-gray-600 mb-1">800 images: 🐕🦮🐩🐕‍🦺 + 🌤️🌧️</p>
                    <p class="text-xs text-gray-500">20 breeds, various weather, but all adult dogs only</p>
                </div>
                <span class="text-lg text-gray-400">?</span>
            </div>
        </div>
        
        <div class="draggable bg-white p-4 rounded-lg shadow border-2 border-gray-200 cursor-move" draggable="true" data-quality="good" data-rank="2">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <p class="font-semibold text-sm">Dataset E</p>
                    <p class="text-xs text-gray-600 mb-1">2,000 images: Mixed quality 📱📸</p>
                    <p class="text-xs text-gray-500">30 breeds, some blurry, various angles, includes mistakes (cats: 5%)</p>
                </div>
                <span class="text-lg text-gray-400">?</span>
            </div>
        </div>
        
        <div class="draggable bg-white p-4 rounded-lg shadow border-2 border-gray-200 cursor-move" draggable="true" data-quality="best" data-rank="1">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <p class="font-semibold text-sm">Dataset F</p>
                    <p class="text-xs text-gray-600 mb-1">3,000 images: 🐕🐕‍🦺👶🏠🌳☀️🌧️</p>
                    <p class="text-xs text-gray-500">40 breeds, puppies to seniors, indoor/outdoor, various conditions</p>
                </div>
                <span class="text-lg text-gray-400">?</span>
            </div>
        </div>
    </div>
    
    <div class="mt-4 bg-yellow-50 p-3 rounded-lg">
        <p class="text-xs text-gray-700"><strong>💡 Hint:</strong> Think about what happens when the AI sees a muddy puppy in someone's messy living room...</p>
    </div>
    
    <button onclick="checkQualityRanking()" class="mt-4 bg-orange-500 text-white px-4 py-2 rounded hover:bg-orange-600 transition-all w-full">
        Check My Ranking
    </button>
    <button onclick="showHint('quality')" class="hint-button mt-2 bg-yellow-500 text-white px-4 py-2 rounded hover:bg-yellow-600 transition-all w-full">
        Need Help? Show Ranking Hints
    </button>
    <div id="quality-hint" class="hint-box">
        <p class="text-sm"><strong>Hint 1:</strong> Big datasets aren't always better - balance matters! Dataset B has 10,000 images but...</p>
    </div>
    <div id="quality-hint2" class="hint-box">
        <p class="text-sm"><strong>Hint 2:</strong> Real-world data is messy! Perfect studio photos won't help identify muddy dogs in parks.</p>
    </div>
    <div id="qualityFeedback" class="mt-3 text-sm"></div>
</div>
            
            <!-- Key Learning Points -->
            <div class="bg-blue-50 p-6 rounded-lg">
                <h4 class="font-bold text-blue-700 mb-4">🎯 Key Machine Learning Concepts</h4>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white p-4 rounded-lg text-center">
                        <div class="text-3xl mb-2">📊</div>
                        <p class="font-semibold text-blue-600 mb-1">Training Data</p>
                        <p class="text-sm text-gray-600">Examples AI learns from. More = better!</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg text-center">
                        <div class="text-3xl mb-2">🔍</div>
                        <p class="font-semibold text-purple-600 mb-1">Pattern Recognition</p>
                        <p class="text-sm text-gray-600">Finding rules and similarities in data</p>
                    </div>
                    <div class="bg-white p-4 rounded-lg text-center">
                        <div class="text-3xl mb-2">🎯</div>
                        <p class="font-semibold text-green-600 mb-1">Prediction</p>
                        <p class="text-sm text-gray-600">Making educated guesses on new data</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Checkpoint Quiz 2 -->
        <section class="checkpoint-quiz mb-6">
            <h3 class="text-xl font-bold text-white mb-4">🎯 Checkpoint Quiz: Training Data</h3>
            <div id="quiz2" class="bg-white rounded-lg p-4">
                <p class="font-semibold mb-3">What makes training data high quality?</p>
                <div class="space-y-2">
                    <div class="quiz-option bg-gray-100 p-3 rounded-lg hover:bg-gray-200" onclick="checkQuizAnswer(2, 'a', false)">
                        A) Having exactly the same type of examples repeated many times
                    </div>
                    <div class="quiz-option bg-gray-100 p-3 rounded-lg hover:bg-gray-200" onclick="checkQuizAnswer(2, 'b', false)">
                        B) Using only perfect, professional examples
                    </div>
                    <div class="quiz-option bg-gray-100 p-3 rounded-lg hover:bg-gray-200" onclick="checkQuizAnswer(2, 'c', true)">
                        C) Having diverse examples from different contexts
                    </div>
                </div>
                <div id="quiz2-feedback" class="mt-3 text-sm font-semibold"></div>
            </div>
        </section>

        <!-- Task 3: Build ML Pipeline -->
        <section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6">
    <h2 class="text-2xl md:text-3xl font-bold text-indigo-600 mb-4">🔧 Task 3: Build a Machine Learning Pipeline</h2>
    <p class="text-gray-700 mb-6">Create the complete ML workflow by arranging steps in the correct order!</p>
    
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Available Steps -->
        <div>
            <h3 class="font-bold text-lg mb-4">Available ML Steps</h3>
            <p class="text-sm text-gray-600 mb-4">Drag these steps to build the pipeline →</p>
            
            <div id="mlSteps" class="space-y-3">
                <div class="draggable bg-blue-100 p-4 rounded-lg border-2 border-blue-300 cursor-move" draggable="true" data-step="test" data-order="4">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">🧪</span>
                        <div>
                            <p class="font-semibold">Test Model</p>
                            <p class="text-sm text-gray-600">Check if it learned correctly</p>
                        </div>
                    </div>
                </div>
                
                <div class="draggable bg-green-100 p-4 rounded-lg border-2 border-green-300 cursor-move" draggable="true" data-step="deploy" data-order="5">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">🚀</span>
                        <div>
                            <p class="font-semibold">Deploy/Use</p>
                            <p class="text-sm text-gray-600">Put it to work in real world</p>
                        </div>
                    </div>
                </div>
                
                <div class="draggable bg-orange-100 p-4 rounded-lg border-2 border-orange-300 cursor-move" draggable="true" data-step="prepare" data-order="2">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">🔨</span>
                        <div>
                            <p class="font-semibold">Prepare Data</p>
                            <p class="text-sm text-gray-600">Clean and organize the data</p>
                        </div>
                    </div>
                </div>
                
                <div class="draggable bg-indigo-100 p-4 rounded-lg border-2 border-indigo-300 cursor-move" draggable="true" data-step="collect" data-order="1">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">📊</span>
                        <div>
                            <p class="font-semibold">Collect Data</p>
                            <p class="text-sm text-gray-600">Gather examples and information</p>
                        </div>
                    </div>
                </div>
                
                <div class="draggable bg-purple-100 p-4 rounded-lg border-2 border-purple-300 cursor-move" draggable="true" data-step="train" data-order="3">
                    <div class="flex items-center gap-3">
                        <span class="text-2xl">🎯</span>
                        <div>
                            <p class="font-semibold">Train Model</p>
                            <p class="text-sm text-gray-600">Teach AI to find patterns</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Pipeline Builder -->
        <div>
            <h3 class="font-bold text-lg mb-4">Your ML Pipeline</h3>
            <div class="bg-gradient-to-br from-indigo-50 to-purple-50 p-6 rounded-lg">
                <div id="pipelineOrder" class="space-y-4">
                    <div class="drop-zone bg-white border-3 border-dashed border-gray-300 rounded-lg p-6 text-center" data-position="1">
                        <span class="text-gray-400 font-semibold">First Step: Drop here</span>
                    </div>
                    <div class="text-center text-2xl text-gray-400">⬇️</div>
                    <div class="drop-zone bg-white border-3 border-dashed border-gray-300 rounded-lg p-6 text-center" data-position="2">
                        <span class="text-gray-400 font-semibold">Second Step: Drop here</span>
                    </div>
                    <div class="text-center text-2xl text-gray-400">⬇️</div>
                    <div class="drop-zone bg-white border-3 border-dashed border-gray-300 rounded-lg p-6 text-center" data-position="3">
                        <span class="text-gray-400 font-semibold">Third Step: Drop here</span>
                    </div>
                    <div class="text-center text-2xl text-gray-400">⬇️</div>
                    <div class="drop-zone bg-white border-3 border-dashed border-gray-300 rounded-lg p-6 text-center" data-position="4">
                        <span class="text-gray-400 font-semibold">Fourth Step: Drop here</span>
                    </div>
                    <div class="text-center text-2xl text-gray-400">⬇️</div>
                    <div class="drop-zone bg-white border-3 border-dashed border-gray-300 rounded-lg p-6 text-center" data-position="5">
                        <span class="text-gray-400 font-semibold">Final Step: Drop here</span>
                    </div>
                </div>
                
                <div class="mt-6 flex gap-3">
                    <button onclick="checkPipeline()" class="flex-1 bg-indigo-500 text-white px-6 py-3 rounded-lg hover:bg-indigo-600 transition-all font-semibold">
                        Check Pipeline
                    </button>
                    <button onclick="resetPipeline()" class="bg-gray-500 text-white px-4 py-3 rounded-lg hover:bg-gray-600 transition-all">
                        Reset
                    </button>
                </div>
                <button onclick="showHint('pipeline')" class="hint-button w-full mt-3 bg-yellow-500 text-white px-4 py-2 rounded-lg hover:bg-yellow-600 transition-all">
                    Need a Hint?
                </button>
                <div id="pipeline-hint" class="hint-box">
                    <p class="text-sm"><strong>Hint 1:</strong> Think about what needs to happen first - you can't train without data!</p>
                </div>
                <div id="pipeline-hint2" class="hint-box">
                    <p class="text-sm"><strong>Hint 2:</strong> The order is: Collect → Prepare → Train → Test → Deploy</p>
                </div>
                <div id="pipelineFeedback" class="mt-4 text-sm"></div>
            </div>
        </div>
    </div>
</section>
<!-- Task 4: Unsupervised Learning - Mystery Sorting Challenge -->
<section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6">
    <h2 class="text-2xl md:text-3xl font-bold text-teal-600 mb-4">🔮 Task 4: Unsupervised Learning - The Mystery Sorting Challenge</h2>
    <div class="bg-purple-50 border-l-4 border-purple-400 p-4 rounded-lg mb-4">
        <p class="text-sm text-gray-700"><strong>🔍 This is Unsupervised Learning!</strong> The AI gets NO labels or correct answers. It must discover patterns and create its own groups based on what it observes. You'll see how it clusters similar things together!</p>
    </div>
    <p class="text-gray-700 mb-6">Watch an AI sort mystery items into groups WITHOUT being told what the groups should be!</p>
    
    <!-- The Challenge Setup -->
    <div class="bg-gradient-to-r from-teal-50 to-cyan-50 p-6 rounded-lg mb-6">
        <h3 class="font-bold text-teal-700 mb-4">🎯 The Challenge</h3>
        <p class="text-sm text-gray-700 mb-4">You're the curator of a Mystery Museum! Mixed items arrived in one big box. The AI must sort them into meaningful groups WITHOUT any labels or hints!</p>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <!-- Input: Mixed Items -->
            <div class="bg-white p-4 rounded-lg border-2 border-teal-200">
                <h4 class="font-semibold text-teal-700 mb-3">📦 Unsorted Mystery Box</h4>
                <div id="mysteryBox" class="grid grid-cols-4 gap-2 mb-4">
                    <!-- Items will be dynamically added here -->
                </div>
                <button onclick="startUnsupervisedLearning()" class="w-full bg-teal-500 text-white px-4 py-2 rounded hover:bg-teal-600 transition-all">
                    🤖 Let AI Sort (No Labels!)
                </button>
            </div>
            
            <!-- Output: AI's Groups -->
            <div class="bg-white p-4 rounded-lg border-2 border-purple-200">
                <h4 class="font-semibold text-purple-700 mb-3">🧠 AI's Discovered Groups</h4>
                <div id="aiGroups" class="space-y-3">
                    <p class="text-gray-400 text-sm text-center py-8">Click "Let AI Sort" to see what patterns the AI finds!</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Interactive Clustering Visualization -->
    <div class="bg-gradient-to-br from-indigo-50 to-purple-50 p-6 rounded-lg mb-6">
        <h3 class="font-bold text-indigo-700 mb-4">👁️ Watch AI's Clustering Process</h3>
        <div class="bg-white rounded-lg p-4 border-2 border-indigo-200">
            <canvas id="clusteringCanvas" width="600" height="400" class="w-full rounded"></canvas>
            <div id="clusteringSteps" class="mt-4 space-y-2">
                <!-- Steps will appear here -->
            </div>
        </div>
        
        <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
            <button onclick="changeDataset('animals')" class="dataset-btn bg-green-100 hover:bg-green-200 text-green-700 px-4 py-2 rounded transition-all">
                🦁 Try: Animals Mix
            </button>
            <button onclick="changeDataset('transport')" class="dataset-btn bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded transition-all">
                🚗 Try: Transport Mix
            </button>
            <button onclick="changeDataset('weather')" class="dataset-btn bg-yellow-100 hover:bg-yellow-200 text-yellow-700 px-4 py-2 rounded transition-all">
                🌦️ Try: Weather Mix
            </button>
        </div>
    </div>
    
    <!-- Compare with Supervised -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        <div class="bg-red-50 p-4 rounded-lg border-l-4 border-red-400">
            <h4 class="font-bold text-red-700 mb-2">📚 Supervised (Task 1)</h4>
            <ul class="text-sm text-gray-700 space-y-1">
                <li>✓ We told AI: "This is a cat"</li>
                <li>✓ We told AI: "This is a dog"</li>
                <li>✓ AI learned our labels</li>
                <li>✓ Groups were pre-defined</li>
            </ul>
        </div>
        <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-400">
            <h4 class="font-bold text-green-700 mb-2">🔍 Unsupervised (This Task)</h4>
            <ul class="text-sm text-gray-700 space-y-1">
                <li>✓ AI sees: "?????"</li>
                <li>✓ AI thinks: "These look similar"</li>
                <li>✓ AI creates its own groups</li>
                <li>✓ Groups emerge from data</li>
            </ul>
        </div>
    </div>
    
    <!-- Real World Examples -->
    <div class="bg-yellow-50 p-4 rounded-lg">
        <h4 class="font-bold text-yellow-800 mb-3">🌍 Real-World Unsupervised Learning</h4>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3">
            <div class="bg-white p-3 rounded text-center">
                <span class="text-2xl">🎵</span>
                <p class="text-xs font-semibold mt-1">Spotify</p>
                <p class="text-xs text-gray-600">Groups similar songs</p>
            </div>
            <div class="bg-white p-3 rounded text-center">
                <span class="text-2xl">🛒</span>
                <p class="text-xs font-semibold mt-1">Shopping</p>
                <p class="text-xs text-gray-600">Finds buying patterns</p>
            </div>
            <div class="bg-white p-3 rounded text-center">
                <span class="text-2xl">🔬</span>
                <p class="text-xs font-semibold mt-1">Science</p>
                <p class="text-xs text-gray-600">Discovers new species</p>
            </div>
            <div class="bg-white p-3 rounded text-center">
                <span class="text-2xl">🏥</span>
                <p class="text-xs font-semibold mt-1">Medicine</p>
                <p class="text-xs text-gray-600">Finds disease patterns</p>
            </div>
        </div>
    </div>
    
    <!-- Challenge Questions -->
    <div class="bg-gradient-to-r from-pink-50 to-purple-50 p-6 rounded-lg mt-6">
        <h4 class="font-bold text-purple-700 mb-4">🤔 Unsupervised Learning Challenge</h4>
        <div class="space-y-3">
            <div class="bg-white p-4 rounded-lg">
                <p class="text-sm font-semibold mb-2">1. Did the AI group things the same way you would?</p>
                <div class="space-y-2">
                    <label class="flex items-center gap-2 text-sm">
                        <input type="radio" name="uq1" onclick="checkUnsupervisedAnswer(1, true)">
                        <span>Yes, exactly the same groups</span>
                    </label>
                    <label class="flex items-center gap-2 text-sm">
                        <input type="radio" name="uq1" onclick="checkUnsupervisedAnswer(1, false)">
                        <span>No, it found different patterns</span>
                    </label>
                </div>
                <div id="uq1-feedback" class="mt-2 text-sm"></div>
            </div>
            
            <div class="bg-white p-4 rounded-lg">
                <p class="text-sm font-semibold mb-2">2. What's the main advantage of unsupervised learning?</p>
                <textarea id="uq2-answer" class="w-full p-2 border rounded text-sm" rows="2" placeholder="Type your answer..."></textarea>
                <button onclick="checkUnsupervisedAnswer(2)" class="mt-2 bg-purple-500 text-white px-3 py-1 rounded text-sm hover:bg-purple-600">
                    Check Answer
                </button>
                <div id="uq2-feedback" class="mt-2 text-sm"></div>
            </div>
        </div>
    </div>
</section>
 <!-- Task 5: Types of Machine Learning -->
<section class="bg-white rounded-xl shadow-lg p-6 md:p-8 mb-6">
    <h2 class="text-2xl md:text-3xl font-bold text-pink-600 mb-4">🏷️ Task 5: Types of Machine Learning</h2>
    <p class="text-gray-700 mb-6">Can you identify which type of machine learning these scenarios use? Test your understanding!</p>
    
    <!-- Progress Tracker -->
    <div class="bg-gray-100 rounded-full h-4 mb-6">
        <div id="mlTypeProgress" class="bg-gradient-to-r from-pink-400 to-purple-600 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
    </div>
    <p class="text-center text-sm text-gray-600 mb-6">Complete <span id="scenariosCompleted">0</span>/10 scenarios</p>
    
    <!-- Interactive Comparison -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
        <!-- Supervised Learning -->
        <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-6 rounded-lg border-2 border-blue-200">
            <h3 class="font-bold text-blue-700 text-xl mb-4 flex items-center gap-2">
                📚 Supervised Learning
                <span class="text-sm bg-blue-100 text-blue-700 px-2 py-1 rounded">With Teacher</span>
            </h3>
            
            <div class="bg-white p-4 rounded-lg mb-4 border-l-4 border-blue-500">
                <p class="font-semibold mb-3 text-gray-700">Key Features:</p>
                <ul class="space-y-2 text-sm">
                    <li>✓ Training data has labels/correct answers</li>
                    <li>✓ AI learns from examples with known outcomes</li>
                    <li>✓ Can predict specific categories or values</li>
                    <li>✓ "This is X" → AI learns what X looks like</li>
                </ul>
            </div>
        </div>
        
        <!-- Unsupervised Learning -->
        <div class="bg-gradient-to-br from-purple-50 to-pink-50 p-6 rounded-lg border-2 border-purple-200">
            <h3 class="font-bold text-purple-700 text-xl mb-4 flex items-center gap-2">
                🔍 Unsupervised Learning
                <span class="text-sm bg-purple-100 text-purple-700 px-2 py-1 rounded">Self Discovery</span>
            </h3>
            
            <div class="bg-white p-4 rounded-lg mb-4 border-l-4 border-purple-500">
                <p class="font-semibold mb-3 text-gray-700">Key Features:</p>
                <ul class="space-y-2 text-sm">
                    <li>✓ No labels or correct answers provided</li>
                    <li>✓ AI finds hidden patterns on its own</li>
                    <li>✓ Groups similar things together</li>
                    <li>✓ "Find patterns" → AI discovers structure</li>
                </ul>
            </div>
        </div>
    </div>
    
    <!-- Scenario Quiz -->
    <div class="bg-gray-50 p-6 rounded-lg">
        <h3 class="font-bold text-lg mb-4 text-center">🎯 Classification Challenge: 10 Scenarios</h3>
        <p class="text-sm text-gray-600 mb-6 text-center">Read each scenario carefully and decide: Supervised or Unsupervised?</p>
        
        <div id="scenarioContainer" class="space-y-4">
            <!-- Scenarios will be loaded here -->
        </div>
        
        <div id="quizComplete" class="hidden mt-6 bg-gradient-to-r from-green-100 to-blue-100 p-6 rounded-lg text-center">
            <h4 class="text-2xl font-bold text-green-700 mb-2">🎉 Excellent Work!</h4>
            <p class="text-lg mb-4">You scored <span id="finalScore" class="font-bold">0</span>/10!</p>
            <button onclick="revealRealExamples()" class="bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-3 rounded-lg hover:from-purple-600 hover:to-pink-600 transition-all font-bold">
                🌟 Unlock Real-World Examples
            </button>
        </div>
    </div>
    
    <!-- Real World Examples (Hidden Initially) -->
    <div id="realWorldExamples" class="hidden mt-6">
        <div class="bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-lg">
            <h3 class="font-bold text-xl text-orange-700 mb-4">🌍 Real-World Applications You Use Every Day!</h3>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-white p-4 rounded-lg shadow">
                    <h4 class="font-bold text-blue-600 mb-3">📚 Supervised Learning in Action</h4>
                    <div class="space-y-3">
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">📧</span>
                            <div>
                                <p class="font-semibold">Gmail Spam Filter</p>
                                <p class="text-sm text-gray-600">Trained on millions of emails labeled "spam" or "not spam"</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">📱</span>
                            <div>
                                <p class="font-semibold">Face ID / Face Unlock</p>
                                <p class="text-sm text-gray-600">Learns from photos labeled "you" vs "not you"</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">🎤</span>
                            <div>
                                <p class="font-semibold">Siri / Alexa</p>
                                <p class="text-sm text-gray-600">Trained on voice recordings with text transcriptions</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">🏥</span>
                            <div>
                                <p class="font-semibold">Medical Diagnosis AI</p>
                                <p class="text-sm text-gray-600">Learns from X-rays labeled by doctors</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-4 rounded-lg shadow">
                    <h4 class="font-bold text-purple-600 mb-3">🔍 Unsupervised Learning in Action</h4>
                    <div class="space-y-3">
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">🎵</span>
                            <div>
                                <p class="font-semibold">Spotify Discover Weekly</p>
                                <p class="text-sm text-gray-600">Groups songs by patterns without genre labels</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">🛒</span>
                            <div>
                                <p class="font-semibold">Amazon "Customers Also Bought"</p>
                                <p class="text-sm text-gray-600">Finds shopping patterns without being told</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">💳</span>
                            <div>
                                <p class="font-semibold">Credit Card Fraud Detection</p>
                                <p class="text-sm text-gray-600">Spots unusual patterns in spending</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <span class="text-2xl">🎬</span>
                            <div>
                                <p class="font-semibold">Netflix Categories</p>
                                <p class="text-sm text-gray-600">Creates viewing groups beyond basic genres</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 bg-yellow-100 p-4 rounded-lg">
                <p class="text-sm text-gray-700"><strong>🤯 Mind-blowing fact:</strong> Most AI systems you interact with daily use BOTH types! Instagram uses supervised learning to detect faces in photos, then unsupervised learning to group similar photos for your Explore page!</p>
            </div>
        </div>
    </div>
</section>

        <!-- Checkpoint Quiz 3 -->
        <section class="checkpoint-quiz mb-6">
            <h3 class="text-xl font-bold text-white mb-4">🎯 Checkpoint Quiz: Types of Learning</h3>
            <div id="quiz3" class="bg-white rounded-lg p-4">
                <p class="font-semibold mb-3">A shopping app groups customers based on their buying habits without being told what groups to create. What type of ML is this?</p>
                <div class="space-y-2">
                    <div class="quiz-option bg-gray-100 p-3 rounded-lg hover:bg-gray-200" onclick="checkQuizAnswer(3, 'a', false)">
                        A) Supervised Learning
                    </div>
                    <div class="quiz-option bg-gray-100 p-3 rounded-lg hover:bg-gray-200" onclick="checkQuizAnswer(3, 'b', true)">
                        B) Unsupervised Learning
                    </div>
                    <div class="quiz-option bg-gray-100 p-3 rounded-lg hover:bg-gray-200" onclick="checkQuizAnswer(3, 'c', false)">
                        C) No Learning
                    </div>
                </div>
                <div id="quiz3-feedback" class="mt-3 text-sm font-semibold"></div>
            </div>
        </section>

        <!-- Enhanced Neural Network Extension -->
<section class="bg-gradient-to-r from-indigo-100 to-purple-100 rounded-xl shadow-lg p-6 md:p-8 mb-6">
    <h2 class="text-2xl md:text-3xl font-bold text-indigo-700 mb-4">🧠 Extension: Interactive Neural Network Lab</h2>
    <p class="text-gray-700 mb-2">See how AI makes decisions by adjusting inputs and watching data flow through the network!</p>
    
    <!-- Instructions Banner -->
    <div class="bg-blue-50 border-2 border-blue-300 p-4 rounded-lg mb-6">
        <h3 class="font-bold text-blue-800 mb-2">📖 How to Use This Neural Network:</h3>
        <ol class="text-sm text-gray-700 space-y-1 list-decimal list-inside">
            <li><strong>Train First:</strong> Click the animal buttons below to teach the network (aim for 5+ each)</li>
            <li><strong>Test It:</strong> Adjust the sliders to describe an animal's features</li>
            <li><strong>Make Prediction:</strong> Click "Make Prediction" to see what the AI thinks</li>
            <li><strong>Watch & Learn:</strong> See how signals flow through the network!</li>
        </ol>
    </div>
    
    <div class="bg-white p-6 rounded-lg">
        <div class="max-w-6xl mx-auto">
            <!-- Main Grid Layout -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                
                <!-- Left Panel: Input Controls -->
                <div class="lg:col-span-1">
                    <div class="bg-gradient-to-br from-blue-50 to-indigo-50 p-4 rounded-lg">
                        <h3 class="font-bold text-indigo-700 mb-4">🎛️ Step 1: Describe an Animal</h3>
                        
                        <!-- Preset Examples -->
                        <div class="mb-4 p-3 bg-white rounded-lg">
                            <p class="text-xs font-semibold mb-2">Quick Examples:</p>
                            <div class="grid grid-cols-3 gap-2">
                                <button onclick="setPreset('cat')" class="preset-btn text-xs px-2 py-1 bg-blue-100 rounded hover:bg-blue-200">
                                    🐱 Cat
                                </button>
                                <button onclick="setPreset('dog')" class="preset-btn text-xs px-2 py-1 bg-green-100 rounded hover:bg-green-200">
                                    🐶 Dog
                                </button>
                                <button onclick="setPreset('bird')" class="preset-btn text-xs px-2 py-1 bg-orange-100 rounded hover:bg-orange-200">
                                    🐦 Bird
                                </button>
                            </div>
                        </div>
                        
                        <!-- Input Sliders -->
                        <div class="space-y-4">
                            <div>
                                <label class="flex justify-between text-sm font-semibold mb-2">
                                    <span>🐁 Size 🐘</span>
                                    <span id="sizeValue" class="text-indigo-600">50</span>
                                </label>
                                <input type="range" id="sizeSlider" min="0" max="100" value="50" 
                                       oninput="updateInput('size', this.value)" 
                                       class="w-full accent-indigo-600">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>Tiny (Mouse)</span>
                                    <span>Large (Elephant)</span>
                                </div>
                            </div>
                            
                            <div>
                                <label class="flex justify-between text-sm font-semibold mb-2">
                                    <span>🎨 Color Variety</span>
                                    <span id="colorValue" class="text-purple-600">50</span>
                                </label>
                                <input type="range" id="colorSlider" min="0" max="100" value="50" 
                                       oninput="updateInput('color', this.value)" 
                                       class="w-full accent-purple-600">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>One Color</span>
                                    <span>Many Colors</span>
                                </div>
                            </div>
                            
                            <div>
                                <label class="flex justify-between text-sm font-semibold mb-2">
                                    <span>🔊 Sound Pitch</span>
                                    <span id="soundValue" class="text-green-600">50</span>
                                </label>
                                <input type="range" id="soundSlider" min="0" max="100" value="50" 
                                       oninput="updateInput('sound', this.value)" 
                                       class="w-full accent-green-600">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>Low (Woof)</span>
                                    <span>High (Tweet)</span>
                                </div>
                            </div>
                        </div>
                        
                        <button onclick="runPrediction()" class="w-full mt-4 bg-gradient-to-r from-indigo-500 to-purple-500 text-white px-4 py-3 rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-all font-bold text-lg">
                            🔮 Make Prediction
                        </button>
                    </div>
                    
                    <!-- Connection Legend -->
                    <div class="mt-4 bg-yellow-50 p-4 rounded-lg">
                        <h4 class="font-bold text-yellow-800 mb-3">📊 What the Lines Mean:</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex items-center gap-2">
                                <div class="w-12 h-3 bg-green-500 rounded"></div>
                                <span><strong>Thick Green:</strong> Strong positive connection</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-12 h-1 bg-green-300 rounded"></div>
                                <span><strong>Thin Green:</strong> Weak positive connection</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <div class="w-12 h-1 bg-red-300 rounded border-b-2 border-dashed border-red-500"></div>
                                <span><strong>Red Dashed:</strong> Negative connection</span>
                            </div>
                        </div>
                        <p class="text-xs text-gray-600 mt-3">💡 The network learns by adjusting these connection strengths!</p>
                    </div>
                </div>
                
                <!-- Center Panel: Neural Network Visualization -->
                <div class="lg:col-span-2">
                    <!-- What's Happening Display -->
                    <div id="whatsHappening" class="bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-lg mb-4">
                        <h4 class="font-bold text-purple-700 mb-2">🔍 What's Happening:</h4>
                        <p id="happeningText" class="text-sm text-gray-700">
                            Train the network first by clicking the animal buttons below. The network needs examples to learn from!
                        </p>
                    </div>
                    
                    <div id="networkContainer" class="bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-lg">
                        <canvas id="neuralCanvas" width="600" height="400" class="w-full rounded bg-white"></canvas>
                    </div>
                    
                    <!-- LARGE Prediction Display -->
                    <div id="predictionDisplay" class="mt-4 bg-gradient-to-r from-green-400 to-blue-500 p-6 rounded-lg text-white text-center hidden">
                        <h3 class="text-lg font-bold mb-2">🎯 AI PREDICTION:</h3>
                        <div id="mainPrediction" class="text-4xl font-bold mb-2">
                            <!-- Prediction will appear here -->
                        </div>
                        <div id="confidenceDisplay" class="text-lg">
                            <!-- Confidence will appear here -->
                        </div>
                    </div>
                    
                    <!-- Detailed Results -->
                    <div id="detailedResults" class="mt-4 bg-white p-4 rounded-lg hidden">
                        <h4 class="font-semibold mb-3">📊 Detailed Analysis:</h4>
                        <div class="space-y-2">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">🐱</span>
                                <div class="flex-1">
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Cat</span>
                                        <span id="catPercent">0%</span>
                                    </div>
                                    <div class="bg-gray-200 rounded-full h-4">
                                        <div id="catBar" class="bg-blue-500 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">🐶</span>
                                <div class="flex-1">
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Dog</span>
                                        <span id="dogPercent">0%</span>
                                    </div>
                                    <div class="bg-gray-200 rounded-full h-4">
                                        <div id="dogBar" class="bg-green-500 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">🐦</span>
                                <div class="flex-1">
                                    <div class="flex justify-between text-sm mb-1">
                                        <span>Bird</span>
                                        <span id="birdPercent">0%</span>
                                    </div>
                                    <div class="bg-gray-200 rounded-full h-4">
                                        <div id="birdBar" class="bg-orange-500 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Training Section -->
            <div class="mt-6 bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-lg">
                <h3 class="font-bold text-orange-700 mb-2">🎯 Step 2: Train Your Network</h3>
                <p class="text-sm text-gray-700 mb-4">Click each animal multiple times to teach the network. Watch the connections change color!</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Training Controls -->
                    <div>
                        <div class="grid grid-cols-3 gap-3">
                            <div class="text-center">
                                <button onclick="trainNetwork('cat')" class="training-btn w-full bg-blue-100 hover:bg-blue-200 p-4 rounded-lg transition-all">
                                    <span class="text-3xl block">🐱</span>
                                    <span class="text-sm font-semibold">Train Cat</span>
                                </button>
                                <div class="mt-2 text-xs">
                                    <span class="font-bold">Typical:</span><br>
                                    Small, One color, High pitch
                                </div>
                            </div>
                            <div class="text-center">
                                <button onclick="trainNetwork('dog')" class="training-btn w-full bg-green-100 hover:bg-green-200 p-4 rounded-lg transition-all">
                                    <span class="text-3xl block">🐶</span>
                                    <span class="text-sm font-semibold">Train Dog</span>
                                </button>
                                <div class="mt-2 text-xs">
                                    <span class="font-bold">Typical:</span><br>
                                    Large, Mixed colors, Low pitch
                                </div>
                            </div>
                            <div class="text-center">
                                <button onclick="trainNetwork('bird')" class="training-btn w-full bg-orange-100 hover:bg-orange-200 p-4 rounded-lg transition-all">
                                    <span class="text-3xl block">🐦</span>
                                    <span class="text-sm font-semibold">Train Bird</span>
                                </button>
                                <div class="mt-2 text-xs">
                                    <span class="font-bold">Typical:</span><br>
                                    Tiny, Colorful, Very high pitch
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4 flex gap-3">
                            <button onclick="resetNetwork()" class="flex-1 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-all">
                                🔄 Reset Network
                            </button>
                            <button onclick="autoTrain()" class="flex-1 bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 transition-all">
                                ⚡ Quick Train All
                            </button>
                        </div>
                    </div>
                    
                    <!-- Training Stats -->
                    <div>
                        <div class="bg-white p-4 rounded-lg">
                            <h4 class="font-semibold mb-3">Training Progress</h4>
                            
                            <!-- Training counts with visual bars -->
                            <div class="space-y-3">
                                <div>
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="flex items-center gap-2">
                                            <span>🐱 Cat</span>
                                        </span>
                                        <span id="catTrainCount" class="font-bold">0</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-3">
                                        <div id="catTrainBar" class="bg-blue-500 h-full rounded-full transition-all" style="width: 0%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="flex items-center gap-2">
                                            <span>🐶 Dog</span>
                                        </span>
                                        <span id="dogTrainCount" class="font-bold">0</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-3">
                                        <div id="dogTrainBar" class="bg-green-500 h-full rounded-full transition-all" style="width: 0%"></div>
                                    </div>
                                </div>
                                <div>
                                    <div class="flex justify-between items-center mb-1">
                                        <span class="flex items-center gap-2">
                                            <span>🐦 Bird</span>
                                        </span>
                                        <span id="birdTrainCount" class="font-bold">0</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-3">
                                        <div id="birdTrainBar" class="bg-orange-500 h-full rounded-full transition-all" style="width: 0%"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Network Status -->
                            <div id="networkHealth" class="mt-4 p-3 bg-gray-50 rounded">
                                <p class="text-sm font-semibold mb-1">Network Status:</p>
                                <p id="healthStatus" class="text-sm text-green-600">Ready to learn! Click animals above to train.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Understanding Section -->
            <div class="mt-6 bg-gradient-to-r from-purple-50 to-pink-50 p-6 rounded-lg">
                <h3 class="font-bold text-purple-700 mb-4">💡 Understanding Neural Networks</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold mb-2">How It Works:</h4>
                        <ol class="text-sm text-gray-700 space-y-1 list-decimal list-inside">
                            <li><strong>Input Layer:</strong> Takes in features (size, color, sound)</li>
                            <li><strong>Hidden Layer:</strong> Finds patterns in the features</li>
                            <li><strong>Output Layer:</strong> Makes the final prediction</li>
                            <li><strong>Learning:</strong> Adjusts connection strengths to reduce errors</li>
                        </ol>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-2">Try This Experiment:</h4>
                        <ul class="text-sm text-gray-700 space-y-1 list-disc list-inside">
                            <li>Train only cats (20 times) - what happens?</li>
                            <li>Test with dog features - what does it predict?</li>
                            <li>This shows <strong>overfitting</strong> - too much of one type!</li>
                            <li>Balance training for best results</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Fun Challenge -->
                <div class="mt-4 bg-yellow-100 p-4 rounded-lg">
                    <h4 class="font-bold text-yellow-800 mb-2">🏆 Challenge: Create a Hybrid!</h4>
                    <p class="text-sm text-gray-700">Can you adjust the sliders to make the network confused? Try features that are between two animals!</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- ML in Your Life Section -->
<section class="bg-gradient-to-r from-teal-50 to-cyan-50 rounded-xl shadow-lg p-6 md:p-8 mb-6">
    <h2 class="text-2xl md:text-3xl font-bold text-teal-700 mb-4">📱 ML in Your Daily Life</h2>
    <p class="text-gray-700 mb-6">You use machine learning every day without realizing it! Let's explore how.</p>
    
    <!-- Interactive Daily Timeline -->
    <div class="bg-white p-6 rounded-lg mb-6">
        <h3 class="font-bold text-lg mb-4">🌅 Your ML-Powered Day</h3>
        <div class="relative">
            <!-- Timeline -->
            <div class="absolute left-8 top-0 bottom-0 w-1 bg-gradient-to-b from-yellow-400 via-blue-400 to-purple-400"></div>
            
            <div class="space-y-6">
                <div class="flex gap-4 items-start">
                    <div class="bg-yellow-400 w-16 h-16 rounded-full flex items-center justify-center text-2xl flex-shrink-0">☀️</div>
                    <div class="bg-yellow-50 p-4 rounded-lg flex-1">
                        <h4 class="font-bold">7:00 AM - Wake Up</h4>
                        <p class="text-sm text-gray-600">Phone's face unlock uses <strong>supervised learning</strong> trained on your face photos</p>
                        <button onclick="showMLExample('faceunlock')" class="text-xs text-blue-600 hover:underline mt-1">See how it works →</button>
                    </div>
                </div>
                
                <div class="flex gap-4 items-start">
                    <div class="bg-blue-400 w-16 h-16 rounded-full flex items-center justify-center text-2xl flex-shrink-0">📧</div>
                    <div class="bg-blue-50 p-4 rounded-lg flex-1">
                        <h4 class="font-bold">8:00 AM - Check Email</h4>
                        <p class="text-sm text-gray-600">Gmail filters spam using ML trained on millions of spam examples</p>
                        <button onclick="showMLExample('spam')" class="text-xs text-blue-600 hover:underline mt-1">See how it works →</button>
                    </div>
                </div>
                
                <div class="flex gap-4 items-start">
                    <div class="bg-green-400 w-16 h-16 rounded-full flex items-center justify-center text-2xl flex-shrink-0">🎵</div>
                    <div class="bg-green-50 p-4 rounded-lg flex-1">
                        <h4 class="font-bold">3:00 PM - Listen to Music</h4>
                        <p class="text-sm text-gray-600">Spotify uses <strong>unsupervised learning</strong> to group similar songs</p>
                        <button onclick="showMLExample('spotify')" class="text-xs text-blue-600 hover:underline mt-1">See how it works →</button>
                    </div>
                </div>
                
                <div class="flex gap-4 items-start">
                    <div class="bg-purple-400 w-16 h-16 rounded-full flex items-center justify-center text-2xl flex-shrink-0">🎮</div>
                    <div class="bg-purple-50 p-4 rounded-lg flex-1">
                        <h4 class="font-bold">7:00 PM - Gaming</h4>
                        <p class="text-sm text-gray-600">Game AI opponents use neural networks to adapt to your play style</p>
                        <button onclick="showMLExample('gaming')" class="text-xs text-blue-600 hover:underline mt-1">See how it works →</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ML Example Details -->
    <div id="mlExampleDetails" class="hidden bg-white p-6 rounded-lg border-2 border-blue-300">
        <!-- Details will appear here -->
    </div>
</section>

<!-- Design Your Own ML Section -->
<section class="bg-gradient-to-r from-pink-50 to-purple-50 rounded-xl shadow-lg p-6 md:p-8 mb-6">
    <h2 class="text-2xl md:text-3xl font-bold text-purple-700 mb-4">💡 Design Your Own ML App!</h2>
    <p class="text-gray-700 mb-6">Now that you understand ML, design an app that could help your school or community!</p>
    
    <div class="bg-white p-6 rounded-lg">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Step 1 -->
            <div class="text-center">
                <div class="bg-purple-100 w-20 h-20 rounded-full flex items-center justify-center text-3xl mx-auto mb-4">1️⃣</div>
                <h3 class="font-bold mb-2">Choose a Problem</h3>
                <select id="mlProblem" class="w-full p-2 border rounded text-sm" onchange="updateDesign()">
                    <option value="">Select a problem...</option>
                    <option value="litter">Detecting litter in school</option>
                    <option value="mood">Student mood tracker</option>
                    <option value="homework">Homework helper</option>
                    <option value="sports">Sports performance analyzer</option>
                    <option value="custom">Your own idea!</option>
                </select>
            </div>
            
            <!-- Step 2 -->
            <div class="text-center">
                <div class="bg-purple-100 w-20 h-20 rounded-full flex items-center justify-center text-3xl mx-auto mb-4">2️⃣</div>
                <h3 class="font-bold mb-2">Choose ML Type</h3>
                <div class="space-y-2">
                    <label class="block">
                        <input type="radio" name="mlType" value="supervised" onchange="updateDesign()">
                        <span class="text-sm">Supervised (with labels)</span>
                    </label>
                    <label class="block">
                        <input type="radio" name="mlType" value="unsupervised" onchange="updateDesign()">
                        <span class="text-sm">Unsupervised (find patterns)</span>
                    </label>
                </div>
            </div>
            
            <!-- Step 3 -->
            <div class="text-center">
                <div class="bg-purple-100 w-20 h-20 rounded-full flex items-center justify-center text-3xl mx-auto mb-4">3️⃣</div>
                <h3 class="font-bold mb-2">Plan Your Data</h3>
                <textarea id="dataplan" class="w-full p-2 border rounded text-sm" rows="4" placeholder="What data would you need?" onchange="updateDesign()"></textarea>
            </div>
        </div>
        
        <!-- Your Design -->
        <div id="yourDesign" class="mt-6 p-4 bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg hidden">
            <h4 class="font-bold text-lg mb-2">🎉 Your ML App Design:</h4>
            <div id="designSummary"></div>
            <button onclick="shareDesign()" class="mt-3 bg-purple-500 text-white px-4 py-2 rounded hover:bg-purple-600 transition-all">
                Share Your Idea! 📤
            </button>
        </div>
    </div>
</section>
<!-- Lesson Summary Dashboard -->
<section class="bg-gradient-to-r from-gray-100 to-gray-200 rounded-xl shadow-lg p-6 md:p-8 mb-6">
    <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">📊 Your ML Learning Journey</h2>
    
    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
        <div class="bg-white p-4 rounded-lg text-center">
            <div class="text-3xl mb-2">🧠</div>
            <p class="text-2xl font-bold" id="conceptsLearned">0</p>
            <p class="text-sm text-gray-600">Concepts Mastered</p>
        </div>
        <div class="bg-white p-4 rounded-lg text-center">
            <div class="text-3xl mb-2">🎯</div>
            <p class="text-2xl font-bold" id="tasksCompleted">0</p>
            <p class="text-sm text-gray-600">Tasks Completed</p>
        </div>
        <div class="bg-white p-4 rounded-lg text-center">
            <div class="text-3xl mb-2">⭐</div>
            <p class="text-2xl font-bold" id="totalXP">0</p>
            <p class="text-sm text-gray-600">Total XP Earned</p>
        </div>
        <div class="bg-white p-4 rounded-lg text-center">
            <div class="text-3xl mb-2">⏱️</div>
            <p class="text-2xl font-bold" id="timeSpent">0m</p>
            <p class="text-sm text-gray-600">Time Learning</p>
        </div>
    </div>
    
    <!-- Key Takeaways -->
    <div class="bg-white p-6 rounded-lg">
        <h3 class="font-bold text-lg mb-4">🎓 Key Takeaways</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <h4 class="font-semibold text-purple-600 mb-2">You Learned:</h4>
                <ul class="space-y-1 text-sm">
                    <li class="flex items-center gap-2"><span class="text-green-500">✓</span> How supervised learning uses labeled data</li>
                    <li class="flex items-center gap-2"><span class="text-green-500">✓</span> How unsupervised learning finds patterns</li>
                    <li class="flex items-center gap-2"><span class="text-green-500">✓</span> Why data quality matters</li>
                    <li class="flex items-center gap-2"><span class="text-green-500">✓</span> How neural networks process information</li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold text-blue-600 mb-2">Next Steps:</h4>
                <ul class="space-y-1 text-sm">
                    <li class="flex items-center gap-2"><span class="text-blue-500">→</span> Try Python ML tutorials</li>
                    <li class="flex items-center gap-2"><span class="text-blue-500">→</span> Explore TensorFlow Playground</li>
                    <li class="flex items-center gap-2"><span class="text-blue-500">→</span> Join your school's coding club</li>
                    <li class="flex items-center gap-2"><span class="text-blue-500">→</span> Research ML careers</li>
                </ul>
            </div>
        </div>
    </div>
</section>

        <!-- Achievement Gallery -->
        <section class="bg-gradient-to-r from-yellow-100 to-orange-100 rounded-xl shadow-lg p-6 md:p-8 mb-6">
            <h2 class="text-2xl md:text-3xl font-bold text-orange-700 mb-4">🏆 Your ML Achievements</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div id="achieve-pattern" class="achievement-unlock bg-white p-4 rounded-lg text-center shadow opacity-50 transition-all">
                    <span class="text-3xl">🔍</span>
                    <p class="font-bold text-sm mt-2">Pattern Detective</p>
                    <p class="text-xs text-gray-600">Found all patterns</p>
                </div>
                <div id="achieve-trainer" class="achievement-unlock bg-white p-4 rounded-lg text-center shadow opacity-50 transition-all">
                    <span class="text-3xl">🎯</span>
                    <p class="font-bold text-sm mt-2">AI Trainer</p>
                    <p class="text-xs text-gray-600">Trained a classifier</p>
                </div>
                <div id="achieve-pipeline" class="achievement-unlock bg-white p-4 rounded-lg text-center shadow opacity-50 transition-all">
                    <span class="text-3xl">🔧</span>
                    <p class="font-bold text-sm mt-2">Pipeline Master</p>
                    <p class="text-xs text-gray-600">Built ML workflow</p>
                </div>
                <div id="achieve-neural" class="achievement-unlock bg-white p-4 rounded-lg text-center shadow opacity-50 transition-all">
                    <span class="text-3xl">🧠</span>
                    <p class="font-bold text-sm mt-2">Neural Explorer</p>
                    <p class="text-xs text-gray-600">Trained neural network</p>
                </div>

                <div id="achieve-deep-thinker" class="achievement-unlock bg-white p-4 rounded-lg text-center shadow opacity-50 transition-all">
    <span class="text-3xl">🤔</span>
    <p class="font-bold text-sm mt-2">Deep Thinker</p>
    <p class="text-xs text-gray-600">Reflected on ML concepts</p>
</div>
            </div>
        </section>
    </div>

    <!-- Sound Toggle Button -->
    <div class="sound-toggle" onclick="toggleSound()" id="soundToggle">
        <span id="soundIcon">🔊</span>
    </div>

    <script>
        // Initialize everything when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing...');
            
            // Disable copy/paste and context menu
            ['copy', 'cut', 'paste'].forEach(event => {
                document.addEventListener(event, function(e) {
                    e.preventDefault();
                    return false;
                });
            });
            
            document.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                return false;
            });
            
            document.addEventListener('keydown', function(e) {
                if ((e.ctrlKey || e.metaKey) && [65, 67, 86, 88].includes(e.keyCode)) {
                    e.preventDefault();
                    return false;
                }
            });
            
            // Initialize drag and drop with error handling
            try {
                initializeDragAndDrop();
                console.log('Drag and drop initialized successfully');
            } catch (error) {
                console.error('Error initializing drag and drop:', error);
            }
            
            // Initialize audio context on first user interaction
            document.body.addEventListener('click', function() {
                initAudio();
            }, { once: true });
            
            // Initialize training chart
            initializeTrainingChart();
        });

        // Global state
        let totalXP = 0;
let achievements = {
    pattern: false,
    trainer: false,
    pipeline: false,
    neural: false,
    'deep-thinker': false  // Add this
};

        // Pattern detection state
        let patternsFound = 0;

        // Quiz state
        let quizTotal = 0;
        let quizCorrect = 0;

        // Classifier state
        let classifierData = {
            cat: 0,
            dog: 0,
            bird: 0,
            correctPredictions: 0,
            totalTests: 0
        };

        // Neural network state
        let neuralData = {
            cat: 0,
            dog: 0,
            bird: 0
        };

        // Sound state
        let soundEnabled = true;

        // Hint state
        let hintCounts = {};

        // Training graph data
        let trainingHistory = [];
        let trainingChart = null;

        // Initialize training chart
        function initializeTrainingChart() {
    const ctx = document.getElementById('trainingChart');
    if (!ctx) return;
    
    trainingChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [],
            datasets: [{
                label: 'Training Quality %',
                data: [],
                borderColor: 'rgb(99, 102, 241)',
                backgroundColor: 'rgba(99, 102, 241, 0.1)',
                tension: 0.4
            }, {
                label: 'Balance %',
                data: [],
                borderColor: 'rgb(168, 85, 247)',
                backgroundColor: 'rgba(168, 85, 247, 0.1)',
                tension: 0.4
            }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    }
                }
            });
        }

        // Sound effects using Web Audio API
        let audioContext = null;

        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
        }

        function playSound(type) {
            if (!soundEnabled || !audioContext) return;
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            switch(type) {
                case 'success':
                    oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime); // C5
                    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1); // E5
                    oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2); // G5
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.5);
                    break;
                    
                case 'error':
                    oscillator.frequency.setValueAtTime(220, audioContext.currentTime); // A3
                    oscillator.frequency.setValueAtTime(180, audioContext.currentTime + 0.15); // Lower
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.3);
                    break;
                    
                case 'achievement':
                    oscillator.frequency.setValueAtTime(440, audioContext.currentTime); // A4
                    oscillator.frequency.setValueAtTime(554.37, audioContext.currentTime + 0.1); // C#5
                    oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.2); // E5
                    oscillator.frequency.setValueAtTime(880, audioContext.currentTime + 0.3); // A5
                    gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.6);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.6);
                    break;
                    
                case 'click':
                    oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
                    gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.05);
                    oscillator.start(audioContext.currentTime);
                    oscillator.stop(audioContext.currentTime + 0.05);
                    break;
            }
        }

        function toggleSound() {
            soundEnabled = !soundEnabled;
            const icon = document.getElementById('soundIcon');
            const toggle = document.getElementById('soundToggle');
            
            if (soundEnabled) {
                icon.textContent = '🔊';
                toggle.classList.remove('muted');
                playSound('click');
            } else {
                icon.textContent = '🔇';
                toggle.classList.add('muted');
            }
        }

        // Hint system
        function showHint(elementId) {
            if (!hintCounts[elementId]) {
                hintCounts[elementId] = 0;
            }
            
            hintCounts[elementId]++;
            playSound('click');
            
            if (hintCounts[elementId] === 1) {
                const hint1 = document.getElementById(elementId + '-hint');
                if (hint1) {
                    hint1.classList.add('visible');
                }
            } else if (hintCounts[elementId] >= 2) {
                const hint2 = document.getElementById(elementId + '-hint2');
                if (hint2) {
                    hint2.classList.add('visible');
                }
            }
        }

        // Checkpoint quiz system
        function checkQuizAnswer(quizNum, option, isCorrect) {
            const options = document.querySelectorAll(`#quiz${quizNum} .quiz-option`);
            const feedback = document.getElementById(`quiz${quizNum}-feedback`);
            
            // Disable all options
            options.forEach(opt => {
                opt.onclick = null;
                opt.style.cursor = 'default';
            });
            
            // Mark the selected option
            if (isCorrect) {
                event.target.classList.add('correct');
                feedback.innerHTML = '<span class="text-green-600">✅ Correct! Well done!</span>';
                playSound('success');
                addXP(20);
            } else {
                event.target.classList.add('incorrect');
                let correctAnswer = '';
                if (quizNum === 1) correctAnswer = 'B - AI finds patterns by looking at many examples!';
                else if (quizNum === 2) correctAnswer = 'C - Diverse examples from different contexts make the best training data!';
                else if (quizNum === 3) correctAnswer = 'B - Unsupervised learning finds patterns without labels!';
                
                feedback.innerHTML = `<span class="text-red-600">❌ Not quite. The correct answer is ${correctAnswer}</span>`;
                playSound('error');
            }
        }

        // Update training graph
        function updateTrainingGraph(accuracy, confidence) {
            if (!trainingChart) return;
            
            const sessionNum = trainingHistory.length + 1;
            trainingHistory.push({ session: sessionNum, accuracy, confidence });
            
            trainingChart.data.labels.push(`Session ${sessionNum}`);
            trainingChart.data.datasets[0].data.push(accuracy);
            trainingChart.data.datasets[1].data.push(confidence);
            
            // Keep only last 10 sessions for clarity
            if (trainingChart.data.labels.length > 10) {
                trainingChart.data.labels.shift();
                trainingChart.data.datasets[0].data.shift();
                trainingChart.data.datasets[1].data.shift();
            }
            
            trainingChart.update();
            
            // Update statistics
            document.getElementById('sessionCount').textContent = sessionNum;
            const bestAccuracy = Math.max(...trainingHistory.map(h => h.accuracy));
            document.getElementById('bestAccuracy').textContent = bestAccuracy + '%';
        }

        // XP and Achievement System
        function addXP(points) {
            totalXP += points;
            document.getElementById('xpPoints').textContent = totalXP;
            const xpBar = document.getElementById('xpBar');
            const percentage = Math.min((totalXP / 600) * 100, 100);
            xpBar.style.width = percentage + '%';
            
            // Level progression
            const levelText = document.getElementById('levelText');
            if (totalXP >= 150 && totalXP < 300) {
                levelText.textContent = 'Level 2 ML Developer';
            } else if (totalXP >= 300 && totalXP < 450) {
                levelText.textContent = 'Level 3 ML Engineer';
            } else if (totalXP >= 450) {
                levelText.textContent = 'Level 4 ML Master';
            }
            
            // Play a subtle sound for XP gain
            playSound('click');
        }

        function unlockAchievement(name) {
            if (!achievements[name]) {
                achievements[name] = true;
                const achieveElement = document.getElementById(`achieve-${name}`);
                if (achieveElement) {
                    achieveElement.classList.remove('opacity-50');
                    achieveElement.style.transform = 'scale(1.1)';
                    setTimeout(() => {
                        achieveElement.style.transform = 'scale(1)';
                    }, 300);
                    addXP(50);
                    playSound('achievement');
                    
                    // Show notification
                    showNotification(`🏆 Achievement Unlocked: ${name.charAt(0).toUpperCase() + name.slice(1)}!`);
                }
            }
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-4 right-4 bg-yellow-500 text-white px-4 py-2 rounded-lg shadow-lg z-50 transition-all';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }

        // Add global error handler
        window.addEventListener('error', function(e) {
            console.error('Global error caught:', e.error);
            console.error('Error details:', e.filename, e.lineno, e.colno);
            return false;
        });

        // Pattern Recognition
        function checkPattern(num, answer) {
            const feedback = document.getElementById(`pattern${num}-feedback`);
            if (!feedback) return;
            
            let userAnswer;
            let correct;
            
            if (num === 2) {
                // Pattern 2 uses buttons, not input field
                userAnswer = answer;
                correct = (answer === 'blue'); // The correct answer is blue
            } else {
                // Patterns 1 and 3 use input fields
                const input = document.getElementById(`pattern${num}`);
                if (!input) return;
                userAnswer = parseInt(input.value);
                correct = (userAnswer === answer);
            }
            
            if (correct) {
                feedback.innerHTML = '<span class="text-green-600 font-bold">✅ Correct! You found the pattern!</span>';
                // Only try to style input if it exists (patterns 1 and 3)
                if (num !== 2) {
                    const input = document.getElementById(`pattern${num}`);
                    if (input) input.style.borderColor = '#10b981';
                }
                playSound('success');
                addXP(25);
                patternsFound++;
                
                if (patternsFound === 3) {
                    unlockAchievement('pattern');
                }
            } else {
                feedback.innerHTML = '<span class="text-red-600 font-bold">❌ Try again! Look for the pattern...</span>';
                // Only try to style input if it exists (patterns 1 and 3)
                if (num !== 2) {
                    const input = document.getElementById(`pattern${num}`);
                    if (input) input.style.borderColor = '#ef4444';
                }
                playSound('error');
            }
        }

        // AI Classifier Training
// Update the trainClassifier function to add null checks
function trainClassifier(animal, emoji) {
    classifierData[animal]++;
    const countElement = document.getElementById(`${animal}Count`);
    const totalElement = document.getElementById('totalExamples');
    
    if (countElement) countElement.textContent = classifierData[animal];
    
    const total = classifierData.cat + classifierData.dog + classifierData.bird;
    if (totalElement) totalElement.textContent = total;
    
    // Update progress bars with null checks
    const maxExamples = 10; // Max for visual progress
    const catProgress = Math.min((classifierData.cat / maxExamples) * 100, 100);
    const dogProgress = Math.min((classifierData.dog / maxExamples) * 100, 100);
    const birdProgress = Math.min((classifierData.bird / maxExamples) * 100, 100);
    
    // Add null checks before accessing style property
    const catProgressElement = document.getElementById('catProgress');
    const dogProgressElement = document.getElementById('dogProgress');
    const birdProgressElement = document.getElementById('birdProgress');
    
    if (catProgressElement) catProgressElement.style.width = catProgress + '%';
    if (dogProgressElement) dogProgressElement.style.width = dogProgress + '%';
    if (birdProgressElement) birdProgressElement.style.width = birdProgress + '%';
    
    // Show visual training example
    showTrainingExample(animal, emoji);
    
    // Show training animation
    const aiSystem = document.getElementById('aiSystem');
    if (aiSystem) {
        aiSystem.classList.add('learning');
        setTimeout(() => aiSystem.classList.remove('learning'), 500);
    }
    
    // Update prediction and confidence
    updateClassifierDisplay();
    
    addXP(10);
    
    if (total >= 15) {
        unlockAchievement('trainer');
    }
}
        
        // Show visual training example flowing to AI
        // Update the showTrainingExample function
// Alternative version that accumulates animals
function showTrainingExample(animal, emoji) {
    const feed = document.getElementById('trainingFeed');
    if (!feed) return;
    
    // Clear placeholder text if first example
    const placeholder = feed.querySelector('.text-gray-400');
    if (placeholder) placeholder.remove();
    
    // Limit the number of visible examples
    const existingExamples = feed.querySelectorAll('.training-example-icon');
    if (existingExamples.length >= 5) {
        existingExamples[0].remove();
    }
    
    // Add variety to the examples shown
    const variations = {
        cat: ['🐱', '🐈', '😺', '🐈‍⬛'],
        dog: ['🐶', '🐕', '🦮', '🐕‍🦺'],
        bird: ['🐦', '🦅', '🦜', '🦆']
    };
    
    const randomEmoji = variations[animal][Math.floor(Math.random() * variations[animal].length)];
    
    // Create new example
    const example = document.createElement('span');
    example.className = 'training-example-icon text-4xl inline-block mx-2 animate-bounce';
    example.textContent = randomEmoji;
    
    feed.appendChild(example);
    
    // Remove bounce after animation
    setTimeout(() => {
        example.classList.remove('animate-bounce');
    }, 1000);
    
    // Show learning message
    const messages = {
        cat: 'Learning: small, meows, has whiskers...',
        dog: 'Learning: barks, wags tail, loyal...',
        bird: 'Learning: flies, has wings, chirps...'
    };
    
    showLearningMessage(messages[animal]);
}
        
        // Show what the AI is learning
        function showLearningMessage(message) {
            const aiSystem = document.getElementById('aiSystem');
            if (!aiSystem) return;
            
            // Create or update learning message
            let learningMsg = document.getElementById('learningMessage');
            if (!learningMsg) {
                learningMsg = document.createElement('div');
                learningMsg.id = 'learningMessage';
                learningMsg.className = 'absolute top-0 left-1/2 transform -translate-x-1/2 bg-purple-600 text-white px-3 py-1 rounded-full text-xs';
                aiSystem.parentElement.appendChild(learningMsg);
            }
            
            learningMsg.textContent = message;
            learningMsg.style.opacity = '1';
            
            setTimeout(() => {
                learningMsg.style.opacity = '0';
            }, 2000);
        }

        // Update the updateClassifierDisplay function
function updateClassifierDisplay() {
    const total = classifierData.cat + classifierData.dog + classifierData.bird;
    
    if (total === 0) return;
    
    // Define animals array at the beginning
    const animals = ['cat', 'dog', 'bird'];
    
    // Update knowledge base display
    const knowledgeBase = document.getElementById('knowledgeBase');
    if (knowledgeBase) {
        let knowledgeHTML = '<div class="space-y-2">';
        
        animals.forEach(animal => {
            const count = classifierData[animal];
            if (count > 0) {
                const emoji = animal === 'cat' ? '🐱' : animal === 'dog' ? '🐶' : '🐦';
                const percentage = Math.round((count / total) * 100);
                const features = {
                    cat: 'meows, whiskers, climbs',
                    dog: 'barks, tail wags, loyal',
                    bird: 'flies, wings, chirps'
                };
                
                knowledgeHTML += `
                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded">
                        <span class="flex items-center gap-2">
                            <span class="text-xl">${emoji}</span>
                            <span class="text-sm font-medium">${animal}</span>
                        </span>
                        <span class="text-xs text-gray-600">${count} patterns (${percentage}%)</span>
                    </div>
                `;
            }
        });
        
        knowledgeHTML += '</div>';
        knowledgeBase.innerHTML = knowledgeHTML;
    }
    
    // Calculate balance factor for accuracy
    const minCount = Math.min(classifierData.cat, classifierData.dog, classifierData.bird);
    const maxPossibleBalance = total / 3;
    const balanceFactor = minCount / maxPossibleBalance;
    
    // Calculate accuracy based on total examples and balance
    let accuracy = 0;
    if (total < 5) {
        accuracy = Math.round((total / 5) * 30);
    } else if (total < 10) {
        accuracy = 30 + Math.round(((total - 5) / 5) * 20 * balanceFactor);
    } else if (total < 15) {
        accuracy = 50 + Math.round(((total - 10) / 5) * 20 * balanceFactor);
    } else {
        accuracy = 70 + Math.round(30 * balanceFactor);
    }
    
    accuracy = Math.min(accuracy, 100);
    
    // Update accuracy display (this represents training quality, not prediction accuracy)
    const accuracyBarElement = document.getElementById('accuracyBar');
    const accuracyTextElement = document.getElementById('accuracyText');
    const accuracyDescElement = document.getElementById('accuracyDescription');
    const accuracyFormula = document.getElementById('accuracyFormula');
    
    if (accuracyBarElement) accuracyBarElement.style.width = accuracy + '%';
    if (accuracyTextElement) accuracyTextElement.textContent = accuracy + '%';
    
    let description = 'Need more training data';
    if (accuracy >= 70) description = 'Excellent training quality!';
    else if (accuracy >= 50) description = 'Good progress, keep training!';
    else if (accuracy >= 30) description = 'Getting better, add more examples!';
    
    if (accuracyDescElement) accuracyDescElement.textContent = description;
    if (accuracyFormula) {
        const balancePercent = Math.round(balanceFactor * 100);
        accuracyFormula.textContent = `Quality = ${total} examples × ${balancePercent}% balance`;
    }
    
    // Update balance score
    const balanceScoreElement = document.getElementById('balanceScore');
    if (balanceScoreElement) {
        balanceScoreElement.textContent = Math.round(balanceFactor * 100) + '%';
    }
    
    // Update AI thinking process
    const aiThinking = document.getElementById('aiThinking');
    if (aiThinking) {
        let thinkingHTML = '<div class="space-y-1">';
        
        animals.forEach(animal => {
            const count = classifierData[animal];
            const emoji = animal === 'cat' ? '🐱' : animal === 'dog' ? '🐶' : '🐦';
            const features = {
                cat: 'small, meows, whiskers, climbs',
                dog: 'barks, loyal, wags tail, fetches',
                bird: 'flies, wings, chirps, nests'
            };
            
            if (count > 0) {
                const percentage = Math.round((count / total) * 100);
                thinkingHTML += `<p>${emoji} ${count} ${animal}s (${percentage}%) - ${features[animal]}</p>`;
            }
        });
        
        // Add balance warning if needed
        if (balanceFactor < 0.5 && total > 5) {
            thinkingHTML += '<p class="text-yellow-600 font-semibold mt-2">⚖️ Training is unbalanced - add more variety!</p>';
        } else if (total < 5) {
            thinkingHTML += '<p class="text-orange-600 font-semibold mt-2">⚠️ Need at least 5 examples to start learning!</p>';
        } else {
            thinkingHTML += '<p class="text-green-600 font-semibold mt-2">✅ Good training balance!</p>';
        }
        
        thinkingHTML += '</div>';
        aiThinking.innerHTML = thinkingHTML;
    }
    
    // Update training graph - now only shows training quality, not confidence
    updateTrainingGraph(accuracy, Math.round(balanceFactor * 100));
}

// Update the testClassifier function
function testClassifier(emoji, expectedAnimal) {
    const total = classifierData.cat + classifierData.dog + classifierData.bird;
    const testResultsElement = document.getElementById('testResults');
    const testProcess = document.getElementById('testProcess');
    const testSteps = document.getElementById('testSteps');
    
    if (!testResultsElement) return;
    
    if (total === 0) {
        testResultsElement.innerHTML = 
            '<div class="p-3 rounded bg-orange-100 text-orange-700 font-semibold">❌ Train the AI first before testing! Click the "Train +1" buttons above.</div>';
        return;
    }
    
    // Show the decision process
    if (testProcess) testProcess.classList.remove('hidden');
    
    // Simulate AI decision process step by step
    let stepsHTML = '';
    const steps = [];
    
    // Step 1: Receive input
    steps.push({
        text: `Step 1: Received test input: ${emoji} (${expectedAnimal})`,
        delay: 0
    });
    
    // Step 2: Compare to training data
    const comparisons = [];
    ['cat', 'dog', 'bird'].forEach(animal => {
        if (classifierData[animal] > 0) {
            const percentage = Math.round((classifierData[animal] / total) * 100);
            comparisons.push(`${animal}: ${classifierData[animal]} examples (${percentage}%)`);
        }
    });
    
    steps.push({
        text: `Step 2: Comparing to training data:\n${comparisons.join('\n')}`,
        delay: 500
    });
    
    // Step 3: Make prediction
    const animals = ['cat', 'dog', 'bird'];
    const predictions = animals.map(a => ({
        animal: a,
        score: classifierData[a] / total + (Math.random() * 0.1 - 0.05) // Add small random factor
    }));
    predictions.sort((a, b) => b.score - a.score);
    
    const bestPrediction = predictions[0];
    const confidence = Math.round(bestPrediction.score * 100);
    
    steps.push({
        text: `Step 3: Calculating probabilities...\nHighest match: ${bestPrediction.animal} (${confidence}% confident)`,
        delay: 1000
    });
    
    // Step 4: Final decision
    const isCorrect = bestPrediction.animal === expectedAnimal;
    classifierData.totalTests++;
    if (isCorrect) classifierData.correctPredictions++;
    
    steps.push({
        text: `Step 4: Prediction: ${bestPrediction.animal} ${isCorrect ? '✅' : '❌'}`,
        delay: 1500
    });
    
    // Animate the steps
    if (testSteps) {
        testSteps.innerHTML = '';
        steps.forEach((step, index) => {
            setTimeout(() => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'text-xs text-gray-600 p-2 bg-gray-50 rounded';
                stepDiv.style.whiteSpace = 'pre-line';
                stepDiv.textContent = step.text;
                testSteps.appendChild(stepDiv);
                
                // Show final result after all steps
                if (index === steps.length - 1) {
                    setTimeout(() => {
                        const accuracy = Math.round((classifierData.correctPredictions / classifierData.totalTests) * 100);
                        
                        testResultsElement.innerHTML = `
                            <div class="p-3 rounded ${isCorrect ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}">
                                <p class="font-semibold">${isCorrect ? '✅ Correct!' : '❌ Incorrect!'}</p>
                                <p>AI predicted: ${bestPrediction.animal} (${confidence}% confident)</p>
                                <p>Actual answer: ${expectedAnimal}</p>
                            </div>
                            <div class="text-xs text-gray-600 mt-2">
                                <p>Overall Test Accuracy: ${accuracy}% (${classifierData.correctPredictions}/${classifierData.totalTests} correct)</p>
                                ${!isCorrect ? '<p class="text-orange-600">Tip: Train more ' + expectedAnimal + ' examples to improve!</p>' : ''}
                            </div>`;
                        
                        playSound(isCorrect ? 'success' : 'error');
                        addXP(isCorrect ? 15 : 5);
                    }, 500);
                }
            }, step.delay);
        });
    }
}

        // Helper function for drag positioning
        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.draggable:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        // Drag and Drop System
        let draggedElement = null;

        function initializeDragAndDrop() {
            const draggables = document.querySelectorAll('.draggable');
            const dropZones = document.querySelectorAll('.drop-zone');

            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', function(e) {
                    draggedElement = this;
                    this.classList.add('dragging');
                    e.dataTransfer.effectAllowed = 'move';
                });

                draggable.addEventListener('dragend', function(e) {
                    this.classList.remove('dragging');
                    draggedElement = null;
                });
            });

            dropZones.forEach(zone => {
                zone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('drag-over');
                });

                zone.addEventListener('dragleave', function(e) {
                    this.classList.remove('drag-over');
                });

                zone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('drag-over');
                    
                    if (draggedElement) {
                        // Clear placeholder text
                        const placeholder = this.querySelector('.text-gray-400');
                        if (placeholder) {
                            this.innerHTML = '';
                        }
                        
                        this.appendChild(draggedElement);
                    }
                });
            });

            // Special handling for quality ranking with Sortable
            const qualityContainer = document.getElementById('qualityRanking');
            if (qualityContainer && typeof Sortable !== 'undefined') {
                new Sortable(qualityContainer, {
                    animation: 150,
                    ghostClass: 'opacity-50'
                });
            }
        }

        // Quality Ranking Check
        function checkQualityRanking() {
    console.log('Checking quality ranking...');
    
    try {
        const items = document.querySelectorAll('#qualityRanking .draggable');
        const feedback = document.getElementById('qualityFeedback');
        
        if (!items.length || !feedback) {
            console.error('Quality ranking elements not found');
            return;
        }
        
        const currentOrder = Array.from(items).map(item => item.dataset.quality);
        const correctOrder = ['best', 'good', 'decent', 'misleading', 'poor', 'terrible'];
        
        let score = 0;
        let partialScore = 0;
        
        items.forEach((item, index) => {
            const quality = item.dataset.quality;
            const correctRank = parseInt(item.dataset.rank);
            const currentRank = index + 1;
            
            if (quality === correctOrder[index]) {
                item.style.backgroundColor = '#dcfce7';
                item.style.borderColor = '#10b981';
                score++;
            } else if (Math.abs(currentRank - correctRank) <= 1) {
                // Partial credit for being close
                item.style.backgroundColor = '#fef3c7';
                item.style.borderColor = '#f59e0b';
                partialScore++;
            } else {
                item.style.backgroundColor = '#fee2e2';
                item.style.borderColor = '#ef4444';
            }
        });
        
        let feedbackHTML = '';
        
        if (score === 6) {
            feedbackHTML = '<span class="text-green-600 font-bold">🎉 Perfect! You understand data quality deeply!</span>';
            playSound('achievement');
            addXP(50);
        } else if (score >= 4) {
            feedbackHTML = `<span class="text-blue-600 font-bold">Very good! Score: ${score}/6 correct.</span>`;
            playSound('success');
            addXP(30);
        } else if (score + partialScore >= 4) {
            feedbackHTML = `<span class="text-yellow-600 font-bold">Getting there! ${score} correct, ${partialScore} close.</span>`;
            playSound('click');
            addXP(20);
        } else {
            feedbackHTML = `<span class="text-orange-600 font-bold">Keep trying! Score: ${score}/6.</span>`;
            playSound('error');
            addXP(10);
        }
        
        // Add explanation
        feedbackHTML += '<div class="mt-3 text-xs text-gray-600">';
        feedbackHTML += '<p><strong>Key insights:</strong></p>';
        feedbackHTML += '<ul class="list-disc list-inside mt-1 space-y-1">';
        
        if (currentOrder[0] !== 'best') {
            feedbackHTML += '<li>Dataset F is best: diverse ages, environments, and conditions = real-world ready!</li>';
        }
        if (currentOrder[5] !== 'terrible') {
            feedbackHTML += '<li>Dataset A is worst: only one breed in one setting = AI fails on anything else!</li>';
        }
        if (currentOrder.indexOf('misleading') < currentOrder.indexOf('good')) {
            feedbackHTML += '<li>Watch out: perfect studio photos (C) are less useful than messy real photos (E)!</li>';
        }
        if (currentOrder.indexOf('poor') < 3) {
            feedbackHTML += '<li>Dataset B is a trap: 10,000 images but 95% poodles = very imbalanced!</li>';
        }
        
        feedbackHTML += '</ul></div>';
        
        feedback.innerHTML = feedbackHTML;
        
        console.log(`Quality ranking check complete. Score: ${score}/6`);
    } catch (error) {
        console.error('Error in checkQualityRanking:', error);
    }
}
// Unsupervised Learning Variables
let currentDataset = 'animals';
let clusteringAnimationId = null;

const datasets = {
    animals: {
        items: ['🦁', '🐅', '🐆', '🦅', '🦉', '🦜', '🐟', '🐠', '🐡', '🦈', '🐢', '🦎'],
        expectedGroups: [
            { name: 'Big Cats', items: ['🦁', '🐅', '🐆'] },
            { name: 'Birds', items: ['🦅', '🦉', '🦜'] },
            { name: 'Fish', items: ['🐟', '🐠', '🐡', '🦈'] },
            { name: 'Reptiles', items: ['🐢', '🦎'] }
        ]
    },
    transport: {
        items: ['🚗', '🚕', '🚙', '✈️', '🛩️', '🚁', '🚢', '⛵', '🚤', '🚲', '🛴', '🛹'],
        expectedGroups: [
            { name: 'Cars', items: ['🚗', '🚕', '🚙'] },
            { name: 'Aircraft', items: ['✈️', '🛩️', '🚁'] },
            { name: 'Boats', items: ['🚢', '⛵', '🚤'] },
            { name: 'Personal', items: ['🚲', '🛴', '🛹'] }
        ]
    },
    weather: {
        items: ['☀️', '🌤️', '⛅', '☁️', '🌧️', '⛈️', '🌩️', '❄️', '🌨️', '🌪️', '🌈', '🌙'],
        expectedGroups: [
            { name: 'Sunny', items: ['☀️', '🌤️', '⛅'] },
            { name: 'Rainy', items: ['🌧️', '⛈️', '🌩️'] },
            { name: 'Cold', items: ['❄️', '🌨️'] },
            { name: 'Special', items: ['🌪️', '🌈', '🌙'] }
        ]
    }
};

// Initialize mystery box
function initializeMysteryBox() {
    const box = document.getElementById('mysteryBox');
    if (!box) return;
    
    box.innerHTML = '';
    const items = [...datasets[currentDataset].items];
    
    // Shuffle items
    for (let i = items.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [items[i], items[j]] = [items[j], items[i]];
    }
    
    items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'text-2xl p-2 bg-gray-100 rounded text-center';
        div.textContent = item;
        box.appendChild(div);
    });
}

// Start unsupervised learning animation
function startUnsupervisedLearning() {
    const steps = document.getElementById('clusteringSteps');
    const groups = document.getElementById('aiGroups');
    
    if (!steps || !groups) return;
    
    // Clear previous results
    steps.innerHTML = '';
    groups.innerHTML = '<p class="text-sm text-gray-600 text-center">🤖 AI is analyzing patterns...</p>';
    
    playSound('click');
    
    // Step 1: Analyzing
    setTimeout(() => {
        steps.innerHTML = '<div class="text-sm bg-blue-50 p-2 rounded">Step 1: Scanning all items for features...</div>';
    }, 500);
    
    // Step 2: Finding similarities
    setTimeout(() => {
        steps.innerHTML += '<div class="text-sm bg-purple-50 p-2 rounded mt-2">Step 2: Calculating similarities between items...</div>';
    }, 1500);
    
    // Step 3: Creating clusters
    setTimeout(() => {
        steps.innerHTML += '<div class="text-sm bg-green-50 p-2 rounded mt-2">Step 3: Grouping similar items together...</div>';
        
        // Show results
        const dataset = datasets[currentDataset];
        groups.innerHTML = '';
        
        // Sometimes show slightly different groupings to demonstrate AI variation
        const showVariation = Math.random() > 0.7;
        
        dataset.expectedGroups.forEach((group, index) => {
            const groupDiv = document.createElement('div');
            groupDiv.className = 'bg-gray-50 p-3 rounded';
            
            let groupName = showVariation && index === 0 ? 'Group A' : `Pattern ${index + 1}`;
            
            groupDiv.innerHTML = `
                <p class="text-sm font-semibold text-gray-700 mb-2">${groupName}:</p>
                <div class="flex flex-wrap gap-2">
                    ${group.items.map(item => `<span class="text-2xl">${item}</span>`).join('')}
                </div>
                <p class="text-xs text-gray-500 mt-1">AI found: ${group.name.toLowerCase()} pattern</p>
            `;
            groups.appendChild(groupDiv);
        });
        
        playSound('success');
        addXP(25);
        
        // Draw clustering visualization
        drawClusteringVisualization();
    }, 2500);
}



// Draw clustering visualization
function drawClusteringVisualization() {
    const canvas = document.getElementById('clusteringCanvas');
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    const width = canvas.width;
    const height = canvas.height;
    
    // Clear canvas
    ctx.clearRect(0, 0, width, height);
    
    // Draw cluster circles
    const dataset = datasets[currentDataset];
    const numClusters = dataset.expectedGroups.length;
    const centerX = width / 2;
    const centerY = height / 2;
    const radius = 80;
    
    dataset.expectedGroups.forEach((group, i) => {
        const angle = (i / numClusters) * 2 * Math.PI;
        const x = centerX + Math.cos(angle) * 150;
        const y = centerY + Math.sin(angle) * 100;
        
        // Draw cluster circle
        ctx.beginPath();
        ctx.arc(x, y, radius, 0, 2 * Math.PI);
        ctx.fillStyle = `hsla(${i * 90}, 70%, 90%, 0.5)`;
        ctx.fill();
        ctx.strokeStyle = `hsl(${i * 90}, 70%, 50%)`;
        ctx.stroke();
        
        // Draw items in cluster
        group.items.forEach((item, j) => {
            const itemAngle = (j / group.items.length) * 2 * Math.PI;
            const itemX = x + Math.cos(itemAngle) * (radius - 20);
            const itemY = y + Math.sin(itemAngle) * (radius - 20);
            
            ctx.font = '24px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText(item, itemX, itemY);
        });
        
        // Label
        ctx.font = '12px Arial';
        ctx.fillStyle = '#333';
        ctx.fillText(group.name, x, y + radius + 20);
    });
}

// Change dataset
function changeDataset(dataset) {
    currentDataset = dataset;
    initializeMysteryBox();
    document.getElementById('aiGroups').innerHTML = '<p class="text-gray-400 text-sm text-center py-8">Click "Let AI Sort" to see what patterns the AI finds!</p>';
    document.getElementById('clusteringSteps').innerHTML = '';
    
    // Clear canvas
    const canvas = document.getElementById('clusteringCanvas');
    if (canvas) {
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
    }
    
    // Update button styles
    document.querySelectorAll('.dataset-btn').forEach(btn => {
        btn.classList.remove('ring-2', 'ring-offset-2');
    });
    event.target.classList.add('ring-2', 'ring-offset-2');
}



// Check unsupervised learning answers
function checkUnsupervisedAnswer(question, answer) {
    const feedback = document.getElementById(`uq${question}-feedback`);
    
    if (question === 1) {
        if (!answer) {
            feedback.innerHTML = '<span class="text-green-600">✅ Correct! AI often finds different patterns than humans expect. This is the power of unsupervised learning!</span>';
            addXP(15);
        } else {
            feedback.innerHTML = '<span class="text-orange-600">Actually, AI often groups things differently than humans. That\'s what makes it interesting!</span>';
        }
    } else if (question === 2) {
        const userAnswer = document.getElementById('uq2-answer').value.toLowerCase();
        if (userAnswer.includes('discover') || userAnswer.includes('pattern') || userAnswer.includes('label') || userAnswer.includes('unknown')) {
            feedback.innerHTML = '<span class="text-green-600">✅ Great answer! Unsupervised learning can discover hidden patterns without needing labeled data!</span>';
            addXP(20);
        } else {
            feedback.innerHTML = '<span class="text-blue-600">Good try! The main advantage is finding patterns in data without needing labels or knowing what to look for.</span>';
            addXP(10);
        }
    }
}

// Initialize on page load
document.addEventListener('DOMContentLoaded', function() {
    initializeMysteryBox();
});
        // Reflection question handlers
let reflectionAnswers = {
    1: false,
    2: false,
    3: false,
    4: false,
    5: false
};

function checkReflectionAnswer(questionNum, answer, isCorrect) {
    const feedback = document.getElementById(`reflection${questionNum}-feedback`);
    const radios = document.querySelectorAll(`input[name="q${questionNum}"]`);
    
    // Disable all radio buttons for this question
    radios.forEach(radio => {
        radio.disabled = true;
    });
    
    if (isCorrect) {
        feedback.innerHTML = '<span class="text-green-600 font-semibold">✅ Correct! </span>';
        reflectionAnswers[questionNum] = true;
        playSound('success');
        addXP(15);
        
        // Add explanation
        const explanations = {
            1: "Exactly! Without diverse examples, the AI can't learn to distinguish between different types.",
            2: "Right! The AI needs to see what makes each animal unique compared to the others.",
            3: "Perfect! Testing uses the patterns learned during training to classify new inputs."
        };
        feedback.innerHTML += `<span class="text-gray-600">${explanations[questionNum]}</span>`;
    } else {
        feedback.innerHTML = '<span class="text-red-600 font-semibold">❌ Not quite. </span>';
        playSound('error');
        
        // Add hint
        const hints = {
            1: "Think about what happens when the AI only sees one type - how can it learn differences?",
            2: "Consider how you tell animals apart - you need to know what makes each one special!",
            3: "Remember: training adds knowledge, testing uses that knowledge."
        };
        feedback.innerHTML += `<span class="text-gray-600">${hints[questionNum]}</span>`;
    }
    
    checkReflectionProgress();
}

function checkOpenAnswer(questionNum) {
    const textarea = document.getElementById(`reflection${questionNum}`);
    const feedback = document.getElementById(`reflection${questionNum}-feedback`);
    const answer = textarea.value.trim().toLowerCase();
    
    if (answer.length < 20) {
        feedback.innerHTML = '<span class="text-orange-600">Please write a more detailed answer (at least 20 characters).</span>';
        return;
    }
    
    reflectionAnswers[questionNum] = true;
    playSound('success');
    addXP(20);
    
    const goodAnswers = {
        4: {
            keywords: ['training', 'data', 'examples', 'enough', 'wrong', 'different', 'quality', 'limited'],
            feedback: "Good thinking! Real AI systems can give wrong answers when they haven't seen enough examples, their training data is limited, or they encounter something very different from their training."
        },
        5: {
            keywords: ['different', 'angles', 'lighting', 'expressions', 'variety', 'diverse', 'multiple'],
            feedback: "Excellent! For face recognition, you'd need photos from different angles, in different lighting, with different expressions - just like how we trained our animal classifier with variety!"
        }
    };
    
    const questionData = goodAnswers[questionNum];
    const hasKeyword = questionData.keywords.some(keyword => answer.includes(keyword));
    
    if (hasKeyword) {
        feedback.innerHTML = `<span class="text-green-600 font-semibold">✅ Great answer!</span> <span class="text-gray-600">${questionData.feedback}</span>`;
    } else {
        feedback.innerHTML = `<span class="text-blue-600 font-semibold">✓ Thanks for your answer!</span> <span class="text-gray-600">${questionData.feedback}</span>`;
    }
    
    // Disable the textarea and button
    textarea.disabled = true;
    event.target.disabled = true;
    
    checkReflectionProgress();
}

function checkReflectionProgress() {
    const completed = Object.values(reflectionAnswers).filter(v => v === true).length;
    
    if (completed >= 4) {
        const summary = document.getElementById('reflectionSummary');
        if (summary) {
            summary.classList.remove('hidden');
            if (completed === 5) {
                unlockAchievement('deep-thinker');
                showNotification('🎯 All reflection questions completed! You really understand ML!');
            }
        }
    }
}

        // ML Pipeline Check
        function checkPipeline() {
            const dropZones = document.querySelectorAll('#pipelineOrder .drop-zone');
            const correctOrder = ['collect', 'prepare', 'train', 'test', 'deploy'];
            let correctSteps = 0;
            
            dropZones.forEach((zone, index) => {
                const step = zone.querySelector('.draggable');
                if (step && step.dataset.step === correctOrder[index]) {
                    step.style.backgroundColor = '#dcfce7';
                    step.style.borderColor = '#10b981';
                    zone.style.backgroundColor = '#dcfce7';
                    correctSteps++;
                } else {
                    if (step) {
                        step.style.backgroundColor = '#fee2e2';
                        step.style.borderColor = '#ef4444';
                    }
                    zone.style.backgroundColor = '#fee2e2';
                }
            });
            
            const feedback = document.getElementById('pipelineFeedback');
            if (correctSteps === 5) {
                feedback.innerHTML = '<div class="text-green-600 font-bold text-center">🎉 Perfect Pipeline! You understand the ML workflow!</div>';
                addXP(40);
                unlockAchievement('pipeline');
            } else {
                feedback.innerHTML = `<div class="text-orange-600 font-bold text-center">Steps correct: ${correctSteps}/5. Think about what needs to happen first!</div>`;
            }
        }

        function resetPipeline() {
            // Move all items back to steps container
            const steps = document.querySelectorAll('#pipelineOrder .draggable');
            const stepsContainer = document.getElementById('mlSteps');
            
            steps.forEach(step => {
                step.style.backgroundColor = '';
                step.style.borderColor = '';
                stepsContainer.appendChild(step);
            });
            
            // Reset drop zones
            const dropZones = document.querySelectorAll('#pipelineOrder .drop-zone');
            dropZones.forEach((zone, index) => {
                zone.innerHTML = `<span class="text-gray-400 font-semibold">Step ${index + 1}: Drop here</span>`;
                zone.style.backgroundColor = '';
            });
            
            document.getElementById('pipelineFeedback').innerHTML = '';
        }

        // ML Type Quiz
        function checkMLType(scenario, choice) {
            console.log(`Checking ML type for ${scenario}: ${choice}`);
            
            const correct = {
                netflix: 'unsupervised',
                faceid: 'supervised'
            };
            
            const isCorrect = correct[scenario] === choice;
            const result = document.getElementById(`${scenario}-result`);
            
            if (!result) {
                console.error(`Result element not found for ${scenario}`);
                return;
            }
            
            quizTotal++;
            
            if (isCorrect) {
                result.innerHTML = '<span class="text-green-600">✅ Correct!</span>';
                quizCorrect++;
                addXP(20);
            } else {
                const explanation = scenario === 'netflix' ? 
                    'Netflix finds patterns without being told what groups to make.' :
                    'Face ID learns from labeled examples of "you" vs "not you".';
                result.innerHTML = `<span class="text-red-600">❌ Try again!</span><br><span class="text-xs text-gray-600">${explanation}</span>`;
            }
            
            // Update quiz results
            const quizResults = document.getElementById('quizResults');
            if (quizResults && quizTotal >= 2) {
                const percentage = Math.round((quizCorrect / quizTotal) * 100);
                quizResults.innerHTML = `<div class="text-lg font-bold">Quiz Score: ${quizCorrect}/${quizTotal} (${percentage}%)</div>`;
            }
        }
// ============================================
// ENHANCED NEURAL NETWORK CODE
// ============================================
// ============================================
// ENHANCED NEURAL NETWORK CODE - IMPROVED VERSION
// ============================================

// Neural Network State
let networkState = {
    weights: {
        inputToHidden: [],
        hiddenToOutput: []
    },
    training: {
        cat: 0,
        dog: 0,
        bird: 0
    },
    neurons: {
        input: [0.5, 0.5, 0.5],
        hidden: [0, 0, 0],
        output: [0, 0, 0]
    },
    isAnimating: false,
    lastPrediction: null
};

// Initialize network weights
function initializeNetworkWeights() {
    // Random weights between -1 and 1
    networkState.weights.inputToHidden = Array(3).fill().map(() => 
        Array(3).fill().map(() => Math.random() * 2 - 1)
    );
    networkState.weights.hiddenToOutput = Array(3).fill().map(() => 
        Array(3).fill().map(() => Math.random() * 2 - 1)
    );
}

// Canvas drawing functions
// Update the drawNeuralNetwork function to pass height to drawConnections
function drawNeuralNetwork() {
    const canvas = document.getElementById('neuralCanvas');
    if (!canvas) return;
    
    const ctx = canvas.getContext('2d');
    const width = canvas.width;
    const height = canvas.height;
    
    // Clear canvas
    ctx.clearRect(0, 0, width, height);
    
    // Add subtle grid background
    ctx.strokeStyle = '#f3f4f6';
    ctx.lineWidth = 1;
    for (let i = 0; i < width; i += 50) {
        ctx.beginPath();
        ctx.moveTo(i, 0);
        ctx.lineTo(i, height);
        ctx.stroke();
    }
    for (let i = 0; i < height; i += 50) {
        ctx.beginPath();
        ctx.moveTo(0, i);
        ctx.lineTo(width, i);
        ctx.stroke();
    }
    
    // Define positions
    const layers = {
        input: { x: 100, neurons: 3 },
        hidden: { x: 300, neurons: 3 },
        output: { x: 500, neurons: 3 }
    };
    
    const neuronRadius = 35;
    const layerHeight = height - 100;
    
    // Draw connections with weights - PASS HEIGHT AS PARAMETER
    drawConnections(ctx, layers, neuronRadius, layerHeight, height);
    
    // Draw neurons
    drawNeurons(ctx, layers, neuronRadius, layerHeight);
    
    // Add labels
    drawLabels(ctx, layers, height);
}

// Update drawConnections to accept height parameter


function drawConnections(ctx, layers, radius, layerHeight) {
    // Draw a key/legend on the canvas - use canvas height from context
    const canvas = ctx.canvas;
    const canvasHeight = canvas.height;
    
    ctx.save();
    ctx.font = '10px Arial';
    ctx.fillStyle = '#6b7280';
    ctx.fillText('Line thickness = connection strength', 10, canvasHeight - 10);
    ctx.restore();
    
    // Input to Hidden connections
    for (let i = 0; i < 3; i++) {
        for (let j = 0; j < 3; j++) {
            const weight = networkState.weights.inputToHidden[i][j];
            const startX = layers.input.x + radius;
            const startY = 50 + (i + 1) * (layerHeight / 4);
            const endX = layers.hidden.x - radius;
            const endY = 50 + (j + 1) * (layerHeight / 4);
            
            drawConnection(ctx, startX, startY, endX, endY, weight, 
                networkState.neurons.input[i] > 0.1);
        }
    }
    
    // Hidden to Output connections
    for (let i = 0; i < 3; i++) {
        for (let j = 0; j < 3; j++) {
            const weight = networkState.weights.hiddenToOutput[i][j];
            const startX = layers.hidden.x + radius;
            const startY = 50 + (i + 1) * (layerHeight / 4);
            const endX = layers.output.x - radius;
            const endY = 50 + (j + 1) * (layerHeight / 4);
            
            drawConnection(ctx, startX, startY, endX, endY, weight,
                networkState.neurons.hidden[i] > 0.1);
        }
    }
}

function drawConnection(ctx, x1, y1, x2, y2, weight, isActive) {
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    
    // Make connections more visible
    const opacity = isActive ? Math.min(1, Math.abs(weight) + 0.3) : 0.2;
    const thickness = Math.abs(weight) * 5 + 1;
    
    if (weight > 0) {
        // Positive connections - solid green
        ctx.strokeStyle = `rgba(34, 197, 94, ${opacity})`;
        ctx.lineWidth = thickness;
        ctx.setLineDash([]);
    } else {
        // Negative connections - dashed red
        ctx.strokeStyle = `rgba(239, 68, 68, ${opacity})`;
        ctx.lineWidth = thickness;
        ctx.setLineDash([5, 5]);
    }
    
    ctx.stroke();
    ctx.setLineDash([]);
}

function drawNeurons(ctx, layers, radius, layerHeight) {
    // Input neurons
    const inputLabels = ['Size', 'Color', 'Sound'];
    const inputIcons = ['📏', '🎨', '🔊'];
    
    for (let i = 0; i < 3; i++) {
        const x = layers.input.x;
        const y = 50 + (i + 1) * (layerHeight / 4);
        const activation = networkState.neurons.input[i];
        
        drawNeuron(ctx, x, y, radius, activation, 'input', i, inputLabels[i], inputIcons[i]);
    }
    
    // Hidden neurons
    for (let i = 0; i < 3; i++) {
        const x = layers.hidden.x;
        const y = 50 + (i + 1) * (layerHeight / 4);
        const activation = networkState.neurons.hidden[i];
        
        drawNeuron(ctx, x, y, radius, activation, 'hidden', i, `H${i + 1}`, '🧠');
    }
    
    // Output neurons
    const outputLabels = ['Cat', 'Dog', 'Bird'];
    const outputIcons = ['🐱', '🐶', '🐦'];
    
    for (let i = 0; i < 3; i++) {
        const x = layers.output.x;
        const y = 50 + (i + 1) * (layerHeight / 4);
        const activation = networkState.neurons.output[i];
        
        drawNeuron(ctx, x, y, radius, activation, 'output', i, outputLabels[i], outputIcons[i]);
    }
}

function drawNeuron(ctx, x, y, radius, activation, layer, index, label, icon) {
    // Draw outer glow for active neurons
    if (activation > 0.5) {
        ctx.beginPath();
        ctx.arc(x, y, radius + 5, 0, 2 * Math.PI);
        ctx.fillStyle = `rgba(99, 102, 241, ${activation * 0.3})`;
        ctx.fill();
    }
    
    // Neuron circle
    ctx.beginPath();
    ctx.arc(x, y, radius, 0, 2 * Math.PI);
    
    // Fill based on activation
    const intensity = Math.floor(activation * 255);
    if (layer === 'input') {
        ctx.fillStyle = `rgba(59, 130, 246, ${activation})`;
    } else if (layer === 'hidden') {
        ctx.fillStyle = `rgba(139, 92, 246, ${activation})`;
    } else {
        ctx.fillStyle = `rgba(34, 197, 94, ${activation})`;
    }
    ctx.fill();
    
    // White background for better readability
    ctx.beginPath();
    ctx.arc(x, y, radius - 5, 0, 2 * Math.PI);
    ctx.fillStyle = 'rgba(255, 255, 255, 0.9)';
    ctx.fill();
    
    // Border
    ctx.beginPath();
    ctx.arc(x, y, radius, 0, 2 * Math.PI);
    ctx.strokeStyle = activation > 0.5 ? '#4c1d95' : '#d1d5db';
    ctx.lineWidth = activation > 0.5 ? 3 : 2;
    ctx.stroke();
    
    // Icon
    ctx.font = '24px Arial';
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';
    ctx.fillText(icon, x, y - 8);
    
    // Label
    ctx.fillStyle = '#1f2937';
    ctx.font = 'bold 12px Arial';
    ctx.fillText(label, x, y + 12);
    
    // Activation value for active neurons
    if (activation > 0.1 && layer !== 'input') {
        ctx.font = '10px Arial';
        ctx.fillStyle = '#6b7280';
        ctx.fillText(`${(activation * 100).toFixed(0)}%`, x, y + radius + 15);
    }
}

function drawLabels(ctx, layers, height) {
    ctx.fillStyle = '#1f2937';
    ctx.font = 'bold 16px Arial';
    ctx.textAlign = 'center';
    
    ctx.fillText('1️⃣ Input Layer', layers.input.x, 30);
    ctx.fillText('2️⃣ Hidden Layer', layers.hidden.x, 30);
    ctx.fillText('3️⃣ Output Layer', layers.output.x, 30);
    
    // Add descriptions
    ctx.font = '11px Arial';
    ctx.fillStyle = '#6b7280';
    ctx.fillText('(Your Description)', layers.input.x, height - 20);
    ctx.fillText('(Pattern Detection)', layers.hidden.x, height - 20);
    ctx.fillText('(Final Decision)', layers.output.x, height - 20);
}

// Preset examples
function setPreset(animal) {
    const presets = {
        'cat': { size: 30, color: 20, sound: 80 },
        'dog': { size: 70, color: 60, sound: 30 },
        'bird': { size: 10, color: 90, sound: 95 }
    };
    
    const preset = presets[animal];
    document.getElementById('sizeSlider').value = preset.size;
    document.getElementById('colorSlider').value = preset.color;
    document.getElementById('soundSlider').value = preset.sound;
    
    updateInput('size', preset.size);
    updateInput('color', preset.color);
    updateInput('sound', preset.sound);
    
    // Update happening text
    updateHappeningText(`Loaded typical ${animal} features. Click "Make Prediction" to see what the AI thinks!`);
}

// Input handling
function updateInput(type, value) {
    document.getElementById(`${type}Value`).textContent = value;
    
    // Update input neurons based on slider values
    const index = type === 'size' ? 0 : type === 'color' ? 1 : 2;
    networkState.neurons.input[index] = value / 100;
    
    drawNeuralNetwork();
}

// Update happening text
function updateHappeningText(text) {
    const happeningText = document.getElementById('happeningText');
    if (happeningText) {
        happeningText.textContent = text;
    }
}

// Prediction function
function runPrediction() {
    if (networkState.isAnimating) return;
    
    const totalTraining = Object.values(networkState.training).reduce((a, b) => a + b, 0);
    if (totalTraining === 0) {
        updateHappeningText("⚠️ Network not trained yet! Click the animal buttons below to train it first.");
        return;
    }
    
    networkState.isAnimating = true;
    updateHappeningText("🔄 Processing input through neural network layers...");
    
    // Get input values
    const inputs = [
        document.getElementById('sizeSlider').value / 100,
        document.getElementById('colorSlider').value / 100,
        document.getElementById('soundSlider').value / 100
    ];
    
    networkState.neurons.input = inputs;
    
    // Animate through layers
    setTimeout(() => {
        calculateHiddenLayer();
        drawNeuralNetwork();
        updateHappeningText("🧠 Hidden layer detecting patterns...");
        
        setTimeout(() => {
            calculateOutputLayer();
            drawNeuralNetwork();
            updateHappeningText("✅ Output layer making final decision!");
            showPredictionResults();
        }, 800);
    }, 800);
}

function calculateHiddenLayer() {
    for (let j = 0; j < 3; j++) {
        let sum = 0;
        for (let i = 0; i < 3; i++) {
            sum += networkState.neurons.input[i] * networkState.weights.inputToHidden[i][j];
        }
        networkState.neurons.hidden[j] = sigmoid(sum);
    }
}

function calculateOutputLayer() {
    for (let j = 0; j < 3; j++) {
        let sum = 0;
        for (let i = 0; i < 3; i++) {
            sum += networkState.neurons.hidden[i] * networkState.weights.hiddenToOutput[i][j];
        }
        networkState.neurons.output[j] = sigmoid(sum);
    }
}

function sigmoid(x) {
    return 1 / (1 + Math.exp(-x));
}

function showPredictionResults() {
    const outputs = networkState.neurons.output;
    const total = outputs.reduce((a, b) => a + b, 0);
    const probabilities = outputs.map(o => (o / total * 100));
    
    // Find winner
    const maxIndex = outputs.indexOf(Math.max(...outputs));
    const animals = ['Cat', 'Dog', 'Bird'];
    const emojis = ['🐱', '🐶', '🐦'];
    
    // Show main prediction
    const predictionDisplay = document.getElementById('predictionDisplay');
    const mainPrediction = document.getElementById('mainPrediction');
    const confidenceDisplay = document.getElementById('confidenceDisplay');
    
    predictionDisplay.classList.remove('hidden');
    mainPrediction.innerHTML = `${emojis[maxIndex]} ${animals[maxIndex]}`;
    
    const confidence = probabilities[maxIndex];
    let confidenceText = '';
    if (confidence > 80) {
        confidenceText = `Very Confident: ${confidence.toFixed(0)}%`;
    } else if (confidence > 60) {
        confidenceText = `Fairly Confident: ${confidence.toFixed(0)}%`;
    } else {
        confidenceText = `Not Sure: ${confidence.toFixed(0)}%`;
    }
    confidenceDisplay.textContent = confidenceText;
    
    // Update detailed bars
    document.getElementById('detailedResults').classList.remove('hidden');
    updateDetailedBar('cat', probabilities[0]);
    updateDetailedBar('dog', probabilities[1]);
    updateDetailedBar('bird', probabilities[2]);
    
    // Update happening text
    const features = [];
    if (networkState.neurons.input[0] < 0.3) features.push('small size');
    else if (networkState.neurons.input[0] > 0.7) features.push('large size');
    
    if (networkState.neurons.input[2] > 0.7) features.push('high-pitched sound');
    else if (networkState.neurons.input[2] < 0.3) features.push('low-pitched sound');
    
    updateHappeningText(`Based on ${features.join(' and ')}, the AI thinks it's most likely a ${animals[maxIndex]}!`);
    
    networkState.isAnimating = false;
    networkState.lastPrediction = animals[maxIndex];
    playSound('success');
}

function updateDetailedBar(animal, percentage) {
    const bar = document.getElementById(`${animal}Bar`);
    const percent = document.getElementById(`${animal}Percent`);
    bar.style.width = `${percentage}%`;
    percent.textContent = `${percentage.toFixed(1)}%`;
}

// Training functions
function trainNetwork(animal) {
    const animalIndex = { 'cat': 0, 'dog': 1, 'bird': 2 }[animal];
    
    // Set ideal inputs for each animal with some variation
    const idealInputs = {
        'cat': [0.3, 0.2, 0.8],  // Small, single color, high pitch
        'dog': [0.7, 0.6, 0.3],  // Large, mixed colors, low pitch
        'bird': [0.1, 0.9, 0.95] // Tiny, very colorful, very high pitch
    };
    
    // Add some randomness to make it realistic
    const inputs = idealInputs[animal].map(v => 
        Math.max(0, Math.min(1, v + (Math.random() - 0.5) * 0.2))
    );
    
    // Update sliders to show what we're training
    document.getElementById('sizeSlider').value = inputs[0] * 100;
    document.getElementById('colorSlider').value = inputs[1] * 100;
    document.getElementById('soundSlider').value = inputs[2] * 100;
    
    updateInput('size', inputs[0] * 100);
    updateInput('color', inputs[1] * 100);
    updateInput('sound', inputs[2] * 100);
    
    // Set expected output
    const expected = [0, 0, 0];
    expected[animalIndex] = 1;
    
    // Forward propagation
    networkState.neurons.input = inputs;
    calculateHiddenLayer();
    calculateOutputLayer();
    
    // Simple backpropagation
    const learningRate = 0.3;
    const errors = expected.map((e, i) => e - networkState.neurons.output[i]);
    
    // Update weights
    for (let i = 0; i < 3; i++) {
        for (let j = 0; j < 3; j++) {
            networkState.weights.hiddenToOutput[i][j] += 
                learningRate * errors[j] * networkState.neurons.hidden[i];
            
            // Also update input to hidden weights
            let hiddenError = 0;
            for (let k = 0; k < 3; k++) {
                hiddenError += errors[k] * networkState.weights.hiddenToOutput[j][k];
            }
            networkState.weights.inputToHidden[i][j] += 
                learningRate * hiddenError * networkState.neurons.input[i] * 
                networkState.neurons.hidden[j] * (1 - networkState.neurons.hidden[j]);
        }
    }
    
    // Update training count
    networkState.training[animal]++;
    updateTrainingDisplay();
    
    // Animate
    drawNeuralNetwork();
    playSound('click');
    
    // Update happening text
    const emojis = { 'cat': '🐱', 'dog': '🐶', 'bird': '🐦' };
    updateHappeningText(`Trained with ${emojis[animal]} ${animal} example! The network adjusted its connections to better recognize ${animal}s.`);
    
    // Check network health
    checkNetworkHealth();
}

function updateTrainingDisplay() {
    const animals = ['cat', 'dog', 'bird'];
    const maxCount = 20; // Max for visual display
    
    animals.forEach(animal => {
        const count = networkState.training[animal];
        const percentage = Math.min((count / maxCount) * 100, 100);
        
        document.getElementById(`${animal}TrainCount`).textContent = count;
        document.getElementById(`${animal}TrainBar`).style.width = `${percentage}%`;
    });
}

function checkNetworkHealth() {
    const counts = Object.values(networkState.training);
    const total = counts.reduce((a, b) => a + b, 0);
    const healthStatus = document.getElementById('healthStatus');
    
    if (total === 0) {
        healthStatus.textContent = 'Ready to learn! Click animals above to train.';
        healthStatus.className = 'text-sm text-green-600';
    } else if (total < 5) {
        healthStatus.textContent = '📚 Just getting started. Train each animal at least 5 times.';
        healthStatus.className = 'text-sm text-blue-600';
    } else {
        const max = Math.max(...counts);
        const min = Math.min(...counts);
        const imbalance = max - min;
        
        if (imbalance > 10) {
            healthStatus.textContent = '⚠️ Very imbalanced! The network is forgetting some animals.';
            healthStatus.className = 'text-sm text-red-600';
        } else if (imbalance > 5) {
            healthStatus.textContent = '⚖️ Getting imbalanced. Train all animals equally!';
            healthStatus.className = 'text-sm text-yellow-600';
        } else {
            healthStatus.textContent = '✅ Well balanced! Network is learning all animals effectively.';
            healthStatus.className = 'text-sm text-green-600';
        }
    }
}

// Track lesson progress
let lessonStartTime = Date.now();
let completedTasks = new Set();

// ML in Daily Life functions
function showMLExample(example) {
    const details = {
        'faceunlock': {
            title: 'Face Unlock ML',
            content: 'Your phone takes many photos of your face from different angles (training data), learns your unique features (supervised learning), and can then recognize you even with different hairstyles!'
        },
        'spam': {
            title: 'Spam Filter ML',
            content: 'Gmail was trained on millions of emails labeled "spam" or "not spam". It learned patterns like suspicious words, fake sender addresses, and unusual formatting.'
        },
        'spotify': {
            title: 'Music Recommendation ML',
            content: 'Spotify groups songs by analyzing audio features (tempo, energy, mood) without being told what genre they are. It finds patterns in what you listen to!'
        },
        'gaming': {
            title: 'Game AI ML',
            content: 'Modern games use neural networks that learn from how you play. If you always attack from the left, the AI learns to defend that side more!'
        }
    };
    
    const detailsDiv = document.getElementById('mlExampleDetails');
    detailsDiv.innerHTML = `
        <h4 class="font-bold text-lg mb-2">${details[example].title}</h4>
        <p class="text-sm text-gray-700">${details[example].content}</p>
        <button onclick="hideMLExample()" class="mt-3 text-sm text-gray-500 hover:text-gray-700">Close</button>
    `;
    detailsDiv.classList.remove('hidden');
}

// Update lesson summary
function updateLessonSummary() {
    const timeSpent = Math.floor((Date.now() - lessonStartTime) / 60000);
    document.getElementById('timeSpent').textContent = timeSpent + 'm';
    document.getElementById('conceptsLearned').textContent = document.querySelectorAll('.completed').length;
    document.getElementById('tasksCompleted').textContent = completedTasks.size;
    document.getElementById('totalXP').textContent = totalXP;
}

// Fairness checker
function checkFairness() {
    const checked = document.querySelectorAll('input[type="checkbox"]:checked').length;
    const score = (checked / 4) * 100;
    document.getElementById('fairnessScore').innerHTML = 
        `Fairness Score: ${score}%${score === 100 ? ' 🌟 Excellent!' : ''}`;
}

// Design your own ML
function updateDesign() {
    const problem = document.getElementById('mlProblem').value;
    const mlType = document.querySelector('input[name="mlType"]:checked')?.value;
    const dataPlan = document.getElementById('dataplan').value;
    
    if (problem && mlType && dataPlan) {
        document.getElementById('yourDesign').classList.remove('hidden');
        document.getElementById('designSummary').innerHTML = `
            <p><strong>Problem:</strong> ${problem}</p>
            <p><strong>ML Type:</strong> ${mlType}</p>
            <p><strong>Data Plan:</strong> ${dataPlan}</p>
        `;
    }
}

// Control functions
function resetNetwork() {
    if (confirm('Reset all training? This will erase the network\'s memory!')) {
        networkState.training = { cat: 0, dog: 0, bird: 0 };
        initializeNetworkWeights();
        updateTrainingDisplay();
        checkNetworkHealth();
        drawNeuralNetwork();
        
        // Hide prediction displays
        document.getElementById('predictionDisplay').classList.add('hidden');
        document.getElementById('detailedResults').classList.add('hidden');
        
        updateHappeningText('Network reset! All connections randomized. Ready to learn from scratch.');
        playSound('error');
    }
}

function autoTrain() {
    // Train each animal 5 times
    updateHappeningText('⚡ Quick training in progress...');
    
    let count = 0;
    const animals = ['cat', 'dog', 'bird'];
    
    const interval = setInterval(() => {
        if (count >= 15) {
            clearInterval(interval);
            updateHappeningText('✅ Quick training complete! Try making predictions now.');
            return;
        }
        
        const animal = animals[count % 3];
        trainNetwork(animal);
        count++;
    }, 300);
}

// Initialize on load
document.addEventListener('DOMContentLoaded', function() {
    initializeNetworkWeights();
    drawNeuralNetwork();
    updateTrainingDisplay();
    checkNetworkHealth();
});
const mlScenarios = [
    {
        id: 1,
        scenario: "A hospital AI system that looks at chest X-rays and determines if they show signs of pneumonia. Doctors provided 10,000 X-rays and marked each one as 'pneumonia' or 'healthy'.",
        type: "supervised",
        hint: "The doctors provided labels for each X-ray"
    },
    {
        id: 2,
        scenario: "A music app analyzes your listening history and automatically creates playlists of songs that 'go well together' without anyone defining what that means.",
        type: "unsupervised",
        hint: "No one told the AI what 'goes well together' means"
    },
    {
        id: 3,
        scenario: "A bank's AI examines thousands of transactions to find unusual spending patterns that might indicate stolen credit cards, without being told what 'unusual' looks like.",
        type: "unsupervised",
        hint: "The AI must discover what's 'unusual' on its own"
    },
    {
        id: 4,
        scenario: "A farming robot learns to identify ripe strawberries by studying thousands of photos where farmers marked each berry as 'ripe' or 'not ripe'.",
        type: "supervised",
        hint: "Farmers provided the correct answer for each photo"
    },
    {
        id: 5,
        scenario: "An online store's AI watches what millions of customers buy and automatically discovers that people who buy camping gear also tend to buy hiking boots, without being told to look for this connection.",
        type: "unsupervised",
        hint: "The AI finds connections without being told what to look for"
    },
    {
        id: 6,
        scenario: "A translation app learns to convert English to Spanish by studying millions of sentence pairs where human translators provided the Spanish version for each English sentence.",
        type: "supervised",
        hint: "Human translators provided correct translations"
    },
    {
        id: 7,
        scenario: "A space telescope's AI analyzes thousands of star images and automatically groups them into different categories based on their characteristics, helping scientists discover new types of stars.",
        type: "unsupervised",
        hint: "The AI creates its own star categories"
    },
    {
        id: 8,
        scenario: "A wildlife camera system learns to count elephants in photos after researchers labeled 5,000 images with the exact number of elephants in each.",
        type: "supervised",
        hint: "Researchers told the AI how many elephants were in each photo"
    },
    {
        id: 9,
        scenario: "A social media platform's AI analyzes millions of posts and automatically identifies trending topics and emerging slang words without anyone defining what makes something 'trending'.",
        type: "unsupervised",
        hint: "No one defined what 'trending' means"
    },
    {
        id: 10,
        scenario: "A smartphone keyboard learns to predict your next word by studying millions of text messages where it knows what word people actually typed after each sequence.",
        type: "supervised",
        hint: "The AI knows what word was actually typed"
    }
];
let currentScenarioIndex = 0;
let scenarioScores = [];

// ... (rest of the JavaScript functions I provided)
        
// Initialize scenarios
function initializeScenarios() {
    currentScenarioIndex = 0;
    scenarioScores = [];
    showNextScenario();
}

// Show next scenario
function showNextScenario() {
    const container = document.getElementById('scenarioContainer');
    if (!container || currentScenarioIndex >= mlScenarios.length) {
        showQuizComplete();
        return;
    }
    
    const scenario = mlScenarios[currentScenarioIndex];
    
    container.innerHTML = `
        <div class="bg-white p-6 rounded-lg border-2 border-gray-200 transition-all">
            <div class="flex justify-between items-start mb-4">
                <h4 class="font-bold text-lg">Scenario ${scenario.id}/10</h4>
                <span class="text-sm text-gray-500">${mlScenarios.length - currentScenarioIndex - 1} remaining</span>
            </div>
            
            <p class="text-gray-700 mb-6">${scenario.scenario}</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="checkMLScenario('supervised')" class="scenario-btn bg-blue-100 hover:bg-blue-200 p-4 rounded-lg text-center transition-all">
                    <span class="text-2xl mb-2 block">📚</span>
                    <span class="font-bold text-blue-700">Supervised Learning</span>
                    <p class="text-xs text-gray-600 mt-1">AI learns from labeled examples</p>
                </button>
                
                <button onclick="checkMLScenario('unsupervised')" class="scenario-btn bg-purple-100 hover:bg-purple-200 p-4 rounded-lg text-center transition-all">
                    <span class="text-2xl mb-2 block">🔍</span>
                    <span class="font-bold text-purple-700">Unsupervised Learning</span>
                    <p class="text-xs text-gray-600 mt-1">AI finds patterns on its own</p>
                </button>
            </div>
            
            <div id="scenarioFeedback" class="mt-4 hidden">
                <!-- Feedback will appear here -->
            </div>
            
            <button id="nextScenarioBtn" onclick="nextScenario()" class="hidden mt-4 w-full bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 transition-all">
                Next Scenario →
            </button>
        </div>
    `;
}

// Check ML scenario answer
function checkMLScenario(answer) {
    const scenario = mlScenarios[currentScenarioIndex];
    const isCorrect = answer === scenario.type;
    const feedback = document.getElementById('scenarioFeedback');
    const buttons = document.querySelectorAll('.scenario-btn');
    
    // Disable buttons
    buttons.forEach(btn => {
        btn.disabled = true;
        btn.style.cursor = 'not-allowed';
        btn.style.opacity = '0.6';
    });
    
    // Show feedback
    feedback.classList.remove('hidden');
    
    if (isCorrect) {
        feedback.innerHTML = `
            <div class="bg-green-100 p-4 rounded-lg">
                <p class="font-bold text-green-700">✅ Correct!</p>
                <p class="text-sm text-gray-700 mt-1">${scenario.hint}</p>
            </div>
        `;
        scenarioScores.push(1);
        playSound('success');
        addXP(10);
    } else {
        feedback.innerHTML = `
            <div class="bg-red-100 p-4 rounded-lg">
                <p class="font-bold text-red-700">❌ Not quite!</p>
                <p class="text-sm text-gray-700 mt-1">This is ${scenario.type} learning. ${scenario.hint}</p>
            </div>
        `;
        scenarioScores.push(0);
        playSound('error');
    }
    
    // Update progress
    updateMLTypeProgress();
    
    // Show next button
    document.getElementById('nextScenarioBtn').classList.remove('hidden');
}

// Move to next scenario
function nextScenario() {
    currentScenarioIndex++;
    showNextScenario();
}

// Update progress bar
function updateMLTypeProgress() {
    const progress = ((currentScenarioIndex + 1) / mlScenarios.length) * 100;
    const progressBar = document.getElementById('mlTypeProgress');
    const completed = document.getElementById('scenariosCompleted');
    
    if (progressBar) progressBar.style.width = progress + '%';
    if (completed) completed.textContent = currentScenarioIndex + 1;
}

// Show quiz complete
function showQuizComplete() {
    const container = document.getElementById('scenarioContainer');
    const completeDiv = document.getElementById('quizComplete');
    const finalScore = scenarioScores.reduce((a, b) => a + b, 0);
    
    container.innerHTML = '';
    completeDiv.classList.remove('hidden');
    document.getElementById('finalScore').textContent = finalScore;
    
    if (finalScore >= 8) {
        playSound('achievement');
        unlockAchievement('ml-master');
    }
}

// Reveal real examples
function revealRealExamples() {
    const examples = document.getElementById('realWorldExamples');
    examples.classList.remove('hidden');
    examples.scrollIntoView({ behavior: 'smooth' });
    playSound('success');
    addXP(30);
}

// Initialize on load
document.addEventListener('DOMContentLoaded', function() {
    initializeScenarios();
});
    </script>
</body>
</html>