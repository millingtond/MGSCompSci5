<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Input/Output Devices - A Level Computer Science</title>
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f3f4f6;
            --text: #374151;
            --border: #e5e7eb;
            --glow: rgba(99, 102, 241, 0.3);
            --glass: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: var(--text);
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            background: var(--glass);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        h1 {
            color: white;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.1rem;
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 20px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-label {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }

        .stat-value {
            color: white;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .xp-bar {
            flex: 1;
            min-width: 200px;
            background: rgba(0, 0, 0, 0.2);
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #34d399);
            width: 0%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .xp-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .xp-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
        }

        .nav-bar {
            background: white;
            border-radius: 15px;
            padding: 10px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: flex;
            gap: 5px;
            overflow-x: auto;
            position: sticky;
            top: 20px;
            z-index: 100;
        }

        .nav-item {
            padding: 10px 20px;
            background: var(--light);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            white-space: nowrap;
            font-weight: 500;
            color: var(--text);
        }

        .nav-item:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3);
        }

        .nav-item.active {
            background: var(--primary);
            color: white;
        }

        .section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            display: none;
            animation: fadeIn 0.5s ease-out;
            position: relative;
            overflow: hidden;
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transform: scaleX(0);
            transform-origin: left;
            animation: expandWidth 0.5s ease-out 0.2s forwards;
        }

        @keyframes expandWidth {
            to { transform: scaleX(1); }
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            color: var(--dark);
            margin-bottom: 20px;
            font-size: 2rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h3 {
            color: var(--dark);
            margin: 20px 0 15px;
            font-size: 1.3rem;
        }

        .task-card {
            background: var(--light);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid transparent;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .task-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            opacity: 0;
            transition: opacity 0.3s;
            z-index: -1;
        }

        .task-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.2);
            border-color: var(--primary);
        }

        .btn {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:active::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #7c3aed);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #059669);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning), #d97706);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
        }

        input[type="text"], input[type="number"], textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.3s;
            background: white;
        }

        input[type="text"]:focus, input[type="number"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--glow);
        }

        .quiz-options {
            display: grid;
            gap: 10px;
            margin: 15px 0;
        }

        .quiz-option {
            padding: 15px 20px;
            background: white;
            border: 2px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .quiz-option:hover {
            border-color: var(--primary);
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.2);
        }

        .quiz-option.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .quiz-option.correct {
            background: var(--success);
            color: white;
            border-color: var(--success);
            animation: correctPulse 0.5s;
        }

        .quiz-option.incorrect {
            background: var(--danger);
            color: white;
            border-color: var(--danger);
            animation: shake 0.5s;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .feedback {
            padding: 15px 20px;
            border-radius: 10px;
            margin: 15px 0;
            display: none;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-10px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .feedback.success {
            background: rgba(16, 185, 129, 0.1);
            border: 2px solid var(--success);
            color: var(--success);
        }

        .feedback.error {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--danger);
            color: var(--danger);
        }

        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
            display: none;
            z-index: 1000;
            animation: achievementSlide 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            border: 3px solid var(--warning);
        }

        @keyframes achievementSlide {
            from {
                transform: translateX(400px);
            }
            to {
                transform: translateX(0);
            }
        }

        .achievement-popup h4 {
            color: var(--warning);
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .xp-float {
            position: fixed;
            color: var(--success);
            font-weight: bold;
            font-size: 1.5rem;
            pointer-events: none;
            animation: floatUp 2s ease-out forwards;
            z-index: 1000;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        @keyframes floatUp {
            to {
                transform: translateY(-100px);
                opacity: 0;
            }
        }

        .drag-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .drag-item {
            padding: 15px;
            background: white;
            border: 2px solid var(--border);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .drag-item:hover {
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(99, 102, 241, 0.2);
        }

        .drag-item.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .drop-zone {
            min-height: 100px;
            padding: 20px;
            background: rgba(99, 102, 241, 0.05);
            border: 2px dashed var(--primary);
            border-radius: 10px;
            margin: 10px 0;
            transition: all 0.3s;
        }

        .drop-zone.highlight {
            background: rgba(99, 102, 241, 0.1);
            border-color: var(--primary-dark);
            transform: scale(1.02);
        }

        .dropped-item {
            display: inline-block;
            padding: 8px 15px;
            background: var(--primary);
            color: white;
            border-radius: 8px;
            margin: 5px;
            animation: dropIn 0.3s ease-out;
        }

        @keyframes dropIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .canvas-container {
            border: 2px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
            background: white;
            position: relative;
        }

        #drawingCanvas {
            display: block;
            cursor: crosshair;
            touch-action: none;
        }

        .canvas-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .nav-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 20px;
        }

        .hint-box {
            background: rgba(245, 158, 11, 0.1);
            border: 2px solid var(--warning);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            display: none;
        }

        .hint-text {
            color: var(--warning);
            font-weight: 500;
        }

        .learning-outcomes {
            background: rgba(99, 102, 241, 0.05);
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 0 10px 10px 0;
            margin: 20px 0;
        }

        .learning-outcomes h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .learning-outcomes ul {
            list-style: none;
            padding: 0;
        }

        .learning-outcomes li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .learning-outcomes li::before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: bold;
        }

        .feedback-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--secondary);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(139, 92, 246, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            transition: all 0.3s;
            z-index: 100;
        }

        .feedback-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(139, 92, 246, 0.4);
        }

        .feedback-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            padding: 20px;
        }

        .feedback-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 500px;
            width: 100%;
            animation: modalSlide 0.3s ease-out;
        }

        @keyframes modalSlide {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .simulation-placeholder {
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            border: 2px dashed var(--primary);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
        }

        .simulation-placeholder h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .shame-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--danger);
            color: white;
            padding: 20px 40px;
            border-radius: 10px;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(239, 68, 68, 0.3);
            display: none;
            z-index: 10000;
            animation: shameShake 0.5s;
        }

        @keyframes shameShake {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-50%, -50%) rotate(-5deg); }
            75% { transform: translate(-50%, -50%) rotate(5deg); }
        }

        .mark-scheme {
            background: rgba(16, 185, 129, 0.05);
            border: 2px solid var(--success);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        .mark-scheme h4 {
            color: var(--success);
            margin-bottom: 10px;
        }

        .marks-input {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
        }

        .marks-input input {
            width: 80px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header {
                padding: 20px;
            }

            h1 {
                font-size: 1.8rem;
            }

            .section {
                padding: 20px;
            }

            .nav-bar {
                position: relative;
                top: auto;
            }

            .drag-container {
                grid-template-columns: 1fr;
            }

            .nav-controls {
                flex-direction: column;
            }

            .achievement-popup {
                right: 10px;
                left: 10px;
                max-width: calc(100% - 20px);
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border-width: 0;
        }

        /* Loading State */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Extension Activities */
        .extension-card {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(99, 102, 241, 0.1));
            border: 2px solid var(--secondary);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .extension-card h4 {
            color: var(--secondary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Real World Context */
        .context-box {
            background: rgba(34, 197, 94, 0.05);
            border-left: 4px solid var(--success);
            padding: 20px;
            border-radius: 0 10px 10px 0;
            margin: 20px 0;
        }

        .context-box h4 {
            color: var(--success);
            margin-bottom: 10px;
        }

        /* Common Mistakes */
        .mistakes-box {
            background: rgba(239, 68, 68, 0.05);
            border-left: 4px solid var(--danger);
            padding: 20px;
            border-radius: 0 10px 10px 0;
            margin: 20px 0;
        }

        .mistakes-box h4 {
            color: var(--danger);
            margin-bottom: 10px;
        }

        /* Interactive Elements */
        .interactive-area {
            background: rgba(99, 102, 241, 0.03);
            border: 2px solid rgba(99, 102, 241, 0.2);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .interactive-area::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(99, 102, 241, 0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }

        @keyframes rotate {
            to { transform: rotate(360deg); }
        }

        /* Touch-friendly Elements */
        @media (hover: none) {
            .btn, .quiz-option, .drag-item, .nav-item {
                padding: 15px 25px;
                font-size: 1.1rem;
            }
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
            }

            .nav-bar, .feedback-btn, .achievement-popup, .xp-float {
                display: none !important;
            }

            .section {
                display: block !important;
                page-break-after: always;
                box-shadow: none;
                border: 1px solid var(--border);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Input/Output Devices</h1>
            <p class="subtitle">A Level Computer Science - Cambridge 9618</p>
            <div class="stats-bar">
                <div class="stat-item">
                    <span class="stat-label">Level</span>
                    <span class="stat-value" id="level">0</span>
                </div>
                <div class="stat-item xp-bar">
                    <div class="xp-fill" id="xpFill"></div>
                    <span class="xp-text" id="xpText">0 / 100 XP</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Score</span>
                    <span class="stat-value" id="score">0</span>
                </div>
            </div>
        </header>

        <nav class="nav-bar" role="navigation" aria-label="Main navigation">
            <button class="nav-item active" onclick="showSection('starter')" aria-label="Starter Activity">Starter</button>
            <button class="nav-item" onclick="showSection('speakers')" aria-label="Speakers Section">Speakers</button>
            <button class="nav-item" onclick="showSection('microphones')" aria-label="Microphones Section">Microphones</button>
            <button class="nav-item" onclick="showSection('touchscreens')" aria-label="Touchscreens Section">Touchscreens</button>
            <button class="nav-item" onclick="showSection('printers')" aria-label="Printers Section">Printers</button>
            <button class="nav-item" onclick="showSection('exam')" aria-label="Exam Practice">Exam Practice</button>
            <button class="nav-item" onclick="showSection('extension')" aria-label="Extension Activities">Extension</button>
            <button class="nav-item" onclick="showSection('summary')" aria-label="Summary Quiz">Summary</button>
        </nav>

        <!-- Starter Activity -->
        <section class="section active" id="starter">
            <h2>🚀 Starter Activity: Device Detective</h2>
            
            <div class="learning-outcomes">
                <h3>Learning Outcomes</h3>
                <ul>
                    <li>Understand the components and operation of speakers and microphones</li>
                    <li>Compare resistive and capacitive touchscreen technologies</li>
                    <li>Explain the operation of laser and 3D printers</li>
                    <li>Evaluate the ethical implications of 3D printing technology</li>
                    <li>Apply knowledge to real-world scenarios</li>
                </ul>
            </div>

            <div class="task-card">
                <h3>Match the Devices to Their Functions</h3>
                <p>Click on a device, then click on its matching function. Can you match all devices correctly?</p>
                
                <div class="drag-container">
                    <div class="drag-item" data-match="speaker" onclick="selectItem(this, 'device')">Speaker</div>
                    <div class="drag-item" data-match="microphone" onclick="selectItem(this, 'device')">Microphone</div>
                    <div class="drag-item" data-match="touchscreen" onclick="selectItem(this, 'device')">Touchscreen</div>
                    <div class="drag-item" data-match="laser-printer" onclick="selectItem(this, 'device')">Laser Printer</div>
                    <div class="drag-item" data-match="3d-printer" onclick="selectItem(this, 'device')">3D Printer</div>
                </div>

                <div style="margin: 20px 0; text-align: center; font-weight: bold;">
                    ↕ Match the devices above with their functions below ↕
                </div>

                <div class="drag-container">
                    <div class="drag-item" data-match="microphone" onclick="selectItem(this, 'function')">Converts sound waves to electrical signals</div>
                    <div class="drag-item" data-match="3d-printer" onclick="selectItem(this, 'function')">Creates physical objects layer by layer</div>
                    <div class="drag-item" data-match="speaker" onclick="selectItem(this, 'function')">Converts electrical signals to sound waves</div>
                    <div class="drag-item" data-match="laser-printer" onclick="selectItem(this, 'function')">Uses toner and heat to print documents</div>
                    <div class="drag-item" data-match="touchscreen" onclick="selectItem(this, 'function')">Detects finger position for input</div>
                </div>

                <div class="feedback" id="matchingFeedback"></div>
                <button class="btn btn-primary" onclick="checkMatching()">Check Answers</button>
                <button class="btn btn-secondary" onclick="resetMatching()">Reset</button>
            </div>

            <div class="nav-controls">
                <button class="btn" disabled>Previous</button>
                <button class="btn btn-primary" onclick="showSection('speakers')">Next: Speakers →</button>
            </div>
        </section>

        <!-- Speakers Section -->
        <section class="section" id="speakers">
            <h2>🔊 Speakers</h2>
            
            <div class="task-card">
                <h3>Speaker Components - Label the Diagram</h3>
                <p>Click on each component name, then click on the corresponding number in the diagram.</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; align-items: center;">
                    <div>
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8IS0tIFNwZWFrZXIgY3Jvc3Mtc2VjdGlvbiAtLT4KICA8IS0tIE91dGVyIGZyYW1lIC0tPgogIDxyZWN0IHg9IjUwIiB5PSI1MCIgd2lkdGg9IjMwMCIgaGVpZ2h0PSIyMDAiIGZpbGw9IiM0NDQ0NDQiIHN0cm9rZT0iIzIyMjIyMiIgc3Ryb2tlLXdpZHRoPSIzIi8+CiAgCiAgPCEtLSBDb25lL0RpYXBocmFnbSAtLT4KICA8cGF0aCBkPSJNIDI1MCwxNTAgTCAzMjAsODAgTCAzMjAsMjIwIFoiIGZpbGw9IiNmZmNjNjYiIHN0cm9rZT0iIzMzMzMzMyIgc3Ryb2tlLXdpZHRoPSIyIi8+CiAgPGNpcmNsZSBjeD0iMzM1IiBjeT0iODAiIHI9IjE1IiBmaWxsPSJub25lIiBzdHJva2U9InJlZCIgc3Ryb2tlLXdpZHRoPSIzIi8+CiAgPHRleHQgeD0iMzMwIiB5PSI4NSIgZm9udC1zaXplPSIxNiIgZmlsbD0icmVkIiBmb250LXdlaWdodD0iYm9sZCI+MTwvdGV4dD4KICAKICA8IS0tIE1hZ25ldCAtLT4KICA8cmVjdCB4PSIxMDAiIHk9IjEyMCIgd2lkdGg9IjgwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjOTk5OTk5IiBzdHJva2U9IiMzMzMzMzMiIHN0cm9rZS13aWR0aD0iMiIvPgogIDxjaXJjbGUgY3g9IjE0MCIgY3k9IjEwMCIgcj0iMTUiIGZpbGw9Im5vbmUiIHN0cm9rZT0icmVkIiBzdHJva2Utd2lkdGg9IjMiLz4KICA8dGV4dCB4PSIxMzUiIHk9IjEwNSIgZm9udC1zaXplPSIxNiIgZmlsbD0icmVkIiBmb250LXdlaWdodD0iYm9sZCI+MjwvdGV4dD4KICAKICA8IS0tIFZvaWNlIENvaWwgLS0+CiAgPHJlY3QgeD0iMTkwIiB5PSIxMzAiIHdpZHRoPSI1MCIgaGVpZ2h0PSI0MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjZmY2NjAwIiBzdHJva2Utd2lkdGg9IjMiLz4KICA8Y2lyY2xlIGN4PSIyMTUiIGN5PSIxMTAiIHI9IjE1IiBmaWxsPSJub25lIiBzdHJva2U9InJlZCIgc3Ryb2tlLXdpZHRoPSIzIi8+CiAgPHRleHQgeD0iMjEwIiB5PSIxMTUiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9InJlZCIgZm9udC13ZWlnaHQ9ImJvbGQiPjM8L3RleHQ+CiAgCiAgPCEtLSBTcGlkZXIvU3VzcGVuc2lvbiAtLT4KICA8Y2lyY2xlIGN4PSIyMTUiIGN5PSIxNTAiIHI9IjQwIiBmaWxsPSJub25lIiBzdHJva2U9IiM2NjY2NjYiIHN0cm9rZS13aWR0aD0iMyIgc3Ryb2tlLWRhc2hhcnJheT0iNSw1Ii8+CiAgPGNpcmNsZSBjeD0iMjE1IiBjeT0iMTkwIiByPSIxNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZWQiIHN0cm9rZS13aWR0aD0iMyIvPgogIDx0ZXh0IHg9IjIxMCIgeT0iMTk1IiBmb250LXNpemU9IjE2IiBmaWxsPSJyZWQiIGZvbnQtd2VpZ2h0PSJib2xkIj40PC90ZXh0PgogIAogIDwhLS0gQmFza2V0IC0tPgogIDxjaXJjbGUgY3g9IjgwIiBjeT0iMTUwIiByPSIxNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZWQiIHN0cm9rZS13aWR0aD0iMyIvPgogIDx0ZXh0IHg9Ijc1IiB5PSIxNTUiIGZvbnQtc2l6ZT0iMTYiIGZpbGw9InJlZCIgZm9udC13ZWlnaHQ9ImJvbGQiPjU8L3RleHQ+CiAgCiAgPCEtLSBEdXN0IENhcCAtLT4KICA8Y2lyY2xlIGN4PSIyNTAiIGN5PSIxNTAiIHI9IjIwIiBmaWxsPSIjMzMzMzMzIi8+CiAgPGNpcmNsZSBjeD0iMjcwIiBjeT0iMTUwIiByPSIxNSIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJyZWQiIHN0cm9rZS13aWR0aD0iMyIvPgogIDx0ZXh0IHg9IjI2NSIgeT0iMTU1IiBmb250LXNpemU9IjE2IiBmaWxsPSJyZWQiIGZvbnQtd2VpZ2h0PSJib2xkIj42PC90ZXh0Pgo8L3N2Zz4=" alt="Speaker cross-section diagram" style="width: 100%; background: white; border-radius: 10px; padding: 10px;">
                    </div>
                    <div>
                        <div class="drag-container">
                            <div class="drag-item" data-label="1" onclick="selectLabel(this)">Diaphragm/Cone</div>
                            <div class="drag-item" data-label="2" onclick="selectLabel(this)">Permanent Magnet</div>
                            <div class="drag-item" data-label="3" onclick="selectLabel(this)">Voice Coil</div>
                            <div class="drag-item" data-label="4" onclick="selectLabel(this)">Spider/Suspension</div>
                            <div class="drag-item" data-label="5" onclick="selectLabel(this)">Basket</div>
                            <div class="drag-item" data-label="6" onclick="selectLabel(this)">Dust Cap</div>
                        </div>
                    </div>
                </div>
                
                <div class="feedback" id="labelingFeedback"></div>
                <button class="btn btn-primary" onclick="checkLabeling()">Check Labels</button>
                <button class="btn btn-secondary" onclick="resetLabeling()">Reset</button>
            </div>

            <div class="simulation-placeholder">
                <h4>🎵 Speaker Operation Simulation</h4>
                <p>Interactive simulation showing how electrical signals are converted to sound waves through electromagnetic interaction.</p>
                <p><em>Placeholder for speaker operation simulation with step-by-step controls</em></p>
            </div>

            <div class="task-card">
                <h3>Speaker Operation Sequence</h3>
                <p>Fill in the blanks to complete the speaker operation process. Choose from the options provided.</p>
                
                <div class="fill-blanks">
                    <p>1. <select id="blank1" class="blank-select">
                        <option value="">Select...</option>
                        <option value="analog-to-digital">Analog-to-digital</option>
                        <option value="digital-to-analog">Digital-to-analog</option>
                        <option value="digital-to-digital">Digital-to-digital</option>
                        <option value="analog-to-analog">Analog-to-analog</option>
                    </select> conversion precedes speaker operation.</p>
                    
                    <p>2. Electric current in the coil generates an <select id="blank2" class="blank-select">
                        <option value="">Select...</option>
                        <option value="electromagnetic field">electromagnetic field</option>
                        <option value="gravitational field">gravitational field</option>
                        <option value="thermal field">thermal field</option>
                        <option value="static field">static field</option>
                    </select>.</p>
                    
                    <p>3. Current direction changes affect the electro-magnet's <select id="blank3" class="blank-select">
                        <option value="">Select...</option>
                        <option value="temperature">temperature</option>
                        <option value="polarity">polarity</option>
                        <option value="size">size</option>
                        <option value="resistance">resistance</option>
                    </select>.</p>
                    
                    <p>4. Coil movement transfers vibrations to the <select id="blank4" class="blank-select">
                        <option value="">Select...</option>
                        <option value="magnet">magnet</option>
                        <option value="basket">basket</option>
                        <option value="cone/diaphragm">cone/diaphragm</option>
                        <option value="wire">wire</option>
                    </select>.</p>
                </div>
                
                <div class="feedback" id="fillBlanksFeedback"></div>
                <button class="btn btn-primary" onclick="checkFillBlanks()">Check Answers</button>
                <button class="btn btn-secondary" onclick="resetFillBlanks()">Reset</button>
                <button class="btn btn-warning" onclick="showHint('speaker-fill')">Hint (-5 XP)</button>
                
                <div class="hint-box" id="hint-speaker-fill">
                    <p class="hint-text">💡 Think about the flow: Digital data → Analog signals → Magnetic fields → Physical movement → Sound waves</p>
                </div>
            </div>

            <div class="context-box">
                <h4>🌍 Real-World Context</h4>
                <p>Speakers are everywhere in our daily lives - from tiny smartphone speakers using piezoelectric technology to massive concert speakers with multiple drivers. Modern smart speakers like Amazon Echo use beam-forming technology with multiple speakers to direct sound in specific directions!</p>
            </div>

            <div class="nav-controls">
                <button class="btn" onclick="showSection('starter')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('microphones')">Next: Microphones →</button>
            </div>
        </section>

        <!-- Microphones Section -->
        <section class="section" id="microphones">
            <h2>🎤 Microphones</h2>
            
            <div class="task-card">
                <h3>Types of Microphones</h3>
                <p>Complete this comparison table by selecting the correct characteristics for each microphone type.</p>
                
                <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                    <thead>
                        <tr style="background: var(--primary); color: white;">
                            <th style="padding: 15px; text-align: left;">Feature</th>
                            <th style="padding: 15px; text-align: center;">Dynamic Microphone</th>
                            <th style="padding: 15px; text-align: center;">Condenser Microphone</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr style="background: var(--light);">
                            <td style="padding: 15px; border: 1px solid var(--border);">Operating Principle</td>
                            <td style="padding: 15px; border: 1px solid var(--border);">
                                <select id="dynamic1" style="width: 100%;">
                                    <option value="">Select...</option>
                                    <option value="coil-magnet">Coil moves past magnet</option>
                                    <option value="capacitance">Changes capacitance</option>
                                    <option value="resistance">Changes resistance</option>
                                    <option value="piezo">Piezoelectric effect</option>
                                </select>
                            </td>
                            <td style="padding: 15px; border: 1px solid var(--border);">
                                <select id="condenser1" style="width: 100%;">
                                    <option value="">Select...</option>
                                    <option value="coil-magnet">Coil moves past magnet</option>
                                    <option value="capacitance">Changes capacitance</option>
                                    <option value="resistance">Changes resistance</option>
                                    <option value="piezo">Piezoelectric effect</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td style="padding: 15px; border: 1px solid var(--border);">Power Required</td>
                            <td style="padding: 15px; border: 1px solid var(--border);">
                                <select id="dynamic2" style="width: 100%;">
                                    <option value="">Select...</option>
                                    <option value="yes">Yes (phantom power)</option>
                                    <option value="no">No power needed</option>
                                    <option value="battery">Battery only</option>
                                </select>
                            </td>
                            <td style="padding: 15px; border: 1px solid var(--border);">
                                <select id="condenser2" style="width: 100%;">
                                    <option value="">Select...</option>
                                    <option value="yes">Yes (phantom power)</option>
                                    <option value="no">No power needed</option>
                                    <option value="battery">Battery only</option>
                                </select>
                            </td>
                        </tr>
                    </tbody>
                </table>
                
                <div class="feedback" id="micComparisonFeedback"></div>
                <button class="btn btn-primary" onclick="checkMicComparison()">Check Answers</button>
                <button class="btn btn-secondary" onclick="resetMicComparison()">Reset</button>
            </div>

            <div class="simulation-placeholder">
                <h4>🎙️ Microphone Operation Simulation</h4>
                <p>Interactive simulation showing how sound waves are converted to electrical signals in both dynamic and condenser microphones.</p>
                <p><em>Placeholder for microphone operation simulation with step-by-step controls</em></p>
            </div>

            <div class="task-card">
                <h3>True or False: Microphone Facts</h3>
                <div class="quiz-options" id="trueFalseQuiz">
                    <div class="quiz-option" onclick="selectTrueFalse(this, 'q1', true)">
                        <strong>Statement 1:</strong> The microphone's diaphragm vibrates when sound waves hit it.
                        <br><span style="margin-left: 20px;">True / False</span>
                    </div>
                    <div class="quiz-option" onclick="selectTrueFalse(this, 'q2', false)">
                        <strong>Statement 2:</strong> Dynamic microphones require phantom power to operate.
                        <br><span style="margin-left: 20px;">True / False</span>
                    </div>
                    <div class="quiz-option" onclick="selectTrueFalse(this, 'q3', true)">
                        <strong>Statement 3:</strong> An ADC is needed to store microphone signals digitally.
                        <br><span style="margin-left: 20px;">True / False</span>
                    </div>
                </div>
                <div class="feedback" id="trueFalseFeedback"></div>
                <button class="btn btn-primary" onclick="checkTrueFalse()">Check Answers</button>
                <button class="btn btn-secondary" onclick="resetTrueFalse()">Reset</button>
            </div>

            <div class="mistakes-box">
                <h4>⚠️ Common Mistakes</h4>
                <ul>
                    <li>Confusing ADC with DAC - remember: Microphones need ADC (Analog-to-Digital), Speakers need DAC (Digital-to-Analog)</li>
                    <li>Thinking all microphones work the same way - dynamic and condenser have very different mechanisms</li>
                    <li>Forgetting that condenser microphones need power (phantom power) to operate</li>
                </ul>
            </div>

            <div class="nav-controls">
                <button class="btn" onclick="showSection('speakers')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('touchscreens')">Next: Touchscreens →</button>
            </div>
        </section>

        <!-- Touchscreens Section -->
        <section class="section" id="touchscreens">
            <h2>📱 Touchscreens</h2>
            
            <div class="task-card">
                <h3>Categorize the Features</h3>
                <p>Click on each feature to categorize it as belonging to Resistive or Capacitive touchscreens.</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <h4 style="text-align: center; color: var(--primary);">Resistive</h4>
                        <div class="drop-zone" id="resistiveZone"></div>
                    </div>
                    <div>
                        <h4 style="text-align: center; color: var(--secondary);">Capacitive</h4>
                        <div class="drop-zone" id="capacitiveZone"></div>
                    </div>
                </div>
                
                <div class="drag-container" id="touchFeatures">
                    <div class="drag-item" data-type="resistive" onclick="categorizeFeature(this)">Uses pressure to complete circuit</div>
                    <div class="drag-item" data-type="capacitive" onclick="categorizeFeature(this)">Multi-touch capability</div>
                    <div class="drag-item" data-type="resistive" onclick="categorizeFeature(this)">Works with gloves</div>
                    <div class="drag-item" data-type="capacitive" onclick="categorizeFeature(this)">Uses charge transfer</div>
                    <div class="drag-item" data-type="resistive" onclick="categorizeFeature(this)">Poor visibility in sunlight</div>
                    <div class="drag-item" data-type="capacitive" onclick="categorizeFeature(this)">Good visibility in sunlight</div>
                    <div class="drag-item" data-type="resistive" onclick="categorizeFeature(this)">Lower cost technology</div>
                    <div class="drag-item" data-type="capacitive" onclick="categorizeFeature(this)">Very durable glass surface</div>
                </div>
                
                <div class="feedback" id="categorizeFeedback"></div>
                <button class="btn btn-primary" onclick="checkCategorization()">Check Answers</button>
                <button class="btn btn-secondary" onclick="resetCategorization()">Reset</button>
            </div>

            <div class="simulation-placeholder">
                <h4>👆 Touchscreen Technology Simulation</h4>
                <p>Interactive simulation showing how resistive and capacitive touchscreens detect touch input differently.</p>
                <p><em>Placeholder for touchscreen operation simulation with step-by-step controls</em></p>
            </div>

            <div class="task-card">
                <h3>Scenario-Based Questions</h3>
                <p>For each scenario, select the most appropriate touchscreen technology and explain why.</p>
                
                <div class="interactive-area">
                    <h4>Scenario 1: Industrial Control Panel</h4>
                    <p>A factory needs touchscreens for control panels where workers wear thick safety gloves.</p>
                    <select id="scenario1" style="margin: 10px 0;">
                        <option value="">Choose technology...</option>
                        <option value="resistive">Resistive</option>
                        <option value="capacitive">Capacitive</option>
                    </select>
                    <textarea id="scenario1reason" placeholder="Explain your choice..." rows="3" style="margin-top: 10px;"></textarea>
                </div>
                
                <div class="interactive-area" style="margin-top: 20px;">
                    <h4>Scenario 2: Modern Smartphone</h4>
                    <p>A smartphone manufacturer wants to implement pinch-to-zoom and multi-finger gestures.</p>
                    <select id="scenario2" style="margin: 10px 0;">
                        <option value="">Choose technology...</option>
                        <option value="resistive">Resistive</option>
                        <option value="capacitive">Capacitive</option>
                    </select>
                    <textarea id="scenario2reason" placeholder="Explain your choice..." rows="3" style="margin-top: 10px;"></textarea>
                </div>
                
                <div class="feedback" id="scenarioFeedback"></div>
                <button class="btn btn-primary" onclick="checkScenarios()">Submit Answers</button>
                <button class="btn btn-secondary" onclick="resetScenarios()">Reset</button>
            </div>

            <div class="context-box">
                <h4>🌍 Real-World Applications</h4>
                <ul>
                    <li><strong>ATMs:</strong> Often use resistive screens for reliability and glove compatibility</li>
                    <li><strong>Smartphones/Tablets:</strong> Exclusively capacitive for multi-touch support</li>
                    <li><strong>Industrial Equipment:</strong> Resistive for harsh environments</li>
                    <li><strong>Information Kiosks:</strong> Capacitive for better user experience</li>
                    <li><strong>Medical Devices:</strong> Often resistive for precision and hygiene (glove use)</li>
                </ul>
            </div>

            <div class="nav-controls">
                <button class="btn" onclick="showSection('microphones')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('printers')">Next: Printers →</button>
            </div>
        </section>

        <!-- Printers Section -->
        <section class="section" id="printers">
            <h2>🖨️ Printers</h2>
            
            <div class="task-card">
                <h3>Laser Printer Operation Sequence</h3>
                <p>Arrange these steps in the correct order by clicking them in sequence.</p>
                
                <div class="drag-container" id="laserSteps">
                    <div class="drag-item" data-order="2" onclick="selectSequence(this)">Laser beam scans across drum, discharging points</div>
                    <div class="drag-item" data-order="1" onclick="selectSequence(this)">Drum is given initial electrical charge</div>
                    <div class="drag-item" data-order="5" onclick="selectSequence(this)">Paper passes through fuser to seal image</div>
                    <div class="drag-item" data-order="3" onclick="selectSequence(this)">Drum coated with oppositely charged toner</div>
                    <div class="drag-item" data-order="6" onclick="selectSequence(this)">Electrical charge removed from drum</div>
                    <div class="drag-item" data-order="4" onclick="selectSequence(this)">Pattern transferred to charged paper</div>
                </div>
                
                <div class="drop-zone" id="sequenceZone" style="min-height: 200px;">
                    <p style="text-align: center; color: #999;">Click steps above in the correct order</p>
                </div>
                
                <div class="feedback" id="sequenceFeedback"></div>
                <button class="btn btn-primary" onclick="checkSequence()">Check Order</button>
                <button class="btn btn-secondary" onclick="resetSequence()">Reset</button>
            </div>

            <div class="simulation-placeholder">
                <h4>🖨️ Laser Printer Operation Simulation</h4>
                <p>Interactive simulation showing the complete laser printing process from charging to fusing.</p>
                <p><em>Placeholder for laser printer operation simulation with step-by-step controls</em></p>
            </div>

            <div class="task-card">
                <h3>3D Printing Ethics Evaluation</h3>
                <p>Evaluate these statements about 3D printing ethics. Rate each from 1 (least concerning) to 5 (most concerning).</p>
                
                <div class="interactive-area">
                    <div style="margin: 15px 0;">
                        <p><strong>High energy consumption during printing</strong></p>
                        <input type="range" id="ethics1" min="1" max="5" value="3" style="width: 100%;">
                        <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: #666;">
                            <span>1 - Low concern</span>
                            <span>5 - High concern</span>
                        </div>
                    </div>
                    
                    <div style="margin: 15px 0;">
                        <p><strong>Potential for printing weapons</strong></p>
                        <input type="range" id="ethics2" min="1" max="5" value="3" style="width: 100%;">
                    </div>
                    
                    <div style="margin: 15px 0;">
                        <p><strong>Copyright and licensing issues</strong></p>
                        <input type="range" id="ethics3" min="1" max="5" value="3" style="width: 100%;">
                    </div>
                    
                    <div style="margin: 15px 0;">
                        <p><strong>Plastic waste and environmental impact</strong></p>
                        <input type="range" id="ethics4" min="1" max="5" value="3" style="width: 100%;">
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <p><strong>Justify your highest concern rating:</strong></p>
                        <textarea id="ethicsJustification" rows="4" placeholder="Explain why you rated one issue as most concerning..."></textarea>
                    </div>
                </div>
                
                <div class="feedback" id="ethicsFeedback"></div>
                <button class="btn btn-primary" onclick="checkEthics()">Submit Evaluation</button>
                <button class="btn btn-secondary" onclick="resetEthics()">Reset</button>
            </div>

            <div class="simulation-placeholder">
                <h4>🏗️ 3D Printer Operation Simulation</h4>
                <p>Interactive simulation showing how 3D printers build objects layer by layer using CAD data.</p>
                <p><em>Placeholder for 3D printer operation simulation with step-by-step controls</em></p>
            </div>

            <div class="task-card">
                <h3>3D Printing Applications</h3>
                <p>Match each application with its primary benefit.</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h4>Applications</h4>
                        <div class="drag-item" onclick="selectApp(this, 'rapid')">Rapid Prototyping</div>
                        <div class="drag-item" onclick="selectApp(this, 'medical')">Medical Implants</div>
                        <div class="drag-item" onclick="selectApp(this, 'space')">Spacecraft Parts</div>
                        <div class="drag-item" onclick="selectApp(this, 'art')">Artwork & Jewelry</div>
                    </div>
                    <div>
                        <h4>Benefits</h4>
                        <div class="drag-item" onclick="selectBenefit(this, 'rapid')">Quick design iteration</div>
                        <div class="drag-item" onclick="selectBenefit(this, 'medical')">Custom fit to patient</div>
                        <div class="drag-item" onclick="selectBenefit(this, 'space')">Lightweight & strong</div>
                        <div class="drag-item" onclick="selectBenefit(this, 'art')">Complex geometries</div>
                    </div>
                </div>
                
                <div class="feedback" id="applicationsFeedback"></div>
                <button class="btn btn-primary" onclick="checkApplications()">Check Matches</button>
                <button class="btn btn-secondary" onclick="resetApplications()">Reset</button>
            </div>

            <div class="nav-controls">
                <button class="btn" onclick="showSection('touchscreens')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('exam')">Next: Exam Practice →</button>
            </div>
        </section>

        <!-- Exam Practice Section -->
        <section class="section" id="exam">
            <h2>📝 Practice Exam Questions</h2>
            
            <div class="task-card">
                <h3>Question 1 - Speaker Operation [6 marks]</h3>
                <p>Explain how a speaker converts electrical signals into sound waves. Include in your answer:</p>
                <ul>
                    <li>The role of the voice coil and permanent magnet</li>
                    <li>How the audio signal affects the electromagnetic field</li>
                    <li>The purpose of the cone/diaphragm</li>
                </ul>
                
                <textarea id="examQ1" rows="8" placeholder="Write your answer here..."></textarea>
                
                <div class="marks-input">
                    <label>Predicted marks:</label>
                    <input type="number" id="q1marks" min="0" max="6" placeholder="0-6">
                    <button class="btn btn-primary" onclick="revealMarkScheme('q1')">Show Mark Scheme</button>
                </div>
                
                <div class="mark-scheme" id="markScheme-q1">
                    <h4>Mark Scheme</h4>
                    <ul>
                        <li>[1] Voice coil wrapped around permanent magnet / positioned in magnetic field</li>
                        <li>[1] Electrical current creates electromagnetic field in coil</li>
                        <li>[1] Changing audio signal changes current direction</li>
                        <li>[1] Interaction between electromagnetic field and permanent magnet causes movement</li>
                        <li>[1] Coil movement transfers to cone/diaphragm</li>
                        <li>[1] Cone vibrations create pressure waves in air / sound waves</li>
                    </ul>
                </div>
            </div>

            <div class="task-card">
                <h3>Question 2 - Touchscreen Comparison [8 marks]</h3>
                <p>Compare and contrast resistive and capacitive touchscreen technologies.</p>
                
                <textarea id="examQ2" rows="8" placeholder="Write your answer here..."></textarea>
                
                <div class="marks-input">
                    <label>Predicted marks:</label>
                    <input type="number" id="q2marks" min="0" max="8" placeholder="0-8">
                    <button class="btn btn-primary" onclick="revealMarkScheme('q2')">Show Mark Scheme</button>
                </div>
                
                <div class="mark-scheme" id="markScheme-q2">
                    <h4>Mark Scheme</h4>
                    <p><strong>Resistive (up to 4 marks):</strong></p>
                    <ul>
                        <li>[1] Uses two charged layers that touch when pressed</li>
                        <li>[1] Works with any input (finger, stylus, gloves)</li>
                        <li>[1] Lower cost technology</li>
                        <li>[1] Poor sunlight visibility / No multi-touch</li>
                    </ul>
                    <p><strong>Capacitive (up to 4 marks):</strong></p>
                    <ul>
                        <li>[1] Detects change in electrical charge/capacitance</li>
                        <li>[1] Requires conductive input (bare finger)</li>
                        <li>[1] Supports multi-touch gestures</li>
                        <li>[1] Better durability / Good sunlight visibility</li>
                    </ul>
                </div>
            </div>

            <div class="task-card">
                <h3>Question 3 - 3D Printing Ethics [5 marks]</h3>
                <p>Discuss three ethical concerns related to 3D printing technology.</p>
                
                <textarea id="examQ3" rows="6" placeholder="Write your answer here..."></textarea>
                
                <div class="marks-input">
                    <label>Predicted marks:</label>
                    <input type="number" id="q3marks" min="0" max="5" placeholder="0-5">
                    <button class="btn btn-primary" onclick="revealMarkScheme('q3')">Show Mark Scheme</button>
                </div>
                
                <div class="mark-scheme" id="markScheme-q3">
                    <h4>Mark Scheme</h4>
                    <p>Any three from (1 mark for concern, 1 mark for explanation):</p>
                    <ul>
                        <li>[1+1] Copyright/IP infringement - Easy reproduction of patented designs</li>
                        <li>[1+1] Weapon printing - Potential for untraceable firearms</li>
                        <li>[1+1] Environmental impact - High energy use and plastic waste</li>
                        <li>[1+1] Drug printing - Unregulated pharmaceutical production</li>
                        <li>[1+1] Bio-printing regulation - Ethical issues with printing organs/tissue</li>
                    </ul>
                    <p>Max 5 marks total</p>
                </div>
            </div>

            <div class="task-card">
                <h3>Drawing Space - Calculations</h3>
                <p>Use this space for any calculations or diagrams needed for your answers.</p>
                
                <div class="canvas-container">
                    <canvas id="drawingCanvas" width="800" height="400"></canvas>
                </div>
                <div class="canvas-controls">
                    <button class="btn btn-secondary" onclick="clearCanvas()">Clear Canvas</button>
                    <label>Color: <input type="color" id="penColor" value="#000000"></label>
                    <label>Width: <input type="range" id="penWidth" min="1" max="10" value="2"></label>
                </div>
            </div>

            <div class="nav-controls">
                <button class="btn" onclick="showSection('printers')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('extension')">Next: Extension →</button>
            </div>
        </section>

        <!-- Extension Section -->
        <section class="section" id="extension">
            <h2>🚀 Extension Activities</h2>
            
            <div class="extension-card">
                <h4>🔬 Research Task: Emerging Technologies</h4>
                <p>Choose ONE of the following emerging input/output technologies to research:</p>
                <ul>
                    <li>Brain-Computer Interfaces (BCIs)</li>
                    <li>Holographic Displays</li>
                    <li>Haptic Feedback Suits</li>
                    <li>Ultrasonic Mid-air Haptics</li>
                    <li>Retinal Projection Displays</li>
                </ul>
                
                <div style="margin-top: 20px;">
                    <p><strong>Your Research (minimum 200 words):</strong></p>
                    <textarea id="extensionResearch" rows="10" placeholder="Include: How it works, current applications, future potential, limitations..."></textarea>
                    <button class="btn btn-primary" onclick="submitExtension('research')">Submit Research</button>
                </div>
            </div>

            <div class="extension-card">
                <h4>💡 Design Challenge</h4>
                <p>Design a new input device for people with limited mobility. Consider:</p>
                <ul>
                    <li>What sensors would you use?</li>
                    <li>How would it detect user input?</li>
                    <li>What feedback would it provide?</li>
                    <li>How would it connect to devices?</li>
                </ul>
                
                <div style="margin-top: 20px;">
                    <textarea id="extensionDesign" rows="8" placeholder="Describe your design..."></textarea>
                    <button class="btn btn-primary" onclick="submitExtension('design')">Submit Design</button>
                </div>
            </div>

            <div class="extension-card">
                <h4>🧮 Technical Challenge</h4>
                <p>Calculate the data rate required for a touchscreen that:</p>
                <ul>
                    <li>Has resolution of 1920×1080 pixels</li>
                    <li>Samples touch at 120Hz</li>
                    <li>Records X, Y coordinates (16 bits each)</li>
                    <li>Records pressure (8 bits)</li>
                    <li>Supports 10 simultaneous touches</li>
                </ul>
                
                <div style="margin-top: 20px;">
                    <textarea id="extensionCalc" rows="6" placeholder="Show your working and final answer in Mbps..."></textarea>
                    <button class="btn btn-primary" onclick="submitExtension('calc')">Submit Calculation</button>
                </div>
            </div>

            <div class="nav-controls">
                <button class="btn" onclick="showSection('exam')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('summary')">Next: Summary →</button>
            </div>
        </section>

        <!-- Summary Section -->
        <section class="section" id="summary">
            <h2>✅ Summary Quiz</h2>
            
            <div class="task-card">
                <h3>Final Assessment</h3>
                <p>Test your understanding with these comprehensive questions.</p>
                
                <div class="quiz-question">
                    <h4>Question 1: Which conversion is needed before speaker operation?</h4>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final1', 'a')">A) Analog-to-Digital Conversion</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final1', 'b')">B) Digital-to-Analog Conversion</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final1', 'c')">C) Digital-to-Digital Conversion</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final1', 'd')">D) No conversion needed</div>
                    </div>
                </div>

                <div class="quiz-question" style="margin-top: 30px;">
                    <h4>Question 2: What makes capacitive touchscreens unsuitable for use with regular gloves?</h4>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final2', 'a')">A) They detect pressure changes</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final2', 'b')">B) They require electrical conductivity</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final2', 'c')">C) They use infrared sensors</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final2', 'd')">D) They measure temperature</div>
                    </div>
                </div>

                <div class="quiz-question" style="margin-top: 30px;">
                    <h4>Question 3: In a laser printer, what attracts toner to specific areas?</h4>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final3', 'a')">A) Heat from the fuser</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final3', 'b')">B) Electrical charge patterns</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final3', 'c')">C) Magnetic fields</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final3', 'd')">D) Air pressure</div>
                    </div>
                </div>

                <div class="quiz-question" style="margin-top: 30px;">
                    <h4>Question 4: Which microphone type requires phantom power?</h4>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final4', 'a')">A) Dynamic microphone</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final4', 'b')">B) Condenser microphone</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final4', 'c')">C) Both types</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final4', 'd')">D) Neither type</div>
                    </div>
                </div>

                <div class="quiz-question" style="margin-top: 30px;">
                    <h4>Question 5: What is the primary ethical concern with 3D printed weapons?</h4>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final5', 'a')">A) High cost of materials</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final5', 'b')">B) Untraceability and regulation</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final5', 'c')">C) Slow printing speed</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final5', 'd')">D) Copyright infringement</div>
                    </div>
                </div>

                <div class="quiz-question" style="margin-top: 30px;">
                    <h4>Question 6: Which component vibrates to create sound waves in a speaker?</h4>
                    <div class="quiz-options">
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final6', 'a')">A) Voice coil</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final6', 'b')">B) Permanent magnet</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final6', 'c')">C) Cone/Diaphragm</div>
                        <div class="quiz-option" onclick="selectQuizOption(this, 'final6', 'd')">D) Basket</div>
                    </div>
                </div>

                <div style="margin-top: 30px;">
                    <button class="btn btn-success" onclick="checkFinalQuiz()">Submit Final Quiz</button>
                    <button class="btn btn-secondary" onclick="resetFinalQuiz()">Reset Quiz</button>
                </div>
                
                <div class="feedback" id="finalQuizFeedback"></div>
            </div>

            <div class="task-card" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.1), rgba(34, 197, 94, 0.1)); border: 2px solid var(--success);">
                <h3>🎉 Completion Certificate</h3>
                <div id="completionStats" style="display: none;">
                    <p style="font-size: 1.2rem; text-align: center; margin: 20px 0;">
                        Congratulations! You've completed the Input/Output Devices lesson!
                    </p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin: 30px 0;">
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--primary); font-weight: bold;" id="finalLevel">0</div>
                            <div>Final Level</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--success); font-weight: bold;" id="finalXP">0</div>
                            <div>Total XP</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--warning); font-weight: bold;" id="finalScore">0</div>
                            <div>Final Score</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 2rem; color: var(--secondary); font-weight: bold;" id="achievementCount">0</div>
                            <div>Achievements</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="task-card">
                <h3>📹 Video Resources</h3>
                <p><em>Additional video tutorials and demonstrations will be added here to reinforce learning.</em></p>
                <div style="background: var(--light); padding: 40px; text-align: center; border-radius: 10px; margin: 20px 0;">
                    <p style="color: #666;">Video playlist placeholder</p>
                </div>
            </div>

            <div class="nav-controls">
                <button class="btn" onclick="showSection('extension')">← Previous</button>
                <button class="btn btn-success" onclick="completeLesson()">Complete Lesson</button>
            </div>
        </section>
    </div>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <h4>🏆 Achievement Unlocked!</h4>
        <p id="achievementText"></p>
    </div>

    <!-- Shame Message -->
    <div class="shame-message" id="shameMessage">
        🚫 Pasting is disabled! Type your own answers.
    </div>

    <!-- Feedback Button -->
    <button class="feedback-btn" onclick="openFeedback()" aria-label="Send Feedback">
        💬
    </button>

    <!-- Feedback Modal -->
    <div class="feedback-modal" id="feedbackModal">
        <div class="feedback-content">
            <h3>Send Feedback</h3>
            <p>Found a bug or have a suggestion? Let us know!</p>
            <p><strong>Current Section:</strong> <span id="currentSection"></span></p>
            <textarea id="feedbackText" rows="5" placeholder="Describe the issue or suggestion..."></textarea>
            <div style="margin-top: 20px; display: flex; gap: 10px;">
                <button class="btn btn-primary" onclick="sendFeedback()">Send</button>
                <button class="btn btn-secondary" onclick="closeFeedback()">Cancel</button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            level: 0,
            xp: 0,
            score: 0,
            achievements: new Set(),
            completedTasks: new Set(),
            currentSection: 'starter',
            xpActions: new Set()
        };

        // XP Requirements per level
        const XP_PER_LEVEL = 100;
        const MAX_LEVEL = 5;

        // Achievement definitions
        const achievements = {
            firstStep: { name: "First Steps", description: "Complete your first task", xp: 10 },
            perfectMatch: { name: "Perfect Match", description: "Complete matching without mistakes", xp: 20 },
            speakerExpert: { name: "Speaker Expert", description: "Complete all speaker tasks", xp: 30 },
            touchMaster: { name: "Touch Master", description: "Master touchscreen technologies", xp: 30 },
            ethicsChampion: { name: "Ethics Champion", description: "Complete ethics evaluation", xp: 25 },
            examReady: { name: "Exam Ready", description: "Complete all practice questions", xp: 40 },
            researcher: { name: "Researcher", description: "Complete an extension activity", xp: 35 },
            completionist: { name: "Completionist", description: "Complete the entire lesson", xp: 50 }
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            initializeCanvas();
            preventPasting();
        });

        // Section Navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Update nav bar
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update current section
            gameState.currentSection = sectionId;
            
            // Award XP for section navigation (once per section)
            if (!gameState.xpActions.has(`nav-${sectionId}`)) {
                awardXP(5, `Explored ${sectionId} section`);
                gameState.xpActions.add(`nav-${sectionId}`);
            }
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // XP and Stats Management
        function awardXP(amount, reason) {
            if (gameState.level >= MAX_LEVEL) return;
            
            gameState.xp += amount;
            gameState.score += amount;
            
            // Show floating XP
            showFloatingXP(amount);
            
            // Check for level up
            while (gameState.xp >= XP_PER_LEVEL && gameState.level < MAX_LEVEL) {
                gameState.xp -= XP_PER_LEVEL;
                gameState.level++;
                showAchievement("Level Up!", `You reached Level ${gameState.level}!`);
                
                // Particle effect for level up
                createParticleEffect();
            }
            
            updateStats();
        }

        function showFloatingXP(amount) {
            const xpFloat = document.createElement('div');
            xpFloat.className = 'xp-float';
            xpFloat.textContent = `+${amount} XP`;
            xpFloat.style.left = Math.random() * window.innerWidth + 'px';
            xpFloat.style.top = Math.random() * window.innerHeight + 'px';
            document.body.appendChild(xpFloat);
            
            setTimeout(() => xpFloat.remove(), 2000);
        }

        function updateStats() {
            document.getElementById('level').textContent = gameState.level;
            document.getElementById('score').textContent = gameState.score;
            document.getElementById('xpText').textContent = `${gameState.xp} / ${XP_PER_LEVEL} XP`;
            
            const xpPercentage = (gameState.xp / XP_PER_LEVEL) * 100;
            document.getElementById('xpFill').style.width = xpPercentage + '%';
        }

        function showAchievement(title, description) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementText').textContent = description;
            popup.style.display = 'block';
            
            setTimeout(() => {
                popup.style.display = 'none';
            }, 3000);
        }

        function unlockAchievement(achievementId) {
            if (!gameState.achievements.has(achievementId)) {
                gameState.achievements.add(achievementId);
                const achievement = achievements[achievementId];
                showAchievement(achievement.name, achievement.description);
                awardXP(achievement.xp, `Achievement: ${achievement.name}`);
            }
        }

        function createParticleEffect() {
            // Simple particle effect for level up
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.style.position = 'fixed';
                particle.style.width = '10px';
                particle.style.height = '10px';
                particle.style.background = `hsl(${Math.random() * 360}, 70%, 50%)`;
                particle.style.borderRadius = '50%';
                particle.style.left = '50%';
                particle.style.top = '50%';
                particle.style.pointerEvents = 'none';
                particle.style.zIndex = '10000';
                
                const angle = (Math.PI * 2 * i) / 20;
                const velocity = 5 + Math.random() * 5;
                
                document.body.appendChild(particle);
                
                let frame = 0;
                const animate = () => {
                    frame++;
                    particle.style.transform = `translate(${Math.cos(angle) * velocity * frame}px, ${Math.sin(angle) * velocity * frame}px)`;
                    particle.style.opacity = 1 - frame / 30;
                    
                    if (frame < 30) {
                        requestAnimationFrame(animate);
                    } else {
                        particle.remove();
                    }
                };
                
                requestAnimationFrame(animate);
            }
        }

        // Starter Activity - Matching
        let selectedDevice = null;
        let selectedFunction = null;
        const matches = new Map();

        function selectItem(element, type) {
            if (type === 'device') {
                document.querySelectorAll('[onclick*="device"]').forEach(el => el.classList.remove('selected'));
                element.classList.add('selected');
                selectedDevice = element;
            } else {
                document.querySelectorAll('[onclick*="function"]').forEach(el => el.classList.remove('selected'));
                element.classList.add('selected');
                selectedFunction = element;
            }
            
            if (selectedDevice && selectedFunction) {
                const deviceMatch = selectedDevice.getAttribute('data-match');
                const functionMatch = selectedFunction.getAttribute('data-match');
                
                if (deviceMatch === functionMatch) {
                    matches.set(deviceMatch, true);
                    selectedDevice.style.background = 'var(--success)';
                    selectedDevice.style.color = 'white';
                    selectedFunction.style.background = 'var(--success)';
                    selectedFunction.style.color = 'white';
                    
                    selectedDevice = null;
                    selectedFunction = null;
                    
                    if (matches.size === 5) {
                        showFeedback('matchingFeedback', 'Perfect! All devices matched correctly!', 'success');
                        if (!gameState.completedTasks.has('matching')) {
                            awardXP(30, 'Completed device matching');
                            unlockAchievement('perfectMatch');
                            gameState.completedTasks.add('matching');
                        }
                    }
                } else {
                    selectedDevice.classList.add('incorrect');
                    selectedFunction.classList.add('incorrect');
                    setTimeout(() => {
                        selectedDevice.classList.remove('incorrect', 'selected');
                        selectedFunction.classList.remove('incorrect', 'selected');
                        selectedDevice = null;
                        selectedFunction = null;
                    }, 1000);
                }
            }
        }

        function checkMatching() {
            if (matches.size === 5) {
                showFeedback('matchingFeedback', 'All correct! Well done!', 'success');
            } else {
                showFeedback('matchingFeedback', `You have ${matches.size}/5 correct matches. Keep trying!`, 'error');
            }
        }

        function resetMatching() {
            matches.clear();
            document.querySelectorAll('.drag-item').forEach(el => {
                el.style.background = '';
                el.style.color = '';
                el.classList.remove('selected', 'correct', 'incorrect');
            });
            selectedDevice = null;
            selectedFunction = null;
            document.getElementById('matchingFeedback').style.display = 'none';
        }

        // Speaker Component Labeling
        let selectedLabel = null;
        const labelMatches = new Map();

        function selectLabel(element) {
            document.querySelectorAll('[onclick*="selectLabel"]').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');
            selectedLabel = element.getAttribute('data-label');
        }

        function checkLabeling() {
            // Simple validation - in real implementation, would check actual diagram clicks
            showFeedback('labelingFeedback', 'Check your labels against the diagram!', 'success');
            if (!gameState.completedTasks.has('labeling')) {
                awardXP(20, 'Completed speaker labeling');
                gameState.completedTasks.add('labeling');
            }
        }

        function resetLabeling() {
            selectedLabel = null;
            labelMatches.clear();
            document.querySelectorAll('[onclick*="selectLabel"]').forEach(el => {
                el.classList.remove('selected');
            });
            document.getElementById('labelingFeedback').style.display = 'none';
        }

        // Fill in the Blanks
        function checkFillBlanks() {
            const answers = {
                blank1: 'digital-to-analog',
                blank2: 'electromagnetic field',
                blank3: 'polarity',
                blank4: 'cone/diaphragm'
            };
            
            let correct = 0;
            let total = 4;
            
            for (let i = 1; i <= total; i++) {
                const select = document.getElementById(`blank${i}`);
                if (select.value === answers[`blank${i}`]) {
                    correct++;
                    select.style.borderColor = 'var(--success)';
                } else {
                    select.style.borderColor = 'var(--danger)';
                }
            }
            
            if (correct === total) {
                showFeedback('fillBlanksFeedback', 'Perfect! All answers correct!', 'success');
                if (!gameState.completedTasks.has('fillBlanks')) {
                    awardXP(25, 'Completed fill in the blanks');
                    gameState.completedTasks.add('fillBlanks');
                    
                    // Check if all speaker tasks completed
                    if (gameState.completedTasks.has('labeling') && gameState.completedTasks.has('fillBlanks')) {
                        unlockAchievement('speakerExpert');
                    }
                }
            } else {
                showFeedback('fillBlanksFeedback', `You got ${correct}/${total} correct. Try again!`, 'error');
            }
        }

        function resetFillBlanks() {
            for (let i = 1; i <= 4; i++) {
                const select = document.getElementById(`blank${i}`);
                select.value = '';
                select.style.borderColor = '';
            }
            document.getElementById('fillBlanksFeedback').style.display = 'none';
        }

        // Microphone Comparison
        function checkMicComparison() {
            const correct = {
                dynamic1: 'coil-magnet',
                dynamic2: 'no',
                condenser1: 'capacitance',
                condenser2: 'yes'
            };
            
            let score = 0;
            for (const [id, answer] of Object.entries(correct)) {
                const select = document.getElementById(id);
                if (select.value === answer) {
                    score++;
                    select.style.borderColor = 'var(--success)';
                } else {
                    select.style.borderColor = 'var(--danger)';
                }
            }
            
            if (score === 4) {
                showFeedback('micComparisonFeedback', 'Excellent! You understand the differences perfectly!', 'success');
                if (!gameState.completedTasks.has('micComparison')) {
                    awardXP(20, 'Completed microphone comparison');
                    gameState.completedTasks.add('micComparison');
                }
            } else {
                showFeedback('micComparisonFeedback', `${score}/4 correct. Review the differences and try again.`, 'error');
            }
        }

        function resetMicComparison() {
            ['dynamic1', 'dynamic2', 'condenser1', 'condenser2'].forEach(id => {
                const select = document.getElementById(id);
                select.value = '';
                select.style.borderColor = '';
            });
            document.getElementById('micComparisonFeedback').style.display = 'none';
        }

        // True/False Questions
        const trueFalseAnswers = new Map();

        function selectTrueFalse(element, question, answer) {
            trueFalseAnswers.set(question, answer);
            
            // Visual feedback
            document.querySelectorAll('.quiz-option').forEach(opt => {
                if (opt.textContent.includes(question.replace('q', 'Statement '))) {
                    opt.classList.add('selected');
                }
            });
        }

        function checkTrueFalse() {
            const correct = {
                q1: true,
                q2: false,
                q3: true
            };
            
            let score = 0;
            for (const [q, correctAnswer] of Object.entries(correct)) {
                if (trueFalseAnswers.get(q) === correctAnswer) {
                    score++;
                }
            }
            
            if (score === 3) {
                showFeedback('trueFalseFeedback', 'Perfect! All answers correct!', 'success');
                if (!gameState.completedTasks.has('trueFalse')) {
                    awardXP(15, 'Completed true/false questions');
                    gameState.completedTasks.add('trueFalse');
                }
            } else {
                showFeedback('trueFalseFeedback', `${score}/3 correct. Think about each statement carefully.`, 'error');
            }
        }

        function resetTrueFalse() {
            trueFalseAnswers.clear();
            document.querySelectorAll('#trueFalseQuiz .quiz-option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            document.getElementById('trueFalseFeedback').style.display = 'none';
        }

        // Touchscreen Categorization
        const categorizedFeatures = new Map();

        function categorizeFeature(element) {
            const type = element.getAttribute('data-type');
            const text = element.textContent;
            
            // Toggle selection
            if (categorizedFeatures.has(text)) {
                categorizedFeatures.delete(text);
                element.classList.remove('selected');
                
                // Remove from zones
                document.querySelectorAll('.dropped-item').forEach(item => {
                    if (item.textContent === text) {
                        item.remove();
                    }
                });
            } else {
                categorizedFeatures.set(text, type);
                element.classList.add('selected');
                
                // Add to appropriate zone
                const zone = document.getElementById(type + 'Zone');
                const droppedItem = document.createElement('span');
                droppedItem.className = 'dropped-item';
                droppedItem.textContent = text;
                zone.appendChild(droppedItem);
            }
        }

        function checkCategorization() {
            let correct = 0;
            let total = document.querySelectorAll('#touchFeatures .drag-item').length;
            
            document.querySelectorAll('#touchFeatures .drag-item').forEach(item => {
                const type = item.getAttribute('data-type');
                const text = item.textContent;
                
                if (categorizedFeatures.get(text) === type) {
                    correct++;
                    item.style.borderColor = 'var(--success)';
                } else {
                    item.style.borderColor = 'var(--danger)';
                }
            });
            
            if (correct === total) {
                showFeedback('categorizeFeedback', 'Perfect categorization! You understand the differences well!', 'success');
                if (!gameState.completedTasks.has('categorization')) {
                    awardXP(25, 'Completed touchscreen categorization');
                    gameState.completedTasks.add('categorization');
                    unlockAchievement('touchMaster');
                }
            } else {
                showFeedback('categorizeFeedback', `${correct}/${total} features correctly categorized.`, 'error');
            }
        }

        function resetCategorization() {
            categorizedFeatures.clear();
            document.querySelectorAll('#touchFeatures .drag-item').forEach(item => {
                item.classList.remove('selected');
                item.style.borderColor = '';
            });
            document.querySelectorAll('.dropped-item').forEach(item => item.remove());
            document.getElementById('categorizeFeedback').style.display = 'none';
        }

        // Scenario Questions
        function checkScenarios() {
            const scenario1 = document.getElementById('scenario1').value;
            const scenario1reason = document.getElementById('scenario1reason').value;
            const scenario2 = document.getElementById('scenario2').value;
            const scenario2reason = document.getElementById('scenario2reason').value;
            
            let feedback = '';
            let score = 0;
            
            if (scenario1 === 'resistive') {
                score++;
                feedback += '✓ Scenario 1: Correct! Resistive screens work with gloves. ';
            } else {
                feedback += '✗ Scenario 1: Think about which technology works with gloves. ';
            }
            
            if (scenario2 === 'capacitive') {
                score++;
                feedback += '✓ Scenario 2: Correct! Capacitive supports multi-touch. ';
            } else {
                feedback += '✗ Scenario 2: Which technology supports multi-touch gestures? ';
            }
            
            // Award bonus XP for good explanations
            const keywords = ['glove', 'multi-touch', 'gesture', 'pressure', 'charge', 'conductiv'];
            let explanationScore = 0;
            
            keywords.forEach(keyword => {
                if (scenario1reason.toLowerCase().includes(keyword) || 
                    scenario2reason.toLowerCase().includes(keyword)) {
                    explanationScore++;
                }
            });
            
            if (explanationScore >= 2 && scenario1reason.length > 50 && scenario2reason.length > 50) {
                feedback += '\n\nExcellent explanations!';
                awardXP(10, 'Detailed scenario explanations');
            }
            
            showFeedback('scenarioFeedback', feedback, score === 2 ? 'success' : 'error');
            
            if (score === 2 && !gameState.completedTasks.has('scenarios')) {
                awardXP(20, 'Completed scenario questions');
                gameState.completedTasks.add('scenarios');
            }
        }

        function resetScenarios() {
            ['scenario1', 'scenario2'].forEach(id => {
                document.getElementById(id).value = '';
                document.getElementById(id + 'reason').value = '';
            });
            document.getElementById('scenarioFeedback').style.display = 'none';
        }

        // Laser Printer Sequence
        const sequenceOrder = [];

        function selectSequence(element) {
            if (!sequenceOrder.includes(element)) {
                sequenceOrder.push(element);
                element.style.display = 'none';
                
                const zone = document.getElementById('sequenceZone');
                const step = document.createElement('div');
                step.className = 'dropped-item';
                step.style.display = 'block';
                step.style.margin = '5px';
                step.textContent = `${sequenceOrder.length}. ${element.textContent}`;
                zone.appendChild(step);
            }
        }

        function checkSequence() {
            const correctOrder = [1, 2, 3, 4, 5, 6];
            let isCorrect = true;
            
            if (sequenceOrder.length !== 6) {
                showFeedback('sequenceFeedback', 'Please arrange all steps before checking.', 'error');
                return;
            }
            
            sequenceOrder.forEach((element, index) => {
                const expectedOrder = parseInt(element.getAttribute('data-order'));
                if (expectedOrder !== correctOrder[index]) {
                    isCorrect = false;
                }
            });
            
            if (isCorrect) {
                showFeedback('sequenceFeedback', 'Perfect sequence! You understand the laser printing process!', 'success');
                if (!gameState.completedTasks.has('laserSequence')) {
                    awardXP(25, 'Completed laser printer sequence');
                    gameState.completedTasks.add('laserSequence');
                }
            } else {
                showFeedback('sequenceFeedback', 'The sequence is not quite right. Think about the logical flow.', 'error');
            }
        }

        function resetSequence() {
            sequenceOrder.length = 0;
            document.getElementById('sequenceZone').innerHTML = '<p style="text-align: center; color: #999;">Click steps above in the correct order</p>';
            document.querySelectorAll('#laserSteps .drag-item').forEach(item => {
                item.style.display = 'block';
            });
            document.getElementById('sequenceFeedback').style.display = 'none';
        }

        // 3D Printing Ethics
        function checkEthics() {
            const justification = document.getElementById('ethicsJustification').value;
            
            if (justification.length < 100) {
                showFeedback('ethicsFeedback', 'Please provide a more detailed justification (at least 100 characters).', 'error');
                return;
            }
            
            // Check for ethical keywords
            const ethicsKeywords = ['safety', 'regulation', 'environment', 'copyright', 'weapon', 'illegal', 'harm', 'responsible'];
            let keywordCount = 0;
            
            ethicsKeywords.forEach(keyword => {
                if (justification.toLowerCase().includes(keyword)) {
                    keywordCount++;
                }
            });
            
            if (keywordCount >= 2) {
                showFeedback('ethicsFeedback', 'Excellent ethical analysis! You\'ve considered important factors.', 'success');
                if (!gameState.completedTasks.has('ethics')) {
                    awardXP(30, 'Completed ethics evaluation');
                    gameState.completedTasks.add('ethics');
                    unlockAchievement('ethicsChampion');
                }
            } else {
                showFeedback('ethicsFeedback', 'Good start! Consider discussing safety, regulation, or environmental impact.', 'error');
                awardXP(10, 'Ethics evaluation attempt');
            }
        }

        function resetEthics() {
            for (let i = 1; i <= 4; i++) {
                document.getElementById(`ethics${i}`).value = 3;
            }
            document.getElementById('ethicsJustification').value = '';
            document.getElementById('ethicsFeedback').style.display = 'none';
        }

        // Application Matching
        const appMatches = new Map();

        function selectApp(element, id) {
            // Implementation similar to device matching
            element.classList.add('selected');
            appMatches.set('app', {element, id});
            checkAppBenefitMatch();
        }

        function selectBenefit(element, id) {
            element.classList.add('selected');
            appMatches.set('benefit', {element, id});
            checkAppBenefitMatch();
        }

        function checkAppBenefitMatch() {
            if (appMatches.has('app') && appMatches.has('benefit')) {
                const app = appMatches.get('app');
                const benefit = appMatches.get('benefit');
                
                if (app.id === benefit.id) {
                    app.element.style.background = 'var(--success)';
                    app.element.style.color = 'white';
                    benefit.element.style.background = 'var(--success)';
                    benefit.element.style.color = 'white';
                } else {
                    app.element.classList.add('incorrect');
                    benefit.element.classList.add('incorrect');
                    setTimeout(() => {
                        app.element.classList.remove('incorrect', 'selected');
                        benefit.element.classList.remove('incorrect', 'selected');
                    }, 1000);
                }
                
                appMatches.clear();
            }
        }

        function checkApplications() {
            showFeedback('applicationsFeedback', 'Check your matches!', 'success');
            if (!gameState.completedTasks.has('applications')) {
                awardXP(20, 'Completed 3D printing applications');
                gameState.completedTasks.add('applications');
            }
        }

        function resetApplications() {
            appMatches.clear();
            // Reset visual states
            document.getElementById('applicationsFeedback').style.display = 'none';
        }

        // Exam Questions
        function revealMarkScheme(questionId) {
            const textarea = document.getElementById(`exam${questionId.toUpperCase()}`);
            const marksInput = document.getElementById(`${questionId}marks`);
            
            if (textarea.value.length < 100) {
                showFeedback('examFeedback', 'Please write a more complete answer before viewing the mark scheme.', 'error');
                return;
            }
            
            if (!marksInput.value) {
                showFeedback('examFeedback', 'Please enter your predicted marks first.', 'error');
                return;
            }
            
            document.getElementById(`markScheme-${questionId}`).style.display = 'block';
            
            if (!gameState.completedTasks.has(`exam-${questionId}`)) {
                awardXP(15, `Completed exam question ${questionId}`);
                gameState.completedTasks.add(`exam-${questionId}`);
                
                // Check if all exam questions completed
                if (gameState.completedTasks.has('exam-q1') && 
                    gameState.completedTasks.has('exam-q2') && 
                    gameState.completedTasks.has('exam-q3')) {
                    unlockAchievement('examReady');
                }
            }
        }

        // Extension Activities
        function submitExtension(type) {
            const inputs = {
                research: 'extensionResearch',
                design: 'extensionDesign',
                calc: 'extensionCalc'
            };
            
            const textarea = document.getElementById(inputs[type]);
            
            if (textarea.value.length < 100) {
                alert('Please provide a more detailed response (minimum 100 characters).');
                return;
            }
            
            // Award XP based on response length and keywords
            let xp = 20;
            if (textarea.value.length > 200) xp += 10;
            if (textarea.value.length > 400) xp += 10;
            
            awardXP(xp, `Completed ${type} extension activity`);
            
            if (!gameState.achievements.has('researcher')) {
                unlockAchievement('researcher');
            }
            
            textarea.style.borderColor = 'var(--success)';
            setTimeout(() => {
                textarea.style.borderColor = '';
            }, 3000);
        }

        // Final Quiz
        const finalAnswers = new Map();

        function selectQuizOption(element, question, answer) {
            // Clear previous selection for this question
            element.parentElement.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            element.classList.add('selected');
            finalAnswers.set(question, answer);
        }

        function checkFinalQuiz() {
            const correctAnswers = {
                final1: 'b',  // Digital-to-Analog
                final2: 'b',  // Electrical conductivity
                final3: 'b',  // Electrical charge patterns
                final4: 'b',  // Condenser microphone
                final5: 'b',  // Untraceability
                final6: 'c'   // Cone/Diaphragm
            };
            
            let correct = 0;
            
            for (const [question, correctAnswer] of Object.entries(correctAnswers)) {
                const userAnswer = finalAnswers.get(question);
                const options = document.querySelectorAll(`[onclick*="${question}"]`);
                
                options.forEach(opt => {
                    if (opt.getAttribute('onclick').includes(correctAnswer)) {
                        if (userAnswer === correctAnswer) {
                            opt.classList.add('correct');
                            correct++;
                        }
                    } else if (opt.getAttribute('onclick').includes(userAnswer)) {
                        opt.classList.add('incorrect');
                    }
                });
            }
            
            const percentage = Math.round((correct / 6) * 100);
            let feedback = `You scored ${correct}/6 (${percentage}%). `;
            
            if (percentage === 100) {
                feedback += 'Perfect score! Outstanding work!';
                if (!gameState.completedTasks.has('finalQuiz')) {
                    awardXP(50, 'Perfect score on final quiz');
                }
            } else if (percentage >= 80) {
                feedback += 'Great job! You have a strong understanding.';
                if (!gameState.completedTasks.has('finalQuiz')) {
                    awardXP(30, 'Completed final quiz');
                }
            } else if (percentage >= 60) {
                feedback += 'Good effort! Review the topics you found challenging.';
                if (!gameState.completedTasks.has('finalQuiz')) {
                    awardXP(20, 'Completed final quiz');
                }
            } else {
                feedback += 'Keep studying! Review the lesson materials and try again.';
                awardXP(10, 'Attempted final quiz');
            }
            
            showFeedback('finalQuizFeedback', feedback, percentage >= 60 ? 'success' : 'error');
            gameState.completedTasks.add('finalQuiz');
        }

        function resetFinalQuiz() {
            finalAnswers.clear();
            document.querySelectorAll('.quiz-option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
            document.getElementById('finalQuizFeedback').style.display = 'none';
        }

        // Complete Lesson
        function completeLesson() {
            // Show completion stats
            document.getElementById('completionStats').style.display = 'block';
            document.getElementById('finalLevel').textContent = gameState.level;
            document.getElementById('finalXP').textContent = gameState.score;
            document.getElementById('finalScore').textContent = gameState.score;
            document.getElementById('achievementCount').textContent = gameState.achievements.size;
            
            if (!gameState.achievements.has('completionist')) {
                unlockAchievement('completionist');
            }
            
            // Celebration effect
            createParticleEffect();
        }

        // Canvas Drawing
        let canvas, ctx;
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;

        function initializeCanvas() {
            canvas = document.getElementById('drawingCanvas');
            if (!canvas) return;
            
            ctx = canvas.getContext('2d');
            
            // Set canvas size
            function resizeCanvas() {
                const rect = canvas.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = 400;
            }
            
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            
            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events
            canvas.addEventListener('touchstart', handleTouch);
            canvas.addEventListener('touchmove', handleTouch);
            canvas.addEventListener('touchend', stopDrawing);
        }

        function startDrawing(e) {
            isDrawing = true;
            [lastX, lastY] = getCoordinates(e);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const [currentX, currentY] = getCoordinates(e);
            
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(currentX, currentY);
            ctx.strokeStyle = document.getElementById('penColor').value;
            ctx.lineWidth = document.getElementById('penWidth').value;
            ctx.lineCap = 'round';
            ctx.stroke();
            
            [lastX, lastY] = [currentX, currentY];
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                            e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function getCoordinates(e) {
            const rect = canvas.getBoundingClientRect();
            return [
                e.clientX - rect.left,
                e.clientY - rect.top
            ];
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // Hints
        function showHint(hintId) {
            document.getElementById(`hint-${hintId}`).style.display = 'block';
            awardXP(-5, 'Used hint');
        }

        // Feedback System
        function showFeedback(elementId, message, type) {
            const feedback = document.getElementById(elementId);
            feedback.className = `feedback ${type}`;
            feedback.textContent = message;
            feedback.style.display = 'block';
            
            if (!gameState.achievements.has('firstStep') && type === 'success') {
                unlockAchievement('firstStep');
            }
        }

        // Prevent Pasting
        function preventPasting() {
            const preventPasteHandler = (e) => {
                e.preventDefault();
                const shameMessage = document.getElementById('shameMessage');
                shameMessage.style.display = 'block';
                setTimeout(() => {
                    shameMessage.style.display = 'none';
                }, 2000);
                return false;
            };

            // Prevent all paste methods
            document.addEventListener('paste', preventPasteHandler);
            
            // Prevent context menu on inputs
            document.addEventListener('contextmenu', (e) => {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                    e.preventDefault();
                    return false;
                }
            });
            
            // Prevent drag and drop
            document.addEventListener('drop', (e) => {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                    e.preventDefault();
                    return false;
                }
            });
            
            document.addEventListener('dragover', (e) => {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                    e.preventDefault();
                    return false;
                }
            });
        }

        // Feedback System
        function openFeedback() {
            document.getElementById('feedbackModal').style.display = 'flex';
            document.getElementById('currentSection').textContent = 
                gameState.currentSection.charAt(0).toUpperCase() + gameState.currentSection.slice(1);
        }

        function closeFeedback() {
            document.getElementById('feedbackModal').style.display = 'none';
            document.getElementById('feedbackText').value = '';
        }

        function sendFeedback() {
            const feedbackText = document.getElementById('feedbackText').value;
            const currentSection = gameState.currentSection;
            
            if (feedbackText.trim().length < 10) {
                alert('Please provide more detailed feedback.');
                return;
            }
            
            // Get relevant code section
            const sectionElement = document.getElementById(currentSection);
            const relevantCode = sectionElement ? sectionElement.innerHTML.substring(0, 500) + '...' : 'Section not found';
            
            // Construct email body
            const emailBody = `Section: ${currentSection}\n\nFeedback: ${feedbackText}\n\nRelevant Code:\n${relevantCode}`;
            
            // Create mailto link
            const subject = encodeURIComponent('IO Devices Worksheet Feedback');
            const body = encodeURIComponent(emailBody);
            window.location.href = `mailto:millingtond@mgs.org?subject=${subject}&body=${body}`;
            
            closeFeedback();
            showAchievement('Feedback Sent', 'Thank you for your feedback!');
        }

        // Keyboard Navigation
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'ArrowLeft':
                        navigatePrevious();
                        break;
                    case 'ArrowRight':
                        navigateNext();
                        break;
                }
            }
        });

        function navigatePrevious() {
            const sections = ['starter', 'speakers', 'microphones', 'touchscreens', 'printers', 'exam', 'extension', 'summary'];
            const currentIndex = sections.indexOf(gameState.currentSection);
            if (currentIndex > 0) {
                showSection(sections[currentIndex - 1]);
            }
        }

        function navigateNext() {
            const sections = ['starter', 'speakers', 'microphones', 'touchscreens', 'printers', 'exam', 'extension', 'summary'];
            const currentIndex = sections.indexOf(gameState.currentSection);
            if (currentIndex < sections.length - 1) {
                showSection(sections[currentIndex + 1]);
            }
        }

        // Save Progress (localStorage disabled as per requirements)
        function saveProgress() {
            // Intentionally disabled to comply with requirements
            console.log('Progress tracking active (in-memory only)');
        }

        // Load Progress
        function loadProgress() {
            // Intentionally disabled to comply with requirements
            console.log('Starting fresh session');
        }

        // Accessibility Features
        function improveAccessibility() {
            // Add ARIA labels dynamically
            document.querySelectorAll('.quiz-option').forEach((option, index) => {
                option.setAttribute('role', 'radio');
                option.setAttribute('aria-label', `Option ${index + 1}`);
                option.setAttribute('tabindex', '0');
            });
            
            // Keyboard navigation for quiz options
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' && e.target.classList.contains('quiz-option')) {
                    e.target.click();
                }
            });
        }

        // Initialize accessibility on load
        document.addEventListener('DOMContentLoaded', () => {
            improveAccessibility();
        });

        // Touch Device Optimization
        function optimizeForTouch() {
            if ('ontouchstart' in window) {
                document.body.classList.add('touch-device');
                
                // Increase touch targets
                document.querySelectorAll('.btn, .quiz-option, .drag-item').forEach(element => {
                    element.style.minHeight = '44px';
                    element.style.minWidth = '44px';
                });
            }
        }

        // Performance Optimization
        const debounce = (func, wait) => {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        };

        // Optimize scroll performance
        const handleScroll = debounce(() => {
            // Update any scroll-dependent UI elements
            updateProgressIndicator();
        }, 100);

        window.addEventListener('scroll', handleScroll);

        function updateProgressIndicator() {
            // Visual progress through the page
            const scrollPercentage = (window.scrollY / (document.documentElement.scrollHeight - window.innerHeight)) * 100;
            // Could update a progress bar here if needed
        }

        // Event Delegation for Dynamic Content
        document.addEventListener('click', (e) => {
            // Handle dynamically created elements
            if (e.target.classList.contains('dropped-item')) {
                // Handle dropped item clicks if needed
            }
        });

        // Initialize on DOM ready
        document.addEventListener('DOMContentLoaded', () => {
            optimizeForTouch();
            loadProgress();
            
            // Set initial focus for accessibility
            const firstInteractive = document.querySelector('.nav-item');
            if (firstInteractive) {
                firstInteractive.focus();
            }
        });

        // Utility Functions
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        // Error Handling
        window.addEventListener('error', (e) => {
            console.error('An error occurred:', e.error);
            // Could send error reports here if needed
        });

        // Ensure all images load
        document.addEventListener('DOMContentLoaded', () => {
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                img.addEventListener('error', () => {
                    img.style.display = 'none';
                    console.warn('Image failed to load:', img.src);
                });
            });
        });

        // Final initialization
        console.log('IO Devices Worksheet initialized successfully!');
    </script>
</body>
</html>