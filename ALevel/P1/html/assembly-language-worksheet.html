<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Assembly Language & Translators - Interactive Worksheet</title>
    <style>
        :root {
            --primary: #6B46C1;
            --secondary: #3B82F6;
            --success: #10B981;
            --danger: #EF4444;
            --warning: #F59E0B;
            --dark: #1F2937;
            --light: #F9FAFB;
            --gradient: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0F172A;
            color: #E2E8F0;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Header with animated gradient */
        .header {
            background: var(--gradient);
            padding: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        /* XP Bar */
        .xp-container {
            max-width: 600px;
            margin: 1rem auto;
            background: rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 0.5rem;
            backdrop-filter: blur(10px);
            position: relative;
            z-index: 1;
        }

        .xp-bar {
            height: 30px;
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .xp-fill {
            height: 100%;
            background: var(--gradient);
            width: 0%;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .xp-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .xp-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
            font-size: 0.9rem;
        }

        /* Navigation */
        .nav-container {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            padding: 1rem;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .nav-btn {
            padding: 0.5rem 1rem;
            background: rgba(107, 70, 193, 0.2);
            border: 1px solid rgba(107, 70, 193, 0.5);
            color: #E2E8F0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .nav-btn:hover {
            background: rgba(107, 70, 193, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(107, 70, 193, 0.3);
        }

        .nav-btn.active {
            background: var(--primary);
            border-color: var(--primary);
        }

        /* Sections */
        .section {
            display: none;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            animation: fadeIn 0.5s;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards with glassmorphism */
        .card {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(107, 70, 193, 0.3);
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient);
            animation: slideIn 0.5s;
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        /* Buttons */
        .btn {
            padding: 0.75rem 1.5rem;
            background: var(--gradient);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(107, 70, 193, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        /* Ripple effect */
        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.5s, height 0.5s;
        }

        .btn:active::after {
            width: 300px;
            height: 300px;
        }

        /* Interactive elements */
        .drag-item, .click-item {
            padding: 0.75rem;
            background: rgba(107, 70, 193, 0.2);
            border: 2px solid rgba(107, 70, 193, 0.5);
            border-radius: 8px;
            margin: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
        }

        .drag-item:hover, .click-item:hover {
            background: rgba(107, 70, 193, 0.3);
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(107, 70, 193, 0.3);
        }

        .drop-zone {
            min-height: 60px;
            border: 2px dashed rgba(107, 70, 193, 0.5);
            border-radius: 8px;
            padding: 1rem;
            margin: 0.5rem 0;
            transition: all 0.3s;
        }

        .drop-zone.highlight {
            background: rgba(107, 70, 193, 0.2);
            border-color: var(--primary);
        }

        /* Achievement popup */
        .achievement {
            position: fixed;
            top: 20px;
            right: -400px;
            background: linear-gradient(135deg, #1E293B 0%, #334155 100%);
            border: 2px solid var(--primary);
            border-radius: 12px;
            padding: 1.5rem;
            color: white;
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
            z-index: 1000;
            transition: right 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            max-width: 350px;
        }

        .achievement.show {
            right: 20px;
        }

        .achievement h3 {
            color: #FCD34D;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .achievement-icon {
            font-size: 1.5rem;
            animation: bounce 0.5s;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        /* Input fields */
        input[type="text"], textarea {
            width: 100%;
            padding: 0.75rem;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(107, 70, 193, 0.5);
            border-radius: 8px;
            color: #E2E8F0;
            font-size: 1rem;
            transition: all 0.3s;
        }

        input[type="text"]:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(107, 70, 193, 0.2);
        }

        /* Quiz options */
        .quiz-option {
            padding: 1rem;
            background: rgba(30, 41, 59, 0.6);
            border: 2px solid transparent;
            border-radius: 8px;
            margin: 0.5rem 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            background: rgba(107, 70, 193, 0.2);
            border-color: rgba(107, 70, 193, 0.5);
            transform: translateX(5px);
        }

        .quiz-option.correct {
            background: rgba(16, 185, 129, 0.2);
            border-color: var(--success);
        }

        .quiz-option.incorrect {
            background: rgba(239, 68, 68, 0.2);
            border-color: var(--danger);
        }

        /* Canvas for drawing */
        .canvas-container {
            position: relative;
            background: white;
            border-radius: 8px;
            margin: 1rem 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        #drawingCanvas {
            border-radius: 8px;
            cursor: crosshair;
            touch-action: none;
        }

        /* XP popup */
        .xp-popup {
            position: fixed;
            font-size: 1.5rem;
            font-weight: bold;
            color: #FCD34D;
            pointer-events: none;
            z-index: 1000;
            animation: floatUp 2s ease-out forwards;
        }

        @keyframes floatUp {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px);
            }
        }

        /* Feedback button */
        .feedback-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(107, 70, 193, 0.8);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s;
            z-index: 999;
        }

        .feedback-btn:hover {
            background: var(--primary);
            transform: scale(1.1);
        }

        /* Feedback modal */
        .feedback-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1001;
            align-items: center;
            justify-content: center;
        }

        .feedback-content {
            background: #1E293B;
            padding: 2rem;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
        }

        /* Simulation styles */
        .simulation {
            background: rgba(15, 23, 42, 0.8);
            border-radius: 12px;
            padding: 2rem;
            margin: 1rem 0;
            position: relative;
        }

        .sim-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .code-display {
            font-family: 'Courier New', monospace;
            background: rgba(0,0,0,0.5);
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border: 1px solid rgba(107, 70, 193, 0.3);
            overflow-x: auto;
        }

        .highlight-active {
            background: rgba(107, 70, 193, 0.3);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        /* Navigation arrows */
        .nav-arrows {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
        }

        .arrow-btn {
            padding: 0.75rem 1.5rem;
            background: rgba(107, 70, 193, 0.3);
            border: 1px solid rgba(107, 70, 193, 0.5);
            color: #E2E8F0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .arrow-btn:hover {
            background: rgba(107, 70, 193, 0.5);
            transform: translateY(-2px);
        }

        /* Shame message */
        .shame-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #DC2626;
            color: white;
            padding: 2rem;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: bold;
            box-shadow: 0 10px 40px rgba(220, 38, 38, 0.5);
            z-index: 9999;
            display: none;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-50%, -50%) rotate(-5deg); }
            75% { transform: translate(-50%, -50%) rotate(5deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8rem; }
            .nav-buttons { padding: 0.5rem; }
            .nav-btn { font-size: 0.8rem; padding: 0.4rem 0.8rem; }
            .section { padding: 1rem; }
            .card { padding: 1.5rem; }
        }

        /* Loading states */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(107, 70, 193, 0.6);
            border-radius: 50%;
            animation: float 3s infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) translateX(0); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) translateX(50px); }
        }

        /* Mark scheme styles */
        .mark-scheme {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            display: none;
        }

        .mark-scheme.visible {
            display: block;
            animation: fadeIn 0.5s;
        }

        /* Progress indicators */
        .progress-dots {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin: 1rem 0;
        }

        .progress-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(107, 70, 193, 0.3);
            transition: all 0.3s;
        }

        .progress-dot.active {
            background: var(--primary);
            transform: scale(1.2);
        }

        /* Learning outcomes */
        .learning-outcomes {
            background: rgba(59, 130, 246, 0.1);
            border-left: 4px solid var(--secondary);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0 8px 8px 0;
        }

        .learning-outcomes h3 {
            color: var(--secondary);
            margin-bottom: 0.5rem;
        }

        .learning-outcomes ul {
            list-style: none;
            padding-left: 0;
        }

        .learning-outcomes li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .learning-outcomes li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: var(--secondary);
            font-weight: bold;
        }
    </style>
</head>
<body>
    <!-- Particles Background -->
    <div class="particles" id="particles"></div>

    <!-- Header -->
    <header class="header">
        <h1>Assembly Language & Translators</h1>
        <div class="xp-container">
            <div class="xp-bar">
                <div class="xp-fill" id="xpFill"></div>
                <div class="xp-text">
                    <span id="currentXP">0</span> / <span id="maxXP">1000</span> XP | Level <span id="level">0</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav-container">
        <div class="nav-buttons">
            <button class="nav-btn active" onclick="showSection('intro')">Introduction</button>
            <button class="nav-btn" onclick="showSection('starter')">Starter</button>
            <button class="nav-btn" onclick="showSection('lowlevel')">Low-Level Languages</button>
            <button class="nav-btn" onclick="showSection('translators')">Translators</button>
            <button class="nav-btn" onclick="showSection('benefits')">Benefits</button>
            <button class="nav-btn" onclick="showSection('java')">Java</button>
            <button class="nav-btn" onclick="showSection('practice')">Practice</button>
            <button class="nav-btn" onclick="showSection('extension')">Extension</button>
            <button class="nav-btn" onclick="showSection('summary')">Summary</button>
        </div>
    </nav>

    <!-- Introduction Section -->
    <section class="section active" id="intro">
        <div class="card">
            <h2>Welcome to Assembly Language & Translators! üöÄ</h2>
            <div class="learning-outcomes">
                <h3>Learning Outcomes</h3>
                <ul>
                    <li>Understand the differences between low-level and high-level languages</li>
                    <li>Explain the role of assembly language, machine code, and object code</li>
                    <li>Compare and contrast compilers, interpreters, and assemblers</li>
                    <li>Understand the benefits of each translator type</li>
                    <li>Explain how Java achieves machine independence</li>
                    <li>Describe the Java compilation process</li>
                </ul>
            </div>
            <p>In this interactive worksheet, you'll explore the fascinating world of low-level programming and language translation. Earn XP and achievements as you complete activities!</p>
            <button class="btn" onclick="showSection('starter')">Start Learning ‚Üí</button>
        </div>
        <div class="nav-arrows">
            <div></div>
            <button class="arrow-btn" onclick="showSection('starter')">Next ‚Üí</button>
        </div>
    </section>

    <!-- Starter Activity -->
    <section class="section" id="starter">
        <div class="card">
            <h2>Starter Activity: Programming Language Knowledge Check</h2>
            <p>Test your current knowledge by matching programming concepts to their descriptions. Click on a term, then click on its matching description.</p>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 2rem;">
                <div>
                    <h3>Terms</h3>
                    <div id="starterTerms"></div>
                </div>
                <div>
                    <h3>Descriptions</h3>
                    <div id="starterDescriptions"></div>
                </div>
            </div>
            
            <div style="margin-top: 2rem;">
                <button class="btn" onclick="checkStarterMatching()">Check Answers</button>
                <button class="btn" onclick="resetStarter()" style="margin-left: 1rem;">Reset</button>
            </div>
            
            <div id="starterFeedback" style="margin-top: 1rem;"></div>
        </div>
        <div class="nav-arrows">
            <button class="arrow-btn" onclick="showSection('intro')">‚Üê Previous</button>
            <button class="arrow-btn" onclick="showSection('lowlevel')">Next ‚Üí</button>
        </div>
    </section>

    <!-- Low-Level Languages Section -->
    <section class="section" id="lowlevel">
        <div class="card">
            <h2>Low-Level Programming Languages</h2>
            <p>Low-level languages are close to the hardware and provide minimal abstraction from a computer's instruction set architecture.</p>
            
            <h3>Assembly Language Simulation</h3>
            <div class="simulation">
                <p>Watch how assembly language instructions are executed step by step:</p>
                <div class="sim-controls">
                    <button class="btn" onclick="startAssemblySimulation()">Start</button>
                    <button class="btn" onclick="stepAssemblySimulation()">Step</button>
                    <button class="btn" onclick="resetAssemblySimulation()">Reset</button>
                </div>
                <div class="code-display" id="assemblyCode">
                    <div>MOV AX, 5    <span class="comment">; Move 5 into register AX</span></div>
                    <div>MOV BX, 3    <span class="comment">; Move 3 into register BX</span></div>
                    <div>ADD AX, BX   <span class="comment">; Add BX to AX</span></div>
                    <div>MOV CX, AX   <span class="comment">; Move result to CX</span></div>
                </div>
                <div style="margin-top: 1rem;">
                    <h4>Registers:</h4>
                    <div style="display: flex; gap: 1rem;">
                        <div>AX: <span id="regAX">0</span></div>
                        <div>BX: <span id="regBX">0</span></div>
                        <div>CX: <span id="regCX">0</span></div>
                    </div>
                </div>
            </div>
            
            <h3>Machine Code Converter</h3>
            <p>Convert assembly instructions to machine code (hexadecimal):</p>
            <div style="margin-top: 1rem;">
                <label>Enter Assembly Instruction:</label>
                <input type="text" id="assemblyInput" placeholder="e.g., MOV AX, 5">
                <button class="btn" onclick="convertToMachineCode()" style="margin-top: 0.5rem;">Convert</button>
                <div id="machineCodeOutput" style="margin-top: 1rem;"></div>
            </div>
            
            <h3>Quick Quiz: Assembly Language</h3>
            <div id="assemblyQuiz">
                <p><strong>Which of the following best describes assembly language?</strong></p>
                <div class="quiz-options" id="assemblyQuizOptions"></div>
            </div>
        </div>
        
        <div class="card">
            <h2>Object Code Activity</h2>
            <p>Arrange these steps in the correct order for creating an executable program:</p>
            <div id="objectCodeSteps" style="margin: 1rem 0;"></div>
            <button class="btn" onclick="checkObjectCodeOrder()">Check Order</button>
            <button class="btn" onclick="resetObjectCodeOrder()" style="margin-left: 1rem;">Reset</button>
            <div id="objectCodeFeedback" style="margin-top: 1rem;"></div>
        </div>
        
        <div class="nav-arrows">
            <button class="arrow-btn" onclick="showSection('starter')">‚Üê Previous</button>
            <button class="arrow-btn" onclick="showSection('translators')">Next ‚Üí</button>
        </div>
    </section>

    <!-- Translators Section -->
    <section class="section" id="translators">
        <div class="card">
            <h2>Language Translators</h2>
            <p>Translators convert programming languages from one form to another. Let's explore the three main types.</p>
            
            <h3>Compiler Simulation</h3>
            <div class="simulation">
                <p>Watch how a compiler processes source code:</p>
                <div class="sim-controls">
                    <button class="btn" onclick="startCompilerSim()">Compile</button>
                    <button class="btn" onclick="nextCompilerStep()">Next Step</button>
                    <button class="btn" onclick="prevCompilerStep()">Previous Step</button>
                    <button class="btn" onclick="resetCompilerSim()">Reset</button>
                </div>
                <div class="progress-dots" id="compilerProgress"></div>
                <div id="compilerDisplay"></div>
            </div>
            
            <h3>Interpreter vs Compiler</h3>
            <p>Categorize these characteristics by dragging them to the correct translator type:</p>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 1rem;">
                <div>
                    <h4>Compiler</h4>
                    <div class="drop-zone" id="compilerDrop" ondrop="drop(event, 'compiler')" ondragover="allowDrop(event)"></div>
                </div>
                <div>
                    <h4>Interpreter</h4>
                    <div class="drop-zone" id="interpreterDrop" ondrop="drop(event, 'interpreter')" ondragover="allowDrop(event)"></div>
                </div>
            </div>
            <div id="translatorCharacteristics" style="margin-top: 1rem;"></div>
            <button class="btn" onclick="checkTranslatorSort()" style="margin-top: 1rem;">Check Answers</button>
            <button class="btn" onclick="resetTranslatorSort()" style="margin-left: 1rem;">Reset</button>
            <div id="translatorFeedback" style="margin-top: 1rem;"></div>
        </div>
        
        <div class="card">
            <h2>Fill in the Blanks: Translators</h2>
            <p>Complete these sentences about language translators. Choose from the word bank below:</p>
            <div id="fillBlanksTranslators"></div>
            <div style="margin-top: 1rem; padding: 1rem; background: rgba(107, 70, 193, 0.1); border-radius: 8px;">
                <strong>Word Bank:</strong> <span id="wordBank"></span>
            </div>
            <button class="btn" onclick="checkFillBlanks()" style="margin-top: 1rem;">Check Answers</button>
            <div id="fillBlanksFeedback" style="margin-top: 1rem;"></div>
        </div>
        
        <div class="nav-arrows">
            <button class="arrow-btn" onclick="showSection('lowlevel')">‚Üê Previous</button>
            <button class="arrow-btn" onclick="showSection('benefits')">Next ‚Üí</button>
        </div>
    </section>

    <!-- Benefits Section -->
    <section class="section" id="benefits">
        <div class="card">
            <h2>Benefits Comparison</h2>
            <p>Understanding when to use each type of translator is crucial for software development.</p>
            
            <h3>Scenario Analysis</h3>
            <div id="scenarioQuestions"></div>
            
            <h3>Combined Usage: Best of Both Worlds</h3>
            <p>Many modern development environments use both interpreters and compilers. Match the development stage to the appropriate translator:</p>
            <div id="developmentStages" style="margin-top: 1rem;"></div>
            <button class="btn" onclick="checkDevelopmentStages()">Check Answers</button>
            <div id="developmentFeedback" style="margin-top: 1rem;"></div>
        </div>
        
        <div class="card">
            <h2>Common Mistakes</h2>
            <div style="background: rgba(239, 68, 68, 0.1); border-left: 4px solid var(--danger); padding: 1rem; border-radius: 0 8px 8px 0;">
                <h4>‚ö†Ô∏è Avoid These Common Misconceptions:</h4>
                <ul>
                    <li>Thinking compilers are always faster than interpreters (not during development!)</li>
                    <li>Believing machine code and assembly language are the same thing</li>
                    <li>Assuming all programming languages use the same type of translator</li>
                    <li>Forgetting that object code still needs linking to become executable</li>
                </ul>
            </div>
        </div>
        
        <div class="nav-arrows">
            <button class="arrow-btn" onclick="showSection('translators')">‚Üê Previous</button>
            <button class="arrow-btn" onclick="showSection('java')">Next ‚Üí</button>
        </div>
    </section>

    <!-- Java Section -->
    <section class="section" id="java">
        <div class="card">
            <h2>Java: Machine Independence</h2>
            <p>Java achieves "write once, run anywhere" through a unique compilation process.</p>
            
            <h3>Java Compilation Process Simulation</h3>
            <div class="simulation">
                <p>Follow the journey of Java code from source to execution:</p>
                <div class="sim-controls">
                    <button class="btn" onclick="startJavaSim()">Start</button>
                    <button class="btn" onclick="nextJavaStep()">Next Step</button>
                    <button class="btn" onclick="prevJavaStep()">Previous Step</button>
                    <button class="btn" onclick="resetJavaSim()">Reset</button>
                </div>
                <div id="javaSimDisplay"></div>
            </div>
            
            <h3>Bytecode Explorer</h3>
            <p>Convert simple Java code to bytecode representation:</p>
            <textarea id="javaCode" rows="4" placeholder="public class Hello {
    public static void main(String[] args) {
        System.out.println(&quot;Hello World&quot;);
    }
}"></textarea>
            <button class="btn" onclick="showBytecode()" style="margin-top: 0.5rem;">Show Bytecode</button>
            <div id="bytecodeDisplay" style="margin-top: 1rem;"></div>
            
            <h3>JVM Quiz</h3>
            <div id="jvmQuiz"></div>
        </div>
        
        <div class="card">
            <h2>Real-World Context: Java Applications</h2>
            <p>Java's machine independence makes it ideal for:</p>
            <ul>
                <li>üåê Web applications (server-side with Spring, servlets)</li>
                <li>üì± Android app development</li>
                <li>üè¢ Enterprise software (banking, e-commerce)</li>
                <li>üéÆ Minecraft and other cross-platform games</li>
                <li>‚òÅÔ∏è Cloud and distributed systems</li>
            </ul>
        </div>
        
        <div class="nav-arrows">
            <button class="arrow-btn" onclick="showSection('benefits')">‚Üê Previous</button>
            <button class="arrow-btn" onclick="showSection('practice')">Next ‚Üí</button>
        </div>
    </section>

    <!-- Practice Section -->
    <section class="section" id="practice">
        <div class="card">
            <h2>Practice Exam Questions</h2>
            <p>Test your understanding with these exam-style questions. Enter your predicted marks for self-assessment.</p>
            
            <div id="examQuestions"></div>
            
            <h3>Drawing Canvas for Working</h3>
            <p>Use this canvas for any calculations or diagrams:</p>
            <div class="canvas-container">
                <canvas id="drawingCanvas" width="800" height="400"></canvas>
            </div>
            <button class="btn" onclick="clearCanvas()">Clear Canvas</button>
        </div>
        
        <div class="nav-arrows">
            <button class="arrow-btn" onclick="showSection('java')">‚Üê Previous</button>
            <button class="arrow-btn" onclick="showSection('extension')">Next ‚Üí</button>
        </div>
    </section>

    <!-- Extension Section -->
    <section class="section" id="extension">
        <div class="card">
            <h2>Extension Activities: Beyond the Specification</h2>
            <p>Challenge yourself with these advanced topics!</p>
            
            <h3>1. Create Your Own Assembly Instruction</h3>
            <p>Design a new assembly language instruction that doesn't exist. What would it do? How would it work?</p>
            <textarea id="customInstruction" rows="4" placeholder="Instruction name: 
Purpose: 
Syntax: 
Example usage:"></textarea>
            <button class="btn" onclick="submitCustomInstruction()" style="margin-top: 0.5rem;">Submit Design</button>
            
            <h3>2. Research Task: Modern Uses of Assembly</h3>
            <p>Research and describe three modern applications where assembly language is still used today:</p>
            <textarea id="modernAssembly" rows="4" placeholder="1. 
2. 
3."></textarea>
            <button class="btn" onclick="submitModernAssembly()" style="margin-top: 0.5rem;">Submit Research</button>
            
            <h3>3. JVM Alternatives</h3>
            <p>Research other virtual machines (like .NET CLR, Python VM). How do they compare to the JVM?</p>
            <textarea id="vmComparison" rows="4" placeholder="Your comparison here..."></textarea>
            <button class="btn" onclick="submitVMComparison()" style="margin-top: 0.5rem;">Submit Comparison</button>
        </div>
        
        <div class="nav-arrows">
            <button class="arrow-btn" onclick="showSection('practice')">‚Üê Previous</button>
            <button class="arrow-btn" onclick="showSection('summary')">Next ‚Üí</button>
        </div>
    </section>

    <!-- Summary Section -->
    <section class="section" id="summary">
        <div class="card">
            <h2>Summary & Final Assessment</h2>
            <p>Let's review what you've learned with a comprehensive quiz!</p>
            
            <div id="finalQuiz"></div>
            
            <button class="btn" onclick="checkFinalQuiz()" style="margin-top: 2rem;">Submit Final Quiz</button>
            <div id="finalQuizResults" style="margin-top: 1rem;"></div>
        </div>
        
        <div class="card">
            <h2>Key Takeaways</h2>
            <ul>
                <li>Assembly language uses mnemonic codes and is hardware-specific</li>
                <li>Machine code is binary/hexadecimal instructions the CPU executes directly</li>
                <li>Object code is compiler output that needs linking to become executable</li>
                <li>Compilers translate entire programs before execution</li>
                <li>Interpreters translate and execute line by line</li>
                <li>Java achieves platform independence through bytecode and the JVM</li>
                <li>Different translators suit different development needs</li>
            </ul>
        </div>
        
        <div class="card">
            <h2>Videos & Further Learning</h2>
            <p style="background: rgba(107, 70, 193, 0.1); padding: 1rem; border-radius: 8px;">
                üìπ <em>Video content will be added here. Check back soon for visual explanations of these concepts!</em>
            </p>
        </div>
        
        <div class="nav-arrows">
            <button class="arrow-btn" onclick="showSection('extension')">‚Üê Previous</button>
            <div></div>
        </div>
    </section>

    <!-- Achievement Popup -->
    <div class="achievement" id="achievementPopup">
        <h3><span class="achievement-icon">üèÜ</span> <span id="achievementTitle">Achievement Unlocked!</span></h3>
        <p id="achievementDesc">You've completed your first task!</p>
    </div>

    <!-- XP Popup (dynamically created) -->

    <!-- Feedback Button & Modal -->
    <button class="feedback-btn" onclick="openFeedback()">üí¨</button>
    
    <div class="feedback-modal" id="feedbackModal">
        <div class="feedback-content">
            <h3>Send Feedback</h3>
            <p>Found a bug or have a suggestion? Let us know!</p>
            <textarea id="feedbackText" rows="5" placeholder="Describe the issue or suggestion..."></textarea>
            <div style="margin-top: 1rem;">
                <button class="btn" onclick="sendFeedback()">Send</button>
                <button class="btn" onclick="closeFeedback()" style="margin-left: 1rem;">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Shame Message -->
    <div class="shame-message" id="shameMessage">
        üö´ No pasting allowed! Type it yourself to learn properly! üö´
    </div>

    <script>
        // Game State
        let gameState = {
            xp: 0,
            level: 0,
            maxXP: 1000,
            achievements: new Set(),
            completedTasks: new Set(),
            currentSection: 'intro',
            assemblyStep: 0,
            compilerStep: 0,
            javaStep: 0,
            selectedTerm: null,
            matchedPairs: new Set()
        };

        // XP Thresholds for levels
        const levelThresholds = [0, 200, 400, 600, 800, 1000];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeParticles();
            initializeCanvas();
            setupPasteProtection();
            loadGameState();
            initializeActivities();
        });

        // Particle System
        function initializeParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 50; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 3 + 's';
                particle.style.animationDuration = (3 + Math.random() * 2) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Canvas Setup
        function initializeCanvas() {
            const canvas = document.getElementById('drawingCanvas');
            const ctx = canvas.getContext('2d');
            let drawing = false;
            
            // Handle both mouse and touch events
            function startDrawing(e) {
                drawing = true;
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                ctx.beginPath();
                ctx.moveTo(x, y);
            }
            
            function draw(e) {
                if (!drawing) return;
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                ctx.lineTo(x, y);
                ctx.stroke();
            }
            
            function stopDrawing() {
                drawing = false;
            }
            
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            canvas.addEventListener('touchstart', function(e) {
                e.preventDefault();
                startDrawing(e);
            });
            canvas.addEventListener('touchmove', function(e) {
                e.preventDefault();
                draw(e);
            });
            canvas.addEventListener('touchend', stopDrawing);
            
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
        }

        function clearCanvas() {
            const canvas = document.getElementById('drawingCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            showXPPopup(5, canvas);
        }

        // Paste Protection
        function setupPasteProtection() {
            document.addEventListener('paste', function(e) {
                e.preventDefault();
                const shame = document.getElementById('shameMessage');
                shame.style.display = 'block';
                setTimeout(() => shame.style.display = 'none', 3000);
                return false;
            });
            
            // Also prevent context menu on inputs
            document.addEventListener('contextmenu', function(e) {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                    e.preventDefault();
                    return false;
                }
            });
        }

        // Game State Management
        function saveGameState() {
            const state = {
                xp: gameState.xp,
                level: gameState.level,
                achievements: Array.from(gameState.achievements),
                completedTasks: Array.from(gameState.completedTasks)
            };
            // In a real implementation, this would save to a backend
            console.log('Game state saved:', state);
        }

        function loadGameState() {
            // In a real implementation, this would load from a backend
            updateXPDisplay();
        }

        // XP System
        function addXP(amount, element) {
            if (!element || !element.dataset.taskId) return;
            
            const taskId = element.dataset.taskId;
            if (gameState.completedTasks.has(taskId)) return;
            
            gameState.completedTasks.add(taskId);
            gameState.xp += amount;
            
            // Check for level up
            const oldLevel = gameState.level;
            for (let i = levelThresholds.length - 1; i >= 0; i--) {
                if (gameState.xp >= levelThresholds[i]) {
                    gameState.level = i;
                    break;
                }
            }
            
            if (oldLevel < gameState.level && gameState.level > 0) {
                showAchievement('Level Up!', `You've reached Level ${gameState.level}!`);
                createLevelUpParticles();
            }
            
            updateXPDisplay();
            showXPPopup(amount, element);
            saveGameState();
        }

        function updateXPDisplay() {
            document.getElementById('currentXP').textContent = gameState.xp;
            document.getElementById('level').textContent = gameState.level;
            const percentage = (gameState.xp / gameState.maxXP) * 100;
            document.getElementById('xpFill').style.width = percentage + '%';
        }

        function showXPPopup(amount, element) {
            const popup = document.createElement('div');
            popup.className = 'xp-popup';
            popup.textContent = `+${amount} XP`;
            
            const rect = element.getBoundingClientRect();
            popup.style.left = rect.left + rect.width / 2 + 'px';
            popup.style.top = rect.top + 'px';
            
            document.body.appendChild(popup);
            setTimeout(() => popup.remove(), 2000);
        }

        function createLevelUpParticles() {
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    particle.style.left = (20 + Math.random() * 60) + '%';
                    particle.style.top = '50%';
                    particle.style.background = '#FCD34D';
                    particle.style.width = '6px';
                    particle.style.height = '6px';
                    document.body.appendChild(particle);
                    setTimeout(() => particle.remove(), 3000);
                }, i * 50);
            }
        }

        // Achievement System
        function showAchievement(title, description) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementTitle').textContent = title;
            document.getElementById('achievementDesc').textContent = description;
            
            popup.classList.add('show');
            setTimeout(() => popup.classList.remove('show'), 5000);
            
            if (!gameState.achievements.has(title)) {
                gameState.achievements.add(title);
                addXP(50, popup);
            }
        }

        // Navigation
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            gameState.currentSection = sectionId;
            window.scrollTo(0, 0);
        }

        // Initialize Activities
        function initializeActivities() {
            initializeStarter();
            initializeAssemblyQuiz();
            initializeObjectCodeActivity();
            initializeTranslatorActivity();
            initializeFillBlanks();
            initializeScenarios();
            initializeDevelopmentStages();
            initializeJVMQuiz();
            initializeExamQuestions();
            initializeFinalQuiz();
            setupCompilerSteps();
            setupJavaSteps();
        }

        // Starter Activity
        function initializeStarter() {
            const terms = [
                { id: 'term1', text: 'High-level language', match: 'desc1' },
                { id: 'term2', text: 'Machine code', match: 'desc2' },
                { id: 'term3', text: 'Compiler', match: 'desc3' },
                { id: 'term4', text: 'Platform independent', match: 'desc4' }
            ];
            
            const descriptions = [
                { id: 'desc1', text: 'Uses English-like syntax that humans can understand' },
                { id: 'desc2', text: 'Binary instructions that the CPU executes directly' },
                { id: 'desc3', text: 'Translates entire program before execution' },
                { id: 'desc4', text: 'Can run on any hardware without modification' }
            ];
            
            // Shuffle descriptions
            descriptions.sort(() => Math.random() - 0.5);
            
            const termsContainer = document.getElementById('starterTerms');
            const descsContainer = document.getElementById('starterDescriptions');
            
            terms.forEach(term => {
                const div = document.createElement('div');
                div.className = 'click-item';
                div.textContent = term.text;
                div.dataset.id = term.id;
                div.dataset.match = term.match;
                div.dataset.taskId = 'starter-' + term.id;
                div.onclick = () => selectStarterItem(div);
                termsContainer.appendChild(div);
            });
            
            descriptions.forEach(desc => {
                const div = document.createElement('div');
                div.className = 'click-item';
                div.textContent = desc.text;
                div.dataset.id = desc.id;
                div.dataset.taskId = 'starter-' + desc.id;
                div.onclick = () => selectStarterItem(div);
                descsContainer.appendChild(div);
            });
        }

        function selectStarterItem(element) {
            if (element.classList.contains('matched')) return;
            
            if (!gameState.selectedTerm) {
                // First selection
                document.querySelectorAll('.click-item').forEach(item => {
                    item.classList.remove('selected');
                });
                element.classList.add('selected');
                gameState.selectedTerm = element;
            } else {
                // Second selection - check for match
                const term = gameState.selectedTerm;
                const desc = element;
                
                if (term.dataset.match === desc.dataset.id || desc.dataset.match === term.dataset.id) {
                    // Match!
                    term.classList.add('matched');
                    desc.classList.add('matched');
                    term.style.background = 'rgba(16, 185, 129, 0.3)';
                    desc.style.background = 'rgba(16, 185, 129, 0.3)';
                    gameState.matchedPairs.add(term.dataset.id);
                    addXP(25, element);
                    
                    if (gameState.matchedPairs.size === 4) {
                        showAchievement('Perfect Match!', 'Completed the starter activity perfectly!');
                    }
                } else {
                    // No match
                    term.style.background = 'rgba(239, 68, 68, 0.3)';
                    desc.style.background = 'rgba(239, 68, 68, 0.3)';
                    setTimeout(() => {
                        term.style.background = '';
                        desc.style.background = '';
                    }, 1000);
                }
                
                term.classList.remove('selected');
                gameState.selectedTerm = null;
            }
        }

        function checkStarterMatching() {
            const feedback = document.getElementById('starterFeedback');
            if (gameState.matchedPairs.size === 4) {
                feedback.innerHTML = '<p style="color: var(--success);">‚úì Excellent! All matches are correct!</p>';
            } else {
                feedback.innerHTML = `<p style="color: var(--warning);">You've matched ${gameState.matchedPairs.size}/4 correctly. Keep trying!</p>`;
            }
        }

        function resetStarter() {
            gameState.matchedPairs.clear();
            gameState.selectedTerm = null;
            document.querySelectorAll('.click-item').forEach(item => {
                item.classList.remove('selected', 'matched');
                item.style.background = '';
            });
            document.getElementById('starterFeedback').innerHTML = '';
        }

        // Assembly Language Activities
        function initializeAssemblyQuiz() {
            const options = [
                'A programming language using binary digits that CPUs understand',
                'A low-level language using mnemonic codes specific to hardware',
                'A high-level language that runs on virtual machines',
                'A type of compiler that produces object code'
            ];
            
            // Shuffle options
            options.sort(() => Math.random() - 0.5);
            
            const container = document.getElementById('assemblyQuizOptions');
            options.forEach((option, index) => {
                const div = document.createElement('div');
                div.className = 'quiz-option';
                div.textContent = option;
                div.dataset.taskId = 'assembly-quiz-' + index;
                div.onclick = () => checkAssemblyQuiz(div, option);
                container.appendChild(div);
            });
        }

        function checkAssemblyQuiz(element, answer) {
            const correct = 'A low-level language using mnemonic codes specific to hardware';
            document.querySelectorAll('#assemblyQuizOptions .quiz-option').forEach(opt => {
                opt.onclick = null;
                if (opt.textContent === correct) {
                    opt.classList.add('correct');
                } else {
                    opt.classList.add('incorrect');
                }
            });
            
            if (answer === correct) {
                addXP(30, element);
                showAchievement('Assembly Expert', 'Correctly identified assembly language!');
            }
        }

        // Assembly Simulation
        let assemblyRegisters = { AX: 0, BX: 0, CX: 0 };
        let assemblyInstructions = [
            { instruction: 'MOV AX, 5', action: () => assemblyRegisters.AX = 5 },
            { instruction: 'MOV BX, 3', action: () => assemblyRegisters.BX = 3 },
            { instruction: 'ADD AX, BX', action: () => assemblyRegisters.AX += assemblyRegisters.BX },
            { instruction: 'MOV CX, AX', action: () => assemblyRegisters.CX = assemblyRegisters.AX }
        ];

        function startAssemblySimulation() {
            gameState.assemblyStep = 0;
            resetAssemblySimulation();
            stepAssemblySimulation();
        }

        function stepAssemblySimulation() {
            if (gameState.assemblyStep >= assemblyInstructions.length) return;
            
            // Clear previous highlights
            document.querySelectorAll('#assemblyCode div').forEach((line, index) => {
                line.classList.remove('highlight-active');
            });
            
            // Execute current instruction
            const currentInstruction = assemblyInstructions[gameState.assemblyStep];
            currentInstruction.action();
            
            // Highlight current line
            document.querySelectorAll('#assemblyCode div')[gameState.assemblyStep].classList.add('highlight-active');
            
            // Update register display
            document.getElementById('regAX').textContent = assemblyRegisters.AX;
            document.getElementById('regBX').textContent = assemblyRegisters.BX;
            document.getElementById('regCX').textContent = assemblyRegisters.CX;
            
            gameState.assemblyStep++;
            
            if (gameState.assemblyStep === assemblyInstructions.length) {
                const btn = document.querySelector('#lowlevel .simulation .btn');
                btn.dataset.taskId = 'assembly-simulation-complete';
                addXP(40, btn);
            }
        }

        function resetAssemblySimulation() {
            gameState.assemblyStep = 0;
            assemblyRegisters = { AX: 0, BX: 0, CX: 0 };
            document.getElementById('regAX').textContent = '0';
            document.getElementById('regBX').textContent = '0';
            document.getElementById('regCX').textContent = '0';
            document.querySelectorAll('#assemblyCode div').forEach(line => {
                line.classList.remove('highlight-active');
            });
        }

        // Machine Code Converter
        function convertToMachineCode() {
            const input = document.getElementById('assemblyInput').value.trim().toUpperCase();
            const output = document.getElementById('machineCodeOutput');
            
            const conversions = {
                'MOV AX, 5': 'B8 05 00',
                'MOV BX, 3': 'BB 03 00',
                'ADD AX, BX': '01 D8',
                'MOV CX, AX': '89 C1'
            };
            
            if (conversions[input]) {
                output.innerHTML = `<div class="code-display">Machine Code: ${conversions[input]}</div>`;
                output.dataset.taskId = 'machine-code-convert';
                addXP(25, output);
            } else {
                output.innerHTML = '<div style="color: var(--danger);">Unknown instruction. Try: MOV AX, 5</div>';
            }
        }

        // Object Code Activity
        function initializeObjectCodeActivity() {
            const steps = [
                'Write source code in high-level language',
                'Compiler translates to object code',
                'Linker combines object files and libraries',
                'Loader places executable in memory',
                'CPU executes the machine code'
            ];
            
            // Shuffle steps
            const shuffled = [...steps].sort(() => Math.random() - 0.5);
            
            const container = document.getElementById('objectCodeSteps');
            shuffled.forEach((step, index) => {
                const div = document.createElement('div');
                div.className = 'drag-item';
                div.textContent = `${index + 1}. ${step}`;
                div.dataset.correct = steps.indexOf(step);
                div.dataset.taskId = 'object-step-' + index;
                div.draggable = true;
                div.ondragstart = (e) => drag(e);
                container.appendChild(div);
            });
        }

        function checkObjectCodeOrder() {
            const items = document.querySelectorAll('#objectCodeSteps .drag-item');
            let correct = true;
            
            items.forEach((item, index) => {
                if (parseInt(item.dataset.correct) !== index) {
                    correct = false;
                }
            });
            
            const feedback = document.getElementById('objectCodeFeedback');
            if (correct) {
                feedback.innerHTML = '<p style="color: var(--success);">‚úì Perfect! The compilation process is in the correct order.</p>';
                const btn = document.querySelector('#lowlevel .card:last-child .btn');
                btn.dataset.taskId = 'object-code-complete';
                addXP(35, btn);
            } else {
                feedback.innerHTML = '<p style="color: var(--danger);">‚úó Not quite right. Think about what needs to happen first.</p>';
            }
        }

        function resetObjectCodeOrder() {
            const container = document.getElementById('objectCodeSteps');
            const items = Array.from(container.children);
            items.sort(() => Math.random() - 0.5);
            container.innerHTML = '';
            items.forEach(item => container.appendChild(item));
            document.getElementById('objectCodeFeedback').innerHTML = '';
        }

        // Translator Activities
        function initializeTranslatorActivity() {
            const characteristics = [
                { text: 'Produces executable file', type: 'compiler' },
                { text: 'Easier debugging', type: 'interpreter' },
                { text: 'Source code kept secure', type: 'compiler' },
                { text: 'Executes immediately', type: 'interpreter' },
                { text: 'Cross-compilation possible', type: 'compiler' },
                { text: 'Errors found in real-time', type: 'interpreter' },
                { text: 'Faster execution speed', type: 'compiler' },
                { text: 'No need to compile entire program', type: 'interpreter' }
            ];
            
            const container = document.getElementById('translatorCharacteristics');
            characteristics.forEach((char, index) => {
                const div = document.createElement('div');
                div.className = 'drag-item';
                div.textContent = char.text;
                div.dataset.type = char.type;
                div.dataset.taskId = 'translator-char-' + index;
                div.draggable = true;
                div.ondragstart = (e) => drag(e);
                container.appendChild(div);
            });
        }

        // Drag and Drop functionality
        function allowDrop(ev) {
            ev.preventDefault();
            ev.currentTarget.classList.add('highlight');
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.id);
            ev.dataTransfer.setData("type", ev.target.dataset.type);
        }

        function drop(ev, dropType) {
            ev.preventDefault();
            ev.currentTarget.classList.remove('highlight');
            
            const data = ev.dataTransfer.getData("text");
            const itemType = ev.dataTransfer.getData("type");
            
            if (itemType === dropType) {
                const element = document.getElementById(data) || ev.dataTransfer.getData("element");
                ev.target.appendChild(element);
            }
        }

        function checkTranslatorSort() {
            const compilerItems = document.querySelectorAll('#compilerDrop .drag-item');
            const interpreterItems = document.querySelectorAll('#interpreterDrop .drag-item');
            
            let correct = true;
            compilerItems.forEach(item => {
                if (item.dataset.type !== 'compiler') correct = false;
            });
            interpreterItems.forEach(item => {
                if (item.dataset.type !== 'interpreter') correct = false;
            });
            
            const feedback = document.getElementById('translatorFeedback');
            if (correct && compilerItems.length === 4 && interpreterItems.length === 4) {
                feedback.innerHTML = '<p style="color: var(--success);">‚úì Excellent! All characteristics correctly categorized.</p>';
                const btn = event.target;
                btn.dataset.taskId = 'translator-sort-complete';
                addXP(40, btn);
                showAchievement('Translator Master', 'Perfectly categorized compiler and interpreter characteristics!');
            } else {
                feedback.innerHTML = '<p style="color: var(--danger);">‚úó Some items are in the wrong category. Try again!</p>';
            }
        }

        function resetTranslatorSort() {
            const container = document.getElementById('translatorCharacteristics');
            const items = document.querySelectorAll('.drop-zone .drag-item');
            items.forEach(item => container.appendChild(item));
            document.getElementById('translatorFeedback').innerHTML = '';
        }

        // Fill in the Blanks
        function initializeFillBlanks() {
            const sentences = [
                { text: 'An assembler translates ___ statements into machine code.', answer: 'low-level', options: ['low-level', 'high-level', 'intermediate', 'object'] },
                { text: 'Compilers produce ___ files that can be distributed.', answer: 'executable', options: ['executable', 'source', 'text', 'temporary'] },
                { text: 'Interpreters translate and execute code ___ by ___.', answer: 'line,line', options: ['line,line', 'file,file', 'block,block', 'program,program'] },
                { text: 'Java achieves platform independence through ___.', answer: 'bytecode', options: ['bytecode', 'assembly', 'machine code', 'source code'] }
            ];
            
            const container = document.getElementById('fillBlanksTranslators');
            const allOptions = new Set();
            
            sentences.forEach((sentence, index) => {
                const parts = sentence.text.split('___');
                const div = document.createElement('div');
                div.style.marginBottom = '1rem';
                
                if (parts.length === 2) {
                    div.innerHTML = `${parts[0]}<select id="blank${index}" data-answer="${sentence.answer}" data-task-id="fill-blank-${index}">
                        <option value="">Choose...</option>
                        ${sentence.options.map(opt => `<option value="${opt}">${opt}</option>`).join('')}
                    </select>${parts[1]}`;
                } else {
                    // Handle multiple blanks
                    const answers = sentence.answer.split(',');
                    let html = parts[0];
                    for (let i = 1; i < parts.length; i++) {
                        html += `<select id="blank${index}-${i}" data-answer="${answers[i-1]}" data-task-id="fill-blank-${index}-${i}">
                            <option value="">Choose...</option>
                            ${sentence.options[0].split(',').map(opt => `<option value="${opt}">${opt}</option>`).join('')}
                        </select>${parts[i]}`;
                    }
                    div.innerHTML = html;
                }
                
                container.appendChild(div);
                sentence.options.forEach(opt => allOptions.add(opt));
            });
            
            // Add more distractor words to word bank
            ['compiler', 'interpreter', 'virtual machine', 'binary', 'hexadecimal'].forEach(word => allOptions.add(word));
            
            document.getElementById('wordBank').textContent = Array.from(allOptions).sort().join(', ');
        }

        function checkFillBlanks() {
            const selects = document.querySelectorAll('#fillBlanksTranslators select');
            let correct = 0;
            let total = selects.length;
            
            selects.forEach(select => {
                const answer = select.value;
                const expected = select.dataset.answer;
                
                if (answer === expected) {
                    select.style.borderColor = 'var(--success)';
                    correct++;
                    addXP(10, select);
                } else {
                    select.style.borderColor = 'var(--danger)';
                }
            });
            
            const feedback = document.getElementById('fillBlanksFeedback');
            if (correct === total) {
                feedback.innerHTML = '<p style="color: var(--success);">‚úì Perfect! All answers are correct.</p>';
                showAchievement('Fill Master', 'Completed all fill-in-the-blanks correctly!');
            } else {
                feedback.innerHTML = `<p style="color: var(--warning);">You got ${correct}/${total} correct. Review the incorrect ones.</p>`;
            }
        }

        // Compiler Simulation
        const compilerSteps = [
            { title: 'Lexical Analysis', description: 'Breaking code into tokens (keywords, identifiers, operators)', visual: 'int x = 5; ‚Üí [int] [x] [=] [5] [;]' },
            { title: 'Syntax Analysis', description: 'Checking grammar rules and building parse tree', visual: 'Verifying statement structure is valid' },
            { title: 'Semantic Analysis', description: 'Checking meaning (type checking, declarations)', visual: 'Ensuring \'x\' is declared and types match' },
            { title: 'Code Generation', description: 'Producing object code', visual: 'MOV EAX, 5\nMOV [x], EAX' },
            { title: 'Optimization', description: 'Improving code efficiency', visual: 'Removing redundant operations' }
        ];

        function setupCompilerSteps() {
            const progress = document.getElementById('compilerProgress');
            compilerSteps.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = 'progress-dot';
                if (index === 0) dot.classList.add('active');
                progress.appendChild(dot);
            });
            updateCompilerDisplay();
        }

        function startCompilerSim() {
            gameState.compilerStep = 0;
            updateCompilerDisplay();
            updateCompilerProgress();
        }

        function nextCompilerStep() {
            if (gameState.compilerStep < compilerSteps.length - 1) {
                gameState.compilerStep++;
                updateCompilerDisplay();
                updateCompilerProgress();
            }
            
            if (gameState.compilerStep === compilerSteps.length - 1) {
                const btn = event.target;
                btn.dataset.taskId = 'compiler-sim-complete';
                addXP(30, btn);
            }
        }

        function prevCompilerStep() {
            if (gameState.compilerStep > 0) {
                gameState.compilerStep--;
                updateCompilerDisplay();
                updateCompilerProgress();
            }
        }

        function resetCompilerSim() {
            gameState.compilerStep = 0;
            updateCompilerDisplay();
            updateCompilerProgress();
        }

        function updateCompilerDisplay() {
            const step = compilerSteps[gameState.compilerStep];
            const display = document.getElementById('compilerDisplay');
            display.innerHTML = `
                <h4>${step.title}</h4>
                <p>${step.description}</p>
                <div class="code-display">${step.visual}</div>
            `;
        }

        function updateCompilerProgress() {
            document.querySelectorAll('#compilerProgress .progress-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index <= gameState.compilerStep);
            });
        }

        // Scenarios
        function initializeScenarios() {
            const scenarios = [
                {
                    question: 'You\'re developing a mobile game that needs to run on both iOS and Android. Which approach would be best?',
                    options: [
                        { text: 'Use a compiler for each platform separately', correct: false },
                        { text: 'Use Java or a cross-platform framework', correct: true },
                        { text: 'Use assembly language for performance', correct: false },
                        { text: 'Use an interpreter for both platforms', correct: false }
                    ]
                },
                {
                    question: 'You need to create device drivers for new hardware. Which language is most appropriate?',
                    options: [
                        { text: 'Java for platform independence', correct: false },
                        { text: 'Python with an interpreter', correct: false },
                        { text: 'Assembly language for hardware control', correct: true },
                        { text: 'Any high-level language with a compiler', correct: false }
                    ]
                }
            ];
            
            const container = document.getElementById('scenarioQuestions');
            scenarios.forEach((scenario, sIndex) => {
                const div = document.createElement('div');
                div.style.marginBottom = '2rem';
                div.innerHTML = `<h4>Scenario ${sIndex + 1}</h4><p>${scenario.question}</p>`;
                
                const optionsDiv = document.createElement('div');
                scenario.options.sort(() => Math.random() - 0.5);
                
                scenario.options.forEach((option, oIndex) => {
                    const optDiv = document.createElement('div');
                    optDiv.className = 'quiz-option';
                    optDiv.textContent = option.text;
                    optDiv.dataset.correct = option.correct;
                    optDiv.dataset.taskId = `scenario-${sIndex}-${oIndex}`;
                    optDiv.onclick = () => checkScenarioAnswer(optDiv, sIndex);
                    optionsDiv.appendChild(optDiv);
                });
                
                div.appendChild(optionsDiv);
                container.appendChild(div);
            });
        }

        function checkScenarioAnswer(element, scenarioIndex) {
            const options = element.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => {
                opt.onclick = null;
                if (opt.dataset.correct === 'true') {
                    opt.classList.add('correct');
                } else {
                    opt.classList.add('incorrect');
                }
            });
            
            if (element.dataset.correct === 'true') {
                addXP(25, element);
            }
        }

        // Development Stages
        function initializeDevelopmentStages() {
            const stages = [
                { stage: 'During development and debugging', translator: 'interpreter' },
                { stage: 'Creating final executable for distribution', translator: 'compiler' },
                { stage: 'Testing individual functions quickly', translator: 'interpreter' },
                { stage: 'Optimizing performance for production', translator: 'compiler' }
            ];
            
            const container = document.getElementById('developmentStages');
            stages.forEach((item, index) => {
                const div = document.createElement('div');
                div.style.marginBottom = '1rem';
                div.innerHTML = `
                    ${item.stage}: 
                    <select id="devStage${index}" data-correct="${item.translator}" data-task-id="dev-stage-${index}">
                        <option value="">Choose...</option>
                        <option value="compiler">Compiler</option>
                        <option value="interpreter">Interpreter</option>
                        <option value="both">Both</option>
                    </select>
                `;
                container.appendChild(div);
            });
        }

        function checkDevelopmentStages() {
            const selects = document.querySelectorAll('#developmentStages select');
            let correct = 0;
            
            selects.forEach(select => {
                if (select.value === select.dataset.correct) {
                    select.style.borderColor = 'var(--success)';
                    correct++;
                    addXP(15, select);
                } else {
                    select.style.borderColor = 'var(--danger)';
                }
            });
            
            const feedback = document.getElementById('developmentFeedback');
            if (correct === selects.length) {
                feedback.innerHTML = '<p style="color: var(--success);">‚úì Excellent understanding of when to use each translator!</p>';
            } else {
                feedback.innerHTML = `<p style="color: var(--warning);">You got ${correct}/${selects.length} correct.</p>`;
            }
        }

        // Java Simulation
        const javaSteps = [
            { title: 'Java Source Code', visual: 'HelloWorld.java', description: 'Platform-independent source code' },
            { title: 'Java Compiler (javac)', visual: 'javac HelloWorld.java', description: 'Compiling to bytecode' },
            { title: 'Java Bytecode', visual: 'HelloWorld.class', description: 'Platform-independent bytecode' },
            { title: 'Java Virtual Machine', visual: 'java HelloWorld', description: 'JVM interprets bytecode' },
            { title: 'Platform-Specific Execution', visual: 'Running on Windows/Mac/Linux', description: 'Same bytecode, different platforms' }
        ];

        function setupJavaSteps() {
            updateJavaDisplay();
        }

        function startJavaSim() {
            gameState.javaStep = 0;
            updateJavaDisplay();
        }

        function nextJavaStep() {
            if (gameState.javaStep < javaSteps.length - 1) {
                gameState.javaStep++;
                updateJavaDisplay();
            }
            
            if (gameState.javaStep === javaSteps.length - 1) {
                const btn = event.target;
                btn.dataset.taskId = 'java-sim-complete';
                addXP(35, btn);
                showAchievement('Java Journey', 'Completed the Java compilation process!');
            }
        }

        function prevJavaStep() {
            if (gameState.javaStep > 0) {
                gameState.javaStep--;
                updateJavaDisplay();
            }
        }

        function resetJavaSim() {
            gameState.javaStep = 0;
            updateJavaDisplay();
        }

        function updateJavaDisplay() {
            const step = javaSteps[gameState.javaStep];
            const display = document.getElementById('javaSimDisplay');
            display.innerHTML = `
                <h4>Step ${gameState.javaStep + 1}: ${step.title}</h4>
                <div class="code-display" style="text-align: center; font-size: 1.2rem;">
                    ${step.visual}
                </div>
                <p>${step.description}</p>
                <div class="progress-dots" style="margin-top: 1rem;">
                    ${javaSteps.map((_, i) => `<div class="progress-dot ${i <= gameState.javaStep ? 'active' : ''}"></div>`).join('')}
                </div>
            `;
        }

        // Bytecode Display
        function showBytecode() {
            const display = document.getElementById('bytecodeDisplay');
            display.innerHTML = `
                <div class="code-display">
                    <pre>Compiled from "Hello.java"
public class Hello {
  public Hello();
    Code:
       0: aload_0
       1: invokespecial #1  // Method java/lang/Object."<init>":()V
       4: return

  public static void main(java.lang.String[]);
    Code:
       0: getstatic     #2  // Field java/lang/System.out
       3: ldc           #3  // String Hello World
       5: invokevirtual #4  // Method java/io/PrintStream.println
       8: return
}</pre>
                </div>
            `;
            display.dataset.taskId = 'bytecode-explorer';
            addXP(20, display);
        }

        // JVM Quiz
        function initializeJVMQuiz() {
            const container = document.getElementById('jvmQuiz');
            container.innerHTML = `
                <h4>Why does Java use a two-step translation process?</h4>
                <div id="jvmOptions"></div>
            `;
            
            const options = [
                'To make programs run faster than compiled languages',
                'To achieve platform independence through bytecode',
                'To avoid using compilers completely',
                'To make debugging more difficult'
            ];
            
            options.sort(() => Math.random() - 0.5);
            
            const optionsContainer = document.getElementById('jvmOptions');
            options.forEach((option, index) => {
                const div = document.createElement('div');
                div.className = 'quiz-option';
                div.textContent = option;
                div.dataset.taskId = `jvm-quiz-${index}`;
                div.onclick = () => {
                    const correct = 'To achieve platform independence through bytecode';
                    document.querySelectorAll('#jvmOptions .quiz-option').forEach(opt => {
                        opt.onclick = null;
                        if (opt.textContent === correct) {
                            opt.classList.add('correct');
                        } else {
                            opt.classList.add('incorrect');
                        }
                    });
                    
                    if (option === correct) {
                        addXP(25, div);
                    }
                };
                optionsContainer.appendChild(div);
            });
        }

        // Practice Exam Questions
        function initializeExamQuestions() {
            const questions = [
                {
                    question: 'Explain the difference between a compiler and an interpreter. [4 marks]',
                    markScheme: [
                        'Compiler translates entire program before execution (1)',
                        'Interpreter translates and executes line by line (1)',
                        'Compiler produces executable file (1)',
                        'Interpreter needs source code present to run (1)'
                    ],
                    marks: 4
                },
                {
                    question: 'Describe how Java achieves platform independence. [3 marks]',
                    markScheme: [
                        'Java source code compiled to bytecode (1)',
                        'Bytecode is platform-independent (1)',
                        'JVM on each platform interprets bytecode (1)'
                    ],
                    marks: 3
                },
                {
                    question: 'State two advantages of using assembly language for system programming. [2 marks]',
                    markScheme: [
                        'Direct hardware control (1)',
                        'Maximum performance/efficiency (1)',
                        'Small program size (1)',
                        'Access to CPU-specific features (1)'
                    ],
                    marks: 2
                }
            ];
            
            const container = document.getElementById('examQuestions');
            questions.forEach((q, index) => {
                const div = document.createElement('div');
                div.className = 'card';
                div.innerHTML = `
                    <h4>Question ${index + 1}</h4>
                    <p>${q.question}</p>
                    <textarea id="examAnswer${index}" rows="4" placeholder="Type your answer here..."></textarea>
                    <div style="margin-top: 1rem;">
                        <label>Predicted marks: </label>
                        <input type="number" id="predictedMarks${index}" min="0" max="${q.marks}" style="width: 60px;">
                        <span> / ${q.marks}</span>
                    </div>
                    <button class="btn" onclick="showMarkScheme(${index})" style="margin-top: 1rem;">Show Mark Scheme</button>
                    <div class="mark-scheme" id="markScheme${index}">
                        <h5>Mark Scheme:</h5>
                        <ul>
                            ${q.markScheme.map(point => `<li>${point}</li>`).join('')}
                        </ul>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function showMarkScheme(index) {
            const answer = document.getElementById(`examAnswer${index}`).value;
            const predicted = document.getElementById(`predictedMarks${index}`).value;
            
            if (answer.length < 50) {
                alert('Please write a more detailed answer before viewing the mark scheme.');
                return;
            }
            
            if (!predicted) {
                alert('Please enter your predicted marks first.');
                return;
            }
            
            document.getElementById(`markScheme${index}`).classList.add('visible');
            const btn = event.target;
            btn.dataset.taskId = `mark-scheme-${index}`;
            addXP(30, btn);
        }

        // Extension Activities
        function submitCustomInstruction() {
            const content = document.getElementById('customInstruction').value;
            if (content.length > 50) {
                const btn = event.target;
                btn.dataset.taskId = 'custom-instruction';
                addXP(40, btn);
                showAchievement('Instruction Designer', 'Created a custom assembly instruction!');
                alert('Great design! Your custom instruction has been submitted.');
            } else {
                alert('Please provide more detail about your instruction.');
            }
        }

        function submitModernAssembly() {
            const content = document.getElementById('modernAssembly').value;
            const keywords = ['embedded', 'driver', 'kernel', 'bootloader', 'firmware', 'optimization', 'graphics', 'crypto'];
            const matches = keywords.filter(keyword => content.toLowerCase().includes(keyword)).length;
            
            if (content.length > 100 && matches >= 2) {
                const btn = event.target;
                btn.dataset.taskId = 'modern-assembly';
                addXP(50, btn);
                showAchievement('Research Pro', 'Completed advanced research on modern assembly usage!');
                alert('Excellent research! You\'ve identified key modern uses of assembly.');
            } else {
                alert('Please provide more specific examples of modern assembly usage.');
            }
        }

        function submitVMComparison() {
            const content = document.getElementById('vmComparison').value;
            const keywords = ['CLR', '.NET', 'Python', 'bytecode', 'intermediate', 'platform', 'performance'];
            const matches = keywords.filter(keyword => content.toLowerCase().includes(keyword)).length;
            
            if (content.length > 100 && matches >= 3) {
                const btn = event.target;
                btn.dataset.taskId = 'vm-comparison';
                addXP(45, btn);
                alert('Great comparison! You\'ve shown good understanding of different VMs.');
            } else {
                alert('Please include more specific comparisons between different virtual machines.');
            }
        }

        // Final Quiz
        function initializeFinalQuiz() {
            const questions = [
                {
                    question: 'What type of code does an assembler produce?',
                    options: ['Source code', 'Machine code', 'Bytecode', 'High-level code'],
                    correct: 'Machine code'
                },
                {
                    question: 'Which translator is best for distributing commercial software?',
                    options: ['Interpreter', 'Assembler', 'Compiler', 'Text editor'],
                    correct: 'Compiler'
                },
                {
                    question: 'What makes Java platform-independent?',
                    options: ['It uses assembly language', 'It compiles to bytecode', 'It only uses interpreters', 'It avoids compilation'],
                    correct: 'It compiles to bytecode'
                },
                {
                    question: 'When would you use both interpreter and compiler?',
                    options: ['Never', 'During development then distribution', 'Only for Java', 'Only for assembly'],
                    correct: 'During development then distribution'
                },
                {
                    question: 'What is object code?',
                    options: ['Human-readable source code', 'Code that defines objects', 'Compiler output before linking', 'Final executable program'],
                    correct: 'Compiler output before linking'
                },
                {
                    question: 'Assembly language uses:',
                    options: ['Binary digits only', 'Mnemonic codes', 'English sentences', 'Mathematical symbols'],
                    correct: 'Mnemonic codes'
                },
                {
                    question: 'Which provides easier debugging?',
                    options: ['Compiler', 'Interpreter', 'Assembler', 'Linker'],
                    correct: 'Interpreter'
                },
                {
                    question: 'Cross-compilation means:',
                    options: ['Using multiple compilers', 'Compiling for different platforms', 'Mixing languages', 'Compiling twice'],
                    correct: 'Compiling for different platforms'
                }
            ];
            
            const container = document.getElementById('finalQuiz');
            questions.forEach((q, index) => {
                const div = document.createElement('div');
                div.style.marginBottom = '1.5rem';
                div.innerHTML = `<h4>Q${index + 1}: ${q.question}</h4>`;
                
                const optionsDiv = document.createElement('div');
                const shuffled = [...q.options].sort(() => Math.random() - 0.5);
                
                shuffled.forEach(option => {
                    const label = document.createElement('label');
                    label.style.display = 'block';
                    label.style.marginBottom = '0.5rem';
                    label.innerHTML = `
                        <input type="radio" name="finalQ${index}" value="${option}" style="margin-right: 0.5rem;">
                        ${option}
                    `;
                    optionsDiv.appendChild(label);
                });
                
                div.appendChild(optionsDiv);
                container.appendChild(div);
            });
        }

        function checkFinalQuiz() {
            const questions = [
                { correct: 'Machine code' },
                { correct: 'Compiler' },
                { correct: 'It compiles to bytecode' },
                { correct: 'During development then distribution' },
                { correct: 'Compiler output before linking' },
                { correct: 'Mnemonic codes' },
                { correct: 'Interpreter' },
                { correct: 'Compiling for different platforms' }
            ];
            
            let score = 0;
            questions.forEach((q, index) => {
                const selected = document.querySelector(`input[name="finalQ${index}"]:checked`);
                if (selected && selected.value === q.correct) {
                    score++;
                    selected.parentElement.style.color = 'var(--success)';
                } else {
                    const radios = document.querySelectorAll(`input[name="finalQ${index}"]`);
                    radios.forEach(radio => {
                        if (radio.value === q.correct) {
                            radio.parentElement.style.color = 'var(--success)';
                        } else if (radio.checked) {
                            radio.parentElement.style.color = 'var(--danger)';
                        }
                    });
                }
            });
            
            const results = document.getElementById('finalQuizResults');
            const percentage = (score / questions.length * 100).toFixed(0);
            
            results.innerHTML = `
                <div style="text-align: center; padding: 2rem; background: rgba(107, 70, 193, 0.1); border-radius: 12px;">
                    <h3>Final Score: ${score}/${questions.length} (${percentage}%)</h3>
                    <p>${score >= 7 ? 'Excellent work! You\'ve mastered the concepts!' : 
                       score >= 5 ? 'Good effort! Review the topics you found challenging.' :
                       'Keep studying! Review the lesson and try again.'}</p>
                </div>
            `;
            
            const btn = event.target;
            btn.dataset.taskId = 'final-quiz-complete';
            addXP(score * 15, btn);
            
            if (score === questions.length) {
                showAchievement('Perfect Score!', 'Achieved 100% on the final quiz!');
            }
            
            if (gameState.level === 5) {
                showAchievement('Master of Assembly!', 'Reached the maximum level!');
            }
        }

        // Feedback System
        function openFeedback() {
            document.getElementById('feedbackModal').style.display = 'flex';
        }

        function closeFeedback() {
            document.getElementById('feedbackModal').style.display = 'none';
            document.getElementById('feedbackText').value = '';
        }

        function sendFeedback() {
            const feedback = document.getElementById('feedbackText').value;
            if (feedback.trim()) {
                // Get current section and relevant code context
                const section = gameState.currentSection;
                const context = {
                    section: section,
                    xp: gameState.xp,
                    level: gameState.level,
                    timestamp: new Date().toISOString()
                };
                
                // In production, this would send an actual email
                const subject = `Assembly Language Worksheet Feedback - ${section}`;
                const body = `Feedback: ${feedback}\n\nContext: ${JSON.stringify(context, null, 2)}`;
                
                // Simulate sending
                console.log('Sending feedback:', { subject, body, to: 'millingtond@mgs.org' });
                
                alert('Thank you for your feedback! It has been sent to the teacher.');
                closeFeedback();
                
                const modal = document.getElementById('feedbackModal');
                modal.dataset.taskId = 'feedback-sent';
                addXP(10, modal);
            }
        }

        // Prevent closing modal by clicking outside
        document.getElementById('feedbackModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeFeedback();
            }
        });
    </script>
</body>
</html>