<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Compression - A Level Computer Science Interactive Worksheet</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #3b82f6;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --background-color: #ffffff;
            --text-color: #1f2937;
            --light-gray: #f3f4f6;
            --border-color: #e5e7eb;
            --disabled-color: #9ca3af;
            --header-text: #ffffff;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--background-color);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background-color: var(--primary-color);
            color: var(--header-text);
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .progress-bar {
            background-color: rgba(255,255,255,0.2);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            flex: 1;
            min-width: 200px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .progress-fill {
            background-color: var(--success-color);
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        .stats {
            display: flex;
            gap: 2rem;
            font-size: 0.9rem;
            color: var(--header-text);
        }

        .navigation {
            background-color: var(--light-gray);
            padding: 0.5rem;
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 60px;
            z-index: 999;
        }

        .nav-buttons {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            padding: 0.5rem 0;
        }

        .nav-button {
            padding: 0.5rem 1rem;
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .nav-button:hover {
            background-color: var(--secondary-color);
            color: white;
        }

        .nav-button.active {
            background-color: var(--primary-color);
            color: white;
        }

        .main-content {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
            width: 100%;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
            
         
        }

        .card {
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        h1, h2, h3 {
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        
        .header h1 {
            color: var(--header-text);
            margin-bottom: 0.25rem;
        }
        
        .header p {
            color: var(--header-text);
            opacity: 0.9;
        }

        .button {
            padding: 0.5rem 1.5rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.2s;
            display: inline-block;
            text-align: center;
        }

        .button:hover {
            background-color: var(--secondary-color);
        }

        .button:disabled {
            background-color: var(--disabled-color);
            cursor: not-allowed;
        }

        .button.secondary {
            background-color: white;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .button.secondary:hover {
            background-color: var(--light-gray);
        }

        .button.success {
            background-color: var(--success-color);
        }

        .button.danger {
            background-color: var(--error-color);
        }

        .quiz-question {
            margin-bottom: 1.5rem;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        .option {
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 0.375rem;
            cursor: pointer;
            transition: all 0.2s;
            background-color: white;
        }

        .option:hover {
            border-color: var(--secondary-color);
            background-color: var(--light-gray);
        }

        .option.selected {
            border-color: var(--primary-color);
            background-color: rgba(37, 99, 235, 0.1);
        }

        .option.correct {
            border-color: var(--success-color);
            background-color: rgba(16, 185, 129, 0.1);
        }

        .option.incorrect {
            border-color: var(--error-color);
            background-color: rgba(239, 68, 68, 0.1);
        }

        .feedback {
            margin-top: 1rem;
            padding: 1rem;
            border-radius: 0.375rem;
            display: none;
        }

        .feedback.success {
            background-color: rgba(16, 185, 129, 0.1);
            border: 1px solid var(--success-color);
            color: var(--success-color);
        }

        .feedback.error {
            background-color: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--error-color);
            color: var(--error-color);
        }

        .achievement-popup {
            position: fixed;
            top: 100px;
            right: 20px;
            background-color: white;
            border: 2px solid var(--success-color);
            border-radius: 0.5rem;
            padding: 1rem 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .achievement-popup.show {
            transform: translateX(0);
        }

        .achievement-popup h4 {
            color: var(--success-color);
            margin-bottom: 0.5rem;
        }

        .input-box {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid var(--border-color);
            border-radius: 0.375rem;
            font-size: 1rem;
            margin-top: 0.5rem;
            transition: border-color 0.2s;
        }

        .input-box:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .drag-drop-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .draggable, .dropzone {
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 0.375rem;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            background-color: white;
        }

        .draggable:hover {
            border-color: var(--secondary-color);
            transform: translateY(-2px);
        }

        .dropzone {
            min-height: 60px;
            background-color: var(--light-gray);
            border-style: dashed;
        }

        .dropzone.highlight {
            border-color: var(--primary-color);
            background-color: rgba(37, 99, 235, 0.1);
        }

        .canvas-container {
            margin-top: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 0.375rem;
            overflow: hidden;
        }

        #drawingCanvas {
            display: block;
            background-color: white;
            cursor: crosshair;
            touch-action: none;
        }

        .canvas-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .navigation-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
        }

        .feedback-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            z-index: 998;
            transition: transform 0.2s;
        }

        .feedback-button:hover {
            transform: scale(1.1);
        }

        .feedback-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1002;
            align-items: center;
            justify-content: center;
        }

        .feedback-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.5rem;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .simulation-container {
            background-color: var(--light-gray);
            padding: 1.5rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
        }

        .error-message {
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: none;
        }

        .hint-button {
            font-size: 0.875rem;
            padding: 0.25rem 0.75rem;
            margin-left: 1rem;
        }

        .hint-text {
            background-color: rgba(245, 158, 11, 0.1);
            border: 1px solid var(--warning-color);
            padding: 0.75rem;
            border-radius: 0.375rem;
            margin-top: 0.5rem;
            display: none;
            font-size: 0.875rem;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: stretch;
            }

            .stats {
                justify-content: space-around;
            }

            .drag-drop-container {
                grid-template-columns: 1fr;
            }

            .navigation-controls {
                flex-direction: column;
                gap: 1rem;
            }
        }

        .rle-grid {
            display: inline-block;
            margin: 1rem 0;
            border: 2px solid var(--border-color);
        }

        .rle-row {
            display: flex;
        }

        .rle-cell {
            width: 30px;
            height: 30px;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
        }

        .compression-demo {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1rem;
        }

        @media (max-width: 768px) {
            .compression-demo {
                grid-template-columns: 1fr;
            }
        }

        .file-size-indicator {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        .size-bar {
            flex: 1;
            height: 30px;
            background-color: var(--light-gray);
            border-radius: 0.375rem;
            overflow: hidden;
            position: relative;
        }

        .size-fill {
            height: 100%;
            background-color: var(--primary-color);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.875rem;
        }

        .accessibility-controls {
            position: fixed;
            top: 100px;
            left: 20px;
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 997;
            display: none;
        }

        .accessibility-toggle {
            position: fixed;
            top: 80px;
            left: 20px;
            z-index: 998;
        }

        body.high-contrast {
            --background-color: #000000;
            --text-color: #ffffff;
            --light-gray: #333333;
            --border-color: #666666;
            --header-text: #ffffff;
        }

        body.high-contrast .card {
            background-color: #111111;
        }

        body.dyslexia-font {
            font-family: 'OpenDyslexic', Arial, sans-serif;
        }
    </style>
</head>
<body>
    <!-- Header with Progress -->
    <header class="header">
        <div class="header-content">
            <div>
                <h1 style="font-size: 1.5rem; margin-bottom: 0.25rem;">Data Compression</h1>
                <p style="font-size: 0.875rem; opacity: 0.9;">A Level Computer Science - Cambridge 9618</p>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar"></div>
            </div>
            <div class="stats">
                <span>XP: <span id="xpCount">0</span></span>
                <span>Level: <span id="levelCount">0</span></span>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="navigation">
        <div class="nav-buttons">
            <button class="nav-button active" onclick="navigateTo(0)">Start</button>
            <button class="nav-button" onclick="navigateTo(1)">Introduction</button>
            <button class="nav-button" onclick="navigateTo(2)">Lossy vs Lossless</button>
            <button class="nav-button" onclick="navigateTo(3)">Image Compression</button>
            <button class="nav-button" onclick="navigateTo(4)">Text Compression</button>
            <button class="nav-button" onclick="navigateTo(5)">Audio Compression</button>
            <button class="nav-button" onclick="navigateTo(6)">RLE</button>
            <button class="nav-button" onclick="navigateTo(7)">Practice</button>
            <button class="nav-button" onclick="navigateTo(8)">Extension</button>
            <button class="nav-button" onclick="navigateTo(9)">Summary</button>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Page 0: Starter Activity -->
        <div class="page active" id="page0">
            <div class="card">
                <h2>Starter Activity: How Much Do You Know About File Sizes?</h2>
                <p>Let's start by testing your current knowledge about data and file sizes. This will help us understand where we're starting from!</p>
                
                <div class="quiz-question">
                    <h3>Question 1: Which of these file sizes is the largest?</h3>
                    <div class="options">
                        <div class="option" onclick="checkStarterAnswer(this, 'q1', false)">500 KB</div>
                        <div class="option" onclick="checkStarterAnswer(this, 'q1', false)">0.5 MB</div>
                        <div class="option" onclick="checkStarterAnswer(this, 'q1', true)">1 GB</div>
                        <div class="option" onclick="checkStarterAnswer(this, 'q1', false)">1000 MB</div>
                    </div>
                    <div class="feedback" id="q1-feedback"></div>
                </div>

                <div class="quiz-question">
                    <h3>Question 2: If you had a 50MB video file and needed to email it, but the email limit is 25MB, what would you need to do?</h3>
                    <div class="options">
                        <div class="option" onclick="checkStarterAnswer(this, 'q2', false)">Delete half the video</div>
                        <div class="option" onclick="checkStarterAnswer(this, 'q2', true)">Compress the file</div>
                        <div class="option" onclick="checkStarterAnswer(this, 'q2', false)">Change the file extension</div>
                        <div class="option" onclick="checkStarterAnswer(this, 'q2', false)">Send it twice</div>
                    </div>
                    <div class="feedback" id="q2-feedback"></div>
                </div>

                <div class="quiz-question">
                    <h3>Question 3: True or False: When you ZIP a file, you can always get back exactly the same file when you unzip it.</h3>
                    <div class="options">
                        <div class="option" onclick="checkStarterAnswer(this, 'q3', true)">True</div>
                        <div class="option" onclick="checkStarterAnswer(this, 'q3', false)">False</div>
                    </div>
                    <div class="feedback" id="q3-feedback"></div>
                </div>
            </div>

            <button class="button reset-button" onclick="resetPage(0)">Reset Activity</button>

            <div class="navigation-controls">
                <div></div>
                <button class="button" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Page 1: Introduction -->
        <div class="page" id="page1">
            <div class="card">
                <h2>What is Compression?</h2>
                <h3>Learning Outcomes:</h3>
                <ul>
                    <li>Understand what data compression is</li>
                    <li>Identify why compression is necessary</li>
                    <li>Recognize real-world applications of compression</li>
                </ul>
            </div>

            <div class="card">
                <h3>Definition</h3>
                <p><strong>Compression</strong> is a method or protocol for using fewer bits to represent the original information.</p>
                
                <div class="simulation-container">
                    <h4>Interactive Demo: See Compression in Action</h4>
                    <p>Click on the text below to see how it could be compressed, or enter your own text:</p>
                    <div style="margin-bottom: 1rem;">
                        <input type="text" class="input-box" id="customCompressionText" placeholder="Enter your own text with repeating characters..." value="AAAAAABBBBBCCCCDDD">
                        <button class="button secondary" onclick="updateCompressionDemo()" style="margin-top: 0.5rem;">Update Text</button>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-top: 1rem;">
                        <div>
                            <h5>Original Text:</h5>
                            <div id="originalText" style="padding: 1rem; background: white; border: 1px solid #ddd; border-radius: 0.375rem; cursor: pointer;">
                                AAAAAABBBBBCCCCDDD
                            </div>
                            <p style="margin-top: 0.5rem;">Size: <span id="originalSize">18 characters</span></p>
                        </div>
                        <div>
                            <h5>Compressed:</h5>
                            <div id="compressedText" style="padding: 1rem; background: white; border: 1px solid #ddd; border-radius: 0.375rem;">
                                Click original to compress
                            </div>
                            <p style="margin-top: 0.5rem;">Size: <span id="compressedSize">? characters</span></p>
                        </div>
                    </div>
                    <button class="button secondary" onclick="resetCompressionDemo()" style="margin-top: 1rem;">Reset Demo</button>
                </div>
            </div>

            <div class="card">
                <h3>Real-World Applications of Compression</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div style="text-align: center; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                        <div style="font-size: 3rem;">üì∫</div>
                        <h4 style="margin: 0.5rem 0;">Netflix Streaming</h4>
                        <p style="font-size: 0.875rem;">4K video compressed from 100GB to 7GB per hour</p>
                    </div>
                    <div style="text-align: center; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                        <div style="font-size: 3rem;">üìß</div>
                        <h4 style="margin: 0.5rem 0;">Email Attachments</h4>
                        <p style="font-size: 0.875rem;">ZIP files reduce attachment sizes by 50-90%</p>
                    </div>
                    <div style="text-align: center; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                        <div style="font-size: 3rem;">üéÆ</div>
                        <h4 style="margin: 0.5rem 0;">Video Games</h4>
                        <p style="font-size: 0.875rem;">Game assets compressed for faster downloads</p>
                    </div>
                    <div style="text-align: center; padding: 1rem; background: #f9fafb; border-radius: 0.5rem;">
                        <div style="font-size: 3rem;">üì±</div>
                        <h4 style="margin: 0.5rem 0;">Mobile Data</h4>
                        <p style="font-size: 0.875rem;">Saves bandwidth and reduces data costs</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Why Do We Need Compression?</h3>
                <p>Fill in the blanks with the most appropriate reasons:</p>
                
                <div style="margin-top: 1rem;">
                    <p>1. Compression reduces download and <select class="input-box" style="width: auto; display: inline;" onchange="checkFillIn(this, 'buffering', 1)">
                        <option value="">Choose...</option>
                        <option value="upload">upload</option>
                        <option value="buffering">buffering</option>
                        <option value="processing">processing</option>
                        <option value="deletion">deletion</option>
                    </select> times.</p>
                    
                    <p>2. Smaller files mean fewer <select class="input-box" style="width: auto; display: inline;" onchange="checkFillIn(this, 'packets', 2)">
                        <option value="">Choose...</option>
                        <option value="computers">computers</option>
                        <option value="servers">servers</option>
                        <option value="packets">packets</option>
                        <option value="cables">cables</option>
                    </select> which results in faster transmission.</p>
                    
                    <p>3. Compression saves money on data <select class="input-box" style="width: auto; display: inline;" onchange="checkFillIn(this, 'storage', 3)">
                        <option value="">Choose...</option>
                        <option value="processing">processing</option>
                        <option value="analysis">analysis</option>
                        <option value="storage">storage</option>
                        <option value="creation">creation</option>
                    </select> like hard drives and cloud services.</p>
                </div>
                
                <div class="feedback" id="fillInFeedback" style="margin-top: 1rem;"></div>
            </div>

            <button class="button reset-button" onclick="resetPage(1)">Reset Activity</button>

            <div class="navigation-controls">
                <button class="button secondary" onclick="previousPage()">‚Üê Previous</button>
                <button class="button" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Page 2: Lossy vs Lossless -->
        <div class="page" id="page2">
            <div class="card">
                <h2>Lossy vs Lossless Compression</h2>
                <p>There are two main types of compression, each with different characteristics and use cases.</p>
            </div>

            <div class="card">
                <h3>Interactive Comparison</h3>
                <p>Click on each characteristic to place it in the correct category:</p>
                
                <div class="drag-drop-container">
                    <div>
                        <h4>Characteristics to Sort:</h4>
                        <div id="characteristics" style="display: flex; flex-direction: column; gap: 0.5rem;">
                            <div class="draggable" onclick="sortCharacteristic(this, 'lossy')">Removes "unnecessary" data</div>
                            <div class="draggable" onclick="sortCharacteristic(this, 'lossless')">Original can be perfectly recovered</div>
                            <div class="draggable" onclick="sortCharacteristic(this, 'lossy')">Can reduce to about 10% size</div>
                            <div class="draggable" onclick="sortCharacteristic(this, 'lossless')">Maximum compression about 50%</div>
                            <div class="draggable" onclick="sortCharacteristic(this, 'lossy')">Some quality loss</div>
                            <div class="draggable" onclick="sortCharacteristic(this, 'lossless')">Works by finding patterns</div>
                        </div>
                    </div>
                    
                    <div>
                        <h4>Lossy Compression</h4>
                        <div class="dropzone" id="lossyDrop" style="min-height: 200px;"></div>
                    </div>
                    
                    <div>
                        <h4>Lossless Compression</h4>
                        <div class="dropzone" id="losslessDrop" style="min-height: 200px;"></div>
                    </div>
                </div>
                
                <button class="button secondary" onclick="resetSorting()" style="margin-top: 1rem;">Reset Sorting</button>
            </div>

            <div class="card">
                <h3>Real-World Example: Digital Photography</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div style="text-align: center;">
                        <div style="width: 100%; height: 150px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                            üì∑
                        </div>
                        <p style="margin-top: 0.5rem;"><strong>Original RAW Photo</strong></p>
                        <p>Size: 25 MB</p>
                        <p style="font-size: 0.875rem; color: #6b7280;">Uncompressed, full quality</p>
                    </div>
                    <div style="text-align: center;">
                        <div style="width: 100%; height: 150px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                            üñºÔ∏è
                        </div>
                        <p style="margin-top: 0.5rem;"><strong>JPEG (High Quality)</strong></p>
                        <p>Size: 3 MB</p>
                        <p style="font-size: 0.875rem; color: #6b7280;">88% smaller, minimal quality loss</p>
                    </div>
                    <div style="text-align: center;">
                        <div style="width: 100%; height: 150px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: white; font-size: 2rem;">
                            üì±
                        </div>
                        <p style="margin-top: 0.5rem;"><strong>JPEG (Web Quality)</strong></p>
                        <p>Size: 150 KB</p>
                        <p style="font-size: 0.875rem; color: #6b7280;">99% smaller, visible compression</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Visual Demonstration</h3>
                <div class="simulation-container">
                    <style>
                        .sim-container {
                            max-width: 100%;
                            background: rgba(255, 255, 255, 0.95);
                            border-radius: 20px;
                            padding: 30px;
                        }
                        
                        .sim-section {
                            margin-bottom: 30px;
                            padding: 20px;
                            background: #f7fafc;
                            border-radius: 15px;
                        }
                        
                        .sim-canvas-container {
                            display: flex;
                            justify-content: space-around;
                            flex-wrap: wrap;
                            gap: 20px;
                            margin: 20px 0;
                        }
                        
                        .sim-canvas-box {
                            text-align: center;
                            background: white;
                            padding: 15px;
                            border-radius: 10px;
                            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                        }
                        
                        .sim-stats {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                            gap: 15px;
                            margin: 20px 0;
                        }
                        
                        .sim-stat-box {
                            background: white;
                            padding: 15px;
                            border-radius: 8px;
                            text-align: center;
                            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
                        }
                    </style>
                    
                    <div class="sim-container">
                        <h2>üé® Interactive Photo Compression Demo</h2>
                        
                        <div class="sim-section">
                            <div class="sim-canvas-container">
                                <div class="sim-canvas-box">
                                    <h3>Original Image</h3>
                                    <canvas id="simOriginalCanvas" width="200" height="200"></canvas>
                                </div>
                                <div class="sim-canvas-box">
                                    <h3>Compressed Image</h3>
                                    <canvas id="simCompressedCanvas" width="200" height="200"></canvas>
                                </div>
                            </div>
                            
                            <div class="sim-stats">
                                <div class="sim-stat-box">
                                    <h4>Original Size</h4>
                                    <p id="simOriginalSize" style="font-size: 24px; font-weight: bold; color: #5a67d8;">0 KB</p>
                                </div>
                                <div class="sim-stat-box">
                                    <h4>Compressed Size</h4>
                                    <p id="simCompressedSize" style="font-size: 24px; font-weight: bold; color: #5a67d8;">0 KB</p>
                                </div>
                                <div class="sim-stat-box">
                                    <h4>Compression Ratio</h4>
                                    <p id="simCompressionRatio" style="font-size: 24px; font-weight: bold; color: #5a67d8;">0%</p>
                                </div>
                                <div class="sim-stat-box">
                                    <h4>Compression Type</h4>
                                    <p id="simCompressionType" style="font-size: 24px; font-weight: bold; color: #5a67d8;">None</p>
                                </div>
                            </div>
                            
                            <div class="controls">
                                <button onclick="simShowOriginal()">Show Original</button>
                                <button onclick="simReduceResolution()">Reduce Resolution</button>
                                <button onclick="simReduceColorDepth()">Reduce Color Depth</button>
                                <button onclick="simApplyRunLengthEncoding()" title="Shows RLE with ideal solid colors">RLE (Ideal Case)</button>
                                <button onclick="simShowRealRLE()" title="Shows what happens with real photos">RLE (Real Photo)</button>
                                <button onclick="simApplyLossyCompression()">Lossy Compression</button>
                            </div>
                        </div>
                        
                        <div class="sim-section">
                            <h2>üîç Run Length Encoding Demonstration</h2>
                            <div id="simRleDemo" style="background: white; padding: 20px; border-radius: 10px;">
                                <p>Run Length Encoding (RLE) replaces sequences of the same data with a count and the data value.</p>
                                <p style="background: #fef3c7; padding: 10px; border-radius: 5px; margin-top: 10px;">
                                    <strong>üí° Tip:</strong> Click "RLE (Ideal Case)" to see how RLE works with solid colors, 
                                    or "RLE (Real Photo)" to see why it fails with photographs!
                                </p>
                                <div id="simRleExample"></div>
                            </div>
                        </div>
                    </div>
                    
                    <script>
                        // Canvas setup
                        const simOriginalCanvas = document.getElementById('simOriginalCanvas');
                        const simCompressedCanvas = document.getElementById('simCompressedCanvas');
                        const simOriginalCtx = simOriginalCanvas.getContext('2d');
                        const simCompressedCtx = simCompressedCanvas.getContext('2d');
                        
                        // Initialize sample image
                        function simInitializeImage() {
                            const width = simOriginalCanvas.width;
                            const height = simOriginalCanvas.height;
                            
                            simOriginalCtx.clearRect(0, 0, width, height);
                            
                            // Sky gradient
                            const skyGradient = simOriginalCtx.createLinearGradient(0, 0, 0, height * 0.6);
                            skyGradient.addColorStop(0, '#87CEEB');
                            skyGradient.addColorStop(0.7, '#E0F6FF');
                            simOriginalCtx.fillStyle = skyGradient;
                            simOriginalCtx.fillRect(0, 0, width, height * 0.6);
                            
                            // Sun
                            simOriginalCtx.fillStyle = '#FFD700';
                            simOriginalCtx.beginPath();
                            simOriginalCtx.arc(50, 50, 25, 0, Math.PI * 2);
                            simOriginalCtx.fill();
                            
                            // Sun glow
                            const sunGlow = simOriginalCtx.createRadialGradient(50, 50, 20, 50, 50, 40);
                            sunGlow.addColorStop(0, 'rgba(255, 255, 0, 0.4)');
                            sunGlow.addColorStop(1, 'rgba(255, 255, 0, 0)');
                            simOriginalCtx.fillStyle = sunGlow;
                            simOriginalCtx.beginPath();
                            simOriginalCtx.arc(50, 50, 40, 0, Math.PI * 2);
                            simOriginalCtx.fill();
                            
                            // Clouds
                            simOriginalCtx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                            // Cloud 1
                            simOriginalCtx.beginPath();
                            simOriginalCtx.arc(120, 40, 15, 0, Math.PI * 2);
                            simOriginalCtx.arc(135, 40, 20, 0, Math.PI * 2);
                            simOriginalCtx.arc(150, 40, 15, 0, Math.PI * 2);
                            simOriginalCtx.fill();
                            
                            // Cloud 2
                            simOriginalCtx.beginPath();
                            simOriginalCtx.arc(160, 80, 12, 0, Math.PI * 2);
                            simOriginalCtx.arc(172, 80, 15, 0, Math.PI * 2);
                            simOriginalCtx.arc(184, 80, 12, 0, Math.PI * 2);
                            simOriginalCtx.fill();
                            
                            // Mountains
                            simOriginalCtx.fillStyle = '#8B7355';
                            simOriginalCtx.beginPath();
                            simOriginalCtx.moveTo(0, height * 0.6);
                            simOriginalCtx.lineTo(80, height * 0.3);
                            simOriginalCtx.lineTo(140, height * 0.45);
                            simOriginalCtx.lineTo(200, height * 0.6);
                            simOriginalCtx.closePath();
                            simOriginalCtx.fill();
                            
                            // Snow caps
                            simOriginalCtx.fillStyle = '#FFFFFF';
                            simOriginalCtx.beginPath();
                            simOriginalCtx.moveTo(60, height * 0.35);
                            simOriginalCtx.lineTo(80, height * 0.3);
                            simOriginalCtx.lineTo(100, height * 0.35);
                            simOriginalCtx.closePath();
                            simOriginalCtx.fill();
                            
                            // Grass ground
                            const grassGradient = simOriginalCtx.createLinearGradient(0, height * 0.6, 0, height);
                            grassGradient.addColorStop(0, '#90EE90');
                            grassGradient.addColorStop(1, '#228B22');
                            simOriginalCtx.fillStyle = grassGradient;
                            simOriginalCtx.fillRect(0, height * 0.6, width, height * 0.4);
                            
                            // Trees
                            simOriginalCtx.fillStyle = '#8B4513';
                            simOriginalCtx.fillRect(30, height * 0.7, 10, 30);
                            
                            simOriginalCtx.fillStyle = '#228B22';
                            simOriginalCtx.beginPath();
                            simOriginalCtx.moveTo(35, height * 0.65);
                            simOriginalCtx.lineTo(20, height * 0.75);
                            simOriginalCtx.lineTo(50, height * 0.75);
                            simOriginalCtx.closePath();
                            simOriginalCtx.fill();
                            
                            // Flowers
                            const flowerColors = ['#FF69B4', '#FF1493', '#FFB6C1', '#FFA500'];
                            for (let i = 0; i < 8; i++) {
                                const x = 70 + i * 15;
                                const y = height * 0.8 + Math.sin(i) * 10;
                                
                                simOriginalCtx.fillStyle = flowerColors[i % flowerColors.length];
                                simOriginalCtx.beginPath();
                                simOriginalCtx.arc(x, y, 4, 0, Math.PI * 2);
                                simOriginalCtx.fill();
                                
                                simOriginalCtx.strokeStyle = '#228B22';
                                simOriginalCtx.lineWidth = 2;
                                simOriginalCtx.beginPath();
                                simOriginalCtx.moveTo(x, y);
                                simOriginalCtx.lineTo(x, y + 10);
                                simOriginalCtx.stroke();
                            }
                            
                            simCompressedCtx.drawImage(simOriginalCanvas, 0, 0);
                            simUpdateStats(400, 400, 'None');
                        }
                        
                        function simUpdateStats(originalSize, compressedSize, type) {
                            document.getElementById('simOriginalSize').textContent = `${originalSize} KB`;
                            document.getElementById('simCompressedSize').textContent = `${compressedSize} KB`;
                            document.getElementById('simCompressionRatio').textContent = 
                                `${Math.round((1 - compressedSize / originalSize) * 100)}%`;
                            document.getElementById('simCompressionType').textContent = type;
                        }
                        
                        function simShowOriginal() {
                            simCompressedCtx.drawImage(simOriginalCanvas, 0, 0);
                            simUpdateStats(400, 400, 'None');
                        }
                        
                        function simReduceResolution() {
                            simCompressedCtx.clearRect(0, 0, simCompressedCanvas.width, simCompressedCanvas.height);
                            
                            const blockSize = 20;
                            const imageData = simOriginalCtx.getImageData(0, 0, simOriginalCanvas.width, simOriginalCanvas.height);
                            const data = imageData.data;
                            
                            for (let y = 0; y < simOriginalCanvas.height; y += blockSize) {
                                for (let x = 0; x < simOriginalCanvas.width; x += blockSize) {
                                    const index = (y * simOriginalCanvas.width + x) * 4;
                                    const r = data[index];
                                    const g = data[index + 1];
                                    const b = data[index + 2];
                                    
                                    simCompressedCtx.fillStyle = `rgb(${r}, ${g}, ${b})`;
                                    simCompressedCtx.fillRect(x, y, blockSize, blockSize);
                                }
                            }
                            
                            simUpdateStats(400, 25, 'Reduced Resolution (Lossy) - 10x10 pixels!');
                        }
                        
                        function simReduceColorDepth() {
                            const imageData = simOriginalCtx.getImageData(0, 0, simOriginalCanvas.width, simOriginalCanvas.height);
                            const data = imageData.data;
                            
                            for (let i = 0; i < data.length; i += 4) {
                                data[i] = Math.round(data[i] / 128) * 128;
                                data[i + 1] = Math.round(data[i + 1] / 128) * 128;
                                data[i + 2] = Math.round(data[i + 2] / 128) * 128;
                            }
                            
                            simCompressedCtx.putImageData(imageData, 0, 0);
                            simUpdateStats(400, 50, 'Reduced Color Depth (Lossy) - 8 colors only!');
                        }
                        
                        function simApplyRunLengthEncoding() {
                            const bandHeight = 40;
                            const imageData = simOriginalCtx.getImageData(0, 0, simOriginalCanvas.width, simOriginalCanvas.height);
                            const data = imageData.data;
                            const width = simOriginalCanvas.width;
                            
                            simCompressedCtx.clearRect(0, 0, simCompressedCanvas.width, simCompressedCanvas.height);
                            
                            for (let bandY = 0; bandY < simOriginalCanvas.height; bandY += bandHeight) {
                                let totalR = 0, totalG = 0, totalB = 0;
                                let count = 0;
                                
                                for (let y = bandY; y < Math.min(bandY + bandHeight, simOriginalCanvas.height); y++) {
                                    for (let x = 0; x < width; x++) {
                                        const index = (y * width + x) * 4;
                                        totalR += data[index];
                                        totalG += data[index + 1];
                                        totalB += data[index + 2];
                                        count++;
                                    }
                                }
                                
                                const avgR = Math.round(totalR / count);
                                const avgG = Math.round(totalG / count);
                                const avgB = Math.round(totalB / count);
                                
                                simCompressedCtx.fillStyle = `rgb(${avgR}, ${avgG}, ${avgB})`;
                                simCompressedCtx.fillRect(0, bandY, simOriginalCanvas.width, bandHeight);
                            }
                            
                            simUpdateStats(400, 80, 'RLE Demo - Ideal Case (Banded)');
                            
                            let rleExample = document.getElementById('simRleExample');
                            rleExample.innerHTML = `
                                <h4>RLE Ideal Case - Image Converted to Bands:</h4>
                                <p>This shows how RLE works when there ARE repeated colors!</p>
                                <p>In each band: Instead of storing 200 individual pixel colors...</p>
                                <p><strong>RLE stores:</strong> [Color] + [Count: 200]</p>
                                <p><strong>Compression:</strong> 200 values ‚Üí 2 values per row (99% reduction!)</p>
                                <p style="color: #2b6cb0; font-weight: bold;">This is why RLE is used for simple graphics, not photos!</p>
                            `;
                        }
                        
                        function simShowRealRLE() {
                            simCompressedCtx.drawImage(simOriginalCanvas, 0, 0);
                            
                            simCompressedCtx.fillStyle = 'rgba(255, 0, 0, 0.3)';
                            simCompressedCtx.font = '20px Arial';
                            simCompressedCtx.fillText('No compression!', 20, 100);
                            
                            simUpdateStats(400, 800, 'RLE on Real Photo (Larger file!)');
                            
                            let rleExample = document.getElementById('simRleExample');
                            rleExample.innerHTML = `
                                <h4>RLE on Real Photos - Why It Fails:</h4>
                                <p style="color: #e53e3e; font-weight: bold;">‚ö†Ô∏è File size DOUBLED! 400KB ‚Üí 800KB</p>
                                <p>Every pixel in a photo is slightly different due to:</p>
                                <ul style="text-align: left; margin: 10px 20px;">
                                    <li>Lighting gradients</li>
                                    <li>Natural texture variations</li>
                                    <li>Anti-aliasing (smooth edges)</li>
                                </ul>
                                <p><strong>Example:</strong> Sky pixels: rgb(135,206,235), rgb(136,206,235), rgb(135,207,235)...</p>
                                <p>RLE must store: 1√ó(135,206,235), 1√ó(136,206,235), 1√ó(135,207,235)...</p>
                                <p><strong>Result:</strong> MORE data than the original!</p>
                            `;
                        }
                        
                        function simApplyLossyCompression() {
                            const blockSize = 8;
                            const imageData = simOriginalCtx.getImageData(0, 0, simOriginalCanvas.width, simOriginalCanvas.height);
                            const data = imageData.data;
                            const width = simOriginalCanvas.width;
                            
                            for (let blockY = 0; blockY < simOriginalCanvas.height; blockY += blockSize) {
                                for (let blockX = 0; blockX < simOriginalCanvas.width; blockX += blockSize) {
                                    let totalR = 0, totalG = 0, totalB = 0;
                                    let count = 0;
                                    
                                    for (let y = blockY; y < Math.min(blockY + blockSize, simOriginalCanvas.height); y++) {
                                        for (let x = blockX; x < Math.min(blockX + blockSize, simOriginalCanvas.width); x++) {
                                            const index = (y * width + x) * 4;
                                            totalR += data[index];
                                            totalG += data[index + 1];
                                            totalB += data[index + 2];
                                            count++;
                                        }
                                    }
                                    
                                    const avgR = Math.round(totalR / count / 32) * 32;
                                    const avgG = Math.round(totalG / count / 32) * 32;
                                    const avgB = Math.round(totalB / count / 32) * 32;
                                    
                                    simCompressedCtx.fillStyle = `rgb(${avgR}, ${avgG}, ${avgB})`;
                                    simCompressedCtx.fillRect(blockX, blockY, blockSize, blockSize);
                                }
                            }
                            
                            simUpdateStats(400, 80, 'Heavy JPEG Compression (8x8 blocks)');
                        }
                        
                        // Initialize when page loads
                        setTimeout(simInitializeImage, 100);
                    </script>
                </div>
            </div>

            <div class="card">
                <h3>Quick Check</h3>
                <p>Which compression type would you use for each scenario?</p>
                
                <div class="quiz-question">
                    <p>1. Archiving important business documents</p>
                    <div class="options" style="flex-direction: row; gap: 1rem;">
                        <button class="button secondary" onclick="checkScenario(this, 'lossless', 1)">Lossy</button>
                        <button class="button secondary" onclick="checkScenario(this, 'lossless', 1)">Lossless</button>
                    </div>
                </div>
                
                <div class="quiz-question">
                    <p>2. Streaming music on a mobile phone</p>
                    <div class="options" style="flex-direction: row; gap: 1rem;">
                        <button class="button secondary" onclick="checkScenario(this, 'lossy', 2)">Lossy</button>
                        <button class="button secondary" onclick="checkScenario(this, 'lossy', 2)">Lossless</button>
                    </div>
                </div>
                
                <div class="feedback" id="scenarioFeedback"></div>
            </div>

            <button class="button reset-button" onclick="resetPage(2)">Reset Activity</button>

            <div class="navigation-controls">
                <button class="button secondary" onclick="previousPage()">‚Üê Previous</button>
                <button class="button" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Page 3: Image Compression -->
        <div class="page" id="page3">
            <div class="card">
                <h2>Image Compression Techniques</h2>
                <p>Images can be compressed using both lossy and lossless methods. Let's explore how each works.</p>
            </div>

            <div class="card">
                <h3>Lossy Image Compression</h3>
                <p>Lossy compression analyzes images looking for pixels in close proximity with similar colors.</p>
                
                <div class="simulation-container">
                    <h4>Real Photo Example: Landscape Compression</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-top: 1rem;">
                        <div>
                            <canvas id="photoOriginal" width="250" height="180" style="border: 1px solid #ddd; width: 100%;"></canvas>
                            <p style="text-align: center; margin-top: 0.5rem;"><strong>Original Photo</strong></p>
                            <p style="text-align: center; font-size: 0.875rem;">File size: 2.5 MB</p>
                        </div>
                        <div>
                            <canvas id="photoCompressed" width="250" height="180" style="border: 1px solid #ddd; width: 100%;"></canvas>
                            <p style="text-align: center; margin-top: 0.5rem;"><strong>JPEG Compressed (Quality: 60%)</strong></p>
                            <p style="text-align: center; font-size: 0.875rem;">File size: 180 KB (93% reduction)</p>
                        </div>
                    </div>
                    <button class="button" onclick="simulatePhotoCompression()" style="margin-top: 1rem;">Simulate Compression</button>
                </div>

                <div class="simulation-container" style="margin-top: 2rem;">
                    <h4>Color Depth Reduction Demo</h4>
                    <p>Click the buttons to see how reducing bit depth affects the image:</p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1rem;">
                        <div>
                            <canvas id="bitDepth24" width="150" height="150" style="border: 1px solid #ddd;"></canvas>
                            <p>24-bit (16.7M colors)</p>
                            <p>Size: 67.5KB</p>
                        </div>
                        <div>
                            <canvas id="bitDepth8" width="150" height="150" style="border: 1px solid #ddd;"></canvas>
                            <p>8-bit (256 colors)</p>
                            <p>Size: 22.5KB</p>
                        </div>
                        <div>
                            <canvas id="bitDepth4" width="150" height="150" style="border: 1px solid #ddd;"></canvas>
                            <p>4-bit (16 colors)</p>
                            <p>Size: 11.25KB</p>
                        </div>
                    </div>
                    
                    <button class="button" onclick="demonstrateBitDepth()">Show Bit Depth Reduction</button>
                </div>
            </div>

            <div class="card">
                <h3>Lossless Image Compression - RLE</h3>
                <p>Run Length Encoding (RLE) finds groups of repeating pixels and records them efficiently.</p>
                
                <div class="simulation-container">
                    <h4>RLE Visualization</h4>
                    <p>Click on cells to change their color, then see how RLE would encode it:</p>
                    
                    <div style="display: flex; gap: 2rem; align-items: flex-start; flex-wrap: wrap;">
                        <div>
                            <h5>Image Grid:</h5>
                            <div class="rle-grid" id="rleGrid"></div>
                            <div style="margin-top: 0.5rem;">
                                <button class="button secondary" onclick="clearRLEGrid()">Clear</button>
                                <button class="button secondary" onclick="fillRLEPattern()">Sample Pattern</button>
                            </div>
                        </div>
                        
                        <div style="flex: 1; min-width: 200px;">
                            <h5>RLE Encoding:</h5>
                            <div id="rleOutput" style="padding: 1rem; background: white; border: 1px solid #ddd; border-radius: 0.375rem; min-height: 100px; font-family: monospace;">
                                Click "Encode" to see RLE
                            </div>
                            <button class="button" onclick="encodeRLE()" style="margin-top: 0.5rem;">Encode</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Practice: Understanding RLE</h3>
                <p>Given this row of pixels: <span style="font-family: monospace; background: #f3f4f6; padding: 0.25rem;">‚¨õ‚¨õ‚¨õ‚¨ú‚¨ú‚¨ú‚¨ú‚¨ú‚¨õ‚¨õ</span></p>
                <p>What would be the RLE encoding? (Format: color count, color count, ...)</p>
                
                <input type="text" class="input-box" id="rleAnswer" placeholder="Enter your answer...">
                <button class="button" onclick="checkRLEAnswer()">Check Answer</button>
                <button class="hint-button button secondary" onclick="showHint('rle')">Need a hint?</button>
                <div class="hint-text" id="rle-hint">Count how many black pixels, then white pixels, then black pixels again.</div>
                <div class="feedback" id="rleFeedback"></div>
            </div>

            <button class="button reset-button" onclick="resetPage(3)">Reset Activity</button>

            <div class="navigation-controls">
                <button class="button secondary" onclick="previousPage()">‚Üê Previous</button>
                <button class="button" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Page 4: Text Compression -->
        <div class="page" id="page4">
            <div class="card">
                <h2>Text Compression Methods</h2>
                <p>Text files use lossless compression methods to ensure no information is lost.</p>
            </div>

            <div class="card">
                <h3>Dictionary Compression</h3>
                <p>This method finds repeated patterns in text and creates a dictionary of replacements.</p>
                
                <div class="simulation-container">
                    <h4>Dictionary Compression Demo</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <h5>Original Text:</h5>
                            <textarea id="dictInput" class="input-box" style="height: 100px;">The cat sat on the mat. The cat was fat. The mat was flat.</textarea>
                            <button class="button" onclick="createDictionary()" style="margin-top: 0.5rem;">Compress Text</button>
                        </div>
                        <div>
                            <h5>Dictionary:</h5>
                            <div id="dictionary" style="padding: 1rem; background: white; border: 1px solid #ddd; border-radius: 0.375rem; min-height: 100px; font-family: monospace; font-size: 0.875rem;">
                                Click "Compress Text" to generate dictionary
                            </div>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <h5>Compressed Result:</h5>
                        <div id="compressedDict" style="padding: 1rem; background: #f3f4f6; border: 1px solid #ddd; border-radius: 0.375rem; min-height: 50px;">
                            Compressed text will appear here...
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Huffman Coding</h3>
                <p>Huffman coding creates variable-length codes based on character frequency.</p>
                
                <div class="simulation-container">
                    <h4>Character Frequency Analysis</h4>
                    <textarea class="input-box" id="huffmanInput" rows="4" placeholder="Enter text to analyze...">The quick brown fox jumps over the lazy dog. This pangram sentence contains every letter of the alphabet at least once, making it perfect for testing character frequency distribution in text compression algorithms.</textarea>
                    <button class="button" onclick="analyzeFrequency()">Analyze Frequency</button>
                    
                    <div id="frequencyChart" style="margin-top: 1rem;"></div>
                    
                    <div class="card" style="margin-top: 1rem; background: #f9fafb;">
                        <p><strong>Key Concept:</strong> More frequent characters get shorter codes!</p>
                        <div id="huffmanCodes"></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Practice Question</h3>
                <p>If the letter 'E' appears 100 times and 'Z' appears 2 times in a document, which should get a shorter Huffman code?</p>
                <div class="options">
                    <div class="option" onclick="checkTextAnswer(this, 'E')">E (frequent letter)</div>
                    <div class="option" onclick="checkTextAnswer(this, 'E')">Z (rare letter)</div>
                    <div class="option" onclick="checkTextAnswer(this, 'neither')">Both get the same length code</div>
                </div>
                <div class="feedback" id="textFeedback"></div>
            </div>

            <button class="button reset-button" onclick="resetPage(4)">Reset Activity</button>

            <div class="navigation-controls">
                <button class="button secondary" onclick="previousPage()">‚Üê Previous</button>
                <button class="button" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Page 5: Audio Compression -->
        <div class="page" id="page5">
            <div class="card">
                <h2>Audio Compression - MP3</h2>
                <p>MP3 is a lossy compression format that uses psycho-acoustic modeling to reduce file sizes dramatically.</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div style="text-align: center;">
                        <div style="width: 100%; height: 120px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: white;">
                            <div>
                                <div style="font-size: 2.5rem;">üéµ</div>
                                <div style="font-size: 0.875rem;">WAV File</div>
                            </div>
                        </div>
                        <p style="margin-top: 0.5rem;"><strong>Uncompressed Audio</strong></p>
                        <p style="font-size: 0.875rem;">CD Quality: 1411 kbps</p>
                        <p style="font-size: 0.75rem; color: #6b7280;">50 MB for 3-min song</p>
                    </div>
                    <div style="text-align: center;">
                        <div style="width: 100%; height: 120px; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: white;">
                            <div>
                                <div style="font-size: 2.5rem;">üéß</div>
                                <div style="font-size: 0.875rem;">MP3 320kbps</div>
                            </div>
                        </div>
                        <p style="margin-top: 0.5rem;"><strong>High Quality MP3</strong></p>
                        <p style="font-size: 0.875rem;">Near-CD Quality</p>
                        <p style="font-size: 0.75rem; color: #6b7280;">11.5 MB (77% smaller)</p>
                    </div>
                    <div style="text-align: center;">
                        <div style="width: 100%; height: 120px; background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; color: white;">
                            <div>
                                <div style="font-size: 2.5rem;">üì±</div>
                                <div style="font-size: 0.875rem;">MP3 128kbps</div>
                            </div>
                        </div>
                        <p style="margin-top: 0.5rem;"><strong>Standard MP3</strong></p>
                        <p style="font-size: 0.875rem;">Good for streaming</p>
                        <p style="font-size: 0.75rem; color: #6b7280;">4.6 MB (91% smaller)</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>How MP3 Compression Works</h3>
                <div class="simulation-container">
                    <h4>Psycho-Acoustic Principles</h4>
                    
                    <div style="display: grid; gap: 1rem;">
                        <div class="card" style="background: #f9fafb;">
                            <h5>1. Frequency Range</h5>
                            <p>Human hearing: 20 Hz - 20,000 Hz</p>
                            <div style="display: flex; align-items: center; gap: 1rem;">
                                <span>20 Hz</span>
                                <div class="size-bar" style="flex: 1;">
                                    <div style="background: linear-gradient(to right, #ef4444, #f59e0b, #10b981, #3b82f6); height: 100%; width: 100%;"></div>
                                </div>
                                <span>20 kHz</span>
                            </div>
                            <p style="margin-top: 0.5rem;">MP3 removes frequencies we can't hear well</p>
                        </div>
                        
                        <div class="card" style="background: #f9fafb;">
                            <h5>2. Masking Effect</h5>
                            <p>When two sounds play together:</p>
                            <button class="button secondary" onclick="demonstrateMasking()">Demonstrate Masking</button>
                            <div id="maskingDemo" style="margin-top: 1rem;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Compression Comparison</h3>
                <div class="file-size-indicator">
                    <span style="min-width: 100px;">WAV (Original):</span>
                    <div class="size-bar">
                        <div class="size-fill" style="width: 100%;">50 MB</div>
                    </div>
                </div>
                <div class="file-size-indicator">
                    <span style="min-width: 100px;">MP3 (320kbps):</span>
                    <div class="size-bar">
                        <div class="size-fill" style="width: 23%; background-color: var(--success-color);">11.5 MB</div>
                    </div>
                </div>
                <div class="file-size-indicator">
                    <span style="min-width: 100px;">MP3 (128kbps):</span>
                    <div class="size-bar">
                        <div class="size-fill" style="width: 9%; background-color: var(--warning-color);">4.6 MB</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Quick Quiz: Audio Compression</h3>
                <div class="quiz-question">
                    <p>Which of these is NOT removed by MP3 compression?</p>
                    <div class="options">
                        <div class="option" onclick="checkAudioAnswer(this, false)">Frequencies above 20kHz</div>
                        <div class="option" onclick="checkAudioAnswer(this, false)">Quieter sounds masked by louder ones</div>
                        <div class="option" onclick="checkAudioAnswer(this, true)">The main melody of a song</div>
                        <div class="option" onclick="checkAudioAnswer(this, false)">Sounds below human hearing range</div>
                    </div>
                    <div class="feedback" id="audioFeedback"></div>
                </div>
            </div>

            <button class="button reset-button" onclick="resetPage(5)">Reset Activity</button>

            <div class="navigation-controls">
                <button class="button secondary" onclick="previousPage()">‚Üê Previous</button>
                <button class="button" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Page 6: RLE Deep Dive -->
        <div class="page" id="page6">
            <div class="card">
                <h2>Run Length Encoding (RLE) - Deep Dive</h2>
                <p>Let's master RLE with hands-on practice for both images and sound.</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1rem;">
                    <div style="text-align: center;">
                        <div style="width: 100%; height: 100px; background: repeating-linear-gradient(90deg, #3b82f6 0px, #3b82f6 20px, #ffffff 20px, #ffffff 40px); border: 2px solid #ddd; border-radius: 0.5rem;"></div>
                        <p style="margin-top: 0.5rem;"><strong>Original Pattern</strong></p>
                        <p style="font-size: 0.875rem;">Repeating stripes</p>
                    </div>
                    <div style="text-align: center;">
                        <div style="width: 100%; height: 100px; background: #f3f4f6; border: 2px solid #ddd; border-radius: 0.5rem; display: flex; align-items: center; justify-content: center; font-family: monospace;">
                            B20,W20,B20,W20...
                        </div>
                        <p style="margin-top: 0.5rem;"><strong>RLE Encoded</strong></p>
                        <p style="font-size: 0.875rem;">Efficient storage</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>RLE for Images - Practice</h3>
                <p>Complete the RLE encoding for this image data:</p>
                
                <div style="font-family: monospace; background: #f3f4f6; padding: 1rem; border-radius: 0.375rem;">
                    Row 1: 153 153 153 153 153 153 153 153 153 153 255 255 255 153 153 153<br>
                    Row 2: 153 153 153 153 153 153 153 153 153 255 255 255 255 255 255 153
                </div>
                
                <p style="margin-top: 1rem;">Row 1 RLE encoding:</p>
                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; align-items: center;">
                    <span>153</span>
                    <input type="text" class="input-box" style="width: 60px;" id="rle1_1" placeholder="?">
                    <span>255</span>
                    <input type="text" class="input-box" style="width: 60px;" id="rle1_2" placeholder="?">
                    <span>153</span>
                    <input type="text" class="input-box" style="width: 60px;" id="rle1_3" placeholder="?">
                    <button class="button" onclick="checkRLEPractice(1)">Check Row 1</button>
                </div>
                
                <p style="margin-top: 1rem;">Row 2 RLE encoding:</p>
                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap; align-items: center;">
                    <span>153</span>
                    <input type="text" class="input-box" style="width: 60px;" id="rle2_1" placeholder="?">
                    <span>255</span>
                    <input type="text" class="input-box" style="width: 60px;" id="rle2_2" placeholder="?">
                    <span>153</span>
                    <input type="text" class="input-box" style="width: 60px;" id="rle2_3" placeholder="?">
                    <button class="button" onclick="checkRLEPractice(2)">Check Row 2</button>
                </div>
                
                <div class="feedback" id="rlePracticeFeedback"></div>
            </div>

            <div class="card">
                <h3>RLE for Sound</h3>
                <p>Sound samples can also be compressed using RLE when the same value repeats.</p>
                
                <div class="simulation-container">
                    <h4>Sound Sample Visualization</h4>
                    <canvas id="soundWave" width="600" height="200" style="border: 1px solid #ddd; width: 100%; max-width: 600px;"></canvas>
                    
                    <p style="margin-top: 1rem;">Sample values: 128, 128, 128, 128, 255, 255, 0, 0, 0, 128, 128</p>
                    
                    <p>What would be the RLE encoding?</p>
                    <input type="text" class="input-box" id="soundRLE" placeholder="Format: value count, value count, ...">
                    <button class="button" onclick="checkSoundRLE()">Check Answer</button>
                    <div class="feedback" id="soundRLEFeedback"></div>
                </div>
            </div>

            <div class="card">
                <h3>RLE Efficiency Calculator</h3>
                <p>Calculate the compression ratio for different data:</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                    <div>
                        <label>Original data size (bytes):</label>
                        <input type="number" class="input-box" id="origSize" value="100">
                    </div>
                    <div>
                        <label>Compressed size (bytes):</label>
                        <input type="number" class="input-box" id="compSize" value="40">
                    </div>
                </div>
                
                <button class="button" onclick="calculateCompression()" style="margin-top: 1rem;">Calculate</button>
                
                <div id="compressionResult" style="margin-top: 1rem;"></div>
            </div>

            <button class="button reset-button" onclick="resetPage(6)">Reset Activity</button>

            <div class="navigation-controls">
                <button class="button secondary" onclick="previousPage()">‚Üê Previous</button>
                <button class="button" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Page 7: Practice Exam Questions -->
        <div class="page" id="page7">
            <div class="card">
                <h2>Practice Exam Questions</h2>
                <p>Test your understanding with these exam-style questions. Enter your predicted marks before viewing the mark scheme.</p>
            </div>

            <div class="card">
                <h3>Question 1 (6 marks)</h3>
                <p>A company needs to store 10,000 high-resolution photographs on their web server.</p>
                <p>(a) Explain why lossy compression would be suitable for this purpose. [3 marks]</p>
                <p>(b) Describe how lossy image compression reduces file size. [3 marks]</p>
                
                <textarea class="input-box" id="q1answer" rows="8" placeholder="Write your answer here..."></textarea>
                
                <div style="margin-top: 1rem;">
                    <label>Predicted marks (out of 6):</label>
                    <input type="number" class="input-box" id="q1marks" min="0" max="6" style="width: 100px;">
                    <button class="button" onclick="showMarkScheme(1)">Show Mark Scheme</button>
                </div>
                
                <div class="feedback" id="markScheme1" style="display: none;">
                    <h4>Mark Scheme:</h4>
                    <p><strong>(a) 3 marks - 1 mark for each valid point:</strong></p>
                    <ul>
                        <li>Significantly reduces file size (to ~10% of original)</li>
                        <li>Faster loading times for website visitors</li>
                        <li>Reduces storage costs/bandwidth requirements</li>
                        <li>Acceptable quality loss for web viewing</li>
                    </ul>
                    <p><strong>(b) 3 marks - 1 mark for each:</strong></p>
                    <ul>
                        <li>Analyzes pixels in close proximity</li>
                        <li>Groups similar colors together</li>
                        <li>Reduces bit depth/color palette</li>
                        <li>Removes information human eye won't notice</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <h3>Question 2 (4 marks)</h3>
                <p>Apply Run Length Encoding to compress the following binary data:</p>
                <p style="font-family: monospace; background: #f3f4f6; padding: 1rem;">11111100000011100000</p>
                <p>Show your working. [4 marks]</p>
                
                <textarea class="input-box" id="q2answer" rows="4" placeholder="Write your answer here..."></textarea>
                
                <div style="margin-top: 1rem;">
                    <label>Predicted marks (out of 4):</label>
                    <input type="number" class="input-box" id="q2marks" min="0" max="4" style="width: 100px;">
                    <button class="button" onclick="showMarkScheme(2)">Show Mark Scheme</button>
                </div>
                
                <div class="feedback" id="markScheme2" style="display: none;">
                    <h4>Mark Scheme:</h4>
                    <p><strong>4 marks:</strong></p>
                    <ul>
                        <li>Correct identification of runs: 1√ó6, 0√ó6, 1√ó3, 0√ó5 (2 marks)</li>
                        <li>Correct RLE format: 1,6,0,6,1,3,0,5 or similar notation (2 marks)</li>
                    </ul>
                </div>
            </div>

            <div class="card">
                <h3>Question 3 (5 marks)</h3>
                <p>A video streaming service needs to compress video files for mobile users with limited data plans.</p>
                <p>(a) Define frame rate and explain how reducing it affects file size. [2 marks]</p>
                <p>(b) State THREE reasons why compression is essential for video streaming services. [3 marks]</p>
                
                <textarea class="input-box" id="q3answer" rows="8" placeholder="Write your answer here..."></textarea>
                
                <div style="margin-top: 1rem;">
                    <label>Predicted marks (out of 5):</label>
                    <input type="number" class="input-box" id="q3marks" min="0" max="5" style="width: 100px;">
                    <button class="button" onclick="showMarkScheme(3)">Show Mark Scheme</button>
                </div>
                
                <div class="feedback" id="markScheme3" style="display: none;">
                    <h4>Mark Scheme:</h4>
                    <p><strong>(a) 2 marks:</strong></p>
                    <ul>
                        <li>Frame rate: The number of images/frames processed per second in a video (1 mark)</li>
                        <li>Lower frame rate = fewer images to store = smaller file size (1 mark)</li>
                    </ul>
                    <p><strong>(b) 3 marks - 1 mark for each reason:</strong></p>
                    <ul>
                        <li>Reduces buffering/download times</li>
                        <li>Saves users' data allowances/money</li>
                        <li>Reduces bandwidth/traffic on servers</li>
                        <li>Allows more content to be stored</li>
                        <li>Enables real-time streaming</li>
                        <li>Reduces storage costs for the company</li>
                    </ul>
                </div>
            </div>

            <button class="button reset-button" onclick="resetPage(7)">Reset Activity</button>

            <div class="navigation-controls">
                <button class="button secondary" onclick="previousPage()">‚Üê Previous</button>
                <button class="button" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Page 8: Extension Activities -->
        <div class="page" id="page8">
            <div class="card">
                <h2>Extension Activities - Beyond the Specification</h2>
                <p>Explore advanced compression concepts to deepen your understanding.</p>
            </div>

            <div class="card">
                <h3>LZ77 Algorithm</h3>
                <p>LZ77 is a more advanced lossless compression algorithm used in ZIP files. It uses a "sliding window" approach.</p>
                
                <div class="simulation-container">
                    <h4>How LZ77 Works:</h4>
                    <p>Instead of just counting repeats, LZ77 looks for patterns that occurred earlier in the data.</p>
                    
                    <p>Example text: "the cat in the hat"</p>
                    <p>When it sees "the" the second time, it references back: (10, 3) meaning "go back 10 positions, copy 3 characters"</p>
                    
                    <p><strong>Challenge:</strong> How would LZ77 encode "abcabcabc"?</p>
                    <input type="text" class="input-box" id="lz77answer" placeholder="Your answer...">
                    <button class="button" onclick="checkLZ77()">Check</button>
                    <div class="feedback" id="lz77feedback"></div>
                </div>
            </div>

            <div class="card">
                <h3>Real-World Application Research</h3>
                <p>Research and explain how compression is used in one of these areas:</p>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1rem 0;">
                    <div class="option" onclick="selectResearchTopic(this, 'streaming')">Video Streaming (Netflix)</div>
                    <div class="option" onclick="selectResearchTopic(this, 'medical')">Medical Imaging</div>
                    <div class="option" onclick="selectResearchTopic(this, 'gaming')">Video Game Assets</div>
                    <div class="option" onclick="selectResearchTopic(this, 'space')">Space Communications</div>
                </div>
                
                <textarea class="input-box" id="researchAnswer" rows="6" placeholder="Write your research findings here..." style="margin-top: 1rem;"></textarea>
                <button class="button" onclick="submitResearch()">Submit Research</button>
                <div class="feedback" id="researchFeedback"></div>
            </div>

            <div class="card">
                <h3>Common Mistakes to Avoid</h3>
                <ul>
                    <li><strong>Confusing compression ratio with space saved:</strong> 2:1 ratio means 50% space saved, not 2%</li>
                    <li><strong>Assuming all compression is lossy:</strong> ZIP files use lossless compression</li>
                    <li><strong>Forgetting RLE can make files larger:</strong> Random data doesn't compress well with RLE</li>
                    <li><strong>Mixing up bit depth and resolution:</strong> They're different aspects of image quality</li>
                </ul>
            </div>

            <button class="button reset-button" onclick="resetPage(8)">Reset Activity</button>

            <div class="navigation-controls">
                <button class="button secondary" onclick="previousPage()">‚Üê Previous</button>
                <button class="button" onclick="nextPage()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Page 9: Summary and Final Quiz -->
        <div class="page" id="page9">
            <div class="card">
                <h2>Summary and Final Assessment</h2>
                <p>Let's review what you've learned about compression.</p>
            </div>

            <div class="card">
                <h3>Key Takeaways</h3>
                <ul>
                    <li>‚úì Compression reduces file sizes for storage and transmission</li>
                    <li>‚úì Lossy compression removes data permanently but achieves smaller sizes</li>
                    <li>‚úì Lossless compression preserves all data and is reversible</li>
                    <li>‚úì Different media types use different compression methods</li>
                    <li>‚úì RLE is a simple but effective lossless compression method</li>
                </ul>
            </div>

            <div class="card">
                <h3>Final Quiz</h3>
                
                <div class="quiz-question">
                    <h4>Question 1: Which compression type would you use for a legal contract?</h4>
                    <div class="options">
                        <div class="option" onclick="checkFinalAnswer(this, 1, 'b')">Lossy compression</div>
                        <div class="option" onclick="checkFinalAnswer(this, 1, 'b')">Lossless compression</div>
                        <div class="option" onclick="checkFinalAnswer(this, 1, 'c')">No compression needed</div>
                    </div>
                </div>

                <div class="quiz-question">
                    <h4>Question 2: What does RLE stand for?</h4>
                    <div class="options">
                        <div class="option" onclick="checkFinalAnswer(this, 2, 'c')">Random Length Encoding</div>
                        <div class="option" onclick="checkFinalAnswer(this, 2, 'c')">Reduced Line Encoding</div>
                        <div class="option" onclick="checkFinalAnswer(this, 2, 'c')">Run Length Encoding</div>
                        <div class="option" onclick="checkFinalAnswer(this, 2, 'd')">Repeat Line Encoding</div>
                    </div>
                </div>

                <div class="quiz-question">
                    <h4>Question 3: MP3 compression removes sounds based on:</h4>
                    <div class="options">
                        <div class="option" onclick="checkFinalAnswer(this, 3, 'd')">File size requirements only</div>
                        <div class="option" onclick="checkFinalAnswer(this, 3, 'd')">Random selection</div>
                        <div class="option" onclick="checkFinalAnswer(this, 3, 'd')">Volume levels only</div>
                        <div class="option" onclick="checkFinalAnswer(this, 3, 'd')">Psycho-acoustic modeling</div>
                    </div>
                </div>

                <div class="quiz-question">
                    <h4>Question 4: Which statement about Huffman coding is correct?</h4>
                    <div class="options">
                        <div class="option" onclick="checkFinalAnswer(this, 4, 'a')">Frequent characters get shorter codes</div>
                        <div class="option" onclick="checkFinalAnswer(this, 4, 'b')">All characters get the same code length</div>
                        <div class="option" onclick="checkFinalAnswer(this, 4, 'c')">Rare characters get shorter codes</div>
                        <div class="option" onclick="checkFinalAnswer(this, 4, 'd')">It's a lossy compression method</div>
                    </div>
                </div>

                <div class="quiz-question">
                    <h4>Question 5: A file compressed from 100MB to 25MB has a compression ratio of:</h4>
                    <div class="options">
                        <div class="option" onclick="checkFinalAnswer(this, 5, 'b')">25:1</div>
                        <div class="option" onclick="checkFinalAnswer(this, 5, 'b')">4:1</div>
                        <div class="option" onclick="checkFinalAnswer(this, 5, 'c')">1:4</div>
                        <div class="option" onclick="checkFinalAnswer(this, 5, 'd')">75:1</div>
                    </div>
                </div>

                <div class="quiz-question">
                    <h4>Question 6: True or False: RLE always makes files smaller</h4>
                    <div class="options">
                        <div class="option" onclick="checkFinalAnswer(this, 6, 'false')">True</div>
                        <div class="option" onclick="checkFinalAnswer(this, 6, 'false')">False</div>
                    </div>
                </div>

                <div id="finalScore" class="card" style="background: #f9fafb; display: none;">
                    <h3>Your Final Score: <span id="scoreValue"></span>/6</h3>
                    <p id="scoreFeedback"></p>
                </div>
            </div>

            <div class="card">
                <h3>Videos (Coming Soon)</h3>
                <p>Additional video resources will be added here to reinforce your learning.</p>
                <div style="background: #f3f4f6; padding: 2rem; text-align: center; border-radius: 0.375rem;">
                    <p>üìπ Video placeholder</p>
                </div>
            </div>

            <button class="button reset-button" onclick="resetPage(9)">Reset Quiz</button>

            <div class="navigation-controls">
                <button class="button secondary" onclick="previousPage()">‚Üê Previous</button>
                <div></div>
            </div>
        </div>
    </main>

    <!-- Feedback Button -->
    <button class="feedback-button" onclick="openFeedback()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
    </button>

    <!-- Feedback Modal -->
    <div class="feedback-modal" id="feedbackModal">
        <div class="feedback-content">
            <h3>Send Feedback</h3>
            <p>Found a bug or have a suggestion? Let us know!</p>
            <textarea class="input-box" id="feedbackText" rows="4" placeholder="Describe the issue or suggestion..."></textarea>
            <div style="margin-top: 1rem; display: flex; gap: 1rem;">
                <button class="button" onclick="sendFeedback()">Send</button>
                <button class="button secondary" onclick="closeFeedback()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <h4>üéâ Achievement Unlocked!</h4>
        <p id="achievementText"></p>
    </div>

    <!-- Accessibility Controls -->
    <button class="accessibility-toggle button secondary" onclick="toggleAccessibility()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="3"></circle>
            <path d="M12 1v6m0 6v6m4.22-10.22l1.42-1.42m-1.42 8.49l1.42 1.42M20 12h-6m-6 0H2m10.22 4.22l-1.42 1.42m1.42-8.49l-1.42-1.42"></path>
        </svg>
    </button>

    <div class="accessibility-controls" id="accessibilityControls">
        <h4>Accessibility Options</h4>
        <label>
            <input type="checkbox" onchange="toggleHighContrast()"> High Contrast Mode
        </label>
        <label>
            <input type="checkbox" onchange="toggleDyslexiaFont()"> Dyslexia-Friendly Font
        </label>
        <label>
            Font Size:
            <input type="range" min="12" max="24" value="16" onchange="changeFontSize(this.value)">
        </label>
    </div>

    <script>
        // Global state
        let currentPage = 0;
        const totalPages = 10;
        let userXP = 0;
        let userLevel = 0;
        let achievements = new Set();
        let answeredQuestions = new Set();
        let startTime = Date.now();

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateProgress();
            updateStats();
            initializeRLEGrid();
            drawSoundWave();
            drawPhotoExample();
            preventPaste();
            
            // Set up click handler for compression demo
            const originalTextDiv = document.getElementById('originalText');
            if (originalTextDiv) {
                originalTextDiv.addEventListener('click', function() {
                    const text = this.textContent;
                    let compressed = '';
                    let currentChar = text[0];
                    let count = 1;
                    
                    for (let i = 1; i < text.length; i++) {
                        if (text[i] === currentChar) {
                            count++;
                        } else {
                            compressed += count + currentChar;
                            currentChar = text[i];
                            count = 1;
                        }
                    }
                    compressed += count + currentChar;
                    
                    document.getElementById('compressedText').textContent = compressed;
                    document.getElementById('compressedSize').textContent = `${compressed.length} characters`;
                    addXP(5, 'compression-demo');
                });
            }
        });

        // Draw photo example
        function drawPhotoExample() {
            const canvas = document.getElementById('photoOriginal');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            // Draw a simulated landscape photo
            // Sky gradient
            const skyGradient = ctx.createLinearGradient(0, 0, 0, 100);
            skyGradient.addColorStop(0, '#87CEEB');
            skyGradient.addColorStop(1, '#E0F6FF');
            ctx.fillStyle = skyGradient;
            ctx.fillRect(0, 0, 250, 100);
            
            // Sun
            ctx.fillStyle = '#FFD700';
            ctx.beginPath();
            ctx.arc(200, 40, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // Mountains
            ctx.fillStyle = '#4A5568';
            ctx.beginPath();
            ctx.moveTo(0, 100);
            ctx.lineTo(80, 60);
            ctx.lineTo(150, 80);
            ctx.lineTo(250, 50);
            ctx.lineTo(250, 100);
            ctx.closePath();
            ctx.fill();
            
            // Foreground hills
            ctx.fillStyle = '#2D3748';
            ctx.beginPath();
            ctx.moveTo(0, 100);
            ctx.lineTo(100, 90);
            ctx.lineTo(180, 95);
            ctx.lineTo(250, 85);
            ctx.lineTo(250, 180);
            ctx.lineTo(0, 180);
            ctx.closePath();
            ctx.fill();
            
            // Trees
            for (let i = 0; i < 5; i++) {
                const x = 30 + i * 50;
                const y = 120;
                
                // Tree trunk
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(x - 3, y, 6, 20);
                
                // Tree foliage
                ctx.fillStyle = '#228B22';
                ctx.beginPath();
                ctx.moveTo(x, y - 20);
                ctx.lineTo(x - 15, y);
                ctx.lineTo(x + 15, y);
                ctx.closePath();
                ctx.fill();
            }
        }

        function simulatePhotoCompression() {
            const original = document.getElementById('photoOriginal');
            const compressed = document.getElementById('photoCompressed');
            const ctxOrig = original.getContext('2d');
            const ctxComp = compressed.getContext('2d');
            
            // Copy original to compressed canvas
            ctxComp.drawImage(original, 0, 0);
            
            // Simulate JPEG compression artifacts
            const imageData = ctxComp.getImageData(0, 0, 250, 180);
            const data = imageData.data;
            
            // Reduce color depth and add blocking artifacts
            for (let y = 0; y < 180; y += 8) {
                for (let x = 0; x < 250; x += 8) {
                    // Calculate average color for 8x8 block
                    let avgR = 0, avgG = 0, avgB = 0;
                    let count = 0;
                    
                    for (let dy = 0; dy < 8 && y + dy < 180; dy++) {
                        for (let dx = 0; dx < 8 && x + dx < 250; dx++) {
                            const idx = ((y + dy) * 250 + (x + dx)) * 4;
                            avgR += data[idx];
                            avgG += data[idx + 1];
                            avgB += data[idx + 2];
                            count++;
                        }
                    }
                    
                    avgR = Math.round(avgR / count / 8) * 8;
                    avgG = Math.round(avgG / count / 8) * 8;
                    avgB = Math.round(avgB / count / 8) * 8;
                    
                    // Apply averaged color to block
                    for (let dy = 0; dy < 8 && y + dy < 180; dy++) {
                        for (let dx = 0; dx < 8 && x + dx < 250; dx++) {
                            const idx = ((y + dy) * 250 + (x + dx)) * 4;
                            data[idx] = avgR;
                            data[idx + 1] = avgG;
                            data[idx + 2] = avgB;
                        }
                    }
                }
            }
            
            ctxComp.putImageData(imageData, 0, 0);
            
            // Add slight blur to simulate quality loss
            ctxComp.filter = 'blur(0.5px)';
            ctxComp.drawImage(compressed, 0, 0);
            
            addXP(10, 'photo-compression-demo');
        }

        // Prevent paste
        function preventPaste() {
            document.addEventListener('paste', function(e) {
                e.preventDefault();
                showShameMessage();
                return false;
            });
            
            // Prevent context menu
            document.addEventListener('contextmenu', function(e) {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                    e.preventDefault();
                    return false;
                }
            });
        }

        function showShameMessage() {
            const shame = document.createElement('div');
            shame.style.cssText = 'position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #ef4444; color: white; padding: 2rem; border-radius: 0.5rem; z-index: 9999; animation: shake 0.5s;';
            shame.textContent = 'üö´ Pasting is disabled! Type your own answers.';
            document.body.appendChild(shame);
            setTimeout(() => shame.remove(), 3000);
        }

        // Navigation
        function navigateTo(page) {
            currentPage = page;
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById(`page${page}`).classList.add('active');
            
            document.querySelectorAll('.nav-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.nav-button')[page].classList.add('active');
            
            updateProgress();
            window.scrollTo(0, 0);
        }

        function nextPage() {
            if (currentPage < totalPages - 1) {
                navigateTo(currentPage + 1);
            }
        }

        function previousPage() {
            if (currentPage > 0) {
                navigateTo(currentPage - 1);
            }
        }

        // XP and Achievements
        function addXP(amount, source) {
            if (!answeredQuestions.has(source)) {
                userXP += amount;
                answeredQuestions.add(source);
                updateStats();
                checkLevelUp();
            }
        }

        function checkLevelUp() {
            const newLevel = Math.floor(userXP / 100);
            if (newLevel > userLevel && newLevel <= 5) {
                userLevel = newLevel;
                showAchievement(`Level ${userLevel} Reached!`, `You've earned ${userXP} XP`);
            }
        }

        function showAchievement(title, text) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementText').textContent = text;
            popup.classList.add('show');
            
            setTimeout(() => {
                popup.classList.remove('show');
            }, 3000);
        }

        function updateProgress() {
            const progress = ((currentPage + 1) / totalPages) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function updateStats() {
            document.getElementById('xpCount').textContent = userXP;
            document.getElementById('levelCount').textContent = userLevel;
        }

        // Starter Activity
        function checkStarterAnswer(element, question, isCorrect) {
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => {
                opt.onclick = null;
                opt.style.cursor = 'default';
            });
            
            if (isCorrect) {
                element.classList.add('correct');
                showFeedback(`${question}-feedback`, 'Correct! Well done!', true);
                addXP(10, `starter-${question}`);
            } else {
                element.classList.add('incorrect');
                showFeedback(`${question}-feedback`, 'Not quite. Think about it and try the next question.', false);
            }
        }

        // Page 1 functions
        function updateCompressionDemo() {
            const customText = document.getElementById('customCompressionText').value;
            document.getElementById('originalText').textContent = customText;
            document.getElementById('originalSize').textContent = `${customText.length} characters`;
            document.getElementById('compressedText').textContent = 'Click original to compress';
            document.getElementById('compressedSize').textContent = '? characters';
        }

        function resetCompressionDemo() {
            document.getElementById('customCompressionText').value = 'AAAAAABBBBBCCCCDDD';
            document.getElementById('originalText').textContent = 'AAAAAABBBBBCCCCDDD';
            document.getElementById('originalSize').textContent = '18 characters';
            document.getElementById('compressedText').textContent = 'Click original to compress';
            document.getElementById('compressedSize').textContent = '? characters';
        }

        function checkFillIn(select, correctAnswer, number) {
            if (select.value === correctAnswer) {
                select.style.borderColor = 'var(--success-color)';
                addXP(5, `fillin-${number}`);
                
                const allCorrect = Array.from(document.querySelectorAll('.page.active select')).every(s => 
                    s.style.borderColor === 'var(--success-color)'
                );
                
                if (allCorrect) {
                    showFeedback('fillInFeedback', 'Excellent! You understand why compression is important.', true);
                }
            } else if (select.value !== '') {
                select.style.borderColor = 'var(--error-color)';
            }
        }

        // Page 2 functions
        function sortCharacteristic(element, correctCategory) {
            element.dataset.category = correctCategory;
            const dropzone = document.getElementById(correctCategory + 'Drop');
            dropzone.appendChild(element);
            element.onclick = null;
            element.style.cursor = 'default';
            
            addXP(5, `sort-${element.textContent.substring(0, 10)}`);
            
            // Check if all sorted
            const remaining = document.getElementById('characteristics').children.length;
            if (remaining === 0) {
                showAchievement('Sorting Master!', 'You correctly sorted all characteristics');
                addXP(20, 'sorting-complete');
            }
        }

        function resetSorting() {
            const characteristics = document.getElementById('characteristics');
            const items = [...document.querySelectorAll('.draggable')];
            items.forEach(item => {
                characteristics.appendChild(item);
                item.onclick = function() { sortCharacteristic(this, item.dataset.category); };
                item.style.cursor = 'pointer';
            });
        }

        function checkScenario(button, expectedAnswer, scenario) {
            const isCorrect = button.textContent.toLowerCase() === expectedAnswer;
            
            button.style.backgroundColor = isCorrect ? 'var(--success-color)' : 'var(--error-color)';
            button.style.color = 'white';
            
            if (isCorrect) {
                addXP(10, `scenario-${scenario}`);
            }
            
            // Disable both buttons
            const buttons = button.parentElement.querySelectorAll('button');
            buttons.forEach(b => b.disabled = true);
            
            if (document.querySelectorAll('.quiz-question button:not(:disabled)').length === 0) {
                showFeedback('scenarioFeedback', 'Good understanding of when to use each type!', true);
            }
        }

        // Page 3 functions
        function initializeRLEGrid() {
            const grid = document.getElementById('rleGrid');
            if (!grid) return;
            
            for (let row = 0; row < 5; row++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'rle-row';
                for (let col = 0; col < 10; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'rle-cell';
                    cell.style.backgroundColor = '#ffffff';
                    cell.dataset.color = 'white';
                    cell.onclick = function() {
                        this.style.backgroundColor = this.dataset.color === 'white' ? '#000000' : '#ffffff';
                        this.dataset.color = this.dataset.color === 'white' ? 'black' : 'white';
                    };
                    rowDiv.appendChild(cell);
                }
                grid.appendChild(rowDiv);
            }
        }

        function clearRLEGrid() {
            document.querySelectorAll('.rle-cell').forEach(cell => {
                cell.style.backgroundColor = '#ffffff';
                cell.dataset.color = 'white';
            });
        }

        function fillRLEPattern() {
            const cells = document.querySelectorAll('.rle-cell');
            // Create a simple pattern
            for (let i = 0; i < 20; i++) {
                cells[i].style.backgroundColor = '#000000';
                cells[i].dataset.color = 'black';
            }
            for (let i = 30; i < 35; i++) {
                cells[i].style.backgroundColor = '#000000';
                cells[i].dataset.color = 'black';
            }
        }

        function encodeRLE() {
            const rows = document.querySelectorAll('.rle-row');
            let encoding = '';
            
            rows.forEach((row, rowIndex) => {
                const cells = row.querySelectorAll('.rle-cell');
                let currentColor = cells[0].dataset.color;
                let count = 1;
                
                encoding += `Row ${rowIndex + 1}: `;
                
                for (let i = 1; i < cells.length; i++) {
                    if (cells[i].dataset.color === currentColor) {
                        count++;
                    } else {
                        encoding += `${currentColor === 'black' ? 'B' : 'W'}${count} `;
                        currentColor = cells[i].dataset.color;
                        count = 1;
                    }
                }
                encoding += `${currentColor === 'black' ? 'B' : 'W'}${count}\n`;
            });
            
            document.getElementById('rleOutput').textContent = encoding;
            addXP(15, 'rle-encode');
        }

        function demonstrateBitDepth() {
            // Draw photographic images with different bit depths
            const drawPhoto = (canvasId, bitDepth) => {
                const canvas = document.getElementById(canvasId);
                const ctx = canvas.getContext('2d');
                
                // Create a portrait-like photo
                // Background gradient
                const bgGradient = ctx.createLinearGradient(0, 0, 150, 150);
                bgGradient.addColorStop(0, '#E8D5C4');
                bgGradient.addColorStop(1, '#D4A574');
                ctx.fillStyle = bgGradient;
                ctx.fillRect(0, 0, 150, 150);
                
                // Simulate face
                ctx.fillStyle = '#FDBCB4';
                ctx.beginPath();
                ctx.ellipse(75, 65, 35, 45, 0, 0, Math.PI * 2);
                ctx.fill();
                
                // Hair
                ctx.fillStyle = '#654321';
                ctx.beginPath();
                ctx.arc(75, 40, 40, Math.PI, 0);
                ctx.fill();
                
                // Eyes
                ctx.fillStyle = '#000000';
                ctx.beginPath();
                ctx.arc(60, 60, 3, 0, Math.PI * 2);
                ctx.arc(90, 60, 3, 0, Math.PI * 2);
                ctx.fill();
                
                // Mouth
                ctx.strokeStyle = '#8B4513';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.arc(75, 75, 10, 0, Math.PI);
                ctx.stroke();
                
                // Clothing
                ctx.fillStyle = '#4169E1';
                ctx.beginPath();
                ctx.moveTo(40, 110);
                ctx.lineTo(110, 110);
                ctx.lineTo(120, 150);
                ctx.lineTo(30, 150);
                ctx.closePath();
                ctx.fill();
                
                // Apply bit depth reduction
                const imageData = ctx.getImageData(0, 0, 150, 150);
                const data = imageData.data;
                
                if (bitDepth === 8) {
                    // Reduce to 256 colors (8-bit)
                    for (let i = 0; i < data.length; i += 4) {
                        data[i] = Math.round(data[i] / 32) * 32;
                        data[i + 1] = Math.round(data[i + 1] / 32) * 32;
                        data[i + 2] = Math.round(data[i + 2] / 32) * 32;
                    }
                } else if (bitDepth === 4) {
                    // Reduce to 16 colors (4-bit)
                    for (let i = 0; i < data.length; i += 4) {
                        data[i] = Math.round(data[i] / 64) * 64;
                        data[i + 1] = Math.round(data[i + 1] / 64) * 64;
                        data[i + 2] = Math.round(data[i + 2] / 64) * 64;
                    }
                }
                
                ctx.putImageData(imageData, 0, 0);
            };
            
            // Draw all three versions
            drawPhoto('bitDepth24', 24);
            drawPhoto('bitDepth8', 8);
            drawPhoto('bitDepth4', 4);
            
            addXP(10, 'bit-depth-demo');
        }

        function checkRLEAnswer() {
            const answer = document.getElementById('rleAnswer').value.toLowerCase().replace(/\s+/g, '');
            const correct = ['black3,white5,black2', 'b3,w5,b2', '3black,5white,2black', '3b,5w,2b'];
            
            if (correct.some(c => answer.includes(c.replace(/\s+/g, '')))) {
                showFeedback('rleFeedback', 'Correct! You understand RLE encoding.', true);
                addXP(20, 'rle-practice');
            } else {
                showFeedback('rleFeedback', 'Not quite. Remember: count each run of the same color.', false);
            }
        }

        // Page 4 functions
        function createDictionary() {
            const text = document.getElementById('dictInput').value;
            const words = text.toLowerCase().split(/[\s,.!?]+/).filter(word => word.length > 0);
            const wordCount = {};
            
            // Count word frequencies
            words.forEach(word => {
                wordCount[word] = (wordCount[word] || 0) + 1;
            });
            
            // Create dictionary for words that appear more than once
            const dictionary = {};
            let code = 1;
            
            const sortedWords = Object.entries(wordCount)
                .filter(([word, count]) => count > 1)
                .sort(([,a], [,b]) => b - a);
            
            sortedWords.forEach(([word, count]) => {
                dictionary[word] = `[${code}]`;
                code++;
            });
            
            // Display dictionary with counts
            const dictDiv = document.getElementById('dictionary');
            dictDiv.innerHTML = '<strong>Dictionary Entries:</strong><br>' + 
                sortedWords.map(([word, count]) => 
                    `"${word}" (appears ${count}x) ‚Üí ${dictionary[word]}`
                ).join('<br>');
            
            if (sortedWords.length === 0) {
                dictDiv.innerHTML = '<em>No repeated words found to compress!</em>';
            }
            
            // Create compressed version
            let compressedText = text.toLowerCase();
            let compressedWords = words.slice(); // Copy of original words array
            
            // Replace words with their dictionary codes
            Object.entries(dictionary).forEach(([word, code]) => {
                compressedWords = compressedWords.map(w => w === word ? code : w);
            });
            
            const compressedString = compressedWords.join(' ');
            
            document.getElementById('compressedDict').innerHTML = `
                <strong>Original size:</strong> ${text.length} characters<br>
                <strong>Dictionary size:</strong> ${JSON.stringify(dictionary).length} characters<br>
                <strong>Compressed text:</strong> ${compressedString}<br>
                <strong>Compressed size:</strong> ${compressedString.length + JSON.stringify(dictionary).length} characters<br>
                <strong>Space saved:</strong> ${Math.round((1 - (compressedString.length + JSON.stringify(dictionary).length) / text.length) * 100)}%
            `;
            
            addXP(15, 'dictionary-compression');
        }

        function analyzeFrequency() {
            const text = document.getElementById('huffmanInput').value.toUpperCase();
            const freq = {};
            
            // Count character frequencies
            for (let char of text) {
                if (char !== ' ') { // Ignore spaces for cleaner visualization
                    freq[char] = (freq[char] || 0) + 1;
                }
            }
            
            const chartDiv = document.getElementById('frequencyChart');
            chartDiv.innerHTML = '<h5>Character Frequency Analysis:</h5>';
            
            // Sort by frequency and show top 10
            const sortedFreq = Object.entries(freq)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 10);
            
            const maxCount = sortedFreq[0][1];
            
            sortedFreq.forEach(([char, count]) => {
                const percentage = (count / maxCount) * 100;
                const bar = document.createElement('div');
                bar.style.cssText = 'display: flex; align-items: center; margin: 0.5rem 0; gap: 0.5rem;';
                bar.innerHTML = `
                    <span style="width: 30px; font-family: monospace; font-weight: bold;">'${char}'</span>
                    <div style="flex: 1; background: #e5e7eb; height: 24px; border-radius: 0.25rem; overflow: hidden;">
                        <div style="background: var(--primary-color); height: 100%; width: ${percentage}%; transition: width 0.5s ease; display: flex; align-items: center; padding-left: 0.5rem;">
                            <span style="color: white; font-size: 0.75rem;">${count}</span>
                        </div>
                    </div>
                `;
                chartDiv.appendChild(bar);
            });
            
            // Show total characters analyzed
            const totalChars = Object.values(freq).reduce((a, b) => a + b, 0);
            chartDiv.innerHTML += `<p style="margin-top: 1rem; font-size: 0.875rem; color: #6b7280;">Total characters analyzed: ${totalChars}</p>`;
            
            // Show Huffman codes
            const codesDiv = document.getElementById('huffmanCodes');
            codesDiv.innerHTML = '<p><strong>Example Huffman Codes:</strong></p>';
            
            const codeTable = document.createElement('div');
            codeTable.style.cssText = 'display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 0.5rem; margin-top: 0.5rem;';
            
            sortedFreq.forEach(([char, count], index) => {
                const bitsNeeded = Math.ceil(Math.log2(index + 2));
                const code = index === 0 ? '0' : 
                            index === 1 ? '10' : 
                            index === 2 ? '110' : 
                            index === 3 ? '1110' : 
                            '1'.repeat(bitsNeeded - 1) + '0';
                
                const entry = document.createElement('div');
                entry.style.cssText = 'background: #f3f4f6; padding: 0.5rem; border-radius: 0.25rem; font-family: monospace; font-size: 0.875rem;';
                entry.innerHTML = `'${char}': ${code} (${code.length} bits)`;
                codeTable.appendChild(entry);
            });
            
            codesDiv.appendChild(codeTable);
            codesDiv.innerHTML += '<p style="margin-top: 1rem; font-size: 0.875rem;"><em>Note: More frequent characters get shorter codes!</em></p>';
            
            addXP(15, 'huffman-analysis');
        }

        function checkTextAnswer(element, correct) {
            const isCorrect = element.textContent.includes(correct);
            element.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            if (isCorrect) {
                showFeedback('textFeedback', 'Correct! Frequent characters get shorter codes in Huffman coding.', true);
                addXP(10, 'huffman-question');
            } else {
                showFeedback('textFeedback', 'Think about efficiency - which letter appears more often?', false);
            }
            
            element.parentElement.querySelectorAll('.option').forEach(opt => opt.onclick = null);
        }

        // Page 5 functions
        function demonstrateMasking() {
            const demo = document.getElementById('maskingDemo');
            demo.innerHTML = `
                <div style="display: grid; gap: 1rem;">
                    <div style="background: #f9fafb; padding: 1rem; border-radius: 0.5rem;">
                        <h5>Interactive Masking Demonstration</h5>
                        <p>Imagine you're at a concert. Click the buttons to hear what happens:</p>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1rem 0;">
                            <button class="button secondary" onclick="playMaskingScenario('quiet')" style="height: 80px;">
                                <div>üé∏ Solo Guitar</div>
                                <div style="font-size: 0.875rem;">Playing alone (60 dB)</div>
                            </button>
                            <button class="button secondary" onclick="playMaskingScenario('loud')" style="height: 80px;">
                                <div>ü•Å Full Band</div>
                                <div style="font-size: 0.875rem;">All instruments (95 dB)</div>
                            </button>
                        </div>
                        
                        <div id="maskingResult" style="padding: 1rem; background: white; border: 2px solid #e5e7eb; border-radius: 0.5rem; min-height: 100px;">
                            <p style="text-align: center; color: #6b7280;">Click a button to see what happens!</p>
                        </div>
                        
                        <div style="background: #fef3c7; padding: 0.75rem; border-radius: 0.25rem; margin-top: 1rem;">
                            <strong>üí° Key Concept:</strong> MP3 uses this principle to save space. If you can't hear something because it's masked, why store it?
                        </div>
                    </div>
                </div>
            `;
            addXP(10, 'masking-demo');
        }
        
        function playMaskingScenario(scenario) {
            const result = document.getElementById('maskingResult');
            
            if (scenario === 'quiet') {
                result.innerHTML = `
                    <div style="text-align: center;">
                        <div style="font-size: 3rem;">üé∏</div>
                        <h4 style="color: #10b981;">You can hear every note!</h4>
                        <p>The guitar plays at 60 dB. You can hear:</p>
                        <ul style="text-align: left; margin: 0.5rem auto; max-width: 300px;">
                            <li>Individual string vibrations</li>
                            <li>Subtle finger movements</li>
                            <li>Quiet harmonics</li>
                        </ul>
                        <p style="margin-top: 1rem; font-weight: bold;">MP3 would keep ALL these sounds</p>
                    </div>
                `;
            } else {
                result.innerHTML = `
                    <div style="text-align: center;">
                        <div style="font-size: 3rem;">ü•Åüé∏üéπüé∫</div>
                        <h4 style="color: #ef4444;">Guitar details are MASKED!</h4>
                        <p>With the full band at 95 dB:</p>
                        <ul style="text-align: left; margin: 0.5rem auto; max-width: 300px;">
                            <li>Drums overpower quiet guitar notes</li>
                            <li>Bass frequencies hide subtle sounds</li>
                            <li>Your brain can't process it all</li>
                        </ul>
                        <p style="margin-top: 1rem; font-weight: bold; color: #ef4444;">MP3 removes the masked sounds - you can't hear them anyway!</p>
                    </div>
                `;
            }
            
            addXP(5, `masking-scenario-${scenario}`);
        }

        function checkAudioAnswer(element, isCorrect) {
            element.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            if (isCorrect) {
                showFeedback('audioFeedback', 'Correct! MP3 preserves the important parts we can hear.', true);
                addXP(15, 'audio-question');
            } else {
                showFeedback('audioFeedback', 'MP3 removes sounds we can\'t hear or that are masked.', false);
            }
            
            element.parentElement.querySelectorAll('.option').forEach(opt => opt.onclick = null);
        }

        // Page 6 functions
        function checkRLEPractice(row) {
            const answers = {
                1: ['10', '3', '3'],
                2: ['9', '6', '1']
            };
            
            let correct = true;
            answers[row].forEach((answer, index) => {
                const input = document.getElementById(`rle${row}_${index + 1}`);
                if (input.value === answer) {
                    input.style.borderColor = 'var(--success-color)';
                } else {
                    input.style.borderColor = 'var(--error-color)';
                    correct = false;
                }
            });
            
            if (correct) {
                showFeedback('rlePracticeFeedback', `Row ${row} correct! You're mastering RLE.`, true);
                addXP(20, `rle-practice-${row}`);
            } else {
                showFeedback('rlePracticeFeedback', 'Check your counting - remember to count consecutive pixels.', false);
            }
        }

        function drawSoundWave() {
            const canvas = document.getElementById('soundWave');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const values = [128, 128, 128, 128, 255, 255, 0, 0, 0, 128, 128];
            const width = canvas.width / values.length;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.strokeStyle = '#3b82f6';
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            values.forEach((value, index) => {
                const x = index * width + width / 2;
                const y = canvas.height - (value / 255 * canvas.height);
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
                
                // Draw value label
                ctx.fillStyle = '#1f2937';
                ctx.fillText(value, x - 10, canvas.height - 10);
            });
            ctx.stroke();
        }

        function checkSoundRLE() {
            const answer = document.getElementById('soundRLE').value.toLowerCase().replace(/\s+/g, '');
            const correct = ['1284,2552,03,1282', '128,4,255,2,0,3,128,2'];
            
            if (correct.some(c => answer.includes(c.replace(/\s+/g, '')))) {
                showFeedback('soundRLEFeedback', 'Perfect! You can apply RLE to sound data.', true);
                addXP(25, 'sound-rle');
            } else {
                showFeedback('soundRLEFeedback', 'Format: value count, value count... (e.g., 128 4)', false);
            }
        }

        function calculateCompression() {
            const orig = parseFloat(document.getElementById('origSize').value);
            const comp = parseFloat(document.getElementById('compSize').value);
            
            if (orig && comp && orig > 0 && comp > 0) {
                const ratio = (orig / comp).toFixed(2);
                const saved = ((1 - comp / orig) * 100).toFixed(1);
                
                document.getElementById('compressionResult').innerHTML = `
                    <div class="card" style="background: #f9fafb;">
                        <p><strong>Compression Ratio:</strong> ${ratio}:1</p>
                        <p><strong>Space Saved:</strong> ${saved}%</p>
                        <p><strong>Efficiency:</strong> ${saved > 50 ? 'Excellent!' : saved > 30 ? 'Good' : 'Moderate'}</p>
                    </div>
                `;
                
                addXP(10, 'compression-calculator');
            }
        }

        // Page 7 functions
        function showMarkScheme(question) {
            const marks = document.getElementById(`q${question}marks`).value;
            const textarea = document.getElementById(`q${question}answer`);
            
            if (!marks || (textarea && textarea.value.length < 50)) {
                alert('Please enter your predicted marks and ensure you\'ve attempted the question adequately.');
                return;
            }
            
            document.getElementById(`markScheme${question}`).style.display = 'block';
            addXP(30, `exam-question-${question}`);
        }

        // Page 8 functions
        function checkLZ77() {
            const answer = document.getElementById('lz77answer').value.toLowerCase();
            
            if (answer.includes('abc') && (answer.includes('(3,3)') || answer.includes('3,3'))) {
                showFeedback('lz77feedback', 'Excellent! You understand the sliding window concept.', true);
                addXP(40, 'lz77-extension');
            } else {
                showFeedback('lz77feedback', 'Hint: After "abc", it can reference back 3 positions and copy 3 characters.', false);
            }
        }

        function selectResearchTopic(element, topic) {
            document.querySelectorAll('.page.active .option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            
            const prompts = {
                streaming: 'Consider: adaptive bitrate, codecs like H.264/H.265, buffering strategies',
                medical: 'Consider: DICOM format, lossless requirements, storage challenges',
                gaming: 'Consider: texture compression, level-of-detail systems, streaming assets',
                space: 'Consider: limited bandwidth, error correction, extreme compression needs'
            };
            
            document.getElementById('researchAnswer').placeholder = prompts[topic] || 'Write your research findings here...';
        }

        function submitResearch() {
            const answer = document.getElementById('researchAnswer').value;
            const keywords = ['compress', 'lossy', 'lossless', 'bandwidth', 'storage', 'quality', 'algorithm'];
            
            const wordCount = answer.split(/\s+/).length;
            const keywordsUsed = keywords.filter(k => answer.toLowerCase().includes(k)).length;
            
            if (wordCount > 100 && keywordsUsed >= 3) {
                showFeedback('researchFeedback', 'Excellent research! You\'ve demonstrated deep understanding.', true);
                addXP(50, 'research-extension');
                showAchievement('Researcher!', 'Completed advanced research task');
            } else {
                showFeedback('researchFeedback', `Keep going! (${wordCount} words, ${keywordsUsed} key concepts used)`, false);
            }
        }

        // Page 9 functions
        let finalAnswers = 0;
        let finalCorrect = 0;

        function checkFinalAnswer(element, question, correctOption) {
            const options = element.parentElement.querySelectorAll('.option');
            const isCorrect = element.textContent.includes(correctOption) || 
                             (question === 1 && element.textContent.includes('Lossless')) ||
                             (question === 2 && element.textContent.includes('Run Length')) ||
                             (question === 3 && element.textContent.includes('Psycho')) ||
                             (question === 4 && element.textContent.includes('Frequent')) ||
                             (question === 5 && element.textContent.includes('4:1')) ||
                             (question === 6 && element.textContent.includes('False'));
            
            options.forEach(opt => {
                opt.onclick = null;
                opt.style.cursor = 'default';
            });
            
            element.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            finalAnswers++;
            if (isCorrect) {
                finalCorrect++;
                addXP(15, `final-q${question}`);
            }
            
            if (finalAnswers === 6) {
                showFinalScore();
            }
        }

        function showFinalScore() {
            const scoreDiv = document.getElementById('finalScore');
            const scoreValue = document.getElementById('scoreValue');
            const scoreFeedback = document.getElementById('scoreFeedback');
            
            scoreDiv.style.display = 'block';
            scoreValue.textContent = finalCorrect;
            
            const percentage = (finalCorrect / 6) * 100;
            
            if (percentage === 100) {
                scoreFeedback.textContent = 'Perfect score! You\'ve mastered compression!';
                showAchievement('Compression Master!', 'Achieved 100% on final quiz');
                addXP(100, 'perfect-score');
            } else if (percentage >= 80) {
                scoreFeedback.textContent = 'Excellent work! You have a strong understanding.';
            } else if (percentage >= 60) {
                scoreFeedback.textContent = 'Good effort! Review the topics you found challenging.';
            } else {
                scoreFeedback.textContent = 'Keep practicing! Review the lesson and try again.';
            }
            
            // Time bonus
            const timeSpent = Math.floor((Date.now() - startTime) / 60000);
            if (timeSpent > 30) {
                showAchievement('Dedicated Learner!', `Spent ${timeSpent} minutes learning`);
                addXP(50, 'time-bonus');
            }
        }

        // Helper functions
        function showFeedback(id, message, isSuccess) {
            const feedback = document.getElementById(id);
            if (feedback) {
                feedback.textContent = message;
                feedback.className = 'feedback ' + (isSuccess ? 'success' : 'error');
                feedback.style.display = 'block';
            }
        }

        function showHint(topic) {
            const hint = document.getElementById(`${topic}-hint`);
            if (hint) {
                hint.style.display = 'block';
                addXP(-5, `hint-${topic}`); // Reduce XP for using hint
            }
        }

        // Reset functions
        function resetPage(pageNum) {
            switch(pageNum) {
                case 0:
                    document.querySelectorAll('#page0 .option').forEach(opt => {
                        opt.classList.remove('correct', 'incorrect');
                        opt.style.cursor = 'pointer';
                    });
                    document.querySelectorAll('#page0 .feedback').forEach(f => f.style.display = 'none');
                    break;
                case 1:
                    resetCompressionDemo();
                    document.getElementById('customCompressionText').value = 'AAAAAABBBBBCCCCDDD';
                    document.querySelectorAll('#page1 select').forEach(s => {
                        s.value = '';
                        s.style.borderColor = 'var(--border-color)';
                    });
                    document.getElementById('fillInFeedback').style.display = 'none';
                    break;
                case 2:
                    resetSorting();
                    document.querySelectorAll('#page2 button').forEach(b => {
                        b.disabled = false;
                        b.style.backgroundColor = '';
                        b.style.color = '';
                    });
                    // Reset the simulation
                    if (typeof simInitializeImage === 'function') {
                        simInitializeImage();
                    }
                    break;
                case 3:
                    clearRLEGrid();
                    document.getElementById('rleOutput').textContent = 'Click "Encode" to see RLE';
                    document.getElementById('rleAnswer').value = '';
                    document.getElementById('rleFeedback').style.display = 'none';
                    break;
                case 4:
                    document.getElementById('dictInput').value = 'The cat sat on the mat. The cat was fat. The mat was flat.';
                    document.getElementById('dictionary').innerHTML = 'Click "Compress Text" to generate dictionary';
                    document.getElementById('compressedDict').innerHTML = 'Compressed text will appear here...';
                    document.getElementById('huffmanInput').value = 'The quick brown fox jumps over the lazy dog. This pangram sentence contains every letter of the alphabet at least once, making it perfect for testing character frequency distribution in text compression algorithms.';
                    document.getElementById('frequencyChart').innerHTML = '';
                    document.getElementById('huffmanCodes').innerHTML = '';
                    break;
                case 5:
                    document.getElementById('maskingDemo').innerHTML = '';
                    document.querySelectorAll('#page5 .option').forEach(opt => {
                        opt.classList.remove('correct', 'incorrect');
                        opt.onclick = function() { checkAudioAnswer(this, this.textContent.includes('main melody')); };
                    });
                    break;
                case 6:
                    document.querySelectorAll('#page6 input[type="text"], #page6 input[type="number"]').forEach(i => {
                        i.value = '';
                        i.style.borderColor = 'var(--border-color)';
                    });
                    document.querySelectorAll('#page6 .feedback').forEach(f => f.style.display = 'none');
                    drawSoundWave();
                    break;
                case 7:
                    document.querySelectorAll('#page7 input, #page7 textarea').forEach(i => i.value = '');
                    document.querySelectorAll('#page7 .feedback').forEach(f => f.style.display = 'none');
                    break;
                case 8:
                    document.getElementById('lz77answer').value = '';
                    document.getElementById('researchAnswer').value = '';
                    document.querySelectorAll('#page8 .option').forEach(opt => opt.classList.remove('selected'));
                    document.querySelectorAll('#page8 .feedback').forEach(f => f.style.display = 'none');
                    break;
                case 9:
                    finalAnswers = 0;
                    finalCorrect = 0;
                    document.querySelectorAll('#page9 .option').forEach(opt => {
                        opt.classList.remove('correct', 'incorrect');
                        opt.style.cursor = 'pointer';
                        const q = parseInt(opt.parentElement.parentElement.querySelector('h4').textContent.match(/\d+/)[0]);
                        opt.onclick = function() { checkFinalAnswer(this, q, ''); };
                    });
                    document.getElementById('finalScore').style.display = 'none';
                    break;
            }
        }

        // Feedback system
        function openFeedback() {
            document.getElementById('feedbackModal').style.display = 'flex';
        }

        function closeFeedback() {
            document.getElementById('feedbackModal').style.display = 'none';
            document.getElementById('feedbackText').value = '';
        }

        function sendFeedback() {
            const feedback = document.getElementById('feedbackText').value;
            if (!feedback.trim()) {
                alert('Please enter your feedback before sending.');
                return;
            }
            
            const pageTitle = document.querySelector(`#page${currentPage} h2`).textContent;
            const subject = `Compression Worksheet Feedback - ${pageTitle}`;
            const body = `Page: ${currentPage + 1} - ${pageTitle}\n\nFeedback:\n${feedback}\n\nUser Stats:\nXP: ${userXP}\nLevel: ${userLevel}`;
            
            // Create mailto link
            const mailtoLink = `mailto:millingtond@mgs.org?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.location.href = mailtoLink;
            
            closeFeedback();
            showAchievement('Feedback Sent!', 'Thanks for helping improve this worksheet');
        }

        // Accessibility
        function toggleAccessibility() {
            const controls = document.getElementById('accessibilityControls');
            controls.style.display = controls.style.display === 'block' ? 'none' : 'block';
        }

        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
        }

        function toggleDyslexiaFont() {
            document.body.classList.toggle('dyslexia-font');
        }

        function changeFontSize(size) {
            document.body.style.fontSize = size + 'px';
        }

        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowRight' && e.ctrlKey) {
                nextPage();
            } else if (e.key === 'ArrowLeft' && e.ctrlKey) {
                previousPage();
            }
        });

        // Mobile touch support
        let touchStartX = null;
        
        document.addEventListener('touchstart', function(e) {
            touchStartX = e.touches[0].clientX;
        });
        
        document.addEventListener('touchend', function(e) {
            if (!touchStartX) return;
            
            const touchEndX = e.changedTouches[0].clientX;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > 50) {
                if (diff > 0) {
                    nextPage();
                } else {
                    previousPage();
                }
            }
            
            touchStartX = null;
        });

        // Initialize first page check
        if (currentPage === 0 && userLevel === 0) {
            setTimeout(() => {
                showAchievement('Welcome!', 'Started learning about compression');
                addXP(5, 'started');
            }, 1000);
        }
    </script>
</body>
</html>