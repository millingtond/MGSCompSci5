<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>Operating Systems - Lesson 2: Utility Software & Program Libraries</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        :root {
            --primary-color: #7c3aed;
            --secondary-color: #06b6d4;
            --danger-color: #dc2626;
            --warning-color: #f59e0b;
            --success-color: #10b981;
            --dark-bg: #1e293b;
            --light-bg: #f1f5f9;
            --text-dark: #0f172a;
            --text-light: #64748b;
            --border-color: #e2e8f0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background-color: #f8fafc;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), #a855f7);
            color: white;
            padding: 30px;
            border-radius: 16px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.1); opacity: 0.1; }
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .learning-outcomes {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-left: 5px solid var(--secondary-color);
        }

        .section {
            background: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            display: none;
        }

        .section.active {
            display: block;
        }

        .nav-bar {
            background: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            position: sticky;
            top: 10px;
            z-index: 100;
        }

        .nav-btn {
            padding: 8px 16px;
            border: none;
            background: var(--light-bg);
            color: var(--text-dark);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .nav-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: var(--primary-color);
            color: white;
        }

        .stats-bar {
            background: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .xp-bar {
            width: 200px;
            height: 20px;
            background: var(--light-bg);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-color), #0891b2);
            width: 0%;
            transition: width 0.5s ease;
        }

        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.5s ease;
            z-index: 1000;
            max-width: 300px;
        }

        .achievement-popup.show {
            transform: translateX(0);
        }

        .achievement-popup h3 {
            color: var(--secondary-color);
            margin-bottom: 5px;
        }

        .task-card {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid transparent;
            transition: all 0.3s;
        }

        .task-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.1);
        }

        .button {
            padding: 10px 20px;
            border: none;
            background: var(--primary-color);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            margin: 5px;
        }

        .button:hover {
            background: #6d28d9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.3);
        }

        .button.secondary {
            background: var(--secondary-color);
        }

        .button.danger {
            background: var(--danger-color);
        }

        input[type="text"], input[type="number"], textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
            background: white;
        }

        input[type="text"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .quiz-option {
            display: block;
            padding: 15px;
            margin: 10px 0;
            background: var(--light-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            border-color: var(--primary-color);
            background: #f8f1ff;
        }

        .quiz-option.selected {
            border-color: var(--primary-color);
            background: #ede9fe;
        }

        .quiz-option.correct {
            border-color: var(--success-color);
            background: #d1fae5;
        }

        .quiz-option.incorrect {
            border-color: var(--danger-color);
            background: #fee2e2;
        }

        .drag-item {
            padding: 12px;
            margin: 8px;
            background: #ddd6fe;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
        }

        .drag-item:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.3);
        }

        .drag-item.selected {
            background: var(--primary-color);
            color: white;
        }

        .drop-zone {
            min-height: 50px;
            padding: 15px;
            margin: 10px 0;
            background: var(--light-bg);
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            transition: all 0.3s;
        }

        .drop-zone.highlight {
            border-color: var(--primary-color);
            background: #f8f1ff;
        }

        .drop-zone.correct {
            border-color: var(--success-color);
            background: #d1fae5;
        }

        .drop-zone.incorrect {
            border-color: var(--danger-color);
            background: #fee2e2;
        }

        .simulation-container {
            background: var(--dark-bg);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .utility-box {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .utility-box:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.02);
        }

        .utility-box.active {
            background: rgba(6, 182, 212, 0.3);
            border-color: var(--secondary-color);
            transform: scale(1.05);
        }

        .disk-visual {
            width: 300px;
            height: 300px;
            margin: 20px auto;
            position: relative;
            border-radius: 50%;
            background: conic-gradient(
                #ef4444 0deg 30deg,
                #f59e0b 30deg 90deg,
                #10b981 90deg 180deg,
                #3b82f6 180deg 270deg,
                #8b5cf6 270deg 360deg
            );
            animation: spin 20s linear infinite paused;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .disk-visual.spinning {
            animation-play-state: running;
        }

        .library-connection {
            stroke: var(--primary-color);
            stroke-width: 3;
            fill: none;
            stroke-dasharray: 5, 5;
            animation: dash 1s linear infinite;
        }

        @keyframes dash {
            to { stroke-dashoffset: -10; }
        }

        .feedback-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
            z-index: 999;
            font-size: 20px;
        }

        .feedback-button:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .feedback-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1001;
            align-items: center;
            justify-content: center;
        }

        .feedback-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .nav-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
        }

        .accessibility-controls {
            position: fixed;
            top: 20px;
            left: 20px;
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 998;
        }

        .high-contrast {
            background: black !important;
            color: white !important;
        }

        .high-contrast * {
            background: black !important;
            color: white !important;
            border-color: white !important;
        }

        .canvas-container {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            margin: 20px 0;
            background: white;
            position: relative;
        }

        #drawingCanvas {
            cursor: crosshair;
            touch-action: none;
        }

        .shame-message {
            background: #fee2e2;
            border: 2px solid var(--danger-color);
            color: var(--danger-color);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
            display: none;
        }

        .hint-box {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: var(--light-bg);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--secondary-color), #0891b2);
            width: 0%;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .code-block {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 15px 0;
            overflow-x: auto;
        }

        .code-highlight {
            color: #fbbf24;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .nav-bar {
                position: relative;
                top: 0;
            }
            
            .stats-bar {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .xp-bar {
                width: 100%;
            }
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        .particle {
            position: fixed;
            pointer-events: none;
            opacity: 0;
            animation: particle-float 2s ease-out forwards;
        }

        @keyframes particle-float {
            0% {
                opacity: 1;
                transform: translateY(0) scale(0);
            }
            50% {
                opacity: 1;
                transform: translateY(-100px) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-200px) scale(0.5);
            }
        }
    </style>
</head>
<body>
    <div class="accessibility-controls">
        <button onclick="toggleHighContrast()" class="button" style="font-size: 12px; padding: 5px 10px;">High Contrast</button>
        <button onclick="changeFontSize(1)" class="button" style="font-size: 12px; padding: 5px 10px;">A+</button>
        <button onclick="changeFontSize(-1)" class="button" style="font-size: 12px; padding: 5px 10px;">A-</button>
    </div>

    <div class="container">
        <div class="header">
            <h1>Operating Systems - Part 2</h1>
            <p>Utility Software & Program Libraries</p>
        </div>

        <div class="stats-bar">
            <div class="stat-item">
                <span>Level: <strong id="level">0</strong>/5</span>
            </div>
            <div class="stat-item">
                <span>XP: <strong id="xp">0</strong></span>
                <div class="xp-bar">
                    <div class="xp-fill" id="xpFill"></div>
                </div>
            </div>
            <div class="stat-item">
                <span>Achievements: <strong id="achievements">0</strong></span>
            </div>
        </div>

        <div class="nav-bar" role="navigation" aria-label="Section navigation">
            <button class="nav-btn active" onclick="showSection(0)" aria-label="Go to Learning Outcomes">Learning Outcomes</button>
            <button class="nav-btn" onclick="showSection(1)" aria-label="Go to Starter Activity">Starter Activity</button>
            <button class="nav-btn" onclick="showSection(2)" aria-label="Go to Utility Software">Utility Software</button>
            <button class="nav-btn" onclick="showSection(3)" aria-label="Go to Disk Formatter">Disk Formatter</button>
            <button class="nav-btn" onclick="showSection(4)" aria-label="Go to Virus Checker">Virus Checker</button>
            <button class="nav-btn" onclick="showSection(5)" aria-label="Go to Defragmentation">Defragmentation</button>
            <button class="nav-btn" onclick="showSection(6)" aria-label="Go to Disk Analysis">Disk Analysis</button>
            <button class="nav-btn" onclick="showSection(7)" aria-label="Go to File Compression">File Compression</button>
            <button class="nav-btn" onclick="showSection(8)" aria-label="Go to Backup Software">Backup Software</button>
            <button class="nav-btn" onclick="showSection(9)" aria-label="Go to Program Libraries">Program Libraries</button>
            <button class="nav-btn" onclick="showSection(10)" aria-label="Go to DLL Files">DLL Files</button>
            <button class="nav-btn" onclick="showSection(11)" aria-label="Go to Real World">Real World</button>
            <button class="nav-btn" onclick="showSection(12)" aria-label="Go to Exam Practice">Exam Practice</button>
            <button class="nav-btn" onclick="showSection(13)" aria-label="Go to Summary">Summary</button>
        </div>

        <!-- Section 0: Learning Outcomes -->
        <div class="section active" id="section0">
            <div class="learning-outcomes">
                <h2>üéØ Learning Outcomes</h2>
                <p>By the end of this lesson, you will be able to:</p>
                <ul>
                    <li>Explain the need for typical utility software provided with an Operating System</li>
                    <li>Understand disk formatting and its purpose</li>
                    <li>Describe how virus checkers protect computer systems</li>
                    <li>Explain defragmentation and its benefits</li>
                    <li>Understand disk analysis and repair tools</li>
                    <li>Describe file compression techniques and benefits</li>
                    <li>Explain the importance of backup software</li>
                    <li>Understand program libraries and their benefits to developers</li>
                    <li>Explain Dynamic Link Library (DLL) files and their advantages</li>
                </ul>
            </div>
            <div class="nav-controls">
                <button class="button secondary" disabled>Previous</button>
                <button class="button" onclick="nextSection()">Start Lesson ‚Üí</button>
            </div>
        </div>

        <!-- Section 1: Starter Activity -->
        <div class="section" id="section1">
            <h2>üöÄ Starter Activity: Utility Software Detective</h2>
            <p>Look at these computer problems. Match each problem with the utility software that would solve it!</p>
            
            <div class="task-card">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h3>Problems</h3>
                        <div class="drag-item" onclick="selectProblem(this, 'virus')">
                            Computer running slowly, suspicious pop-ups appearing
                        </div>
                        <div class="drag-item" onclick="selectProblem(this, 'defrag')">
                            Files taking longer to open, hard drive making excessive noise
                        </div>
                        <div class="drag-item" onclick="selectProblem(this, 'backup')">
                            Important files accidentally deleted, need to recover them
                        </div>
                        <div class="drag-item" onclick="selectProblem(this, 'compress')">
                            Running out of storage space for photos and videos
                        </div>
                        <div class="drag-item" onclick="selectProblem(this, 'format')">
                            New hard drive needs to be prepared for use
                        </div>
                        <div class="drag-item" onclick="selectProblem(this, 'repair')">
                            Error messages when trying to save files
                        </div>
                    </div>
                    <div>
                        <h3>Solutions</h3>
                        <div class="drop-zone" data-solution="virus">Virus Checker</div>
                        <div class="drop-zone" data-solution="defrag">Defragmentation Tool</div>
                        <div class="drop-zone" data-solution="backup">Backup Software</div>
                        <div class="drop-zone" data-solution="compress">File Compression</div>
                        <div class="drop-zone" data-solution="format">Disk Formatter</div>
                        <div class="drop-zone" data-solution="repair">Disk Repair Tool</div>
                    </div>
                </div>
                
                <div style="margin-top: 20px;">
                    <button class="button" onclick="checkStarter()">Check Answers</button>
                    <button class="button secondary" onclick="resetStarter()">Reset</button>
                    <button class="button secondary" onclick="showHint('starter')">Hint (-5 XP)</button>
                </div>
                
                <div id="starterFeedback" style="margin-top: 20px;"></div>
                <div id="starterHint" class="hint-box">
                    <strong>Hint:</strong> Think about what each utility does - virus checkers find malware, defragmentation reorganizes files, backup saves copies, etc.
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 2: Introduction to Utility Software -->
        <div class="section" id="section2">
            <h2>üõ†Ô∏è What is Utility Software?</h2>
            
            <div class="task-card">
                <h3>Understanding Utility Software</h3>
                <p>Utility software are small programs that help maintain and optimize your computer system. They work alongside the OS to keep everything running smoothly.</p>
                
                <div style="margin: 20px 0;">
                    <h4>Key Points:</h4>
                    <ul>
                        <li>Provided with the Operating System</li>
                        <li>Perform specific maintenance tasks</li>
                        <li>Help optimize system performance</li>
                        <li>Protect against threats</li>
                        <li>Manage storage efficiently</li>
                    </ul>
                </div>
            </div>

            <div class="task-card">
                <h3>Interactive Utility Dashboard</h3>
                <p>Click on each utility to see what it does:</p>
                
                <div class="simulation-container">
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                        <div class="utility-box" onclick="showUtilityInfo('formatter')">
                            <h4>üíæ Disk Formatter</h4>
                        </div>
                        <div class="utility-box" onclick="showUtilityInfo('virus')">
                            <h4>üõ°Ô∏è Virus Checker</h4>
                        </div>
                        <div class="utility-box" onclick="showUtilityInfo('defrag')">
                            <h4>üìä Defragmentation</h4>
                        </div>
                        <div class="utility-box" onclick="showUtilityInfo('repair')">
                            <h4>üîß Disk Repair</h4>
                        </div>
                        <div class="utility-box" onclick="showUtilityInfo('compress')">
                            <h4>üóúÔ∏è File Compression</h4>
                        </div>
                        <div class="utility-box" onclick="showUtilityInfo('backup')">
                            <h4>üíæ Backup Software</h4>
                        </div>
                    </div>
                    
                    <div id="utilityInfo" style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 8px; min-height: 100px;">
                        <p style="color: #94a3b8;">Click a utility to learn more about it...</p>
                    </div>
                </div>
            </div>

            <div class="task-card">
                <h3>Quick Check</h3>
                <p>Which of these statements about utility software is TRUE?</p>
                <div>
                    <label class="quiz-option" onclick="selectQuizOption(this, 'util1')">
                        <input type="radio" name="utilQ" value="a" style="display: none;">
                        Utility software replaces the Operating System
                    </label>
                    <label class="quiz-option" onclick="selectQuizOption(this, 'util1')">
                        <input type="radio" name="utilQ" value="b" style="display: none;">
                        Utility software performs maintenance and optimization tasks
                    </label>
                    <label class="quiz-option" onclick="selectQuizOption(this, 'util1')">
                        <input type="radio" name="utilQ" value="c" style="display: none;">
                        Utility software is only for gaming
                    </label>
                    <label class="quiz-option" onclick="selectQuizOption(this, 'util1')">
                        <input type="radio" name="utilQ" value="d" style="display: none;">
                        Utility software must be purchased separately
                    </label>
                </div>
                <button class="button" onclick="checkUtilityQuiz()">Check Answer</button>
                <div id="utilityQuizFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 3: Disk Formatter -->
        <div class="section" id="section3">
            <h2>üíæ Disk Formatter</h2>
            
            <div class="task-card">
                <h3>What is Disk Formatting?</h3>
                <p>Disk formatting prepares a storage device for use by creating a file system structure.</p>
                
                <div class="simulation-container">
                    <h4>Disk Formatting Simulator</h4>
                    <p>Click "Format Disk" to see the formatting process:</p>
                    
                    <div id="diskVisual" class="disk-visual"></div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="button" onclick="startFormatting()">Format Disk</button>
                        <button class="button secondary" onclick="resetDisk()">Reset</button>
                    </div>
                    
                    <div id="formatProgress" style="margin-top: 20px;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="formatFill">0%</div>
                        </div>
                        <p id="formatStatus" style="text-align: center; color: #e2e8f0;">Ready to format...</p>
                    </div>
                </div>
            </div>

            <div class="task-card">
                <h3>Formatting Types</h3>
                <p>Match the formatting type with its description:</p>
                
                <div style="margin: 20px 0;">
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <strong>Quick Format:</strong>
                        <select id="format1">
                            <option value="">Select description...</option>
                            <option value="quick">Only removes file table, faster but less thorough</option>
                            <option value="full">Checks for bad sectors, slower but more thorough</option>
                            <option value="low">Overwrites all data multiple times</option>
                        </select>
                    </div>
                    
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <strong>Full Format:</strong>
                        <select id="format2">
                            <option value="">Select description...</option>
                            <option value="quick">Only removes file table, faster but less thorough</option>
                            <option value="full">Checks for bad sectors, slower but more thorough</option>
                            <option value="low">Overwrites all data multiple times</option>
                        </select>
                    </div>
                    
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px;">
                        <strong>Low-Level Format:</strong>
                        <select id="format3">
                            <option value="">Select description...</option>
                            <option value="quick">Only removes file table, faster but less thorough</option>
                            <option value="full">Checks for bad sectors, slower but more thorough</option>
                            <option value="low">Overwrites all data multiple times</option>
                        </select>
                    </div>
                </div>
                
                <button class="button" onclick="checkFormatTypes()">Check Answers</button>
                <div id="formatTypesFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>When to Format?</h3>
                <p>Select all scenarios where disk formatting would be appropriate:</p>
                <div style="margin: 20px 0;">
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="formatWhen1"> Preparing a new hard drive for first use
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="formatWhen2"> Removing all data before selling a computer
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="formatWhen3"> Backing up important files
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="formatWhen4"> Changing file system (e.g., FAT32 to NTFS)
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="formatWhen5"> Playing video games
                    </label>
                </div>
                <button class="button" onclick="checkFormatWhen()">Check Answers</button>
                <div id="formatWhenFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 4: Virus Checker -->
        <div class="section" id="section4">
            <h2>üõ°Ô∏è Virus Checker</h2>
            
            <div class="task-card">
                <h3>Virus Detection Simulator</h3>
                <p>Run a virus scan to see how antivirus software protects your system:</p>
                
                <div class="simulation-container">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>System Files</h4>
                            <div id="fileList" style="max-height: 300px; overflow-y: auto;">
                                <!-- Files will be added here -->
                            </div>
                        </div>
                        <div>
                            <h4>Scan Results</h4>
                            <div id="scanResults" style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; min-height: 300px;">
                                <p style="color: #94a3b8;">Click "Start Scan" to begin...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="button" onclick="startVirusScan()">Start Scan</button>
                        <button class="button danger" onclick="quarantineThreats()">Quarantine Threats</button>
                        <button class="button secondary" onclick="resetVirusScan()">Reset</button>
                    </div>
                    
                    <div class="progress-bar" style="margin-top: 20px;">
                        <div class="progress-fill" id="scanProgress">0%</div>
                    </div>
                </div>
            </div>

            <div class="task-card">
                <h3>Virus Protection Methods</h3>
                <p>Complete these sentences about how virus checkers work:</p>
                
                <div style="display: flex; flex-wrap: wrap; gap: 10px; margin: 20px 0;">
                    <span class="drag-item" onclick="selectWord(this, 'signatures')">signatures</span>
                    <span class="drag-item" onclick="selectWord(this, 'behavior')">behavior</span>
                    <span class="drag-item" onclick="selectWord(this, 'quarantine')">quarantine</span>
                    <span class="drag-item" onclick="selectWord(this, 'real-time')">real-time</span>
                    <span class="drag-item" onclick="selectWord(this, 'updates')">updates</span>
                    <span class="drag-item" onclick="selectWord(this, 'games')">games</span>
                    <span class="drag-item" onclick="selectWord(this, 'music')">music</span>
                    <span class="drag-item" onclick="selectWord(this, 'movies')">movies</span>
                </div>
                
                <div style="font-size: 18px; line-height: 2;">
                    <p>1. Virus checkers use <input type="text" id="virusBlank1" style="width: 150px; display: inline-block;"> to identify known malware.</p>
                    <p>2. Modern antivirus includes <input type="text" id="virusBlank2" style="width: 150px; display: inline-block;"> protection to scan files as they're accessed.</p>
                    <p>3. Suspicious files are placed in <input type="text" id="virusBlank3" style="width: 150px; display: inline-block;"> to prevent them from causing harm.</p>
                    <p>4. Regular <input type="text" id="virusBlank4" style="width: 150px; display: inline-block;"> are essential to protect against new threats.</p>
                </div>
                
                <button class="button" onclick="checkVirusBlanks()">Check Answers</button>
                <div id="virusBlanksFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>Types of Malware</h3>
                <p>Match each type of malware with its description:</p>
                
                <table style="width: 100%; margin: 20px 0;">
                    <tr>
                        <th>Malware Type</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>Virus</td>
                        <td><select id="malware1">
                            <option value="">Select...</option>
                            <option value="virus">Attaches to files and spreads when executed</option>
                            <option value="worm">Self-replicates across networks without user action</option>
                            <option value="trojan">Disguises as legitimate software</option>
                            <option value="spyware">Secretly monitors user activity</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td>Worm</td>
                        <td><select id="malware2">
                            <option value="">Select...</option>
                            <option value="virus">Attaches to files and spreads when executed</option>
                            <option value="worm">Self-replicates across networks without user action</option>
                            <option value="trojan">Disguises as legitimate software</option>
                            <option value="spyware">Secretly monitors user activity</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td>Trojan</td>
                        <td><select id="malware3">
                            <option value="">Select...</option>
                            <option value="virus">Attaches to files and spreads when executed</option>
                            <option value="worm">Self-replicates across networks without user action</option>
                            <option value="trojan">Disguises as legitimate software</option>
                            <option value="spyware">Secretly monitors user activity</option>
                        </select></td>
                    </tr>
                    <tr>
                        <td>Spyware</td>
                        <td><select id="malware4">
                            <option value="">Select...</option>
                            <option value="virus">Attaches to files and spreads when executed</option>
                            <option value="worm">Self-replicates across networks without user action</option>
                            <option value="trojan">Disguises as legitimate software</option>
                            <option value="spyware">Secretly monitors user activity</option>
                        </select></td>
                    </tr>
                </table>
                
                <button class="button" onclick="checkMalwareTypes()">Check Answers</button>
                <div id="malwareTypesFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 5: Defragmentation -->
        <div class="section" id="section5">
            <h2>üìä Defragmentation Software</h2>
            
            <div class="task-card">
                <h3>Understanding Fragmentation</h3>
                <p>When files are saved, edited, and deleted, they can become fragmented - split into pieces across the disk. This makes access slower.</p>
                
                <div class="simulation-container">
                    <h4>Disk Fragmentation Visualizer</h4>
                    <p>Watch how files become fragmented and then defragmented:</p>
                    
                    <div id="diskGrid" style="display: grid; grid-template-columns: repeat(10, 1fr); gap: 2px; margin: 20px auto; max-width: 500px;">
                        <!-- Disk blocks will be added here -->
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="button" onclick="addFragmentedFile()">Add File</button>
                        <button class="button" onclick="deleteRandomFile()">Delete File</button>
                        <button class="button secondary" onclick="runDefrag()">Defragment</button>
                        <button class="button secondary" onclick="resetDefrag()">Reset</button>
                    </div>
                    
                    <div style="margin-top: 20px; display: flex; justify-content: center; gap: 20px;">
                        <div><span style="display: inline-block; width: 20px; height: 20px; background: #3b82f6;"></span> File A</div>
                        <div><span style="display: inline-block; width: 20px; height: 20px; background: #ef4444;"></span> File B</div>
                        <div><span style="display: inline-block; width: 20px; height: 20px; background: #10b981;"></span> File C</div>
                        <div><span style="display: inline-block; width: 20px; height: 20px; background: #f59e0b;"></span> File D</div>
                        <div><span style="display: inline-block; width: 20px; height: 20px; background: #64748b;"></span> Empty</div>
                    </div>
                    
                    <p id="fragStatus" style="text-align: center; margin-top: 10px; color: #e2e8f0;">Fragmentation Level: 0%</p>
                </div>
            </div>

            <div class="task-card">
                <h3>Benefits of Defragmentation</h3>
                <p>Select all the TRUE statements about defragmentation:</p>
                
                <div style="margin: 20px 0;">
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="defragBenefit1"> Improves file access speed
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="defragBenefit2"> Reduces hard drive wear
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="defragBenefit3"> Increases available storage space
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="defragBenefit4"> Organizes related file parts together
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="defragBenefit5"> Protects against viruses
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="defragBenefit6"> Can improve system boot time
                    </label>
                </div>
                
                <button class="button" onclick="checkDefragBenefits()">Check Answers</button>
                <div id="defragBenefitsFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>SSD vs HDD Defragmentation</h3>
                <p>Answer this question about modern storage:</p>
                <p><strong>Why should you NOT defragment an SSD (Solid State Drive)?</strong></p>
                <textarea id="ssdAnswer" rows="3" placeholder="Explain why SSDs don't need defragmentation..."></textarea>
                <button class="button" onclick="checkSSDAnswer()">Submit Answer</button>
                <div id="ssdFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 6: Disk Analysis & Repair -->
        <div class="section" id="section6">
            <h2>üîß Disk Contents Analysis & Repair Software</h2>
            
            <div class="task-card">
                <h3>Disk Analysis Tool</h3>
                <p>Analyze disk usage and identify problems:</p>
                
                <div class="simulation-container">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>Disk Usage Analysis</h4>
                            <canvas id="diskChart" width="300" height="300"></canvas>
                        </div>
                        <div>
                            <h4>Analysis Results</h4>
                            <div id="analysisResults" style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px;">
                                <p>Documents: <span id="docsSize">2.3 GB</span></p>
                                <p>Media: <span id="mediaSize">15.7 GB</span></p>
                                <p>Programs: <span id="programsSize">8.2 GB</span></p>
                                <p>System: <span id="systemSize">12.1 GB</span></p>
                                <p>Other: <span id="otherSize">4.5 GB</span></p>
                                <hr style="margin: 10px 0; border-color: rgba(255,255,255,0.2);">
                                <p><strong>Issues Found:</strong></p>
                                <p id="issuesFound" style="color: #f59e0b;">Click "Analyze" to scan...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="button" onclick="analyzeDisk()">Analyze Disk</button>
                        <button class="button danger" onclick="repairErrors()">Repair Errors</button>
                        <button class="button secondary" onclick="resetAnalysis()">Reset</button>
                    </div>
                </div>
            </div>

            <div class="task-card">
                <h3>Common Disk Errors</h3>
                <p>Match each error type with its solution:</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <div class="drag-item" onclick="selectError(this, 'bad-sectors')">Bad Sectors</div>
                        <div class="drag-item" onclick="selectError(this, 'file-system')">File System Errors</div>
                        <div class="drag-item" onclick="selectError(this, 'lost-clusters')">Lost Clusters</div>
                        <div class="drag-item" onclick="selectError(this, 'cross-linked')">Cross-linked Files</div>
                    </div>
                    <div>
                        <div class="drop-zone" data-error="bad-sectors">Mark damaged areas as unusable</div>
                        <div class="drop-zone" data-error="file-system">Run file system check and repair</div>
                        <div class="drop-zone" data-error="lost-clusters">Recover or delete orphaned data</div>
                        <div class="drop-zone" data-error="cross-linked">Separate files sharing same space</div>
                    </div>
                </div>
                
                <button class="button" onclick="checkErrorMatching()">Check Matches</button>
                <button class="button secondary" onclick="resetErrorMatching()">Reset</button>
                <div id="errorMatchingFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>Disk Maintenance Schedule</h3>
                <p>How often should these maintenance tasks be performed?</p>
                
                <div style="margin: 20px 0;">
                    <div style="margin-bottom: 15px;">
                        <strong>Disk Analysis:</strong>
                        <select id="schedule1">
                            <option value="">Select frequency...</option>
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>Error Checking:</strong>
                        <select id="schedule2">
                            <option value="">Select frequency...</option>
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>Full System Backup:</strong>
                        <select id="schedule3">
                            <option value="">Select frequency...</option>
                            <option value="daily">Daily</option>
                            <option value="weekly">Weekly</option>
                            <option value="monthly">Monthly</option>
                            <option value="yearly">Yearly</option>
                        </select>
                    </div>
                </div>
                
                <button class="button" onclick="checkSchedule()">Check Answers</button>
                <div id="scheduleFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 7: File Compression -->
        <div class="section" id="section7">
            <h2>üóúÔ∏è File Compression</h2>
            
            <div class="task-card">
                <h3>Compression Simulator</h3>
                <p>See how file compression reduces file sizes:</p>
                
                <div class="simulation-container">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div>
                            <h4>Original Files</h4>
                            <div id="originalFiles">
                                <div class="file-item" data-size="1024">
                                    <span>üìÑ Document.txt</span>
                                    <span>1024 KB</span>
                                </div>
                                <div class="file-item" data-size="5120">
                                    <span>üñºÔ∏è Photo.jpg</span>
                                    <span>5 MB</span>
                                </div>
                                <div class="file-item" data-size="2048">
                                    <span>üìä Spreadsheet.xlsx</span>
                                    <span>2 MB</span>
                                </div>
                                <div class="file-item" data-size="10240">
                                    <span>üé• Video.mp4</span>
                                    <span>10 MB</span>
                                </div>
                            </div>
                        </div>
                        <div>
                            <h4>Compressed Files</h4>
                            <div id="compressedFiles" style="min-height: 200px;">
                                <p style="color: #94a3b8;">Select files and click "Compress"...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="button" onclick="compressFiles()">Compress Selected</button>
                        <button class="button secondary" onclick="resetCompression()">Reset</button>
                    </div>
                    
                    <div style="margin-top: 20px; text-align: center;">
                        <p>Total Size Saved: <span id="sizeSaved" style="font-weight: bold; color: #10b981;">0 KB</span></p>
                        <p>Compression Ratio: <span id="compressionRatio" style="font-weight: bold; color: #06b6d4;">0%</span></p>
                    </div>
                </div>
                
                <style>
                    .file-item {
                        display: flex;
                        justify-content: space-between;
                        padding: 10px;
                        margin: 5px 0;
                        background: rgba(255,255,255,0.05);
                        border-radius: 5px;
                        cursor: pointer;
                        transition: all 0.3s;
                    }
                    .file-item:hover {
                        background: rgba(255,255,255,0.1);
                    }
                    .file-item.selected {
                        background: rgba(6, 182, 212, 0.2);
                        border: 2px solid #06b6d4;
                    }
                </style>
            </div>

            <div class="task-card">
                <h3>Compression Types</h3>
                <p>Identify whether each statement describes Lossless or Lossy compression:</p>
                
                <div style="margin: 20px 0;">
                    <div style="margin-bottom: 15px; padding: 15px; background: var(--light-bg); border-radius: 8px;">
                        <p>Perfect reconstruction of original data</p>
                        <label class="quiz-option" onclick="selectQuizOption(this, 'comp1')">
                            <input type="radio" name="compQ1" value="lossless" style="display: none;"> Lossless
                        </label>
                        <label class="quiz-option" onclick="selectQuizOption(this, 'comp1')">
                            <input type="radio" name="compQ1" value="lossy" style="display: none;"> Lossy
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 15px; padding: 15px; background: var(--light-bg); border-radius: 8px;">
                        <p>Used for JPEG images and MP3 audio</p>
                        <label class="quiz-option" onclick="selectQuizOption(this, 'comp2')">
                            <input type="radio" name="compQ2" value="lossless" style="display: none;"> Lossless
                        </label>
                        <label class="quiz-option" onclick="selectQuizOption(this, 'comp2')">
                            <input type="radio" name="compQ2" value="lossy" style="display: none;"> Lossy
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 15px; padding: 15px; background: var(--light-bg); border-radius: 8px;">
                        <p>ZIP files use this type of compression</p>
                        <label class="quiz-option" onclick="selectQuizOption(this, 'comp3')">
                            <input type="radio" name="compQ3" value="lossless" style="display: none;"> Lossless
                        </label>
                        <label class="quiz-option" onclick="selectQuizOption(this, 'comp3')">
                            <input type="radio" name="compQ3" value="lossy" style="display: none;"> Lossy
                        </label>
                    </div>
                </div>
                
                <button class="button" onclick="checkCompressionTypes()">Check Answers</button>
                <div id="compressionTypesFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>Benefits of Compression</h3>
                <p>List three benefits of using file compression:</p>
                <textarea id="compressionBenefits" rows="4" placeholder="1. \n2. \n3. "></textarea>
                <button class="button" onclick="checkCompressionBenefits()">Submit Answer</button>
                <div id="compressionBenefitsFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 8: Backup Software -->
        <div class="section" id="section8">
            <h2>üíæ Backup Software</h2>
            
            <div class="task-card">
                <h3>Backup Strategy Planner</h3>
                <p>Create a backup plan by selecting appropriate options:</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <h4>What to Backup?</h4>
                        <label style="display: block; margin: 10px 0;">
                            <input type="checkbox" id="backup1"> Documents
                        </label>
                        <label style="display: block; margin: 10px 0;">
                            <input type="checkbox" id="backup2"> Photos & Videos
                        </label>
                        <label style="display: block; margin: 10px 0;">
                            <input type="checkbox" id="backup3"> System Settings
                        </label>
                        <label style="display: block; margin: 10px 0;">
                            <input type="checkbox" id="backup4"> Installed Programs
                        </label>
                        <label style="display: block; margin: 10px 0;">
                            <input type="checkbox" id="backup5"> Browser Bookmarks
                        </label>
                    </div>
                    <div>
                        <h4>Backup Type</h4>
                        <label class="quiz-option" onclick="selectQuizOption(this, 'backupType')">
                            <input type="radio" name="backupType" value="full" style="display: none;">
                            Full Backup (All selected files)
                        </label>
                        <label class="quiz-option" onclick="selectQuizOption(this, 'backupType')">
                            <input type="radio" name="backupType" value="incremental" style="display: none;">
                            Incremental (Only changes since last backup)
                        </label>
                        <label class="quiz-option" onclick="selectQuizOption(this, 'backupType')">
                            <input type="radio" name="backupType" value="differential" style="display: none;">
                            Differential (Changes since last full backup)
                        </label>
                    </div>
                </div>
                
                <div style="text-align: center;">
                    <button class="button" onclick="createBackupPlan()">Create Backup Plan</button>
                </div>
                
                <div id="backupPlanResult" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>3-2-1 Backup Rule</h3>
                <p>The 3-2-1 rule is a best practice for data protection. Fill in what each number represents:</p>
                
                <div style="margin: 20px 0;">
                    <div style="margin-bottom: 15px;">
                        <strong>3:</strong> <input type="text" id="rule3" style="width: 300px;" placeholder="What does 3 represent?">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>2:</strong> <input type="text" id="rule2" style="width: 300px;" placeholder="What does 2 represent?">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>1:</strong> <input type="text" id="rule1" style="width: 300px;" placeholder="What does 1 represent?">
                    </div>
                </div>
                
                <button class="button" onclick="check321Rule()">Check Answers</button>
                <button class="button secondary" onclick="showHint('backup321')">Hint (-5 XP)</button>
                <div id="rule321Feedback" style="margin-top: 20px;"></div>
                <div id="backup321Hint" class="hint-box">
                    <strong>Hint:</strong> Think about copies, storage types, and locations...
                </div>
            </div>

            <div class="task-card">
                <h3>Backup Scenarios</h3>
                <p>Which backup solution would be best for each scenario?</p>
                
                <div style="margin: 20px 0;">
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <p><strong>Small business with critical customer data:</strong></p>
                        <select id="scenario1">
                            <option value="">Select best option...</option>
                            <option value="usb">USB drive backup weekly</option>
                            <option value="cloud">Cloud backup with encryption</option>
                            <option value="cd">Burn to CD monthly</option>
                        </select>
                    </div>
                    
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <p><strong>Student with assignments and projects:</strong></p>
                        <select id="scenario2">
                            <option value="">Select best option...</option>
                            <option value="external">External hard drive</option>
                            <option value="cloud-sync">Cloud sync service</option>
                            <option value="email">Email to self</option>
                        </select>
                    </div>
                    
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px;">
                        <p><strong>Photographer with large RAW image files:</strong></p>
                        <select id="scenario3">
                            <option value="">Select best option...</option>
                            <option value="raid">RAID array with redundancy</option>
                            <option value="floppy">Floppy disks</option>
                            <option value="print">Print all photos</option>
                        </select>
                    </div>
                </div>
                
                <button class="button" onclick="checkBackupScenarios()">Check Answers</button>
                <div id="backupScenariosFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 9: Program Libraries -->
        <div class="section" id="section9">
            <h2>üìö Program Libraries</h2>
            
            <div class="task-card">
                <h3>What are Program Libraries?</h3>
                <p>Program libraries are collections of pre-written code that developers can use in their applications.</p>
                
                <div class="simulation-container">
                    <h4>Library Usage Visualizer</h4>
                    <p>Click on libraries to see how they connect to applications:</p>
                    
                    <svg width="100%" height="400" viewBox="0 0 800 400">
                        <!-- Libraries -->
                        <g id="libraries">
                            <rect x="50" y="50" width="150" height="80" fill="#7c3aed" rx="10" onclick="showLibraryInfo('math')" style="cursor: pointer;">
                                <title>Math Library</title>
                            </rect>
                            <text x="125" y="95" text-anchor="middle" fill="white" style="pointer-events: none;">Math Library</text>
                            
                            <rect x="50" y="150" width="150" height="80" fill="#7c3aed" rx="10" onclick="showLibraryInfo('graphics')" style="cursor: pointer;">
                                <title>Graphics Library</title>
                            </rect>
                            <text x="125" y="195" text-anchor="middle" fill="white" style="pointer-events: none;">Graphics Library</text>
                            
                            <rect x="50" y="250" width="150" height="80" fill="#7c3aed" rx="10" onclick="showLibraryInfo('network')" style="cursor: pointer;">
                                <title>Network Library</title>
                            </rect>
                            <text x="125" y="295" text-anchor="middle" fill="white" style="pointer-events: none;">Network Library</text>
                        </g>
                        
                        <!-- Applications -->
                        <g id="applications">
                            <rect x="600" y="50" width="150" height="80" fill="#06b6d4" rx="10">
                                <title>Calculator App</title>
                            </rect>
                            <text x="675" y="95" text-anchor="middle" fill="white">Calculator App</text>
                            
                            <rect x="600" y="150" width="150" height="80" fill="#06b6d4" rx="10">
                                <title>Photo Editor</title>
                            </rect>
                            <text x="675" y="195" text-anchor="middle" fill="white">Photo Editor</text>
                            
                            <rect x="600" y="250" width="150" height="80" fill="#06b6d4" rx="10">
                                <title>Web Browser</title>
                            </rect>
                            <text x="675" y="295" text-anchor="middle" fill="white">Web Browser</text>
                        </g>
                        
                        <!-- Connections (will be shown on click) -->
                        <g id="connections" style="display: none;">
                            <path class="library-connection" d="M 200 90 L 600 90" />
                            <path class="library-connection" d="M 200 190 L 600 190" />
                            <path class="library-connection" d="M 200 290 L 600 290" />
                        </g>
                    </svg>
                    
                    <div id="libraryInfo" style="margin-top: 20px; padding: 20px; background: rgba(255,255,255,0.1); border-radius: 8px; min-height: 100px;">
                        <p style="color: #94a3b8;">Click on a library to see its functions and connections...</p>
                    </div>
                </div>
            </div>

            <div class="task-card">
                <h3>Benefits of Using Libraries</h3>
                <p>Categorize these statements as either benefits or drawbacks of using program libraries:</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                    <div>
                        <h4>Statements</h4>
                        <div class="drag-item" onclick="selectStatement(this, 'benefit')">
                            Saves development time
                        </div>
                        <div class="drag-item" onclick="selectStatement(this, 'drawback')">
                            May include unnecessary code
                        </div>
                        <div class="drag-item" onclick="selectStatement(this, 'benefit')">
                            Code is tested and reliable
                        </div>
                        <div class="drag-item" onclick="selectStatement(this, 'benefit')">
                            Reduces bugs in applications
                        </div>
                        <div class="drag-item" onclick="selectStatement(this, 'drawback')">
                            Dependency on external code
                        </div>
                        <div class="drag-item" onclick="selectStatement(this, 'benefit')">
                            Standard implementations
                        </div>
                    </div>
                    <div>
                        <div class="drop-zone" data-category="benefit">
                            <h4>Benefits</h4>
                            <div id="benefitsList"></div>
                        </div>
                        <div class="drop-zone" data-category="drawback">
                            <h4>Drawbacks</h4>
                            <div id="drawbacksList"></div>
                        </div>
                    </div>
                </div>
                
                <button class="button" onclick="checkLibraryCategories()">Check Answers</button>
                <button class="button secondary" onclick="resetLibraryCategories()">Reset</button>
                <div id="libraryCategoriesFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>Code Example</h3>
                <p>Compare developing with and without libraries:</p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <div>
                        <h4>Without Library</h4>
                        <div class="code-block">
                            <pre>// Calculate square root manually
function sqrt(n) {
    let x = n;
    let y = 1;
    let e = 0.000001;
    while(x - y > e) {
        x = (x + y) / 2;
        y = n / x;
    }
    return x;
}

result = sqrt(25);</pre>
                        </div>
                    </div>
                    <div>
                        <h4>With Library</h4>
                        <div class="code-block">
                            <pre>// Using Math library
<span class="code-highlight">import math</span>

result = <span class="code-highlight">math.sqrt(25)</span></pre>
                        </div>
                    </div>
                </div>
                
                <p style="margin-top: 20px;"><strong>Question:</strong> Which approach is better for most applications and why?</p>
                <textarea id="libraryComparison" rows="3" placeholder="Explain your answer..."></textarea>
                <button class="button" onclick="checkLibraryComparison()">Submit Answer</button>
                <div id="libraryComparisonFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 10: DLL Files -->
        <div class="section" id="section10">
            <h2>üîó Dynamic Link Library (DLL) Files</h2>
            
            <div class="task-card">
                <h3>Understanding DLLs</h3>
                <p>Dynamic Link Libraries are shared libraries that multiple programs can use simultaneously.</p>
                
                <div class="simulation-container">
                    <h4>DLL Sharing Demonstration</h4>
                    <p>See how multiple programs share the same DLL file:</p>
                    
                    <div id="dllDemo" style="position: relative; height: 400px;">
                        <!-- Central DLL -->
                        <div style="position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); width: 120px; height: 120px; background: #7c3aed; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; box-shadow: 0 0 20px rgba(124, 58, 237, 0.5);">
                            user32.dll
                        </div>
                        
                        <!-- Programs around the DLL -->
                        <div class="program-node" style="position: absolute; left: 20%; top: 20%;" onclick="showDLLConnection(1)">
                            Program A
                        </div>
                        <div class="program-node" style="position: absolute; right: 20%; top: 20%;" onclick="showDLLConnection(2)">
                            Program B
                        </div>
                        <div class="program-node" style="position: absolute; left: 20%; bottom: 20%;" onclick="showDLLConnection(3)">
                            Program C
                        </div>
                        <div class="program-node" style="position: absolute; right: 20%; bottom: 20%;" onclick="showDLLConnection(4)">
                            Program D
                        </div>
                    </div>
                    
                    <div id="dllStatus" style="text-align: center; margin-top: 20px; color: #e2e8f0;">
                        <p>Click on programs to see how they use the shared DLL</p>
                    </div>
                </div>
                
                <style>
                    .program-node {
                        width: 100px;
                        height: 60px;
                        background: #06b6d4;
                        border-radius: 10px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: white;
                        cursor: pointer;
                        transition: all 0.3s;
                    }
                    .program-node:hover {
                        transform: scale(1.1);
                        box-shadow: 0 5px 15px rgba(6, 182, 212, 0.5);
                    }
                    .program-node.active {
                        background: #0891b2;
                        box-shadow: 0 0 20px rgba(6, 182, 212, 0.8);
                    }
                </style>
            </div>

            <div class="task-card">
                <h3>DLL Advantages</h3>
                <p>Select all the advantages of using DLL files:</p>
                
                <div style="margin: 20px 0;">
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="dllAdv1"> Reduces memory usage by sharing code
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="dllAdv2"> Makes programs run slower
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="dllAdv3"> Enables modular programming
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="dllAdv4"> Updates can benefit multiple programs
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="dllAdv5"> Increases disk space usage
                    </label>
                    <label style="display: block; margin: 10px 0;">
                        <input type="checkbox" id="dllAdv6"> Promotes code reusability
                    </label>
                </div>
                
                <button class="button" onclick="checkDLLAdvantages()">Check Answers</button>
                <div id="dllAdvantagesFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>DLL Hell Problem</h3>
                <p>What is "DLL Hell" and how can it be avoided?</p>
                <textarea id="dllHellAnswer" rows="4" placeholder="Explain DLL Hell and its solutions..."></textarea>
                <button class="button" onclick="checkDLLHell()">Submit Answer</button>
                <div id="dllHellFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 11: Real World Context -->
        <div class="section" id="section11">
            <h2>üåç Real World Applications</h2>
            
            <div class="task-card">
                <h3>Utility Software in Action</h3>
                <p>Match real-world scenarios with the appropriate utility software:</p>
                
                <div style="margin: 20px 0;">
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <p><strong>Scenario:</strong> A company needs to archive 5 years of emails to save server space</p>
                        <select id="realWorld1">
                            <option value="">Select utility...</option>
                            <option value="compress">File Compression</option>
                            <option value="format">Disk Formatter</option>
                            <option value="defrag">Defragmentation</option>
                            <option value="virus">Virus Checker</option>
                        </select>
                    </div>
                    
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <p><strong>Scenario:</strong> A laptop is running slowly after years of use with files scattered across the drive</p>
                        <select id="realWorld2">
                            <option value="">Select utility...</option>
                            <option value="compress">File Compression</option>
                            <option value="format">Disk Formatter</option>
                            <option value="defrag">Defragmentation</option>
                            <option value="virus">Virus Checker</option>
                        </select>
                    </div>
                    
                    <div style="background: var(--light-bg); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                        <p><strong>Scenario:</strong> Suspicious emails have been opened and the computer is behaving strangely</p>
                        <select id="realWorld3">
                            <option value="">Select utility...</option>
                            <option value="compress">File Compression</option>
                            <option value="format">Disk Formatter</option>
                            <option value="defrag">Defragmentation</option>
                            <option value="virus">Virus Checker</option>
                        </select>
                    </div>
                </div>
                
                <button class="button" onclick="checkRealWorldScenarios()">Check Answers</button>
                <div id="realWorldScenariosFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>Common Mistakes to Avoid</h3>
                <p>True or False: Identify common misconceptions about utility software</p>
                
                <div style="margin: 20px 0;">
                    <div style="margin-bottom: 15px;">
                        <p>1. "You should defragment an SSD regularly for best performance"</p>
                        <label class="quiz-option" onclick="selectTF(this, 'mistake1', true)">
                            <input type="radio" name="mistakeTF1" value="true" style="display: none;"> True
                        </label>
                        <label class="quiz-option" onclick="selectTF(this, 'mistake1', false)">
                            <input type="radio" name="mistakeTF1" value="false" style="display: none;"> False
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <p>2. "Compression always reduces file quality"</p>
                        <label class="quiz-option" onclick="selectTF(this, 'mistake2', true)">
                            <input type="radio" name="mistakeTF2" value="true" style="display: none;"> True
                        </label>
                        <label class="quiz-option" onclick="selectTF(this, 'mistake2', false)">
                            <input type="radio" name="mistakeTF2" value="false" style="display: none;"> False
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <p>3. "DLL files should be deleted to save space"</p>
                        <label class="quiz-option" onclick="selectTF(this, 'mistake3', true)">
                            <input type="radio" name="mistakeTF3" value="true" style="display: none;"> True
                        </label>
                        <label class="quiz-option" onclick="selectTF(this, 'mistake3', false)">
                            <input type="radio" name="mistakeTF3" value="false" style="display: none;"> False
                        </label>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <p>4. "Virus checkers only need to run when you suspect a problem"</p>
                        <label class="quiz-option" onclick="selectTF(this, 'mistake4', true)">
                            <input type="radio" name="mistakeTF4" value="true" style="display: none;"> True
                        </label>
                        <label class="quiz-option" onclick="selectTF(this, 'mistake4', false)">
                            <input type="radio" name="mistakeTF4" value="false" style="display: none;"> False
                        </label>
                    </div>
                </div>
                
                <button class="button" onclick="checkMistakes()">Check Answers</button>
                <div id="mistakesFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>Extension: Modern Developments</h3>
                <p>Research and explain one modern development in utility software or program libraries (e.g., containerization, package managers, cloud-based utilities):</p>
                <textarea id="modernExtension" rows="4" placeholder="Describe a modern development..."></textarea>
                <button class="button" onclick="submitModernExtension()">Submit Extension</button>
                <div id="modernExtensionFeedback" style="margin-top: 20px;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 12: Exam Practice -->
        <div class="section" id="section12">
            <h2>üìù Practice Exam Questions</h2>
            
            <div class="task-card">
                <h3>Question 1 (3 marks)</h3>
                <p>Describe three different types of utility software provided with an Operating System.</p>
                <textarea id="examQ1" rows="6" placeholder="Write your answer here..."></textarea>
                <div style="margin-top: 10px;">
                    <label>Predicted marks: <input type="number" id="marks1" min="0" max="3" style="width: 60px;"></label>
                    <button class="button" onclick="checkExamQ1()">Show Mark Scheme</button>
                </div>
                <div id="examQ1Feedback" style="margin-top: 20px; display: none;"></div>
            </div>

            <div class="task-card">
                <h3>Question 2 (4 marks)</h3>
                <p>Explain the benefits to a developer of using program libraries when creating software.</p>
                <div class="canvas-container">
                    <canvas id="drawingCanvas" width="600" height="150"></canvas>
                    <button class="button secondary" onclick="clearCanvas()">Clear Canvas</button>
                </div>
                <textarea id="examQ2" rows="6" placeholder="Write your answer here..."></textarea>
                <div style="margin-top: 10px;">
                    <label>Predicted marks: <input type="number" id="marks2" min="0" max="4" style="width: 60px;"></label>
                    <button class="button" onclick="checkExamQ2()">Show Mark Scheme</button>
                </div>
                <div id="examQ2Feedback" style="margin-top: 20px; display: none;"></div>
            </div>

            <div class="task-card">
                <h3>Question 3 (2 marks)</h3>
                <p>What is a Dynamic Link Library (DLL) file and why are they used?</p>
                <textarea id="examQ3" rows="4" placeholder="Write your answer here..."></textarea>
                <div style="margin-top: 10px;">
                    <label>Predicted marks: <input type="number" id="marks3" min="0" max="2" style="width: 60px;"></label>
                    <button class="button" onclick="checkExamQ3()">Show Mark Scheme</button>
                </div>
                <div id="examQ3Feedback" style="margin-top: 20px; display: none;"></div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button" onclick="nextSection()">Next ‚Üí</button>
            </div>
        </div>

        <!-- Section 13: Summary -->
        <div class="section" id="section13">
            <h2>üìä Lesson Summary</h2>
            
            <div class="task-card">
                <h3>Key Takeaways</h3>
                <ul style="line-height: 2;">
                    <li>Utility software performs essential maintenance tasks to keep systems running efficiently</li>
                    <li>Disk formatters prepare storage devices with file systems</li>
                    <li>Virus checkers protect against malware using signatures and behavior analysis</li>
                    <li>Defragmentation reorganizes files for faster access (HDDs only)</li>
                    <li>Disk analysis tools identify and repair file system errors</li>
                    <li>File compression reduces storage requirements using lossless or lossy methods</li>
                    <li>Backup software protects data through regular copies</li>
                    <li>Program libraries save development time and reduce bugs</li>
                    <li>DLL files allow code sharing between multiple programs</li>
                </ul>
            </div>

            <div class="task-card">
                <h3>Final Assessment</h3>
                <p>Test your understanding with these summary questions:</p>
                
                <div id="summaryQuiz">
                    <!-- Questions will be dynamically loaded here -->
                </div>
                
                <button class="button" onclick="checkSummaryQuiz()">Submit Assessment</button>
                <button class="button secondary" onclick="resetSummaryQuiz()">Reset</button>
                <div id="summaryFeedback" style="margin-top: 20px;"></div>
            </div>

            <div class="task-card">
                <h3>Your Progress</h3>
                <div style="text-align: center; padding: 20px;">
                    <h4>Final Level: <span id="finalLevel">0</span>/5</h4>
                    <h4>Total XP Earned: <span id="finalXP">0</span></h4>
                    <h4>Achievements Unlocked: <span id="finalAchievements">0</span></h4>
                    <div id="achievementsList" style="margin-top: 20px;"></div>
                </div>
            </div>

            <div class="task-card">
                <h3>üìπ Additional Resources</h3>
                <p>Watch these videos to reinforce your learning:</p>
                <div style="background: var(--light-bg); padding: 20px; border-radius: 8px; text-align: center;">
                    <p style="color: var(--text-light);">Video content placeholder - Your teacher will provide links to relevant videos</p>
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="button secondary" onclick="previousSection()">‚Üê Previous</button>
                <button class="button secondary" disabled>Course Complete!</button>
            </div>
        </div>
    </div>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <h3>üèÜ Achievement Unlocked!</h3>
        <p id="achievementText"></p>
    </div>

    <!-- Feedback Modal -->
    <div class="feedback-modal" id="feedbackModal">
        <div class="feedback-content">
            <h3>Send Feedback</h3>
            <p>Found a bug or have a suggestion? Let us know!</p>
            <textarea id="feedbackText" rows="4" placeholder="Describe the issue or suggestion..."></textarea>
            <div style="margin-top: 20px;">
                <button class="button" onclick="sendFeedback()">Send</button>
                <button class="button secondary" onclick="closeFeedback()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Feedback Button -->
    <button class="feedback-button" onclick="openFeedback()" aria-label="Send Feedback">üí¨</button>

    <!-- Shame Message -->
    <div class="shame-message" id="shameMessage">
        üö´ Pasting is disabled! Type your own answers to learn properly! üö´
    </div>

    <script>
        // Global variables
        let currentSection = 0;
        let xp = 0;
        let level = 0;
        let achievements = [];
        let completedTasks = new Set();
        let selectedWord = null;
        let selectedProblem = null;
        let selectedError = null;
        let selectedStatement = null;
        let formatInterval = null;
        let scanInterval = null;
        let diskBlocks = [];
        let fragmentationLevel = 0;
        let selectedFiles = new Set();
        let currentConnections = [];

        // XP thresholds for levels
        const levelThresholds = [0, 100, 250, 450, 700, 1000];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeSummaryQuiz();
            initializeCanvas();
            initializeDiskGrid();
            initializeFiles();
            preventPasting();
        });

        // Navigation functions
        function showSection(index) {
            const sections = document.querySelectorAll('.section');
            const navBtns = document.querySelectorAll('.nav-btn');
            
            sections.forEach(s => s.classList.remove('active'));
            navBtns.forEach(b => b.classList.remove('active'));
            
            sections[index].classList.add('active');
            navBtns[index].classList.add('active');
            currentSection = index;
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function nextSection() {
            if (currentSection < 13) {
                showSection(currentSection + 1);
            }
        }

        function previousSection() {
            if (currentSection > 0) {
                showSection(currentSection - 1);
            }
        }

        // XP and Achievement System
        function addXP(amount, taskId) {
            if (completedTasks.has(taskId)) return;
            
            completedTasks.add(taskId);
            xp += amount;
            document.getElementById('xp').textContent = xp;
            
            updateLevel();
            updateXPBar();
            
            // Create particle effect
            createParticle(amount);
        }

        function updateLevel() {
            const oldLevel = level;
            for (let i = levelThresholds.length - 1; i >= 0; i--) {
                if (xp >= levelThresholds[i]) {
                    level = i;
                    break;
                }
            }
            
            if (level > oldLevel) {
                document.getElementById('level').textContent = level;
                unlockAchievement('Level Up!', `Reached Level ${level}`);
            }
        }

        function updateXPBar() {
            const currentThreshold = levelThresholds[level];
            const nextThreshold = levelThresholds[level + 1] || levelThresholds[levelThresholds.length - 1];
            const progress = ((xp - currentThreshold) / (nextThreshold - currentThreshold)) * 100;
            document.getElementById('xpFill').style.width = progress + '%';
        }

        function unlockAchievement(title, description) {
            if (achievements.find(a => a.title === title)) return;
            
            achievements.push({ title, description });
            document.getElementById('achievements').textContent = achievements.length;
            
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementText').textContent = description;
            popup.classList.add('show');
            
            setTimeout(() => {
                popup.classList.remove('show');
            }, 3000);
        }

        function createParticle(xpAmount) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.textContent = `+${xpAmount} XP`;
            particle.style.left = Math.random() * window.innerWidth + 'px';
            particle.style.top = Math.random() * window.innerHeight + 'px';
            particle.style.color = '#06b6d4';
            particle.style.fontSize = '20px';
            particle.style.fontWeight = 'bold';
            document.body.appendChild(particle);
            
            setTimeout(() => particle.remove(), 2000);
        }

        // Starter Activity
        function selectProblem(element, type) {
            if (selectedProblem) {
                selectedProblem.classList.remove('selected');
            }
            selectedProblem = element;
            selectedProblem.dataset.type = type;
            element.classList.add('selected');
            
            // Find matching drop zone and add
            const zone = document.querySelector(`[data-solution="${type}"]`);
            if (zone && !zone.querySelector('.drag-item')) {
                zone.appendChild(element);
            }
        }

        function checkStarter() {
            const zones = document.querySelectorAll('.drop-zone[data-solution]');
            let correct = 0;
            let total = 6;
            
            zones.forEach(zone => {
                const item = zone.querySelector('.drag-item');
                if (item && item.dataset.type === zone.dataset.solution) {
                    correct++;
                    zone.classList.add('correct');
                } else if (item) {
                    zone.classList.add('incorrect');
                }
            });
            
            const feedback = document.getElementById('starterFeedback');
            feedback.innerHTML = `<p style="color: ${correct === total ? '#10b981' : '#f59e0b'}">
                You matched ${correct}/${total} correctly! 
                ${correct === total ? 'Perfect! You understand utility software purposes!' : 'Review which utilities solve which problems.'}
            </p>`;
            
            if (correct === total) {
                addXP(50, 'starter-perfect');
                unlockAchievement('Utility Expert', 'Perfectly matched all utility software!');
            } else if (correct >= 4) {
                addXP(30, 'starter-good');
            }
        }

        function resetStarter() {
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.remove('correct', 'incorrect');
                const items = zone.querySelectorAll('.drag-item');
                items.forEach(item => {
                    document.querySelector('.task-card > div > div:first-child').appendChild(item);
                });
            });
            document.getElementById('starterFeedback').innerHTML = '';
        }

        function showHint(section) {
            const hintBox = document.getElementById(section + 'Hint');
            if (hintBox) {
                hintBox.style.display = 'block';
                addXP(-5, section + '-hint-penalty');
            }
        }

        // Utility Software Info
        function showUtilityInfo(type) {
            const info = {
                formatter: {
                    title: 'Disk Formatter',
                    desc: 'Prepares storage devices for use by creating a file system. Essential for new drives or when changing file systems.'
                },
                virus: {
                    title: 'Virus Checker',
                    desc: 'Scans for and removes malware. Uses signature databases and behavior analysis to protect your system.'
                },
                defrag: {
                    title: 'Defragmentation Tool',
                    desc: 'Reorganizes fragmented files on hard drives to improve access speed. Not needed for SSDs.'
                },
                repair: {
                    title: 'Disk Repair Tool',
                    desc: 'Checks for and fixes file system errors, bad sectors, and other disk problems.'
                },
                compress: {
                    title: 'File Compression',
                    desc: 'Reduces file sizes to save storage space and speed up transfers. Can be lossless or lossy.'
                },
                backup: {
                    title: 'Backup Software',
                    desc: 'Creates copies of important data to protect against loss. Supports scheduled and incremental backups.'
                }
            };
            
            document.querySelectorAll('.utility-box').forEach(box => box.classList.remove('active'));
            event.target.closest('.utility-box').classList.add('active');
            
            const infoDiv = document.getElementById('utilityInfo');
            const selected = info[type];
            infoDiv.innerHTML = `
                <h4 style="color: #06b6d4;">${selected.title}</h4>
                <p>${selected.desc}</p>
            `;
            
            addXP(5, 'utility-info-' + type);
        }

        function selectQuizOption(element, quizId) {
            const options = element.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
        }

        function checkUtilityQuiz() {
            const selected = document.querySelector('input[name="utilQ"]:checked');
            const feedback = document.getElementById('utilityQuizFeedback');
            
            if (!selected) {
                feedback.innerHTML = '<p style="color: #f59e0b;">Please select an answer.</p>';
                return;
            }
            
            if (selected.value === 'b') {
                feedback.innerHTML = '<p style="color: #10b981;">Correct! Utility software performs maintenance and optimization tasks.</p>';
                addXP(20, 'utility-quiz');
                selected.parentElement.classList.add('correct');
            } else {
                feedback.innerHTML = '<p style="color: #ef4444;">Incorrect. Utility software helps maintain and optimize your system.</p>';
                selected.parentElement.classList.add('incorrect');
            }
        }

        // Disk Formatter
        function startFormatting() {
            const disk = document.getElementById('diskVisual');
            const fill = document.getElementById('formatFill');
            const status = document.getElementById('formatStatus');
            let progress = 0;
            
            disk.classList.add('spinning');
            
            formatInterval = setInterval(() => {
                progress += 5;
                fill.style.width = progress + '%';
                fill.textContent = progress + '%';
                
                if (progress <= 30) {
                    status.textContent = 'Checking disk integrity...';
                } else if (progress <= 60) {
                    status.textContent = 'Creating file system structure...';
                } else if (progress <= 90) {
                    status.textContent = 'Writing partition table...';
                } else {
                    status.textContent = 'Finalizing format...';
                }
                
                if (progress >= 100) {
                    clearInterval(formatInterval);
                    disk.classList.remove('spinning');
                    status.textContent = 'Format complete! Disk is ready for use.';
                    status.style.color = '#10b981';
                    addXP(30, 'format-simulation');
                }
            }, 100);
        }

        function resetDisk() {
            if (formatInterval) clearInterval(formatInterval);
            document.getElementById('diskVisual').classList.remove('spinning');
            document.getElementById('formatFill').style.width = '0%';
            document.getElementById('formatFill').textContent = '0%';
            document.getElementById('formatStatus').textContent = 'Ready to format...';
            document.getElementById('formatStatus').style.color = '#e2e8f0';
        }

        function checkFormatTypes() {
            const correct = {
                format1: 'quick',
                format2: 'full',
                format3: 'low'
            };
            
            let score = 0;
            for (let i = 1; i <= 3; i++) {
                const select = document.getElementById('format' + i);
                if (select.value === correct['format' + i]) {
                    score++;
                    select.style.borderColor = '#10b981';
                } else {
                    select.style.borderColor = '#ef4444';
                }
            }
            
            const feedback = document.getElementById('formatTypesFeedback');
            feedback.innerHTML = `<p style="color: ${score === 3 ? '#10b981' : '#f59e0b'}">
                ${score}/3 correct! ${score === 3 ? 'You understand formatting types!' : 'Review the different formatting methods.'}
            </p>`;
            
            if (score === 3) {
                addXP(30, 'format-types');
            }
        }

        function checkFormatWhen() {
            const correct = [true, true, false, true, false];
            let score = 0;
            
            for (let i = 1; i <= 5; i++) {
                const checkbox = document.getElementById('formatWhen' + i);
                if (checkbox.checked === correct[i-1]) {
                    score++;
                }
            }
            
            const feedback = document.getElementById('formatWhenFeedback');
            feedback.innerHTML = `<p style="color: ${score === 5 ? '#10b981' : '#f59e0b'}">
                ${score}/5 correct! ${score === 5 ? 'Perfect understanding of when to format!' : 'Remember: formatting erases all data and is for disk preparation.'}
            </p>`;
            
            if (score === 5) {
                addXP(25, 'format-when');
            }
        }

        // Virus Checker
        function initializeFiles() {
            const fileList = document.getElementById('fileList');
            const files = [
                { name: 'system32.dll', safe: true },
                { name: 'explorer.exe', safe: true },
                { name: 'totally_not_virus.exe', safe: false },
                { name: 'document.docx', safe: true },
                { name: 'photos.zip', safe: true },
                { name: 'hack_tool.bat', safe: false },
                { name: 'music.mp3', safe: true },
                { name: 'keylogger.dll', safe: false },
                { name: 'chrome.exe', safe: true },
                { name: 'suspicious.scr', safe: false }
            ];
            
            fileList.innerHTML = '';
            files.forEach((file, index) => {
                const div = document.createElement('div');
                div.className = 'file-item';
                div.dataset.safe = file.safe;
                div.dataset.index = index;
                div.innerHTML = `<span>${file.safe ? 'üìÑ' : '‚ö†Ô∏è'} ${file.name}</span>`;
                fileList.appendChild(div);
            });
        }

        function startVirusScan() {
            const files = document.querySelectorAll('#fileList .file-item');
            const results = document.getElementById('scanResults');
            const progress = document.getElementById('scanProgress');
            let scanned = 0;
            let threats = [];
            
            results.innerHTML = '<p style="color: #06b6d4;">Scanning in progress...</p>';
            
            scanInterval = setInterval(() => {
                if (scanned < files.length) {
                    const file = files[scanned];
                    file.style.background = 'rgba(6, 182, 212, 0.3)';
                    
                    if (file.dataset.safe === 'false') {
                        threats.push(file.textContent);
                        file.style.background = 'rgba(239, 68, 68, 0.3)';
                    } else {
                        setTimeout(() => {
                            file.style.background = 'rgba(16, 185, 129, 0.3)';
                        }, 200);
                    }
                    
                    scanned++;
                    const percent = Math.round((scanned / files.length) * 100);
                    progress.style.width = percent + '%';
                    progress.textContent = percent + '%';
                } else {
                    clearInterval(scanInterval);
                    
                    results.innerHTML = `
                        <p style="color: ${threats.length > 0 ? '#f59e0b' : '#10b981'};">
                            Scan complete!
                        </p>
                        <p>Files scanned: ${files.length}</p>
                        <p>Threats found: ${threats.length}</p>
                        ${threats.length > 0 ? `
                            <hr style="margin: 10px 0; border-color: rgba(255,255,255,0.2);">
                            <p style="color: #ef4444;"><strong>Threats detected:</strong></p>
                            ${threats.map(t => `<p>‚Ä¢ ${t}</p>`).join('')}
                            <p style="margin-top: 10px;">Click "Quarantine Threats" to remove them.</p>
                        ` : '<p>Your system is clean!</p>'}
                    `;
                    
                    addXP(40, 'virus-scan');
                    if (threats.length > 0) {
                        unlockAchievement('Threat Detector', 'Successfully identified malware!');
                    }
                }
            }, 300);
        }

        function quarantineThreats() {
            const threats = document.querySelectorAll('#fileList .file-item[data-safe="false"]');
            threats.forEach(threat => {
                threat.style.textDecoration = 'line-through';
                threat.style.opacity = '0.5';
            });
            
            const results = document.getElementById('scanResults');
            results.innerHTML += '<p style="color: #10b981; margin-top: 10px;">‚úì All threats have been quarantined!</p>';
            
            addXP(20, 'quarantine-threats');
        }

        function resetVirusScan() {
            if (scanInterval) clearInterval(scanInterval);
            initializeFiles();
            document.getElementById('scanResults').innerHTML = '<p style="color: #94a3b8;">Click "Start Scan" to begin...</p>';
            document.getElementById('scanProgress').style.width = '0%';
            document.getElementById('scanProgress').textContent = '0%';
        }

        function selectWord(element, word) {
            if (selectedWord) {
                selectedWord.classList.remove('selected');
            }
            selectedWord = element;
            element.classList.add('selected');
        }

        function checkVirusBlanks() {
            const answers = {
                virusBlank1: 'signatures',
                virusBlank2: 'real-time',
                virusBlank3: 'quarantine',
                virusBlank4: 'updates'
            };
            
            let correct = 0;
            for (let i = 1; i <= 4; i++) {
                const input = document.getElementById('virusBlank' + i);
                if (input.value.toLowerCase().trim() === answers['virusBlank' + i]) {
                    correct++;
                    input.style.borderColor = '#10b981';
                } else {
                    input.style.borderColor = '#ef4444';
                }
            }
            
            const feedback = document.getElementById('virusBlanksFeedback');
            feedback.innerHTML = `<p style="color: ${correct === 4 ? '#10b981' : '#f59e0b'}">
                ${correct}/4 correct! ${correct === 4 ? 'Excellent understanding of virus protection!' : 'Review how antivirus software works.'}
            </p>`;
            
            if (correct === 4) {
                addXP(35, 'virus-blanks');
            }
        }

        function checkMalwareTypes() {
            const correct = {
                malware1: 'virus',
                malware2: 'worm',
                malware3: 'trojan',
                malware4: 'spyware'
            };
            
            let score = 0;
            for (let i = 1; i <= 4; i++) {
                const select = document.getElementById('malware' + i);
                if (select.value === correct['malware' + i]) {
                    score++;
                    select.style.borderColor = '#10b981';
                } else {
                    select.style.borderColor = '#ef4444';
                }
            }
            
            const feedback = document.getElementById('malwareTypesFeedback');
            feedback.innerHTML = `<p style="color: ${score === 4 ? '#10b981' : '#f59e0b'}">
                ${score}/4 correct! ${score === 4 ? 'You know your malware types!' : 'Review the different types of malware.'}
            </p>`;
            
            if (score === 4) {
                addXP(30, 'malware-types');
            }
        }

        // Defragmentation
        function initializeDiskGrid() {
            const grid = document.getElementById('diskGrid');
            grid.innerHTML = '';
            diskBlocks = [];
            
            for (let i = 0; i < 100; i++) {
                const block = document.createElement('div');
                block.style.width = '100%';
                block.style.height = '30px';
                block.style.background = '#64748b';
                block.style.transition = 'all 0.3s';
                grid.appendChild(block);
                diskBlocks.push({ element: block, file: null });
            }
        }

        const fileColors = ['#3b82f6', '#ef4444', '#10b981', '#f59e0b'];
        let fileCounter = 0;

        function addFragmentedFile() {
            const emptyBlocks = diskBlocks.filter(b => b.file === null);
            if (emptyBlocks.length < 10) {
                alert('Not enough space!');
                return;
            }
            
            const fileId = fileCounter % 4;
            const fileSize = Math.floor(Math.random() * 8) + 5;
            const color = fileColors[fileId];
            
            // Fragment the file
            let blocksUsed = 0;
            while (blocksUsed < fileSize && emptyBlocks.length > 0) {
                const randomIndex = Math.floor(Math.random() * emptyBlocks.length);
                const block = emptyBlocks[randomIndex];
                block.file = fileId;
                block.element.style.background = color;
                emptyBlocks.splice(randomIndex, 1);
                blocksUsed++;
            }
            
            fileCounter++;
            updateFragmentationLevel();
            addXP(5, 'add-file-' + fileCounter);
        }

        function deleteRandomFile() {
            const usedBlocks = diskBlocks.filter(b => b.file !== null);
            if (usedBlocks.length === 0) return;
            
            const fileToDelete = usedBlocks[Math.floor(Math.random() * usedBlocks.length)].file;
            
            diskBlocks.forEach(block => {
                if (block.file === fileToDelete) {
                    block.file = null;
                    block.element.style.background = '#64748b';
                }
            });
            
            updateFragmentationLevel();
        }

        function updateFragmentationLevel() {
            let fragments = 0;
            let lastFile = null;
            
            diskBlocks.forEach(block => {
                if (block.file !== null && block.file !== lastFile) {
                    fragments++;
                    lastFile = block.file;
                } else if (block.file === null) {
                    lastFile = null;
                }
            });
            
            const usedBlocks = diskBlocks.filter(b => b.file !== null).length;
            fragmentationLevel = usedBlocks > 0 ? Math.round((fragments / usedBlocks) * 100) : 0;
            
            document.getElementById('fragStatus').textContent = `Fragmentation Level: ${fragmentationLevel}%`;
            document.getElementById('fragStatus').style.color = 
                fragmentationLevel > 50 ? '#ef4444' : 
                fragmentationLevel > 20 ? '#f59e0b' : '#10b981';
        }

        function runDefrag() {
            const files = {};
            
            // Group blocks by file
            diskBlocks.forEach(block => {
                if (block.file !== null) {
                    if (!files[block.file]) files[block.file] = [];
                    files[block.file].push(block);
                }
            });
            
            // Clear all blocks
            diskBlocks.forEach(block => {
                block.file = null;
                block.element.style.background = '#64748b';
            });
            
            // Reorganize files contiguously
            let currentIndex = 0;
            Object.keys(files).forEach(fileId => {
                files[fileId].forEach(() => {
                    if (currentIndex < diskBlocks.length) {
                        diskBlocks[currentIndex].file = parseInt(fileId);
                        diskBlocks[currentIndex].element.style.background = fileColors[parseInt(fileId)];
                        currentIndex++;
                    }
                });
            });
            
            updateFragmentationLevel();
            addXP(40, 'defrag-complete');
            unlockAchievement('Defragmentation Master', 'Successfully defragmented the disk!');
        }

        function resetDefrag() {
            initializeDiskGrid();
            fragmentationLevel = 0;
            document.getElementById('fragStatus').textContent = 'Fragmentation Level: 0%';
            document.getElementById('fragStatus').style.color = '#10b981';
        }

        function checkDefragBenefits() {
            const correct = [true, true, false, true, false, true];
            let score = 0;
            
            for (let i = 1; i <= 6; i++) {
                const checkbox = document.getElementById('defragBenefit' + i);
                if (checkbox.checked === correct[i-1]) {
                    score++;
                }
            }
            
            const feedback = document.getElementById('defragBenefitsFeedback');
            feedback.innerHTML = `<p style="color: ${score === 6 ? '#10b981' : '#f59e0b'}">
                ${score}/6 correct! ${score === 6 ? 'Perfect! You understand defragmentation benefits!' : 'Note: Defragmentation doesn\'t increase space or protect against viruses.'}
            </p>`;
            
            if (score === 6) {
                addXP(35, 'defrag-benefits');
            }
        }

        function checkSSDAnswer() {
            const answer = document.getElementById('ssdAnswer').value.trim();
            const keywords = ['wear', 'flash', 'no moving parts', 'random access', 'lifespan', 'unnecessary'];
            let keywordsFound = 0;
            
            keywords.forEach(keyword => {
                if (answer.toLowerCase().includes(keyword)) {
                    keywordsFound++;
                }
            });
            
            const feedback = document.getElementById('ssdFeedback');
            if (answer.length < 30) {
                feedback.innerHTML = '<p style="color: #f59e0b;">Please provide more detail.</p>';
                return;
            }
            
            feedback.innerHTML = `<p style="color: #10b981;">Good answer! SSDs don't need defragmentation because they have no moving parts and can access any location equally fast. Defragmenting actually reduces SSD lifespan due to unnecessary write operations.</p>`;
            
            addXP(keywordsFound * 10, 'ssd-explanation');
        }

        // Disk Analysis
        function analyzeDisk() {
            const ctx = document.getElementById('diskChart').getContext('2d');
            const centerX = 150;
            const centerY = 150;
            const radius = 100;
            
            // Clear canvas
            ctx.clearRect(0, 0, 300, 300);
            
            // Data
            const data = [
                { label: 'Documents', size: 2.3, color: '#3b82f6' },
                { label: 'Media', size: 15.7, color: '#ef4444' },
                { label: 'Programs', size: 8.2, color: '#10b981' },
                { label: 'System', size: 12.1, color: '#f59e0b' },
                { label: 'Other', size: 4.5, color: '#8b5cf6' }
            ];
            
            const total = data.reduce((sum, item) => sum + item.size, 0);
            let currentAngle = -Math.PI / 2;
            
            // Draw pie chart
            data.forEach(item => {
                const sliceAngle = (item.size / total) * 2 * Math.PI;
                
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                ctx.closePath();
                ctx.fillStyle = item.color;
                ctx.fill();
                
                currentAngle += sliceAngle;
            });
            
            // Simulate finding issues
            setTimeout(() => {
                const issues = document.getElementById('issuesFound');
                issues.innerHTML = `
                    <p style="color: #ef4444;">‚Ä¢ 3 bad sectors found</p>
                    <p style="color: #f59e0b;">‚Ä¢ 127 MB of temporary files</p>
                    <p style="color: #f59e0b;">‚Ä¢ File system errors detected</p>
                    <p style="margin-top: 10px;">Click "Repair Errors" to fix these issues.</p>
                `;
                
                addXP(30, 'disk-analysis');
            }, 2000);
        }

        function repairErrors() {
            const issues = document.getElementById('issuesFound');
            if (issues.innerHTML.includes('bad sectors')) {
                issues.innerHTML = '<p style="color: #10b981;">‚úì All errors repaired successfully!</p>';
                addXP(25, 'repair-errors');
            }
        }

        function resetAnalysis() {
            const ctx = document.getElementById('diskChart').getContext('2d');
            ctx.clearRect(0, 0, 300, 300);
            document.getElementById('issuesFound').innerHTML = '<p style="color: #f59e0b;">Click "Analyze" to scan...</p>';
        }

        function selectError(element, type) {
            if (selectedError) {
                selectedError.classList.remove('selected');
            }
            selectedError = element;
            selectedError.dataset.type = type;
            element.classList.add('selected');
            
            // Move to matching zone
            const zone = document.querySelector(`[data-error="${type}"]`);
            if (zone && !zone.querySelector('.drag-item')) {
                zone.appendChild(element);
            }
        }

        function checkErrorMatching() {
            const zones = document.querySelectorAll('.drop-zone[data-error]');
            let correct = 0;
            
            zones.forEach(zone => {
                const item = zone.querySelector('.drag-item');
                if (item && item.dataset.type === zone.dataset.error) {
                    correct++;
                    zone.classList.add('correct');
                } else if (item) {
                    zone.classList.add('incorrect');
                }
            });
            
            const feedback = document.getElementById('errorMatchingFeedback');
            feedback.innerHTML = `<p style="color: ${correct === 4 ? '#10b981' : '#f59e0b'}">
                ${correct}/4 matches correct! ${correct === 4 ? 'Excellent understanding of disk errors!' : 'Review how different errors are fixed.'}
            </p>`;
            
            if (correct === 4) {
                addXP(35, 'error-matching');
            }
        }

        function resetErrorMatching() {
            document.querySelectorAll('.drop-zone[data-error]').forEach(zone => {
                zone.classList.remove('correct', 'incorrect');
                const items = zone.querySelectorAll('.drag-item');
                items.forEach(item => {
                    document.querySelector('.task-card .drag-item').parentElement.appendChild(item);
                });
            });
            document.getElementById('errorMatchingFeedback').innerHTML = '';
        }

        function checkSchedule() {
            const correct = {
                schedule1: 'monthly',
                schedule2: 'monthly',
                schedule3: 'weekly'
            };
            
            let score = 0;
            for (let i = 1; i <= 3; i++) {
                const select = document.getElementById('schedule' + i);
                if (select.value === correct['schedule' + i]) {
                    score++;
                    select.style.borderColor = '#10b981';
                } else {
                    select.style.borderColor = '#ef4444';
                }
            }
            
            const feedback = document.getElementById('scheduleFeedback');
            feedback.innerHTML = `<p style="color: ${score === 3 ? '#10b981' : '#f59e0b'}">
                ${score}/3 correct! ${score === 3 ? 'Good maintenance schedule!' : 'Consider: analysis monthly, errors monthly, backups weekly for important data.'}
            </p>`;
            
            if (score === 3) {
                addXP(25, 'schedule');
            }
        }

        // File Compression
        function compressFiles() {
            const originalFiles = document.querySelectorAll('#originalFiles .file-item');
            const compressedDiv = document.getElementById('compressedFiles');
            let totalOriginal = 0;
            let totalCompressed = 0;
            
            compressedDiv.innerHTML = '';
            
            originalFiles.forEach(file => {
                if (file.classList.contains('selected')) {
                    const size = parseInt(file.dataset.size);
                    totalOriginal += size;
                    
                    // Different compression ratios for different file types
                    let ratio = 0.5; // Default 50% compression
                    if (file.textContent.includes('.jpg')) ratio = 0.9; // Already compressed
                    if (file.textContent.includes('.txt')) ratio = 0.3; // Text compresses well
                    if (file.textContent.includes('.mp4')) ratio = 0.95; // Already compressed
                    
                    const compressedSize = Math.round(size * ratio);
                    totalCompressed += compressedSize;
                    
                    const compressedFile = document.createElement('div');
                    compressedFile.className = 'file-item';
                    compressedFile.style.background = 'rgba(6, 182, 212, 0.2)';
                    compressedFile.innerHTML = `
                        <span>üóúÔ∏è ${file.querySelector('span').textContent.replace('üìÑ', '').replace('üñºÔ∏è', '').replace('üìä', '').replace('üé•', '')}.zip</span>
                        <span>${compressedSize >= 1024 ? (compressedSize/1024).toFixed(1) + ' MB' : compressedSize + ' KB'}</span>
                    `;
                    compressedDiv.appendChild(compressedFile);
                }
            });
            
            if (totalOriginal > 0) {
                const saved = totalOriginal - totalCompressed;
                const ratio = Math.round((1 - totalCompressed/totalOriginal) * 100);
                
                document.getElementById('sizeSaved').textContent = 
                    saved >= 1024 ? (saved/1024).toFixed(1) + ' MB' : saved + ' KB';
                document.getElementById('compressionRatio').textContent = ratio + '%';
                
                addXP(20, 'compress-files');
                
                if (selectedFiles.size >= 3) {
                    unlockAchievement('Compression Pro', 'Compressed multiple files successfully!');
                }
            }
        }

        function resetCompression() {
            selectedFiles.clear();
            document.querySelectorAll('#originalFiles .file-item').forEach(file => {
                file.classList.remove('selected');
                file.onclick = function() {
                    this.classList.toggle('selected');
                    if (this.classList.contains('selected')) {
                        selectedFiles.add(this);
                    } else {
                        selectedFiles.delete(this);
                    }
                };
            });
            document.getElementById('compressedFiles').innerHTML = '<p style="color: #94a3b8;">Select files and click "Compress"...</p>';
            document.getElementById('sizeSaved').textContent = '0 KB';
            document.getElementById('compressionRatio').textContent = '0%';
        }

        function checkCompressionTypes() {
            const correct = {
                compQ1: 'lossless',
                compQ2: 'lossy',
                compQ3: 'lossless'
            };
            
            let score = 0;
            for (let i = 1; i <= 3; i++) {
                const selected = document.querySelector(`input[name="compQ${i}"]:checked`);
                if (selected && selected.value === correct['compQ' + i]) {
                    score++;
                    selected.parentElement.classList.add('correct');
                } else if (selected) {
                    selected.parentElement.classList.add('incorrect');
                }
            }
            
            const feedback = document.getElementById('compressionTypesFeedback');
            feedback.innerHTML = `<p style="color: ${score === 3 ? '#10b981' : '#f59e0b'}">
                ${score}/3 correct! ${score === 3 ? 'You understand compression types!' : 'Remember: Lossless = perfect reconstruction, Lossy = some data loss for smaller size.'}
            </p>`;
            
            if (score === 3) {
                addXP(30, 'compression-types');
            }
        }

        function checkCompressionBenefits() {
            const answer = document.getElementById('compressionBenefits').value.trim();
            const lines = answer.split('\n').filter(line => line.trim().length > 0);
            
            if (lines.length < 3) {
                document.getElementById('compressionBenefitsFeedback').innerHTML = 
                    '<p style="color: #f59e0b;">Please list at least 3 benefits.</p>';
                return;
            }
            
            const keywords = ['storage', 'space', 'transfer', 'bandwidth', 'backup', 'archive', 'email', 'speed'];
            let keywordsFound = 0;
            
            keywords.forEach(keyword => {
                if (answer.toLowerCase().includes(keyword)) {
                    keywordsFound++;
                }
            });
            
            document.getElementById('compressionBenefitsFeedback').innerHTML = 
                `<p style="color: #10b981;">Good benefits! Key advantages include: saves storage space, faster file transfers, reduced bandwidth usage, easier backups, and efficient archiving.</p>`;
            
            addXP(keywordsFound * 5, 'compression-benefits');
        }

        // Backup Software
        function createBackupPlan() {
            const checkboxes = [
                document.getElementById('backup1'),
                document.getElementById('backup2'),
                document.getElementById('backup3'),
                document.getElementById('backup4'),
                document.getElementById('backup5')
            ];
            
            const selected = checkboxes.filter(cb => cb.checked);
            const backupType = document.querySelector('input[name="backupType"]:checked');
            
            if (selected.length === 0) {
                document.getElementById('backupPlanResult').innerHTML = 
                    '<p style="color: #f59e0b;">Please select at least one item to backup.</p>';
                return;
            }
            
            if (!backupType) {
                document.getElementById('backupPlanResult').innerHTML = 
                    '<p style="color: #f59e0b;">Please select a backup type.</p>';
                return;
            }
            
            const items = ['Documents', 'Photos & Videos', 'System Settings', 'Installed Programs', 'Browser Bookmarks'];
            const selectedItems = checkboxes.map((cb, i) => cb.checked ? items[i] : null).filter(item => item);
            
            document.getElementById('backupPlanResult').innerHTML = `
                <div style="background: var(--light-bg); padding: 20px; border-radius: 8px; margin-top: 20px;">
                    <h4 style="color: #06b6d4;">Your Backup Plan</h4>
                    <p><strong>Items to backup:</strong></p>
                    <ul>${selectedItems.map(item => `<li>${item}</li>`).join('')}</ul>
                    <p><strong>Backup type:</strong> ${backupType.value.charAt(0).toUpperCase() + backupType.value.slice(1)}</p>
                    <p><strong>Recommended schedule:</strong> ${backupType.value === 'full' ? 'Weekly' : 'Daily'}</p>
                    <p><strong>Estimated storage needed:</strong> ${selectedItems.length * 5} GB</p>
                </div>
            `;
            
            addXP(30, 'backup-plan');
            
            if (selected.length >= 3 && selectedItems.includes('Documents')) {
                unlockAchievement('Backup Strategist', 'Created a comprehensive backup plan!');
            }
        }

        function check321Rule() {
            const rule3 = document.getElementById('rule3').value.toLowerCase();
            const rule2 = document.getElementById('rule2').value.toLowerCase();
            const rule1 = document.getElementById('rule1').value.toLowerCase();
            
            let score = 0;
            const feedback = [];
            
            if (rule3.includes('copies') || rule3.includes('three')) {
                score++;
                document.getElementById('rule3').style.borderColor = '#10b981';
            } else {
                document.getElementById('rule3').style.borderColor = '#ef4444';
                feedback.push('3 = Three copies of data');
            }
            
            if (rule2.includes('media') || rule2.includes('storage') || rule2.includes('different')) {
                score++;
                document.getElementById('rule2').style.borderColor = '#10b981';
            } else {
                document.getElementById('rule2').style.borderColor = '#ef4444';
                feedback.push('2 = Two different storage media');
            }
            
            if (rule1.includes('offsite') || rule1.includes('location') || rule1.includes('remote')) {
                score++;
                document.getElementById('rule1').style.borderColor = '#10b981';
            } else {
                document.getElementById('rule1').style.borderColor = '#ef4444';
                feedback.push('1 = One offsite backup');
            }
            
            const feedbackDiv = document.getElementById('rule321Feedback');
            if (score === 3) {
                feedbackDiv.innerHTML = '<p style="color: #10b981;">Perfect! You understand the 3-2-1 backup rule!</p>';
                addXP(40, '321-rule');
            } else {
                feedbackDiv.innerHTML = `<p style="color: #f59e0b;">Not quite. Remember:<br>${feedback.join('<br>')}</p>`;
            }
        }

        function checkBackupScenarios() {
            const correct = {
                scenario1: 'cloud',
                scenario2: 'cloud-sync',
                scenario3: 'raid'
            };
            
            let score = 0;
            for (let i = 1; i <= 3; i++) {
                const select = document.getElementById('scenario' + i);
                if (select.value === correct['scenario' + i]) {
                    score++;
                    select.style.borderColor = '#10b981';
                } else {
                    select.style.borderColor = '#ef4444';
                }
            }
            
            const feedback = document.getElementById('backupScenariosFeedback');
            feedback.innerHTML = `<p style="color: ${score === 3 ? '#10b981' : '#f59e0b'}">
                ${score}/3 correct! ${score === 3 ? 'Excellent backup solution choices!' : 'Consider: Business needs encryption & reliability, students need convenience, photographers need capacity.'}
            </p>`;
            
            if (score === 3) {
                addXP(35, 'backup-scenarios');
            }
        }

        // Program Libraries
        function showLibraryInfo(type) {
            const info = {
                math: {
                    title: 'Math Library',
                    functions: ['sqrt() - Square root', 'pow() - Power', 'sin() - Sine', 'random() - Random numbers'],
                    apps: ['Calculator App']
                },
                graphics: {
                    title: 'Graphics Library',
                    functions: ['drawImage()', 'fillRect()', 'createGradient()', 'rotate()'],
                    apps: ['Photo Editor']
                },
                network: {
                    title: 'Network Library',
                    functions: ['connect()', 'send()', 'receive()', 'encrypt()'],
                    apps: ['Web Browser']
                }
            };
            
            const selected = info[type];
            const infoDiv = document.getElementById('libraryInfo');
            
            // Show connections
            document.getElementById('connections').style.display = 'block';
            
            infoDiv.innerHTML = `
                <h4 style="color: #7c3aed;">${selected.title}</h4>
                <p><strong>Common Functions:</strong></p>
                <ul>${selected.functions.map(f => `<li>${f}</li>`).join('')}</ul>
                <p><strong>Used by:</strong> ${selected.apps.join(', ')}</p>
                <p style="margin-top: 10px; color: #06b6d4;">Developers can import this library instead of writing these functions from scratch!</p>
            `;
            
            addXP(10, 'library-info-' + type);
        }

        function selectStatement(element, type) {
            if (selectedStatement) {
                selectedStatement.classList.remove('selected');
            }
            selectedStatement = element;
            selectedStatement.dataset.type = type;
            element.classList.add('selected');
            
            // Move to appropriate list
            const list = type === 'benefit' ? 'benefitsList' : 'drawbacksList';
            document.getElementById(list).appendChild(element);
        }

        function checkLibraryCategories() {
            const benefitsList = document.getElementById('benefitsList').children;
            const drawbacksList = document.getElementById('drawbacksList').children;
            let correct = 0;
            let total = 6;
            
            for (let item of benefitsList) {
                if (item.dataset.type === 'benefit') {
                    correct++;
                    item.style.background = '#d1fae5';
                } else {
                    item.style.background = '#fee2e2';
                }
            }
            
            for (let item of drawbacksList) {
                if (item.dataset.type === 'drawback') {
                    correct++;
                    item.style.background = '#d1fae5';
                } else {
                    item.style.background = '#fee2e2';
                }
            }
            
            const feedback = document.getElementById('libraryCategoriesFeedback');
            feedback.innerHTML = `<p style="color: ${correct === total ? '#10b981' : '#f59e0b'}">
                ${correct}/${total} correctly categorized! 
                ${correct === total ? 'Perfect! You understand library trade-offs!' : 'Review: Most are benefits, but dependency and bloat are concerns.'}
            </p>`;
            
            if (correct === total) {
                addXP(40, 'library-categories');
            }
        }

        function resetLibraryCategories() {
            const items = document.querySelectorAll('#benefitsList .drag-item, #drawbacksList .drag-item');
            const container = document.querySelector('.task-card .drag-item').parentElement;
            
            items.forEach(item => {
                item.style.background = '';
                container.appendChild(item);
            });
            
            document.getElementById('libraryCategoriesFeedback').innerHTML = '';
        }

        function checkLibraryComparison() {
            const answer = document.getElementById('libraryComparison').value.trim();
            
            if (answer.length < 30) {
                document.getElementById('libraryComparisonFeedback').innerHTML = 
                    '<p style="color: #f59e0b;">Please provide a more detailed answer.</p>';
                return;
            }
            
            const keywords = ['library', 'tested', 'reliable', 'faster', 'maintain', 'standard', 'bugs'];
            let keywordsFound = 0;
            
            keywords.forEach(keyword => {
                if (answer.toLowerCase().includes(keyword)) {
                    keywordsFound++;
                }
            });
            
            document.getElementById('libraryComparisonFeedback').innerHTML = 
                `<p style="color: #10b981;">Good analysis! Using libraries is generally better because the code is tested, optimized, and maintained by experts. It saves time and reduces bugs.</p>`;
            
            addXP(keywordsFound * 7, 'library-comparison');
        }

        // DLL Files
        function showDLLConnection(programId) {
            const programs = document.querySelectorAll('.program-node');
            programs.forEach(p => p.classList.remove('active'));
            programs[programId - 1].classList.add('active');
            
            const status = document.getElementById('dllStatus');
            const messages = [
                'Program A is using user32.dll for window management functions',
                'Program B is accessing user32.dll for input handling',
                'Program C is utilizing user32.dll for dialog boxes',
                'Program D is calling user32.dll for menu operations'
            ];
            
            status.innerHTML = `<p style="color: #06b6d4;">${messages[programId - 1]}</p>
                <p style="margin-top: 10px;">All programs share the same DLL file in memory, saving space!</p>`;
            
            addXP(5, 'dll-connection-' + programId);
        }

        function checkDLLAdvantages() {
            const correct = [true, false, true, true, false, true];
            let score = 0;
            
            for (let i = 1; i <= 6; i++) {
                const checkbox = document.getElementById('dllAdv' + i);
                if (checkbox.checked === correct[i-1]) {
                    score++;
                }
            }
            
            const feedback = document.getElementById('dllAdvantagesFeedback');
            feedback.innerHTML = `<p style="color: ${score === 6 ? '#10b981' : '#f59e0b'}">
                ${score}/6 correct! ${score === 6 ? 'Perfect understanding of DLL advantages!' : 'Remember: DLLs save memory and disk space, not increase usage.'}
            </p>`;
            
            if (score === 6) {
                addXP(40, 'dll-advantages');
                unlockAchievement('DLL Expert', 'Mastered Dynamic Link Library concepts!');
            }
        }

        function checkDLLHell() {
            const answer = document.getElementById('dllHellAnswer').value.trim();
            const wordCount = answer.split(/\s+/).filter(word => word.length > 0).length;
            
            if (wordCount < 30) {
                document.getElementById('dllHellFeedback').innerHTML = 
                    '<p style="color: #f59e0b;">Please provide more detail about DLL Hell.</p>';
                return;
            }
            
            const keywords = ['version', 'conflict', 'compatibility', 'overwrite', 'side-by-side', 'manifest'];
            let keywordsFound = 0;
            
            keywords.forEach(keyword => {
                if (answer.toLowerCase().includes(keyword)) {
                    keywordsFound++;
                }
            });
            
            document.getElementById('dllHellFeedback').innerHTML = 
                `<p style="color: #10b981;">Good explanation! DLL Hell occurs when programs require different versions of the same DLL. Solutions include version-specific folders, side-by-side assemblies, and application manifests.</p>`;
            
            addXP(keywordsFound * 10, 'dll-hell');
        }

        // Real World Context
        function checkRealWorldScenarios() {
            const correct = {
                realWorld1: 'compress',
                realWorld2: 'defrag',
                realWorld3: 'virus'
            };
            
            let score = 0;
            for (let i = 1; i <= 3; i++) {
                const select = document.getElementById('realWorld' + i);
                if (select.value === correct['realWorld' + i]) {
                    score++;
                    select.style.borderColor = '#10b981';
                } else {
                    select.style.borderColor = '#ef4444';
                }
            }
            
            const feedback = document.getElementById('realWorldScenariosFeedback');
            feedback.innerHTML = `<p style="color: ${score === 3 ? '#10b981' : '#f59e0b'}">
                ${score}/3 scenarios correctly matched! 
                ${score === 3 ? 'Excellent real-world application!' : 'Think about which utility best solves each problem.'}
            </p>`;
            
            if (score === 3) {
                addXP(35, 'real-world-scenarios');
            }
        }

        function selectTF(element, question, value) {
            const options = element.parentElement.querySelectorAll('.quiz-option');
            options.forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
        }

        function checkMistakes() {
            const correct = {
                mistakeTF1: false,
                mistakeTF2: false,
                mistakeTF3: false,
                mistakeTF4: false
            };
            
            let score = 0;
            for (let i = 1; i <= 4; i++) {
                const selected = document.querySelector(`input[name="mistakeTF${i}"]:checked`);
                if (selected && (selected.value === 'true') === correct['mistakeTF' + i]) {
                    score++;
                    selected.parentElement.classList.add('correct');
                } else if (selected) {
                    selected.parentElement.classList.add('incorrect');
                }
            }
            
            const feedback = document.getElementById('mistakesFeedback');
            const explanations = [
                'Never defragment SSDs - it reduces their lifespan!',
                'Only lossy compression reduces quality, not lossless!',
                'Never delete DLL files - programs depend on them!',
                'Virus checkers should run continuously in real-time!'
            ];
            
            feedback.innerHTML = `<p style="color: ${score === 4 ? '#10b981' : '#f59e0b'}">
                ${score}/4 correct! ${score < 4 ? 'Remember: ' + explanations.filter((e, i) => {
                    const selected = document.querySelector(`input[name="mistakeTF${i+1}"]:checked`);
                    return !selected || (selected.value === 'true') !== correct['mistakeTF' + (i+1)];
                }).join(' ') : 'Excellent! You avoided all common mistakes!'}
            </p>`;
            
            if (score === 4) {
                addXP(40, 'avoid-mistakes');
                unlockAchievement('Myth Buster', 'Identified all utility software misconceptions!');
            }
        }

        function submitModernExtension() {
            const answer = document.getElementById('modernExtension').value.trim();
            const wordCount = answer.split(/\s+/).filter(word => word.length > 0).length;
            
            if (wordCount < 40) {
                document.getElementById('modernExtensionFeedback').innerHTML = 
                    '<p style="color: #f59e0b;">Please provide more detail about the modern development.</p>';
                return;
            }
            
            document.getElementById('modernExtensionFeedback').innerHTML = 
                '<p style="color: #10b981;">Excellent extension work! Modern developments like containerization, package managers, and cloud utilities are reshaping how we think about system software.</p>';
            
            addXP(80, 'modern-extension');
            unlockAchievement('Future Thinker', 'Explored modern developments in system software!');
        }

        // Exam Practice
        function checkExamQ1() {
            const answer = document.getElementById('examQ1').value.trim();
            const marks = parseInt(document.getElementById('marks1').value) || 0;
            
            if (answer.length < 50) {
                alert('Please write a more detailed answer before viewing the mark scheme.');
                return;
            }
            
            const feedback = document.getElementById('examQ1Feedback');
            feedback.style.display = 'block';
            feedback.innerHTML = `
                <h4>Mark Scheme (3 marks)</h4>
                <p><strong>Any three from (1 mark each):</strong></p>
                <ul>
                    <li>Disk formatter - prepares storage devices for use</li>
                    <li>Virus checker - protects against malware</li>
                    <li>Defragmentation - reorganizes files for faster access</li>
                    <li>Disk analysis/repair - checks and fixes disk errors</li>
                    <li>File compression - reduces file sizes</li>
                    <li>Backup software - creates copies of data</li>
                </ul>
                <p><strong>Your predicted marks:</strong> ${marks}/3</p>
            `;
            
            addXP(marks * 15, 'exam-q1');
        }

        function checkExamQ2() {
            const answer = document.getElementById('examQ2').value.trim();
            const marks = parseInt(document.getElementById('marks2').value) || 0;
            
            if (answer.length < 80) {
                alert('Please write a more detailed answer before viewing the mark scheme.');
                return;
            }
            
            const feedback = document.getElementById('examQ2Feedback');
            feedback.style.display = 'block';
            feedback.innerHTML = `
                <h4>Mark Scheme (4 marks)</h4>
                <p><strong>Benefits include (1 mark each, max 4):</strong></p>
                <ul>
                    <li>Saves development time - no need to write common functions</li>
                    <li>Code is tested and reliable - fewer bugs</li>
                    <li>Standard implementations - consistent behavior</li>
                    <li>Regular updates and maintenance by library developers</li>
                    <li>Reduces program size through code reuse</li>
                    <li>Access to optimized algorithms</li>
                </ul>
                <p><strong>Your predicted marks:</strong> ${marks}/4</p>
            `;
            
            addXP(marks * 12, 'exam-q2');
        }

        function checkExamQ3() {
            const answer = document.getElementById('examQ3').value.trim();
            const marks = parseInt(document.getElementById('marks3').value) || 0;
            
            if (answer.length < 30) {
                alert('Please write a more detailed answer before viewing the mark scheme.');
                return;
            }
            
            const feedback = document.getElementById('examQ3Feedback');
            feedback.style.display = 'block';
            feedback.innerHTML = `
                <h4>Mark Scheme (2 marks)</h4>
                <ul>
                    <li>DLL is a shared library file containing code/functions (1 mark)</li>
                    <li>Multiple programs can use the same DLL, saving memory/disk space (1 mark)</li>
                </ul>
                <p>Accept: enables code reuse, easier updates, modular programming</p>
                <p><strong>Your predicted marks:</strong> ${marks}/2</p>
            `;
            
            addXP(marks * 20, 'exam-q3');
        }

        // Summary Quiz
        function initializeSummaryQuiz() {
            const questions = [
                {
                    question: "Which utility software prepares a new hard drive for use?",
                    options: ["Virus Checker", "Disk Formatter", "Defragmentation", "Backup Software"],
                    correct: 1
                },
                {
                    question: "What type of compression is used for ZIP files?",
                    options: ["Lossy", "Lossless", "Dynamic", "Static"],
                    correct: 1
                },
                {
                    question: "Why shouldn't you defragment an SSD?",
                    options: ["It's too slow", "It reduces lifespan", "It corrupts data", "It increases fragmentation"],
                    correct: 1
                },
                {
                    question: "What does the '3' in the 3-2-1 backup rule represent?",
                    options: ["3 different locations", "3 types of media", "3 copies of data", "3 backup schedules"],
                    correct: 2
                },
                {
                    question: "What is a main benefit of using DLL files?",
                    options: ["Faster internet", "Memory sharing between programs", "Better graphics", "Automatic updates"],
                    correct: 1
                },
                {
                    question: "Which is NOT a benefit of program libraries?",
                    options: ["Saves development time", "Tested code", "Increases program size", "Reduces bugs"],
                    correct: 2
                },
                {
                    question: "What does real-time protection in antivirus software do?",
                    options: ["Speeds up computer", "Scans files as accessed", "Deletes all viruses", "Updates virus definitions"],
                    correct: 1
                },
                {
                    question: "Which utility helps when running out of storage space?",
                    options: ["Disk Formatter", "Virus Checker", "File Compression", "Defragmentation"],
                    correct: 2
                }
            ];
            
            const container = document.getElementById('summaryQuiz');
            container.innerHTML = '';
            
            questions.forEach((q, index) => {
                const div = document.createElement('div');
                div.style.marginBottom = '20px';
                div.innerHTML = `
                    <p><strong>${index + 1}. ${q.question}</strong></p>
                    ${q.options.map((opt, i) => `
                        <label class="quiz-option" onclick="selectQuizOption(this, 'summary${index}')">
                            <input type="radio" name="summaryQ${index}" value="${i}" style="display: none;">
                            ${opt}
                        </label>
                    `).join('')}
                `;
                container.appendChild(div);
            });
        }

        function checkSummaryQuiz() {
            const questions = 8;
            let correct = 0;
            
            for (let i = 0; i < questions; i++) {
                const selected = document.querySelector(`input[name="summaryQ${i}"]:checked`);
                if (selected) {
                    const answer = parseInt(selected.value);
                    const correctAnswers = [1, 1, 1, 2, 1, 2, 1, 2];
                    
                    if (answer === correctAnswers[i]) {
                        correct++;
                        selected.parentElement.classList.add('correct');
                    } else {
                        selected.parentElement.classList.add('incorrect');
                    }
                }
            }
            
            const percentage = Math.round((correct / questions) * 100);
            const feedback = document.getElementById('summaryFeedback');
            feedback.innerHTML = `
                <h4>Assessment Results</h4>
                <p>You scored ${correct}/${questions} (${percentage}%)</p>
                <p style="color: ${percentage >= 80 ? '#10b981' : percentage >= 60 ? '#f59e0b' : '#ef4444'}">
                    ${percentage >= 80 ? 'Excellent work! You have mastered utility software and program libraries!' : 
                      percentage >= 60 ? 'Good effort! Review the topics you found challenging.' : 
                      'Keep practicing! Review the lesson and try again.'}
                </p>
            `;
            
            addXP(correct * 15, 'summary-quiz');
            
            if (percentage === 100) {
                unlockAchievement('Perfect Score', 'Achieved 100% on the final assessment!');
            }
            
            // Update final stats
            updateFinalStats();
        }

        function resetSummaryQuiz() {
            initializeSummaryQuiz();
            document.getElementById('summaryFeedback').innerHTML = '';
        }

        function updateFinalStats() {
            document.getElementById('finalLevel').textContent = level;
            document.getElementById('finalXP').textContent = xp;
            document.getElementById('finalAchievements').textContent = achievements.length;
            
            const achievementsList = document.getElementById('achievementsList');
            achievementsList.innerHTML = '<h5>Your Achievements:</h5>';
            achievements.forEach(ach => {
                achievementsList.innerHTML += `<p>üèÜ ${ach.title}: ${ach.description}</p>`;
            });
        }

        // Canvas Functions
        let canvas, ctx;
        let isDrawing = false;

        function initializeCanvas() {
            canvas = document.getElementById('drawingCanvas');
            ctx = canvas.getContext('2d');
            
            // Set canvas size
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width;
            canvas.height = rect.height;
            
            // Drawing events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events
            canvas.addEventListener('touchstart', handleTouch);
            canvas.addEventListener('touchmove', handleTouch);
            canvas.addEventListener('touchend', stopDrawing);
        }

        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            ctx.beginPath();
            ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const rect = canvas.getBoundingClientRect();
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.strokeStyle = '#7c3aed';
            
            ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                            e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // Accessibility Functions
        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
        }

        function changeFontSize(delta) {
            const root = document.documentElement;
            const currentSize = parseFloat(getComputedStyle(root).fontSize);
            root.style.fontSize = (currentSize + delta) + 'px';
        }

        // Feedback System
        function openFeedback() {
            document.getElementById('feedbackModal').style.display = 'flex';
        }

        function closeFeedback() {
            document.getElementById('feedbackModal').style.display = 'none';
            document.getElementById('feedbackText').value = '';
        }

        function sendFeedback() {
            const feedback = document.getElementById('feedbackText').value.trim();
            if (!feedback) {
                alert('Please enter your feedback before sending.');
                return;
            }
            
            const section = document.querySelector('.section.active h2').textContent;
            const subject = `OS Lesson 2 Feedback - ${section}`;
            const body = `Section: ${section}\n\nFeedback: ${feedback}\n\nPage: Section ${currentSection + 1}`;
            
            // Create mailto link
            const mailtoLink = `mailto:millingtond@mgs.org?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.location.href = mailtoLink;
            
            closeFeedback();
            addXP(10, 'feedback-sent');
        }

        // Prevent Pasting
        function preventPasting() {
            // Prevent paste events
            document.addEventListener('paste', function(e) {
                e.preventDefault();
                showShameMessage();
                return false;
            });
            
            // Prevent context menu
            document.addEventListener('contextmenu', function(e) {
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                    e.preventDefault();
                    return false;
                }
            });
            
            // Prevent keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if ((e.ctrlKey || e.metaKey) && (e.key === 'v' || e.key === 'V')) {
                    e.preventDefault();
                    showShameMessage();
                    return false;
                }
            });
        }

        function showShameMessage() {
            const shame = document.getElementById('shameMessage');
            shame.style.display = 'block';
            setTimeout(() => {
                shame.style.display = 'none';
            }, 3000);
        }

        // Initialize on load
        window.onload = function() {
            resetCompression();
            resetVirusScan();
        };

        // Prevent accidental navigation
        window.addEventListener('beforeunload', function(e) {
            if (xp > 0) {
                e.preventDefault();
                e.returnValue = '';
            }
        });
    </script>
</body>
</html>