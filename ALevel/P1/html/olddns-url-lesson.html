<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URLs, DNS and IP Addresses - A Level Computer Science</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #3b82f6;
            --success-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --text-color: #1f2937;
            --bg-color: #f9fafb;
            --card-bg: #ffffff;
            --border-color: #e5e7eb;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header and Navigation */
        .header {
            background-color: var(--card-bg);
            border-bottom: 2px solid var(--border-color);
            padding: 20px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .nav-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .nav-menu {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .nav-btn {
            padding: 8px 16px;
            border: none;
            background-color: var(--primary-color);
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .nav-btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-1px);
        }
        
        .nav-btn.active {
            background-color: var(--success-color);
        }
        
        /* Progress and XP */
        .progress-bar {
            background-color: var(--border-color);
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
            position: relative;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success-color), var(--primary-color));
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            padding: 0 15px;
            color: white;
            font-weight: bold;
        }
        
        .xp-display {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-weight: bold;
            color: var(--text-color);
        }
        
        /* Section Styling */
        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card {
            background-color: var(--card-bg);
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        /* Interactive Elements */
        .interactive-box {
            background-color: #f0f9ff;
            border: 2px solid #93c5fd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            margin: 5px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--secondary-color);
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-reset {
            background-color: var(--warning-color);
            color: white;
        }
        
        .input-field {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
            margin: 10px 0;
        }
        
        .input-field:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        /* Drag and Drop (Click to Match) */
        .match-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .match-item {
            padding: 15px;
            background-color: #e0f2fe;
            border: 2px solid #0ea5e9;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .match-item:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .match-item.selected {
            background-color: #fef3c7;
            border-color: #f59e0b;
        }
        
        .match-item.matched {
            background-color: #d1fae5;
            border-color: #10b981;
            cursor: default;
        }
        
        /* Achievement Popup */
        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: var(--success-color);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.5s ease;
            z-index: 1000;
        }
        
        .achievement-popup.show {
            transform: translateX(0);
        }
        
        /* Feedback Button */
        .feedback-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            transition: all 0.3s;
        }
        
        .feedback-btn:hover {
            transform: scale(1.1);
            background-color: var(--secondary-color);
        }
        
        /* Feedback Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 2000;
        }
        
        .modal-content {
            position: relative;
            background-color: white;
            margin: 10% auto;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            border-radius: 10px;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        /* Canvas for Drawing */
        .drawing-canvas {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            margin: 20px 0;
            touch-action: none;
            cursor: crosshair;
        }
        
        /* Accessibility */
        .high-contrast {
            filter: contrast(1.5);
        }
        
        .dyslexia-font {
            font-family: 'OpenDyslexic', sans-serif;
        }
        
        /* Navigation Buttons */
        .nav-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .match-container {
                grid-template-columns: 1fr;
            }
            
            .nav-menu {
                order: 2;
                width: 100%;
                justify-content: center;
            }
            
            .card {
                padding: 20px;
            }
        }
        
        /* Anti-paste styling */
        .shame-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: #dc2626;
            color: white;
            padding: 20px 40px;
            border-radius: 10px;
            font-size: 20px;
            font-weight: bold;
            display: none;
            z-index: 3000;
            animation: shake 0.5s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
            25% { transform: translate(-50%, -50%) rotate(-5deg); }
            75% { transform: translate(-50%, -50%) rotate(5deg); }
        }
        
        /* Quiz Styling */
        .quiz-option {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background-color: #f3f4f6;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
        }
        
        .quiz-option:hover {
            background-color: #e5e7eb;
            transform: translateX(5px);
        }
        
        .quiz-option.selected {
            border-color: var(--primary-color);
            background-color: #dbeafe;
        }
        
        .quiz-option.correct {
            border-color: var(--success-color);
            background-color: #d1fae5;
        }
        
        .quiz-option.incorrect {
            border-color: var(--error-color);
            background-color: #fee2e2;
        }
        
        /* Mark Scheme */
        .mark-scheme {
            display: none;
            background-color: #f0fdf4;
            border: 2px solid var(--success-color);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .mark-scheme.show {
            display: block;
        }
        
        /* Learning Outcomes */
        .learning-outcomes {
            background-color: #eff6ff;
            border-left: 4px solid var(--primary-color);
            padding: 20px;
            margin: 20px 0;
        }
        
        .learning-outcomes h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        
        .learning-outcomes ul {
            list-style-position: inside;
            margin-left: 10px;
        }
        
        /* Simulation Styles */
        .simulation-container {
            background-color: #f8fafc;
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
        }
        
        .simulation-step {
            padding: 15px;
            margin: 10px 0;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .simulation-step.active {
            background-color: #dbeafe;
            transform: scale(1.02);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
            border: 2px solid #3b82f6;
        }
        
        /* Hint System */
        .hint-button {
            background-color: var(--warning-color);
            color: white;
            padding: 5px 10px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
        }
        
        .hint-text {
            display: none;
            background-color: #fef3c7;
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-style: italic;
        }
        
        .hint-text.show {
            display: block;
        }
        
        /* NAT Simulation Styles */
        .nat-device:hover {
            transform: scale(1.05);
            background: rgba(255,255,255,0.5);
        }
        
        .nat-device.selected {
            box-shadow: 0 0 0 4px #3b82f6;
            background: rgba(255,255,255,0.8);
        }
        
        .nat-table-entry {
            transition: all 0.5s ease-in-out;
        }
        
        .nat-table-entry.highlight {
            animation: highlight-row 1.5s ease-in-out;
        }
        
        @keyframes highlight-row {
            0%, 100% { background-color: transparent; }
            50% { background-color: #fef08a; }
        }
        
        #nat-packet-info.visible {
            opacity: 1 !important;
            transform: translateX(-50%) scale(1) !important;
        }
    </style>
</head>
<body>
    <!-- Header and Navigation -->
    <header class="header">
        <div class="container">
            <div class="nav-bar">
                <h1>URLs, DNS and IP Addresses</h1>
                <div class="nav-menu">
                    <button class="nav-btn active" onclick="showSection(0)">Start</button>
                    <button class="nav-btn" onclick="showSection(1)">URLs</button>
                    <button class="nav-btn" onclick="showSection(2)">DNS</button>
                    <button class="nav-btn" onclick="showSection(3)">IP & NAT</button>
                    <button class="nav-btn" onclick="showSection(4)">Static vs Dynamic</button>
                    <button class="nav-btn" onclick="showSection(5)">Web Hosting</button>
                    <button class="nav-btn" onclick="showSection(6)">Summary</button>
                    <button class="nav-btn" onclick="showSection(7)">Exam Practice</button>
                    <button class="nav-btn" onclick="showSection(8)">Extension</button>
                </div>
            </div>
            
            <!-- Progress Bar -->
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">
                    Level <span id="currentLevel">1</span>
                </div>
                <div class="xp-display">
                    <span id="currentXP">0</span> / <span id="requiredXP">100</span> XP
                </div>
            </div>
        </div>
    </header>
    
    <!-- Main Container -->
    <div class="container">
        <!-- Section 0: Starter Activity -->
        <section class="section active" id="section0">
            <div class="card">
                <h2>Starter Activity: DNS Lookup Simulator</h2>
                <div class="learning-outcomes">
                    <h3>Learning Outcomes</h3>
                    <ul>
                        <li>Understand the structure and purpose of URLs</li>
                        <li>Explain how DNS translates domain names to IP addresses</li>
                        <li>Distinguish between public and private IP addresses</li>
                        <li>Describe Network Address Translation (NAT)</li>
                        <li>Compare static and dynamic IP addresses</li>
                        <li>Understand web hosting's role in website accessibility</li>
                    </ul>
                </div>
                
                <div class="interactive-box">
                    <h3>Try a DNS Lookup!</h3>
                    <p>Enter a domain name to see how DNS resolution works:</p>
                    <input type="text" class="input-field" id="dnsInput" placeholder="Enter a domain (e.g., www.example.com)">
                    <button class="btn btn-primary" onclick="simulateDNS()">Lookup DNS</button>
                    <button class="btn btn-reset" onclick="resetDNS()">Reset</button>
                    
                    <div id="dnsSimulation" style="margin-top: 20px;"></div>
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="btn btn-primary" disabled>Previous</button>
                <button class="btn btn-primary" onclick="showSection(1)">Next</button>
            </div>
        </section>
        
        <!-- Section 1: URL Structure -->
        <section class="section" id="section1">
 <iframe 
        width="100%" 
        height="1000px" 
        frameborder="0"
        srcdoc='
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Structure Simulator - Learn How URLs Work</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: #333;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            animation: fadeInDown 0.8s ease;
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .main-content {
            padding: 40px;
        }
        
        .url-display {
            background: #f8f9fa;
            border: 3px solid #e9ecef;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .url-preview {
            font-family: "Courier New", monospace;
            font-size: 1.5em;
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            position: relative;
            word-break: break-all;
        }
        
        .url-part {
            padding: 2px 6px;
            margin: 2px;
            border-radius: 4px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }
        
        .url-part:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 10;
        }
        
        .protocol { background: #ff6b6b; color: white; }
        .subdomain { background: #4ecdc4; color: white; }
        .domain { background: #45b7d1; color: white; }
        .port { background: #f9ca24; color: #333; }
        .path { background: #a55eea; color: white; }
        .query { background: #26de81; color: white; }
        .fragment { background: #fd79a8; color: white; }
        
        .url-builder {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
        }
        
        .builder-section {
            margin: 20px 0;
        }
        
        .builder-section h3 {
            color: #495057;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .part-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .part-option {
            padding: 12px 20px;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }
        
        .part-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .part-option.selected {
            border-color: #007bff;
            background: #e7f3ff;
            transform: scale(1.05);
        }
        
        .control-panel {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .info-card {
            background: #e3f2fd;
            border-left: 5px solid #2196f3;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }
        
        .info-card h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        
        .info-card::after {
            content: "💡";
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            opacity: 0.5;
        }
        
        .custom-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }
        
        .custom-input:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
        }
        
        @keyframes fadeInDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .bounce {
            animation: bounce 0.5s ease;
        }

        @media (max-width: 768px) {
            .container {
                margin: 0;
                border-radius: 0;
                padding: 10px;
            }
            .header h1 {
                font-size: 1.8em;
            }
            .url-preview {
                font-size: 1em;
            }
            .main-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌐 URL Structure Simulator</h1>
            <p>Deconstruct web addresses interactively!</p>
        </div>
        
        <div class="main-content">
            <div class="url-display">
                <h2>Your URL</h2>
                <div class="url-preview" id="urlPreview">
                    <span style="color: #999;">Build your URL below...</span>
                </div>
                <p id="urlStatus" style="margin-top: 10px; font-weight: bold; min-height: 24px;"></p>
            </div>
            
            <div class="url-builder" id="urlBuilder">
                <h2 style="text-align: center; margin-bottom: 30px;">🛠️ Build Your URL</h2>
                
                <div class="builder-section">
                    <h3><span class="url-part protocol">Protocol</span> - How to connect</h3>
                    <div class="info-card">
                        <h4>What is a Protocol?</h4>
                        <p>The protocol tells your browser HOW to communicate. <strong>https://</strong> is the standard for secure communication.</p>
                    </div>
                    <div class="part-options" id="protocolOptions">
                        <div class="part-option" onclick="selectPart(this, &apos;protocol&apos;, &apos;https://&apos;)">https://</div>
                        <div class="part-option" onclick="selectPart(this, &apos;protocol&apos;, &apos;http://&apos;)">http://</div>
                        <div class="part-option" onclick="selectPart(this, &apos;protocol&apos;, &apos;ftp://&apos;)">ftp://</div>
                    </div>
                </div>
                
                <div class="builder-section">
                    <h3><span class="url-part subdomain">Subdomain</span> - Section of the site (optional)</h3>
                    <div class="info-card">
                        <h4>What is a Subdomain?</h4>
                        <p>A specific section of a larger domain. 'www' is common, but others like 'blog.' or 'shop.' are also used.</p>
                    </div>
                    <div class="part-options" id="subdomainOptions">
                        <div class="part-option" onclick="selectPart(this, &apos;subdomain&apos;, &apos;www.&apos;)">www.</div>
                        <div class="part-option" onclick="selectPart(this, &apos;subdomain&apos;, &apos;blog.&apos;)">blog.</div>
                        <div class="part-option" onclick="selectPart(this, &apos;subdomain&apos;, &apos;shop.&apos;)">shop.</div>
                        <div class="part-option" onclick="selectPart(this, &apos;subdomain&apos;, &apos;&apos;)">None</div>
                    </div>
                </div>
                
                <div class="builder-section">
                    <h3><span class="url-part domain">Domain Name</span> - The website address</h3>
                    <div class="info-card">
                        <h4>What is a Domain?</h4>
                        <p>The unique, human-readable address for a website. It consists of a name and a Top-Level Domain (TLD) like .com or .co.uk.</p>
                    </div>
                    <div class="part-options" id="domainOptions">
                        <div class="part-option" onclick="selectPart(this, &apos;domain&apos;, &apos;example.com&apos;)">example.com</div>
                        <div class="part-option" onclick="selectPart(this, &apos;domain&apos;, &apos;my-school.ac.uk&apos;)">my-school.ac.uk</div>
                        <div class="part-option" onclick="selectPart(this, &apos;domain&apos;, &apos;cool-site.org&apos;)">cool-site.org</div>
                    </div>
                    <input type="text" class="custom-input" placeholder="Or type your own domain and press Enter..." id="customDomain" onkeyup="handleCustomDomain(event)">
                </div>
                
                <div class="builder-section">
                    <h3><span class="url-part port">Port</span> - The door number (optional)</h3>
                    <div class="info-card">
                        <h4>What is a Port?</h4>
                        <p>Specifies a service on the server. Default ports (80 for http, 443 for https) are usually hidden. Only specify if it’s non-standard.</p>
                    </div>
                    <div class="part-options" id="portOptions">
                        <div class="part-option" onclick="selectPart(this, &apos;port&apos;, &apos;:8080&apos;)">:8080</div>
                        <div class="part-option" onclick="selectPart(this, &apos;port&apos;, &apos;:3000&apos;)">:3000</div>
                        <div class="part-option" onclick="selectPart(this, &apos;port&apos;, &apos;&apos;)">Default (hidden)</div>
                    </div>
                </div>
                
                <div class="builder-section">
                    <h3><span class="url-part path">Path</span> - Location of the resource</h3>
                    <div class="info-card">
                        <h4>What is a Path?</h4>
                        <p>The specific location of a page or file on the server, like a folder structure on a computer.</p>
                    </div>
                    <div class="part-options" id="pathOptions">
                        <div class="part-option" onclick="selectPart(this, &apos;path&apos;, &apos;/products/laptops&apos;)">/products/laptops</div>
                        <div class="part-option" onclick="selectPart(this, &apos;path&apos;, &apos;/about-us.html&apos;)">/about-us.html</div>
                        <div class="part-option" onclick="selectPart(this, &apos;path&apos;, &apos;/&apos;)">/ (Homepage)</div>
                    </div>
                </div>

                <div class="builder-section">
                    <h3><span class="url-part query">Query</span> - Extra information (optional)</h3>
                    <div class="info-card">
                        <h4>What are Query Parameters?</h4>
                        <p>Sends data to the server, often for searches or filtering. Starts with '?' and uses '&' to separate key-value pairs.</p>
                    </div>
                    <div class="part-options" id="queryOptions">
                        <div class="part-option" onclick="selectPart(this, &apos;query&apos;, &apos;?search=laptops&apos;)">?search=laptops</div>
                        <div class="part-option" onclick="selectPart(this, &apos;query&apos;, &apos;?id=123&amp;sort=price&apos;)">?id=123&amp;sort=price</div>
                        <div class="part-option" onclick="selectPart(this, &apos;query&apos;, &apos;&apos;)">None</div>
                    </div>
                </div>

                <div class="builder-section">
                    <h3><span class="url-part fragment">Fragment</span> - Jump to section (optional)</h3>
                    <div class="info-card">
                        <h4>What is a Fragment?</h4>
                        <p>An internal page reference that tells the browser to scroll to a specific element. It starts with '#' and is not sent to the server.</p>
                    </div>
                    <div class="part-options" id="fragmentOptions">
                        <div class="part-option" onclick="selectPart(this, &apos;fragment&apos;, &apos;#reviews&apos;)">#reviews</div>
                        <div class="part-option" onclick="selectPart(this, &apos;fragment&apos;, &apos;#contact-form&apos;)">#contact-form</div>
                        <div class="part-option" onclick="selectPart(this, &apos;fragment&apos;, &apos;&apos;)">None</div>
                    </div>
                </div>
                
                <div class="control-panel">
                    <button class="btn btn-primary" onclick="validateURL()">Validate URL</button>
                    <button class="btn btn-reset" onclick="resetBuilder()">Reset</button>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        let urlParts = {
            protocol: "",
            subdomain: "",
            domain: "",
            port: "",
            path: "",
            query: "",
            fragment: ""
        };

        function selectPart(element, type, value) {
            document.querySelectorAll(`#${type}Options .part-option`).forEach(opt => {
                opt.classList.remove("selected");
            });
            
            if (element) {
                element.classList.add("selected");
            }

            urlParts[type] = value;
            updateURLPreview();
            
            const preview = document.getElementById("urlPreview");
            preview.classList.remove("bounce");
            void preview.offsetWidth; // Trigger reflow
            preview.classList.add("bounce");
        }

        function handleCustomDomain(event) {
            const value = event.target.value.trim();
            if (event.key === "Enter" && value) {
                urlParts.domain = value;
                document.querySelectorAll(`#domainOptions .part-option`).forEach(opt => {
                    opt.classList.remove("selected");
                });
                updateURLPreview();
                event.target.blur();
            }
        }

        function updateURLPreview() {
            const preview = document.getElementById("urlPreview");
            const status = document.getElementById("urlStatus");

            if (!urlParts.protocol && !urlParts.domain) {
                preview.innerHTML = `<span style="color: #999;">Build your URL below...</span>`;
                return;
            }

            let urlHTML = "";
            if (urlParts.protocol) urlHTML += `<span class="url-part protocol">${urlParts.protocol}</span>`;
            if (urlParts.subdomain) urlHTML += `<span class="url-part subdomain">${urlParts.subdomain}</span>`;
            if (urlParts.domain) urlHTML += `<span class="url-part domain">${urlParts.domain}</span>`;
            if (urlParts.port) urlHTML += `<span class="url-part port">${urlParts.port}</span>`;
            if (urlParts.path) urlHTML += `<span class="url-part path">${urlParts.path}</span>`;
            if (urlParts.query) urlHTML += `<span class="url-part query">${urlParts.query.replace(/&/g, "&amp;")}</span>`;
            if (urlParts.fragment) urlHTML += `<span class="url-part fragment">${urlParts.fragment}</span>`;
            
            preview.innerHTML = urlHTML || `<span style="color: #999;">Incomplete URL</span>`;
            status.textContent = ""; 
        }

        function validateURL() {
            const status = document.getElementById("urlStatus");
            if (!urlParts.protocol) {
                status.textContent = "❌ Missing protocol (e.g., https://)";
                status.style.color = "#dc3545";
                return;
            }
            if (!urlParts.domain) {
                status.textContent = "❌ Missing domain name (e.g., example.com)";
                status.style.color = "#dc3545";
                return;
            }
            
            status.textContent = "✅ Valid URL Structure! Well done!";
            status.style.color = "#28a745";
        }

        function resetBuilder() {
            urlParts = { protocol: "", subdomain: "", domain: "", port: "", path: "", query: "", fragment: "" };
            document.querySelectorAll(".part-option").forEach(opt => {
                opt.classList.remove("selected");
            });
            document.getElementById("customDomain").value = "";
            updateURLPreview();
        }

        document.addEventListener("DOMContentLoaded", () => {
            resetBuilder();
        });
    </script>
</body>
</html>
'></iframe>
            
            <div class="nav-controls">
                <button class="btn btn-primary" onclick="showSection(0)">Previous</button>
                <button class="btn btn-primary" onclick="showSection(2)">Next</button>
            </div>
        </section>
        
        <!-- Section 2: DNS Process -->
        <section class="section" id="section2">
            <div class="card">
                <h2>Domain Name System (DNS)</h2>
                <p>DNS servers are computers with a list of domain names and their IP addresses. Let's see how the DNS resolution process works!</p>
                
                <div class="simulation-container">
                    <h3>DNS Resolution Simulation</h3>
                    <p>Click "Start" to see how your browser finds a website's IP address:</p>
                    
                    <button class="btn btn-primary" onclick="startDNSAnimation()">Start DNS Resolution</button>
                    <button class="btn btn-reset" onclick="resetDNSAnimation()">Reset</button>
                    
                    <div id="dnsSteps" style="margin-top: 20px;">
                        <div class="simulation-step" id="step1">
                            <strong>Step 1:</strong> You type www.example.com in your browser
                        </div>
                        <div class="simulation-step" id="step2">
                            <strong>Step 2:</strong> Browser sends request to nearest DNS server
                        </div>
                        <div class="simulation-step" id="step3">
                            <strong>Step 3:</strong> DNS server checks its cache for the IP address
                        </div>
                        <div class="simulation-step" id="step4">
                            <strong>Step 4:</strong> If not found, forwards to higher-level DNS server
                        </div>
                        <div class="simulation-step" id="step5">
                            <strong>Step 5:</strong> IP address (93.184.216.34) is found and returned
                        </div>
                        <div class="simulation-step" id="step6">
                            <strong>Step 6:</strong> Browser connects to the web server using the IP
                        </div>
                    </div>
                </div>
                
                <div class="interactive-box" style="margin-top: 30px;">
                    <h3>DNS Sequencing Activity</h3>
                    <p>Put these DNS resolution steps in the correct order:</p>
                    
                    <div id="dnsSequence" style="display: flex; flex-direction: column; gap: 10px;">
                        <div class="quiz-option" data-order="3" onclick="selectSequence(this)">DNS server adds IP to cache</div>
                        <div class="quiz-option" data-order="1" onclick="selectSequence(this)">URL passed to nearest DNS server</div>
                        <div class="quiz-option" data-order="4" onclick="selectSequence(this)">IP address returned to browser</div>
                        <div class="quiz-option" data-order="2" onclick="selectSequence(this)">DNS looks for URL in database</div>
                    </div>
                    
                    <button class="btn btn-success" onclick="checkSequence()">Check Order</button>
                    <button class="btn btn-reset" onclick="resetSequence()">Reset</button>
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="btn btn-primary" onclick="showSection(1)">Previous</button>
                <button class="btn btn-primary" onclick="showSection(3)">Next</button>
            </div>
        </section>
        
        <!-- Section 3: IP Addresses & NAT -->
        <section class="section" id="section3">
            <div class="card">
                <h2>IP Addresses & Network Address Translation (NAT)</h2>
                <p>Learn about public vs private IP addresses and how NAT allows multiple devices to share a single public IP address.</p>
                
                <!-- Learning Outcomes for combined section -->
                <div class="learning-outcomes">
                    <h3>Learning Outcomes</h3>
                    <ul>
                        <li>Distinguish between public and private IP addresses</li>
                        <li>Identify private IP address ranges</li>
                        <li>Understand how NAT allows multiple devices to share one public IP</li>
                        <li>Explain how NAT uses port numbers to track connections</li>
                    </ul>
                </div>
                
                <!-- Part 1: Public vs Private IPs -->
                <div class="card" style="margin-top: 30px; background-color: #f0f9ff;">
                    <h3>Part 1: Public vs Private IP Addresses</h3>
                    <p>Each device on a network needs a unique IP address. Let's explore the differences between public and private IP addresses.</p>
                    
                    <div class="interactive-box">
                        <h3>Categorize IP Addresses</h3>
                        <p>Click each IP address and then click whether it's Public or Private:</p>
                        
                        <div id="ipAddresses" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin: 20px 0;">
                            <div class="match-item" onclick="selectIP(this)">192.168.1.1</div>
                            <div class="match-item" onclick="selectIP(this)">8.8.8.8</div>
                            <div class="match-item" onclick="selectIP(this)">10.0.0.5</div>
                            <div class="match-item" onclick="selectIP(this)">172.217.14.206</div>
                            <div class="match-item" onclick="selectIP(this)">172.16.0.1</div>
                            <div class="match-item" onclick="selectIP(this)">93.184.216.34</div>
                        </div>
                        
                        <div style="display: flex; gap: 20px; justify-content: center; margin-top: 20px;">
                            <button class="btn btn-primary" onclick="categorizeIP('private')">Private IP</button>
                            <button class="btn btn-primary" onclick="categorizeIP('public')">Public IP</button>
                        </div>
                        
                        <div id="ipResults" style="margin-top: 20px;"></div>
                        <button class="btn btn-reset" onclick="resetIPCategorization()">Reset</button>
                    </div>
                    
                    <div class="interactive-box" style="margin-top: 30px;">
                        <h3>Fill in the Blanks: IP Address Ranges</h3>
                        <p>Complete the private IP address ranges. Choose from the options provided:</p>
                        
                        <p>Private IP ranges:</p>
                        <ol>
                            <li>10.0.0.1 to <select id="range1" class="input-field" style="width: 200px;">
                                <option value="">Select...</option>
                                <option value="10.255.255.254">10.255.255.254</option>
                                <option value="10.255.255.255">10.255.255.255</option>
                                <option value="11.255.255.254">11.255.255.254</option>
                                <option value="10.254.254.254">10.254.254.254</option>
                            </select></li>
                            
                            <li>172.16.0.1 to <select id="range2" class="input-field" style="width: 200px;">
                                <option value="">Select...</option>
                                <option value="172.31.255.254">172.31.255.254</option>
                                <option value="172.32.255.254">172.32.255.254</option>
                                <option value="172.16.255.254">172.16.255.254</option>
                                <option value="173.31.255.254">173.31.255.254</option>
                            </select></li>
                            
                            <li>192.168.0.1 to <select id="range3" class="input-field" style="width: 200px;">
                                <option value="">Select...</option>
                                <option value="192.168.255.254">192.168.255.254</option>
                                <option value="192.168.254.254">192.168.254.254</option>
                                <option value="192.169.255.254">192.169.255.254</option>
                                <option value="193.168.255.254">193.168.255.254</option>
                            </select></li>
                        </ol>
                        
                        <button class="btn btn-success" onclick="checkIPRanges()">Check Answers</button>
                        <button class="btn btn-reset" onclick="resetIPRanges()">Reset</button>
                    </div>
                </div>
                
                <!-- Part 2: NAT -->
                <div class="card" style="margin-top: 30px; background-color: #fef3c7;">
                    <h3>Part 2: Network Address Translation (NAT)</h3>
                    <p>NAT allows multiple devices within a private network to share a single public IP address. Let's see how it works!</p>
                    
                    <div class="interactive-box" style="background: #f0f9ff; border: 2px solid #3b82f6; margin-bottom: 30px;">
                        <h4 style="color: #2563eb;">🤔 Why do we need NAT?</h4>
                        <ul style="margin: 10px 0;">
                            <li>Your ISP gives you only ONE public IP address</li>
                            <li>But you have MANY devices at home (phones, laptops, tablets, smart TVs...)</li>
                            <li>NAT lets all your devices share that one public IP!</li>
                        </ul>
                    </div>
                    
                    <!-- NAT Simulation -->
                    <div class="nat-sim-container" style="background: white; border-radius: 15px; padding: 20px; margin: 20px 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
                        <h4 style="text-align: center; margin-bottom: 20px;">🛡️ NAT Simulation - How Multiple Devices Share One Public IP</h4>
                        
                        <!-- Instructions -->
                        <div class="interactive-box" style="background: #e0f2fe; border-color: #3b82f6; margin-bottom: 20px;">
                            <ol style="list-style: decimal; margin-left: 20px;">
                                <li><strong>Select a Device:</strong> Click on a device in the 'Private Network' to begin</li>
                                <li><strong>Send a Request:</strong> Click the "Send Request to a Website" button</li>
                                <li><strong>Follow the Steps:</strong> Use the "Next Step" button to advance</li>
                                <li><strong>Read Explanations:</strong> Close the pop-up to watch the animation</li>
                                <li><strong>Observe the NAT Table:</strong> Watch how the router tracks connections</li>
                            </ol>
                        </div>
                        
                        <!-- Simulation Area -->
                        <div style="position: relative; min-height: 500px; background: #f8fafc; border-radius: 12px; padding: 20px;">
                            <!-- Packet -->
                            <div id="nat-packet" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); opacity: 0; transition: all 1.5s cubic-bezier(0.5, 0, 0.5, 1); z-index: 50;">
                                <div style="width: 80px; height: 60px; background: #fbbf24; border: 2px solid #f59e0b; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 32px; box-shadow: 0 8px 16px rgba(0,0,0,0.2);">✉️</div>
                                <div id="nat-packet-info" style="position: absolute; top: 100%; left: 50%; transform: translateX(-50%); margin-top: 8px; width: 200px; background: #1e293b; color: white; padding: 12px; border-radius: 8px; font-size: 11px; font-family: monospace; text-align: center; opacity: 0; transition: all 0.5s ease-in-out;"></div>
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; height: 100%;">
                                <!-- Private Network -->
                                <div id="nat-private-network" style="background: #dbeafe; border: 2px solid #3b82f6; border-radius: 12px; padding: 20px;">
                                    <h5 style="text-align: center; color: #1e40af; margin-bottom: 20px; font-weight: bold;">🏠 Private Network</h5>
                                    <div style="display: flex; flex-direction: column; gap: 20px; align-items: center;">
                                        <div id="nat-device-1" class="nat-device" style="text-align: center; cursor: pointer; padding: 10px; border-radius: 8px; transition: all 0.2s;" onclick="NAT_SIM.selectDevice(this, 'Laptop', '192.168.1.101')">
                                            <div style="font-size: 48px;">💻</div>
                                            <div style="font-weight: bold;">Laptop</div>
                                            <div style="font-size: 12px; font-family: monospace; color: #64748b;">192.168.1.101</div>
                                        </div>
                                        <div id="nat-device-2" class="nat-device" style="text-align: center; cursor: pointer; padding: 10px; border-radius: 8px; transition: all 0.2s;" onclick="NAT_SIM.selectDevice(this, 'Phone', '172.16.10.55')">
                                            <div style="font-size: 48px;">📱</div>
                                            <div style="font-weight: bold;">Phone</div>
                                            <div style="font-size: 12px; font-family: monospace; color: #64748b;">172.16.10.55</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Router -->
                                <div style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
                                    <button id="nat-send-request-btn" onclick="NAT_SIM.startSimulation()" class="btn btn-primary" style="margin-bottom: 20px;" disabled>
                                        Send Request to Website
                                    </button>
                                    <div id="nat-router" style="text-align: center;">
                                        <div style="font-size: 64px;">🛡️</div>
                                        <div style="font-weight: bold;">NAT Router</div>
                                        <div style="font-size: 12px; font-family: monospace; color: #64748b;">Public IP: <strong>82.45.110.23</strong></div>
                                    </div>
                                    <div style="width: 100%; max-width: 300px; margin-top: 20px;">
                                        <h5 style="text-align: center; font-weight: bold; margin-bottom: 10px;">NAT Table</h5>
                                        <table style="width: 100%; background: #f1f5f9; border-radius: 8px; overflow: hidden; font-size: 12px; font-family: monospace;">
                                            <thead>
                                                <tr style="background: #e2e8f0;">
                                                    <th style="padding: 8px; text-align: left;">Private IP:Port</th>
                                                    <th style="padding: 8px; text-align: left;">Public IP:Port</th>
                                                </tr>
                                            </thead>
                                            <tbody id="nat-table-body">
                                                <!-- Entries added dynamically -->
                                            </tbody>
                                        </table>
                                    </div>
                                    <div id="nat-step-controls" style="display: none; margin-top: 20px;">
                                        <button id="nat-next-step-btn" onclick="NAT_SIM.nextStep()" class="btn btn-success">Next Step →</button>
                                    </div>
                                </div>
                                
                                <!-- Public Network -->
                                <div id="nat-public-network" style="background: #fee2e2; border: 2px solid #ef4444; border-radius: 12px; padding: 20px;">
                                    <h5 style="text-align: center; color: #991b1b; margin-bottom: 20px; font-weight: bold;">☁️ The Internet</h5>
                                    <div style="display: flex; align-items: center; justify-content: center; height: calc(100% - 40px);">
                                        <div id="nat-web-server" style="text-align: center;">
                                            <div style="font-size: 56px;">🌍</div>
                                            <div style="font-weight: bold;">Web Server</div>
                                            <div style="font-size: 12px; font-family: monospace; color: #64748b;">www.cambridge.org</div>
                                            <div style="font-size: 12px; font-family: monospace; color: #64748b;">204.15.5.10</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Reset Button -->
                            <button id="nat-reset-btn" onclick="NAT_SIM.resetSimulation()" class="btn btn-reset" style="position: absolute; bottom: 10px; right: 10px;">
                                ↻ Reset
                            </button>
                        </div>
                    </div>
                    
                    <!-- NAT Popup -->
                    <div id="nat-popup-container" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 100; display: none;">
                        <div id="nat-popup" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 90%; max-width: 500px; background: white; border-radius: 15px; padding: 25px; box-shadow: 0 20px 40px rgba(0,0,0,0.3);">
                            <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                                <div id="nat-popup-icon" style="font-size: 36px;">📱</div>
                                <h3 id="nat-popup-title" style="margin: 0; color: var(--primary-color);">NAT Step</h3>
                            </div>
                            <div id="nat-popup-content" style="color: #495057; line-height: 1.6;"></div>
                            <button id="nat-popup-close-btn" onclick="NAT_SIM.closePopup()" class="btn btn-primary" style="width: 100%; margin-top: 20px;">Continue</button>
                        </div>
                    </div>
                    
                    <!-- True/False quiz -->
                    <div class="interactive-box" style="margin-top: 30px;">
                        <h3>True or False: NAT Statements</h3>
                        <p>Based on what you learned from the simulation, answer these questions:</p>
                        
                        <div id="natQuiz">
                            <div style="margin: 20px 0;">
                                <p>1. NAT allows multiple devices to share one public IP address</p>
                                <button class="quiz-option" onclick="answerTrueFalse(this, 1, true)">True</button>
                                <button class="quiz-option" onclick="answerTrueFalse(this, 1, false)">False</button>
                            </div>
                            
                            <div style="margin: 20px 0;">
                                <p>2. The web server can see all private IP addresses in your network</p>
                                <button class="quiz-option" onclick="answerTrueFalse(this, 2, true)">True</button>
                                <button class="quiz-option" onclick="answerTrueFalse(this, 2, false)">False</button>
                            </div>
                            
                            <div style="margin: 20px 0;">
                                <p>3. NAT uses port numbers to track different device connections</p>
                                <button class="quiz-option" onclick="answerTrueFalse(this, 3, true)">True</button>
                                <button class="quiz-option" onclick="answerTrueFalse(this, 3, false)">False</button>
                            </div>
                        </div>
                        
                        <button class="btn btn-reset" onclick="resetNATQuiz()">Reset</button>
                    </div>
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="btn btn-primary" onclick="showSection(2)">Previous</button>
                <button class="btn btn-primary" onclick="showSection(4)">Next</button>
            </div>
        </section>
        
        <!-- Section 4: Static vs Dynamic IP -->
        <section class="section" id="section4">
            <div class="card">
                <h2>Static vs Dynamic IP Addresses</h2>
                <p>IP addresses can be assigned statically (permanent) or dynamically (changing). Let's explore how they work!</p>
                
                <!-- Interactive Device Simulation -->
                <div class="interactive-box" style="background: linear-gradient(135deg, #f0f4ff 0%, #e8efff 100%); border: 2px solid #667eea;">
                    <h3>🖥️ Interactive Device Connection Simulation</h3>
                    <p>Click on the devices below to disconnect and reconnect them. Observe how their IP addresses behave!</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin: 30px 0;">
                        <!-- Static IP Device -->
                        <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                            <h4 style="color: #e74c3c; text-align: center; margin-bottom: 20px;">
                                🔒 Static IP Configuration
                            </h4>
                            <div id="staticSimDevice" class="device-sim" style="width: 120px; height: 80px; background: #3498db; border-radius: 8px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);" onclick="toggleSimDevice('static')">
                                Online
                            </div>
                            <div id="staticSimIP" style="background: #f8f9fa; padding: 12px; border-radius: 8px; text-align: center; font-family: monospace; font-size: 1.1em; margin-bottom: 15px; border: 2px solid #e0e0e0; transition: all 0.3s ease;">
                                IP: 192.168.1.100
                            </div>
                            <p style="text-align: center; color: #7f8c8d; font-size: 0.9em;">
                                Assigned by: Server/ISP (Manual)
                            </p>
                            <p style="text-align: center; font-size: 0.85em; color: #666; margin-top: 10px;">
                                Click device to disconnect/reconnect
                            </p>
                        </div>
                        
                        <!-- Dynamic IP Device -->
                        <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);">
                            <h4 style="color: #27ae60; text-align: center; margin-bottom: 20px;">
                                🔄 Dynamic IP Configuration
                            </h4>
                            <div id="dynamicSimDevice" class="device-sim" style="width: 120px; height: 80px; background: #3498db; border-radius: 8px; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);" onclick="toggleSimDevice('dynamic')">
                                Online
                            </div>
                            <div id="dynamicSimIP" style="background: #f8f9fa; padding: 12px; border-radius: 8px; text-align: center; font-family: monospace; font-size: 1.1em; margin-bottom: 15px; border: 2px solid #e0e0e0; transition: all 0.3s ease;">
                                IP: 192.168.1.25
                            </div>
                            <p style="text-align: center; color: #7f8c8d; font-size: 0.9em;">
                                Assigned by: DHCP Server (Auto)
                            </p>
                            <p style="text-align: center; font-size: 0.85em; color: #666; margin-top: 10px;">
                                Click device to disconnect/reconnect
                            </p>
                        </div>
                    </div>
                    
                    <div style="background: #e8efff; padding: 15px; border-radius: 8px; margin-top: 20px;">
                        <p style="margin: 0; text-align: center;">
                            <strong>💡 Key Observation:</strong> Static IPs never change, while Dynamic IPs get new addresses each time they reconnect!
                        </p>
                    </div>
                    
                    <div style="text-align: center; margin-top: 15px;">
                        <button class="btn btn-reset" onclick="resetDeviceSimulation()">Reset Devices</button>
                    </div>
                </div>
                
                <div class="interactive-box" style="margin-top: 30px;">
                    <h3>Compare and Contrast</h3>
                    <p>Click on characteristics and assign them to either Static or Dynamic IP:</p>
                    
                    <div id="ipComparison" style="display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; margin: 20px 0;">
                        <div>
                            <h4>Static IP</h4>
                            <div id="staticBox" style="min-height: 200px; background-color: #e0f2fe; border: 2px dashed #0ea5e9; border-radius: 8px; padding: 10px;"></div>
                        </div>
                        
                        <div>
                            <h4>Characteristics</h4>
                            <div id="characteristics">
                                <div class="match-item" onclick="selectCharacteristic(this)">Address never changes</div>
                                <div class="match-item" onclick="selectCharacteristic(this)">Assigned by DHCP automatically</div>
                                <div class="match-item" onclick="selectCharacteristic(this)">Better for hosting servers</div>
                                <div class="match-item" onclick="selectCharacteristic(this)">More secure from random attacks</div>
                                <div class="match-item" onclick="selectCharacteristic(this)">Requires manual configuration</div>
                                <div class="match-item" onclick="selectCharacteristic(this)">Cost-effective for most users</div>
                                <div class="match-item" onclick="selectCharacteristic(this)">No DNS updates needed</div>
                                <div class="match-item" onclick="selectCharacteristic(this)">Address changes on reconnection</div>
                            </div>
                        </div>
                        
                        <div>
                            <h4>Dynamic IP</h4>
                            <div id="dynamicBox" style="min-height: 200px; background-color: #fef3c7; border: 2px dashed #f59e0b; border-radius: 8px; padding: 10px;"></div>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="checkIPComparison()">Check Answers</button>
                    <button class="btn btn-reset" onclick="resetIPComparison()">Reset</button>
                </div>
                
                <div class="interactive-box" style="margin-top: 30px;">
                    <h3>Scenario-Based Questions</h3>
                    <p>Choose the best IP type for each scenario:</p>
                    
                    <div style="margin: 20px 0;">
                        <p>1. A small business wants to host their own email server:</p>
                        <button class="quiz-option" onclick="answerScenario(this, 1, 'static')">Static IP</button>
                        <button class="quiz-option" onclick="answerScenario(this, 1, 'dynamic')">Dynamic IP</button>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <p>2. A home user browsing social media and streaming videos:</p>
                        <button class="quiz-option" onclick="answerScenario(this, 2, 'static')">Static IP</button>
                        <button class="quiz-option" onclick="answerScenario(this, 2, 'dynamic')">Dynamic IP</button>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <p>3. A company needs reliable VPN access for remote workers:</p>
                        <button class="quiz-option" onclick="answerScenario(this, 3, 'static')">Static IP</button>
                        <button class="quiz-option" onclick="answerScenario(this, 3, 'dynamic')">Dynamic IP</button>
                    </div>
                    
                    <button class="btn btn-reset" onclick="resetScenarios()">Reset</button>
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="btn btn-primary" onclick="showSection(3)">Previous</button>
                <button class="btn btn-primary" onclick="showSection(5)">Next</button>
            </div>
        </section>
        
        <!-- Section 5: Web Hosting -->
        <section class="section" id="section5">
            <div class="card">
                <h2>Web Hosting</h2>
                <p>Web hosting provides server storage space and an IP address for your website. Let's explore how it works!</p>
                
                <div class="interactive-box">
                    <h3>Case Study: Setting Up a Website</h3>
                    <p>Sarah wants to create a website for her bakery. Read the case study and answer the questions:</p>
                    
                    <div style="background-color: #f9fafb; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <p><strong>Case Study:</strong> Sarah's Bakery needs an online presence. She has designed her website and now needs to make it accessible to customers. She purchases a domain name "sarahsbakery.com" and signs up with a web hosting provider. The hosting provider assigns her website an IP address (198.51.100.42) and provides server space for her files.</p>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <p>1. What role does the web hosting provider play?</p>
                        <textarea class="input-field" id="hostingAnswer1" rows="3" placeholder="Your answer here..."></textarea>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <p>2. How will customers access Sarah's website without knowing the IP address?</p>
                        <textarea class="input-field" id="hostingAnswer2" rows="3" placeholder="Your answer here..."></textarea>
                    </div>
                    
                    <button class="btn btn-success" onclick="checkHostingAnswers()">Submit Answers</button>
                    <button class="btn btn-reset" onclick="resetHostingAnswers()">Reset</button>
                    
                    <div class="mark-scheme" id="hostingMarkScheme">
                        <h4>Mark Scheme:</h4>
                        <p><strong>Question 1 (2 marks):</strong> The web hosting provider gives server storage space (1 mark) and assigns an IP address for the website (1 mark).</p>
                        <p><strong>Question 2 (2 marks):</strong> Customers type the domain name (1 mark) which is resolved to the IP address through DNS (1 mark).</p>
                    </div>
                </div>
                
                <div class="interactive-box" style="margin-top: 30px;">
                    <h3>Web Hosting Process</h3>
                    <p>Put these steps of accessing a hosted website in order:</p>
                    
                    <div id="hostingSequence" style="display: flex; flex-direction: column; gap: 10px;">
                        <div class="quiz-option" data-order="3" onclick="selectHostingStep(this)">Web server sends website files to browser</div>
                        <div class="quiz-option" data-order="1" onclick="selectHostingStep(this)">User types domain name in browser</div>
                        <div class="quiz-option" data-order="4" onclick="selectHostingStep(this)">Browser displays the website</div>
                        <div class="quiz-option" data-order="2" onclick="selectHostingStep(this)">DNS resolves to hosting server IP</div>
                    </div>
                    
                    <button class="btn btn-success" onclick="checkHostingSequence()">Check Order</button>
                    <button class="btn btn-reset" onclick="resetHostingSequence()">Reset</button>
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="btn btn-primary" onclick="showSection(4)">Previous</button>
                <button class="btn btn-primary" onclick="showSection(6)">Next</button>
            </div>
        </section>
        
        <!-- Section 6: Summary Quiz -->
        <section class="section" id="section6">
            <div class="card">
                <h2>Summary Quiz</h2>
                <p>Test your understanding of URLs, DNS, and IP addresses with this comprehensive quiz!</p>
                
                <div class="interactive-box">
                    <div id="summaryQuiz">
                        <!-- Question 1 -->
                        <div style="margin: 30px 0;">
                            <h4>Question 1: What does URL stand for?</h4>
                            <button class="quiz-option" onclick="answerSummary(this, 1, 'a')">Universal Resource Locator</button>
                            <button class="quiz-option" onclick="answerSummary(this, 1, 'b')">Uniform Resource Locator</button>
                            <button class="quiz-option" onclick="answerSummary(this, 1, 'c')">Unique Resource Link</button>
                            <button class="quiz-option" onclick="answerSummary(this, 1, 'd')">United Resource Locator</button>
                        </div>
                        
                        <!-- Question 2 -->
                        <div style="margin: 30px 0;">
                            <h4>Question 2: Which IP address is a private address?</h4>
                            <button class="quiz-option" onclick="answerSummary(this, 2, 'a')">8.8.8.8</button>
                            <button class="quiz-option" onclick="answerSummary(this, 2, 'b')">172.16.0.5</button>
                            <button class="quiz-option" onclick="answerSummary(this, 2, 'c')">203.0.113.1</button>
                            <button class="quiz-option" onclick="answerSummary(this, 2, 'd')">93.184.216.34</button>
                        </div>
                        
                        <!-- Question 3 -->
                        <div style="margin: 30px 0;">
                            <h4>Question 3: What is the primary purpose of DNS?</h4>
                            <button class="quiz-option" onclick="answerSummary(this, 3, 'a')">To assign IP addresses to devices</button>
                            <button class="quiz-option" onclick="answerSummary(this, 3, 'b')">To translate domain names to IP addresses</button>
                            <button class="quiz-option" onclick="answerSummary(this, 3, 'c')">To secure network connections</button>
                            <button class="quiz-option" onclick="answerSummary(this, 3, 'd')">To host website files</button>
                        </div>
                        
                        <!-- Question 4 -->
                        <div style="margin: 30px 0;">
                            <h4>Question 4: Which is NOT a benefit of static IP addresses?</h4>
                            <button class="quiz-option" onclick="answerSummary(this, 4, 'a')">Better for hosting servers</button>
                            <button class="quiz-option" onclick="answerSummary(this, 4, 'b')">No DNS updates needed</button>
                            <button class="quiz-option" onclick="answerSummary(this, 4, 'c')">Automatic configuration</button>
                            <button class="quiz-option" onclick="answerSummary(this, 4, 'd')">Reliable remote access</button>
                        </div>
                        
                        <!-- Question 5 -->
                        <div style="margin: 30px 0;">
                            <h4>Question 5: What does NAT stand for?</h4>
                            <button class="quiz-option" onclick="answerSummary(this, 5, 'a')">Network Address Translation</button>
                            <button class="quiz-option" onclick="answerSummary(this, 5, 'b')">Network Access Transfer</button>
                            <button class="quiz-option" onclick="answerSummary(this, 5, 'c')">New Address Technology</button>
                            <button class="quiz-option" onclick="answerSummary(this, 5, 'd')">Network Authentication Tool</button>
                        </div>
                        
                        <!-- Question 6 -->
                        <div style="margin: 30px 0;">
                            <h4>Question 6: Which protocol is commonly used in URLs for secure connections?</h4>
                            <button class="quiz-option" onclick="answerSummary(this, 6, 'a')">ftp://</button>
                            <button class="quiz-option" onclick="answerSummary(this, 6, 'b')">http://</button>
                            <button class="quiz-option" onclick="answerSummary(this, 6, 'c')">https://</button>
                            <button class="quiz-option" onclick="answerSummary(this, 6, 'd')">smtp://</button>
                        </div>
                        
                        <!-- Question 7 -->
                        <div style="margin: 30px 0;">
                            <h4>Question 7: Who is responsible for allocating IP addresses to domain names?</h4>
                            <button class="quiz-option" onclick="answerSummary(this, 7, 'a')">Web hosting providers</button>
                            <button class="quiz-option" onclick="answerSummary(this, 7, 'b')">Internet registries</button>
                            <button class="quiz-option" onclick="answerSummary(this, 7, 'c')">DNS servers</button>
                            <button class="quiz-option" onclick="answerSummary(this, 7, 'd')">ISPs only</button>
                        </div>
                        
                        <!-- Question 8 -->
                        <div style="margin: 30px 0;">
                            <h4>Question 8: What happens when a DNS server doesn't have the requested IP in its cache?</h4>
                            <button class="quiz-option" onclick="answerSummary(this, 8, 'a')">It returns an error message</button>
                            <button class="quiz-option" onclick="answerSummary(this, 8, 'b')">It creates a new IP address</button>
                            <button class="quiz-option" onclick="answerSummary(this, 8, 'c')">It forwards the request to a higher-level DNS server</button>
                            <button class="quiz-option" onclick="answerSummary(this, 8, 'd')">It blocks the request</button>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="showSummaryResults()">Show Results</button>
                    <button class="btn btn-reset" onclick="resetSummaryQuiz()">Reset Quiz</button>
                    
                    <div id="summaryResults" style="margin-top: 20px; display: none;">
                        <h3>Your Results:</h3>
                        <p>Score: <span id="summaryScore">0</span>/8</p>
                        <div id="summaryFeedback"></div>
                    </div>
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="btn btn-primary" onclick="showSection(5)">Previous</button>
                <button class="btn btn-primary" onclick="showSection(7)">Next</button>
            </div>
        </section>
        
        <!-- Section 7: Exam Practice -->
        <section class="section" id="section7">
            <div class="card">
                <h2>Practice Exam Questions</h2>
                <p>Try these exam-style questions. Enter your predicted marks before viewing the mark scheme.</p>
                
                <div class="interactive-box">
                    <h3>Question 1 (4 marks)</h3>
                    <p>Explain how a browser uses DNS to display a web page when a user enters a URL.</p>
                    <textarea class="input-field" id="examAnswer1" rows="6" placeholder="Your answer here..."></textarea>
                    
                    <div style="margin: 10px 0;">
                        <label>Predicted marks: </label>
                        <input type="number" id="marks1" min="0" max="4" style="width: 60px;">
                        <button class="btn btn-primary" onclick="showMarkScheme(1)">Show Mark Scheme</button>
                    </div>
                    
                    <div class="mark-scheme" id="markScheme1">
                        <h4>Mark Scheme:</h4>
                        <ul>
                            <li>URL is passed to the nearest DNS server (1 mark)</li>
                            <li>DNS server looks for the URL in its database/cache (1 mark)</li>
                            <li>If not found, forwards to higher-level DNS server (1 mark)</li>
                            <li>IP address is returned to the browser which then connects to the web server (1 mark)</li>
                        </ul>
                    </div>
                </div>
                
                <div class="interactive-box" style="margin-top: 30px;">
                    <h3>Question 2 (6 marks)</h3>
                    <p>Compare and contrast static and dynamic IP addresses. Include at least three differences in your answer.</p>
                    <textarea class="input-field" id="examAnswer2" rows="8" placeholder="Your answer here..."></textarea>
                    
                    <div style="margin: 10px 0;">
                        <label>Predicted marks: </label>
                        <input type="number" id="marks2" min="0" max="6" style="width: 60px;">
                        <button class="btn btn-primary" onclick="showMarkScheme(2)">Show Mark Scheme</button>
                    </div>
                    
                    <div class="mark-scheme" id="markScheme2">
                        <h4>Mark Scheme:</h4>
                        <p>Award 1 mark for each valid comparison (max 6):</p>
                        <ul>
                            <li>Static IP never changes vs Dynamic IP changes on reconnection</li>
                            <li>Static requires manual configuration vs Dynamic uses automatic DHCP</li>
                            <li>Static better for servers vs Dynamic better for regular users</li>
                            <li>Static allows direct access vs Dynamic requires DNS updates</li>
                            <li>Static costs more vs Dynamic is cost-effective</li>
                            <li>Static less secure (constant target) vs Dynamic more secure (changing target)</li>
                        </ul>
                    </div>
                </div>
                
                <div class="interactive-box" style="margin-top: 30px;">
                    <h3>Question 3 (3 marks)</h3>
                    <p>Describe the purpose of NAT and explain one advantage of using it.</p>
                    <textarea class="input-field" id="examAnswer3" rows="5" placeholder="Your answer here..."></textarea>
                    
                    <div style="margin: 10px 0;">
                        <label>Predicted marks: </label>
                        <input type="number" id="marks3" min="0" max="3" style="width: 60px;">
                        <button class="btn btn-primary" onclick="showMarkScheme(3)">Show Mark Scheme</button>
                    </div>
                    
                    <div class="mark-scheme" id="markScheme3">
                        <h4>Mark Scheme:</h4>
                        <ul>
                            <li>NAT allows multiple devices to share a single public IP address (1 mark)</li>
                            <li>It translates between private and public IP addresses (1 mark)</li>
                            <li>Advantage: Improves security by hiding internal network structure / Conserves public IP addresses / Reduces costs (1 mark)</li>
                        </ul>
                    </div>
                </div>
                
                <!-- Drawing Canvas for Calculations -->
                <div class="interactive-box" style="margin-top: 30px;">
                    <h3>Workspace for Calculations</h3>
                    <p>Use this canvas for any calculations or diagrams:</p>
                    <canvas id="drawingCanvas" class="drawing-canvas" width="600" height="300"></canvas>
                    <button class="btn btn-reset" onclick="clearCanvas()">Clear Canvas</button>
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="btn btn-primary" onclick="showSection(6)">Previous</button>
                <button class="btn btn-primary" onclick="showSection(8)">Next</button>
            </div>
        </section>
        
        <!-- Section 8: Extension Activities -->
        <section class="section" id="section8">
            <div class="card">
                <h2>Extension Activities</h2>
                <p>Go beyond the specification with these advanced topics!</p>
                
                <div class="interactive-box">
                    <h3>IPv6 Addressing</h3>
                    <p>Research IPv6 and explain why it was developed. What are the main differences from IPv4?</p>
                    <textarea class="input-field" rows="5" placeholder="Your research findings..."></textarea>
                </div>
                
                <div class="interactive-box" style="margin-top: 30px;">
                    <h3>DNS Security</h3>
                    <p>Investigate DNSSEC (DNS Security Extensions). How does it improve DNS security?</p>
                    <textarea class="input-field" rows="5" placeholder="Your research findings..."></textarea>
                </div>
                
                <div class="interactive-box" style="margin-top: 30px;">
                    <h3>Real-World Application</h3>
                    <p>Design a network architecture for a small business with 50 employees. Include:</p>
                    <ul>
                        <li>IP addressing scheme (public and private)</li>
                        <li>DNS configuration</li>
                        <li>Web hosting requirements</li>
                        <li>Security considerations</li>
                    </ul>
                    <textarea class="input-field" rows="10" placeholder="Your network design..."></textarea>
                    <button class="btn btn-success" onclick="saveExtension()">Save Work</button>
                </div>
                
                <div class="card" style="margin-top: 30px; background-color: #f0f9ff;">
                    <h3>Video Resources</h3>
                    <p>Watch these videos to reinforce your understanding:</p>
                    <ul>
                        <li>How DNS Works - [Video placeholder]</li>
                        <li>Understanding IP Addresses - [Video placeholder]</li>
                        <li>NAT Explained - [Video placeholder]</li>
                        <li>Web Hosting Basics - [Video placeholder]</li>
                    </ul>
                </div>
                
                <div class="card" style="margin-top: 30px; background-color: #fef3c7;">
                    <h3>Common Mistakes to Avoid</h3>
                    <ul>
                        <li>Confusing public and private IP address ranges</li>
                        <li>Forgetting that DNS caches results for efficiency</li>
                        <li>Not understanding that NAT modifies packet headers</li>
                        <li>Mixing up static and dynamic IP characteristics</li>
                        <li>Forgetting the role of Internet registries in IP allocation</li>
                    </ul>
                </div>
            </div>
            
            <div class="nav-controls">
                <button class="btn btn-primary" onclick="showSection(7)">Previous</button>
                <button class="btn btn-primary" disabled>Next</button>
            </div>
        </section>
    </div>
    
    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <h3>Achievement Unlocked!</h3>
        <p id="achievementText"></p>
    </div>
    
    <!-- Feedback Button -->
    <button class="feedback-btn" onclick="openFeedback()">?</button>
    
    <!-- Feedback Modal -->
    <div class="modal" id="feedbackModal">
        <div class="modal-content">
            <h3>Send Feedback</h3>
            <p>Found a bug or have a suggestion? Let us know!</p>
            <textarea class="input-field" id="feedbackText" rows="5" placeholder="Your feedback..."></textarea>
            <button class="btn btn-primary" onclick="sendFeedback()">Send</button>
            <button class="btn btn-reset" onclick="closeFeedback()">Cancel</button>
        </div>
    </div>
    
    <!-- Shame Message for Paste Attempt -->
    <div class="shame-message" id="shameMessage">
        🚫 No pasting allowed! Do your own work! 🚫
    </div>
    
    <!-- Accessibility Controls -->
    <div style="position: fixed; bottom: 20px; left: 20px; background-color: white; padding: 10px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
        <button class="btn btn-primary" onclick="toggleHighContrast()">High Contrast</button>
        <button class="btn btn-primary" onclick="changeFontSize(1)">A+</button>
        <button class="btn btn-primary" onclick="changeFontSize(-1)">A-</button>
    </div>
    
    <script>
        // Global Variables
        let currentSection = 0;
        let currentXP = 0;
        let currentLevel = 1;
        let achievements = new Set();
        let selectedIP = null;
        let selectedCharacteristic = null;
        let ipCategories = {};
    
        let matchedPairs = new Set();
        let selectedMatch = null;
        let sequenceOrder = [];
        let natInterval;
        let dnsInterval;
        let trueFalseAnswers = {};
        let scenarioAnswers = {};
        let summaryAnswers = {};
        let characteristicAssignments = { static: [], dynamic: [] };
        let hostingOrder = [];
        
        // Device simulation variables
        let staticSimConnected = true;
        let dynamicSimConnected = true;
        let dynamicSimCounter = 25;
        
        // XP Requirements per level
        const xpRequirements = [0, 100, 250, 450, 700, 1000];
        
        // Correct answers
        const correctAnswers = {
            trueFalse: { 1: true, 2: false, 3: true },
            scenarios: { 1: 'static', 2: 'dynamic', 3: 'static' },
            summary: { 1: 'b', 2: 'b', 3: 'b', 4: 'c', 5: 'a', 6: 'c', 7: 'b', 8: 'c' }
        };
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            preventPaste();
            initializeCanvas();
            updateProgress();
            
            // Initialize NAT simulation if elements exist
            if (document.getElementById('nat-packet')) {
                // NAT simulation is loaded when Section 3 is accessed
            }
        });
        
        // Prevent Paste
        function preventPaste() {
            document.addEventListener('paste', function(e) {
                e.preventDefault();
                showShameMessage();
                return false;
            });
            
            // Prevent right-click paste
            document.addEventListener('contextmenu', function(e) {
                if (e.target.tagName === 'TEXTAREA' || e.target.tagName === 'INPUT') {
                    e.preventDefault();
                    return false;
                }
            });
            
            // Prevent keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if ((e.ctrlKey || e.metaKey) && (e.key === 'v' || e.key === 'V')) {
                    e.preventDefault();
                    showShameMessage();
                    return false;
                }
            });
        }
        
        function showShameMessage() {
            const shame = document.getElementById('shameMessage');
            shame.style.display = 'block';
            setTimeout(() => {
                shame.style.display = 'none';
            }, 3000);
        }
        
        // Navigation
        function showSection(index) {
            const sections = document.querySelectorAll('.section');
            const navBtns = document.querySelectorAll('.nav-btn');
            
            sections.forEach(section => section.classList.remove('active'));
            navBtns.forEach(btn => btn.classList.remove('active'));
            
            sections[index].classList.add('active');
            navBtns[index].classList.add('active');
            currentSection = index;
            
            // Award XP for progression
            if (!achievements.has(`section${index}`)) {
                achievements.add(`section${index}`);
                awardXP(10, 'Section Progress');
            }
        }
        
        // XP and Achievements
        function awardXP(points, reason) {
            currentXP += points;
            updateProgress();
            
            // Check for level up
            if (currentLevel < 5 && currentXP >= xpRequirements[currentLevel]) {
                currentLevel++;
                showAchievement(`Level ${currentLevel} Reached!`);
            }
        }
        
        function updateProgress() {
            const progressBar = document.getElementById('progressBar');
            const currentXPDisplay = document.getElementById('currentXP');
            const requiredXPDisplay = document.getElementById('requiredXP');
            const levelDisplay = document.getElementById('currentLevel');
            
            currentXPDisplay.textContent = currentXP;
            requiredXPDisplay.textContent = xpRequirements[currentLevel] || 'MAX';
            levelDisplay.textContent = currentLevel;
            
            const percentage = currentLevel < 5 
                ? (currentXP - xpRequirements[currentLevel - 1]) / (xpRequirements[currentLevel] - xpRequirements[currentLevel - 1]) * 100 
                : 100;
            
            progressBar.style.width = percentage + '%';
        }
        
        function showAchievement(text) {
            const popup = document.getElementById('achievementPopup');
            const achievementText = document.getElementById('achievementText');
            
            achievementText.textContent = text;
            popup.classList.add('show');
            
            setTimeout(() => {
                popup.classList.remove('show');
            }, 3000);
        }
        
        // Section 0: DNS Simulator
        function simulateDNS() {
            const input = document.getElementById('dnsInput').value.trim();
            const simulation = document.getElementById('dnsSimulation');
            
            if (!input) {
                simulation.innerHTML = '<p style="color: var(--error-color);">Please enter a domain name!</p>';
                return;
            }
            
            const steps = [
                { delay: 0, text: `Looking up ${input}...` },
                { delay: 1000, text: 'Contacting local DNS server...' },
                { delay: 2000, text: 'Checking DNS cache...' },
                { delay: 3000, text: 'Forwarding to root DNS server...' },
                { delay: 4000, text: `Found IP address: ${generateRandomIP()}` },
                { delay: 5000, text: '✅ DNS resolution complete!' }
            ];
            
            simulation.innerHTML = '';
            steps.forEach(step => {
                setTimeout(() => {
                    const div = document.createElement('div');
                    div.className = 'simulation-step';
                    div.textContent = step.text;
                    simulation.appendChild(div);
                    
                    if (step.delay === 5000) {
                        awardXP(20, 'DNS Simulation Complete');
                    }
                }, step.delay);
            });
        }
        
        function generateRandomIP() {
            return `${Math.floor(Math.random() * 256)}.${Math.floor(Math.random() * 256)}.${Math.floor(Math.random() * 256)}.${Math.floor(Math.random() * 256)}`;
        }
        
        function resetDNS() {
            document.getElementById('dnsInput').value = '';
            document.getElementById('dnsSimulation').innerHTML = '';
        }
        
        // Section 1: URL Builder
        function selectURLPart(element) {
            if (element.classList.contains('matched')) return;
            
            urlParts.push({
                text: element.textContent,
                type: element.dataset.part
            });
            
            element.classList.add('matched');
            updateBuiltURL();
        }
        
        function updateBuiltURL() {
            const display = document.getElementById('builtURL');
            display.textContent = urlParts.map(part => part.text).join('');
        }
        
        function checkURL() {
            const built = urlParts.map(part => part.text).join('');
            const validURLs = [
                'http://www.example.com/index.html',
                'http://blog.www.example.com/index.html',
                'http://www.example.com:8080/index.html',
                'http://www.example.com/index.html?page=1'
            ];
            
            if (validURLs.includes(built)) {
                showAchievement('URL Master!');
                awardXP(30, 'Correct URL Built');
            } else {
                alert('Not quite right. Remember: protocol://domain/path');
            }
        }
        
        function resetURLBuilder() {
            urlParts = [];
            document.querySelectorAll('#urlBuilder .match-item').forEach(item => {
                item.classList.remove('matched');
            });
            document.getElementById('builtURL').textContent = '';
        }
        
        // URL Matching
        function matchComponent(element) {
            if (element.classList.contains('matched')) return;
            
            if (!selectedMatch) {
                selectedMatch = element;
                element.classList.add('selected');
            } else {
                if (selectedMatch.dataset.match === element.dataset.match && selectedMatch !== element) {
                    selectedMatch.classList.add('matched');
                    element.classList.add('matched');
                    selectedMatch.classList.remove('selected');
                    matchedPairs.add(selectedMatch.dataset.match);
                    
                    if (matchedPairs.size === 4) {
                        awardXP(25, 'All Components Matched');
                    }
                } else {
                    selectedMatch.classList.remove('selected');
                }
                selectedMatch = null;
            }
        }
        
        function resetMatching() {
            matchedPairs.clear();
            selectedMatch = null;
            document.querySelectorAll('#urlMatching .match-item').forEach(item => {
                item.classList.remove('matched', 'selected');
            });
        }
        
        // Section 2: DNS Animation
        function startDNSAnimation() {
            const steps = document.querySelectorAll('#dnsSteps .simulation-step');
            let currentStep = 0;
            
            steps.forEach(step => step.classList.remove('active'));
            
            dnsInterval = setInterval(() => {
                if (currentStep < steps.length) {
                    steps[currentStep].classList.add('active');
                    currentStep++;
                } else {
                    clearInterval(dnsInterval);
                    awardXP(20, 'DNS Process Understood');
                }
            }, 1500);
        }
        
        function resetDNSAnimation() {
            if (dnsInterval) clearInterval(dnsInterval);
            document.querySelectorAll('#dnsSteps .simulation-step').forEach(step => {
                step.classList.remove('active');
            });
        }
        
        // DNS Sequencing
        function selectSequence(element) {
            if (element.classList.contains('selected')) {
                element.classList.remove('selected');
                sequenceOrder = sequenceOrder.filter(el => el !== element);
            } else {
                element.classList.add('selected');
                sequenceOrder.push(element);
            }
        }
        
        function checkSequence() {
            const correct = sequenceOrder.every((el, index) => {
                return parseInt(el.dataset.order) === index + 1;
            });
            
            if (correct && sequenceOrder.length === 4) {
                awardXP(30, 'DNS Sequence Correct');
                sequenceOrder.forEach(el => el.classList.add('correct'));
            } else {
                alert('Not quite right. Think about the logical flow of DNS resolution.');
                sequenceOrder.forEach(el => el.classList.add('incorrect'));
            }
        }
        
        function resetSequence() {
            sequenceOrder = [];
            document.querySelectorAll('#dnsSequence .quiz-option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
            });
        }
        
        // Section 3: IP Address Categorization
        function selectIP(element) {
            if (selectedIP) selectedIP.classList.remove('selected');
            selectedIP = element;
            element.classList.add('selected');
        }
        
        function categorizeIP(type) {
            if (!selectedIP) {
                alert('Please select an IP address first!');
                return;
            }
            
            const ip = selectedIP.textContent;
            ipCategories[ip] = type;
            
            const privateIPs = ['192.168.1.1', '10.0.0.5', '172.16.0.1'];
            const isCorrect = (privateIPs.includes(ip) && type === 'private') || 
                             (!privateIPs.includes(ip) && type === 'public');
            
            if (isCorrect) {
                selectedIP.style.backgroundColor = '#d1fae5';
                selectedIP.classList.add('matched');
                awardXP(10, 'IP Correctly Categorized');
            } else {
                selectedIP.style.backgroundColor = '#fee2e2';
            }
            
            selectedIP.classList.remove('selected');
            selectedIP = null;
            
            updateIPResults();
        }
        
        function updateIPResults() {
            const results = document.getElementById('ipResults');
            const categorized = Object.keys(ipCategories).length;
            results.innerHTML = `<p>Categorized: ${categorized}/6</p>`;
            
            if (categorized === 6) {
                const correct = Object.entries(ipCategories).filter(([ip, type]) => {
                    const privateIPs = ['192.168.1.1', '10.0.0.5', '172.16.0.1'];
                    return (privateIPs.includes(ip) && type === 'private') || 
                           (!privateIPs.includes(ip) && type === 'public');
                }).length;
                
                results.innerHTML += `<p>Correct: ${correct}/6</p>`;
                if (correct === 6) {
                    showAchievement('IP Expert!');
                }
            }
        }
        
        function resetIPCategorization() {
            ipCategories = {};
            selectedIP = null;
            document.querySelectorAll('#ipAddresses .match-item').forEach(item => {
                item.classList.remove('selected', 'matched');
                item.style.backgroundColor = '';
            });
            document.getElementById('ipResults').innerHTML = '';
        }
        
        // IP Ranges Check
        function checkIPRanges() {
            const range1 = document.getElementById('range1').value;
            const range2 = document.getElementById('range2').value;
            const range3 = document.getElementById('range3').value;
            
            let correct = 0;
            if (range1 === '10.255.255.254') correct++;
            if (range2 === '172.31.255.254') correct++;
            if (range3 === '192.168.255.254') correct++;
            
            if (correct === 3) {
                awardXP(30, 'IP Ranges Mastered');
                alert('Perfect! You know your private IP ranges!');
            } else {
                alert(`${correct}/3 correct. Review the private IP address ranges.`);
            }
        }
        
        function resetIPRanges() {
            document.getElementById('range1').value = '';
            document.getElementById('range2').value = '';
            document.getElementById('range3').value = '';
        }
        
        // Section 4: NAT Simulation
        const NAT_SIM = (() => {
            const state = {
                selectedDevice: null,
                currentStepIndex: -1,
                simulationRunning: false,
                isAnimating: false,
                natTable: {},
                currentTranslation: null,
                nextPort: 49152,
                resolvePopup: null,
            };
            
            const DOM = {
                packet: null,
                packetInfo: null,
                natTableBody: null,
                sendRequestBtn: null,
                stepControls: null,
                nextStepBtn: null,
                resetBtn: null,
                popupContainer: null,
                popup: null,
                popupIcon: null,
                popupTitle: null,
                popupContent: null,
                popupCloseBtn: null,
            };
            
            // Initialize DOM elements when NAT section is accessed
            function initDOM() {
                DOM.packet = document.getElementById('nat-packet');
                DOM.packetInfo = document.getElementById('nat-packet-info');
                DOM.natTableBody = document.getElementById('nat-table-body');
                DOM.sendRequestBtn = document.getElementById('nat-send-request-btn');
                DOM.stepControls = document.getElementById('nat-step-controls');
                DOM.nextStepBtn = document.getElementById('nat-next-step-btn');
                DOM.resetBtn = document.getElementById('nat-reset-btn');
                DOM.popupContainer = document.getElementById('nat-popup-container');
                DOM.popup = document.getElementById('nat-popup');
                DOM.popupIcon = document.getElementById('nat-popup-icon');
                DOM.popupTitle = document.getElementById('nat-popup-title');
                DOM.popupContent = document.getElementById('nat-popup-content');
                DOM.popupCloseBtn = document.getElementById('nat-popup-close-btn');
                
                if (DOM.sendRequestBtn) DOM.sendRequestBtn.disabled = true;
                if (DOM.popupCloseBtn) DOM.popupCloseBtn.addEventListener('click', () => closePopup());
            }
            
            const PUBLIC_IP = '82.45.110.23';
            const SERVER_IP = '204.15.5.10';
            
            const STEPS = [
                {
                    id: 'createAndSend',
                    title: 'Step 1: Create & Send Packet',
                    icon: '📱',
                    content: (t) => `The packet is created with a <strong style='color: #3b82f6'>Private IP</strong> as its source.
                    <div style='margin-top: 10px; padding: 12px; background: #f1f5f9; border-radius: 8px;'>
                        <strong>Private IP Address (${t.privateIP})</strong>
                        <ul style='list-style: disc; margin-left: 20px; margin-top: 8px;'>
                            <li>Only works inside your network</li>
                            <li>Cannot be reached from the internet</li>
                            <li>Common ranges: 192.168.x.x, 172.16.x.x, 10.x.x.x</li>
                        </ul>
                    </div>`,
                    execute: async (t) => {
                        updatePacketInfo(`${t.privateIP}:${t.privatePort}`, `${SERVER_IP}:443`, 'Leaving device');
                        await movePacket(state.selectedDevice.element, document.getElementById('nat-router'));
                    }
                },
                {
                    id: 'performNAT',
                    title: 'Step 2: Perform NAT',
                    icon: '🛡️',
                    content: (t) => `The router performs <strong>Port Address Translation (PAT)</strong>, replacing the private source IP with its <strong style='color: #ef4444'>Public IP</strong>.
                    <div style='margin-top: 10px; padding: 12px; background: #f1f5f9; border-radius: 8px;'>
                        <strong>Public IP Address (${PUBLIC_IP})</strong>
                        <ul style='list-style: disc; margin-left: 20px; margin-top: 8px;'>
                            <li>Globally unique address from ISP</li>
                            <li>Reachable from anywhere on internet</li>
                            <li>NAT table maps this back to private IP</li>
                        </ul>
                    </div>`,
                    execute: async (t) => {
                        renderNatTable();
                        const row = document.querySelector(`#nat-table-body tr:last-child`);
                        if (row) row.classList.add('highlight');
                        updatePacketInfo(`${t.publicIP}:${t.publicPort}`, `${SERVER_IP}:443`, 'Translated & Forwarded');
                    }
                },
                {
                    id: 'toWebServer',
                    title: 'Step 3: Travel to Server',
                    icon: '✈️',
                    content: () => `The modified packet, now with a public source IP, travels across the internet to the destination web server.`,
                    execute: async () => {
                        await movePacket(document.getElementById('nat-router'), document.getElementById('nat-web-server'));
                    }
                },
                {
                    id: 'serverResponse',
                    title: 'Step 4: Server Responds',
                    icon: '🌍',
                    content: () => `The server receives the request from <strong style='color: #ef4444'>${PUBLIC_IP}</strong>. It has no knowledge of the original device's private IP. It creates a response packet and sends it back.`,
                    execute: async (t) => {
                        updatePacketInfo(`${SERVER_IP}:443`, `${t.publicIP}:${t.publicPort}`, 'Server responding');
                    }
                },
                {
                    id: 'responseToRouter',
                    title: 'Step 5: Return to Router',
                    icon: '↩️',
                    content: () => `The response packet travels back across the internet to the NAT router's public IP address.`,
                    execute: async () => {
                        await movePacket(document.getElementById('nat-web-server'), document.getElementById('nat-router'));
                    }
                },
                {
                    id: 'reverseNAT',
                    title: 'Step 6: Perform Reverse NAT',
                    icon: '🔍',
                    content: (t) => `The router receives the response. It checks the destination port (<strong style='color: #ef4444'>${t.publicPort}</strong>) in its NAT table to find the matching internal device.`,
                    execute: async (t) => {
                        const row = document.querySelector(`#nat-table-body tr:last-child`);
                        if (row) row.classList.add('highlight');
                        updatePacketInfo(`${SERVER_IP}:443`, `${t.privateIP}:${t.privatePort}`, 'Reverse Translated');
                    }
                },
                {
                    id: 'responseToDevice',
                    title: 'Step 7: Deliver to Device',
                    icon: '📦',
                    content: () => `The router forwards the final packet to the correct device on the private network.`,
                    execute: async () => {
                        await movePacket(document.getElementById('nat-router'), state.selectedDevice.element);
                    }
                },
                {
                    id: 'finish',
                    title: 'Step 8: Process Complete',
                    icon: '✅',
                    content: () => `The response has reached the original device. The NAT process is complete!`,
                    execute: async () => {
                        DOM.packet.style.opacity = '0';
                        DOM.packetInfo.classList.remove('visible');
                        resetUIForNewSession();
                        
                        // Award XP for completing NAT simulation
                        if (!achievements.has('natSimCompleted')) {
                            achievements.add('natSimCompleted');
                            awardXP(50, 'NAT Simulation Completed');
                            showAchievement('NAT Expert!');
                        }
                    }
                },
            ];
            
            function selectDevice(element, name, ip) {
                if (!DOM.packet) initDOM(); // Initialize DOM if not already done
                if (state.simulationRunning) return;
                document.querySelectorAll('.nat-device').forEach(el => el.classList.remove('selected'));
                element.classList.add('selected');
                state.selectedDevice = { element, name, ip };
                DOM.sendRequestBtn.disabled = false;
                
                // Award XP for selecting device
                awardXP(5, 'Device Selected');
            }
            
            function startSimulation() {
                if (!DOM.packet) initDOM(); // Initialize DOM if not already done
                if (!state.selectedDevice || state.simulationRunning) return;
                
                state.simulationRunning = true;
                updateButtonStates();
                
                const sourcePort = state.nextPort++;
                state.currentTranslation = {
                    privateIP: state.selectedDevice.ip,
                    privatePort: sourcePort,
                    publicIP: PUBLIC_IP,
                    publicPort: sourcePort,
                };
                
                state.natTable[state.currentTranslation.privateIP + ':' + state.currentTranslation.privatePort] = state.currentTranslation;
                
                state.currentStepIndex = 0;
                DOM.stepControls.style.display = 'block';
                runCurrentStep();
                
                // Award XP for starting
                awardXP(10, 'NAT Simulation Started');
            }
            
            function nextStep() {
                if (!DOM.packet) initDOM(); // Initialize DOM if not already done
                if (state.isAnimating || state.currentStepIndex >= STEPS.length - 1) return;
                state.currentStepIndex++;
                runCurrentStep();
            }
            
            async function runCurrentStep() {
                state.isAnimating = true;
                updateButtonStates();
                
                const step = STEPS[state.currentStepIndex];
                if (!step) {
                    state.isAnimating = false;
                    updateButtonStates();
                    return;
                }
                
                const popupClosed = new Promise(resolve => state.resolvePopup = resolve);
                showPopup(step.icon, step.title, step.content(state.currentTranslation));
                await popupClosed;
                
                await step.execute(state.currentTranslation);
                
                state.isAnimating = false;
                updateButtonStates();
                
                // Award XP for each step
                awardXP(10, 'NAT Step Completed');
            }
            
            function updateButtonStates() {
                if (!DOM.sendRequestBtn) return;
                DOM.sendRequestBtn.disabled = state.simulationRunning || !state.selectedDevice;
                DOM.resetBtn.disabled = state.isAnimating;
                DOM.nextStepBtn.disabled = state.isAnimating || !state.simulationRunning || state.currentStepIndex >= STEPS.length - 1;
            }
            
            function showPopup(icon, title, content) {
                if (!DOM.popupIcon) return;
                DOM.popupIcon.textContent = icon;
                DOM.popupTitle.textContent = title;
                DOM.popupContent.innerHTML = content;
                DOM.popupContainer.style.display = 'block';
            }
            
            function closePopup() {
                if (!DOM.popupContainer) return;
                DOM.popupContainer.style.display = 'none';
                if (state.resolvePopup) {
                    state.resolvePopup();
                    state.resolvePopup = null;
                }
            }
            
            function updatePacketInfo(source, dest, status) {
                if (!DOM.packetInfo) return;
                DOM.packetInfo.innerHTML = `
                    <div><span style="color: #86efac">SRC:</span> ${source}</div>
                    <div><span style="color: #fca5a5">DST:</span> ${dest}</div>
                    <div style="padding-top: 4px; margin-top: 4px; border-top: 1px solid #64748b"><span style="color: #fde047">Status:</span> ${status}</div>
                `;
                DOM.packetInfo.classList.add('visible');
            }
            
            async function movePacket(fromEl, toEl) {
                if (!DOM.packet) return;
                const fromRect = fromEl.getBoundingClientRect();
                const toRect = toEl.getBoundingClientRect();
                const container = DOM.packet.parentElement.getBoundingClientRect();
                
                DOM.packet.style.transition = 'none';
                DOM.packet.style.left = `${fromRect.left - container.left + fromRect.width / 2 - 40}px`;
                DOM.packet.style.top = `${fromRect.top - container.top + fromRect.height / 2 - 30}px`;
                DOM.packet.style.opacity = '1';
                
                await new Promise(r => setTimeout(r, 50));
                
                DOM.packet.style.transition = 'all 1.5s cubic-bezier(0.5, 0, 0.5, 1)';
                DOM.packet.style.left = `${toRect.left - container.left + toRect.width / 2 - 40}px`;
                DOM.packet.style.top = `${toRect.top - container.top + toRect.height / 2 - 30}px`;
                
                await new Promise(r => setTimeout(r, 1500));
            }
            
            function renderNatTable() {
                if (!DOM.natTableBody) return;
                DOM.natTableBody.innerHTML = '';
                for(const key in state.natTable) {
                    const entry = state.natTable[key];
                    const row = document.createElement('tr');
                    row.className = 'nat-table-entry';
                    row.innerHTML = `
                        <td style="padding: 8px;">${entry.privateIP}:${entry.privatePort}</td>
                        <td style="padding: 8px;">${entry.publicIP}:${entry.publicPort}</td>
                    `;
                    DOM.natTableBody.appendChild(row);
                }
            }
            
            function resetUIForNewSession() {
                state.simulationRunning = false;
                state.currentStepIndex = -1;
                if (DOM.stepControls) DOM.stepControls.style.display = 'none';
                if (DOM.sendRequestBtn) DOM.sendRequestBtn.disabled = state.selectedDevice ? false : true;
                document.querySelectorAll('.nat-table-entry.highlight').forEach(el => el.classList.remove('highlight'));
                updateButtonStates();
            }
            
            function resetSimulation() {
                if (!DOM.packet) initDOM(); // Initialize DOM if not already done
                Object.assign(state, {
                    selectedDevice: null,
                    currentStepIndex: -1,
                    simulationRunning: false,
                    isAnimating: false,
                    natTable: {},
                    currentTranslation: null,
                    nextPort: 49152,
                    resolvePopup: null,
                });
                
                document.querySelectorAll('.nat-device.selected').forEach(el => el.classList.remove('selected'));
                resetUIForNewSession();
                if (DOM.packet) DOM.packet.style.opacity = '0';
                if (DOM.packetInfo) DOM.packetInfo.classList.remove('visible');
                renderNatTable();
                closePopup();
            }
            
            function init() {
                return {
                    selectDevice,
                    startSimulation,
                    nextStep,
                    resetSimulation,
                    closePopup
                };
            }
            
            return init();
        })();
        
        // True/False Questions
        function answerTrueFalse(button, question, answer) {
            const buttons = button.parentElement.querySelectorAll('.quiz-option');
            buttons.forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
            
            trueFalseAnswers[question] = answer;
            
            if (answer === correctAnswers.trueFalse[question]) {
                button.classList.add('correct');
                awardXP(10, 'Correct Answer');
            } else {
                button.classList.add('incorrect');
            }
        }
        
        function resetNATQuiz() {
            trueFalseAnswers = {};
            document.querySelectorAll('#natQuiz .quiz-option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
            });
        }
        
        // Section 5: Static vs Dynamic IP
        // Device Simulation Functions
        function toggleSimDevice(type) {
            const device = document.getElementById(type + 'SimDevice');
            const ipDisplay = document.getElementById(type + 'SimIP');
            
            if (type === 'static') {
                if (staticSimConnected) {
                    device.classList.add('device-offline');
                    device.textContent = 'Offline';
                    device.style.background = '#95a5a6';
                    staticSimConnected = false;
                } else {
                    device.classList.remove('device-offline');
                    device.textContent = 'Online';
                    device.style.background = '#3498db';
                    staticSimConnected = true;
                    // Static IP remains the same - just highlight it
                    ipDisplay.classList.add('ip-highlight');
                    setTimeout(() => {
                        ipDisplay.classList.remove('ip-highlight');
                    }, 600);
                }
            } else {
                if (dynamicSimConnected) {
                    device.classList.add('device-offline');
                    device.textContent = 'Offline';
                    device.style.background = '#95a5a6';
                    dynamicSimConnected = false;
                } else {
                    device.classList.remove('device-offline');
                    device.textContent = 'Online';
                    device.style.background = '#3498db';
                    dynamicSimConnected = true;
                    // Dynamic IP changes to a new address
                    dynamicSimCounter = Math.floor(Math.random() * 200) + 10;
                    ipDisplay.classList.add('ip-highlight');
                    ipDisplay.textContent = `IP: 192.168.1.${dynamicSimCounter}`;
                    setTimeout(() => {
                        ipDisplay.classList.remove('ip-highlight');
                    }, 600);
                    
                    // Award XP for discovering dynamic behavior
                    if (!achievements.has('dynamicDiscovery')) {
                        achievements.add('dynamicDiscovery');
                        awardXP(15, 'Dynamic IP Discovery');
                        showAchievement('Dynamic Behavior Observed!');
                    }
                }
            }
        }
        
        function resetDeviceSimulation() {
            // Reset static device
            document.getElementById('staticSimDevice').classList.remove('device-offline');
            document.getElementById('staticSimDevice').textContent = 'Online';
            document.getElementById('staticSimDevice').style.background = '#3498db';
            document.getElementById('staticSimIP').textContent = 'IP: 192.168.1.100';
            document.getElementById('staticSimIP').classList.remove('ip-highlight');
            staticSimConnected = true;
            
            // Reset dynamic device
            document.getElementById('dynamicSimDevice').classList.remove('device-offline');
            document.getElementById('dynamicSimDevice').textContent = 'Online';
            document.getElementById('dynamicSimDevice').style.background = '#3498db';
            document.getElementById('dynamicSimIP').textContent = 'IP: 192.168.1.25';
            document.getElementById('dynamicSimIP').classList.remove('ip-highlight');
            dynamicSimConnected = true;
            dynamicSimCounter = 25;
        }
        
        // IP Comparison Functions
        function selectCharacteristic(element) {
            if (selectedCharacteristic) selectedCharacteristic.classList.remove('selected');
            selectedCharacteristic = element;
            element.classList.add('selected');
        }
        
        function assignToStatic() {
            if (!selectedCharacteristic) return;
            assignCharacteristic('static');
        }
        
        function assignToDynamic() {
            if (!selectedCharacteristic) return;
            assignCharacteristic('dynamic');
        }
        
        // Add event listeners for the boxes
        document.addEventListener('DOMContentLoaded', function() {
            const staticBox = document.getElementById('staticBox');
            const dynamicBox = document.getElementById('dynamicBox');
            
            if (staticBox) {
                staticBox.addEventListener('click', function() {
                    if (selectedCharacteristic && !selectedCharacteristic.classList.contains('matched')) {
                        assignCharacteristic('static');
                    }
                });
            }
            
            if (dynamicBox) {
                dynamicBox.addEventListener('click', function() {
                    if (selectedCharacteristic && !selectedCharacteristic.classList.contains('matched')) {
                        assignCharacteristic('dynamic');
                    }
                });
            }
        });
        
        function assignCharacteristic(type) {
            if (!selectedCharacteristic || selectedCharacteristic.classList.contains('matched')) return;
            
            const text = selectedCharacteristic.textContent;
            const box = document.getElementById(type + 'Box');
            
            const item = document.createElement('div');
            item.className = 'match-item matched';
            item.style.margin = '5px';
            item.textContent = text;
            box.appendChild(item);
            
            characteristicAssignments[type].push(text);
            selectedCharacteristic.classList.add('matched');
            selectedCharacteristic.classList.remove('selected');
            selectedCharacteristic = null;
        }
        
        function checkIPComparison() {
            const correctStatic = ['Address never changes', 'Better for hosting servers', 'Requires manual configuration', 'No DNS updates needed'];
            const correctDynamic = ['Assigned by DHCP automatically', 'More secure from random attacks', 'Cost-effective for most users', 'Address changes on reconnection'];
            
            let staticCorrect = 0;
            let dynamicCorrect = 0;
            
            characteristicAssignments.static.forEach(char => {
                if (correctStatic.includes(char)) staticCorrect++;
            });
            
            characteristicAssignments.dynamic.forEach(char => {
                if (correctDynamic.includes(char)) dynamicCorrect++;
            });
            
            const total = staticCorrect + dynamicCorrect;
            alert(`You got ${total}/8 characteristics correct!`);
            
            if (total === 8) {
                awardXP(40, 'Perfect IP Comparison');
                showAchievement('IP Classification Master!');
            } else if (total >= 6) {
                awardXP(25, 'Good IP Comparison');
            }
        }
        
        function resetIPComparison() {
            characteristicAssignments = { static: [], dynamic: [] };
            selectedCharacteristic = null;
            document.getElementById('staticBox').innerHTML = '';
            document.getElementById('dynamicBox').innerHTML = '';
            document.querySelectorAll('#characteristics .match-item').forEach(item => {
                item.classList.remove('selected', 'matched');
            });
            
            // Reset device simulation
            document.getElementById('staticSimDevice').classList.remove('device-offline');
            document.getElementById('staticSimDevice').textContent = 'Online';
            document.getElementById('staticSimDevice').style.background = '#3498db';
            document.getElementById('staticSimIP').textContent = 'IP: 192.168.1.100';
            staticSimConnected = true;
            
            document.getElementById('dynamicSimDevice').classList.remove('device-offline');
            document.getElementById('dynamicSimDevice').textContent = 'Online';
            document.getElementById('dynamicSimDevice').style.background = '#3498db';
            document.getElementById('dynamicSimIP').textContent = 'IP: 192.168.1.25';
            dynamicSimConnected = true;
            dynamicSimCounter = 25;
        }
        
        // Scenario Questions
        function answerScenario(button, question, answer) {
            const buttons = button.parentElement.querySelectorAll('.quiz-option');
            buttons.forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
            
            scenarioAnswers[question] = answer;
            
            if (answer === correctAnswers.scenarios[question]) {
                button.classList.add('correct');
                awardXP(15, 'Scenario Correct');
            } else {
                button.classList.add('incorrect');
            }
        }
        
        function resetScenarios() {
            scenarioAnswers = {};
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
            });
        }
        
        // Section 6: Web Hosting
        function checkHostingAnswers() {
            const answer1 = document.getElementById('hostingAnswer1').value.trim();
            const answer2 = document.getElementById('hostingAnswer2').value.trim();
            
            if (answer1.length < 30 || answer2.length < 30) {
                alert('Please provide more detailed answers before viewing the mark scheme.');
                return;
            }
            
            document.getElementById('hostingMarkScheme').classList.add('show');
            
            // Award XP based on keywords
            let xp = 0;
            const keywords1 = ['storage', 'space', 'server', 'IP', 'address'];
            const keywords2 = ['domain', 'DNS', 'name', 'type', 'resolution'];
            
            keywords1.forEach(keyword => {
                if (answer1.toLowerCase().includes(keyword)) xp += 5;
            });
            
            keywords2.forEach(keyword => {
                if (answer2.toLowerCase().includes(keyword)) xp += 5;
            });
            
            awardXP(xp, 'Web Hosting Understanding');
        }
        
        function resetHostingAnswers() {
            document.getElementById('hostingAnswer1').value = '';
            document.getElementById('hostingAnswer2').value = '';
            document.getElementById('hostingMarkScheme').classList.remove('show');
        }
        
        // Hosting Sequence
        function selectHostingStep(element) {
            if (element.classList.contains('selected')) {
                element.classList.remove('selected');
                hostingOrder = hostingOrder.filter(el => el !== element);
            } else {
                element.classList.add('selected');
                hostingOrder.push(element);
            }
        }
        
        function checkHostingSequence() {
            const correct = hostingOrder.every((el, index) => {
                return parseInt(el.dataset.order) === index + 1;
            });
            
            if (correct && hostingOrder.length === 4) {
                awardXP(25, 'Hosting Sequence Correct');
                hostingOrder.forEach(el => el.classList.add('correct'));
            } else {
                alert('Not quite right. Think about the order of events.');
                hostingOrder.forEach(el => el.classList.add('incorrect'));
            }
        }
        
        function resetHostingSequence() {
            hostingOrder = [];
            document.querySelectorAll('#hostingSequence .quiz-option').forEach(option => {
                option.classList.remove('selected', 'correct', 'incorrect');
            });
        }
        
        // Section 7: Summary Quiz
        function answerSummary(button, question, answer) {
            const buttons = button.parentElement.querySelectorAll('.quiz-option');
            buttons.forEach(btn => btn.classList.remove('selected'));
            button.classList.add('selected');
            
            summaryAnswers[question] = answer;
        }
        
        function showSummaryResults() {
            let correct = 0;
            Object.entries(summaryAnswers).forEach(([question, answer]) => {
                if (answer === correctAnswers.summary[question]) {
                    correct++;
                }
            });
            
            document.getElementById('summaryScore').textContent = correct;
            document.getElementById('summaryResults').style.display = 'block';
            
            const feedback = document.getElementById('summaryFeedback');
            if (correct === 8) {
                feedback.innerHTML = '<p style="color: var(--success-color);">Perfect score! You\'ve mastered this topic!</p>';
                awardXP(80, 'Perfect Summary Quiz');
                showAchievement('Quiz Champion!');
            } else if (correct >= 6) {
                feedback.innerHTML = '<p style="color: var(--success-color);">Good job! Review the questions you missed.</p>';
                awardXP(50, 'Good Summary Score');
            } else {
                feedback.innerHTML = '<p style="color: var(--warning-color);">Keep studying! Review the lesson and try again.</p>';
                awardXP(20, 'Summary Attempt');
            }
        }
        
        function resetSummaryQuiz() {
            summaryAnswers = {};
            document.querySelectorAll('#summaryQuiz .quiz-option').forEach(option => {
                option.classList.remove('selected');
            });
            document.getElementById('summaryResults').style.display = 'none';
        }
        
        // Section 8: Exam Practice
        function showMarkScheme(question) {
            const answer = document.getElementById(`examAnswer${question}`).value;
            const marks = document.getElementById(`marks${question}`).value;
            
            if (!marks || answer.length < 50) {
                alert('Please enter your predicted marks and provide a substantial answer first.');
                return;
            }
            
            document.getElementById(`markScheme${question}`).classList.add('show');
            awardXP(20, 'Exam Practice');
        }
        
        // Drawing Canvas
        function initializeCanvas() {
            const canvas = document.getElementById('drawingCanvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            let isDrawing = false;
            
            function getCoordinates(e) {
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                return { x, y };
            }
            
            function startDrawing(e) {
                isDrawing = true;
                const coords = getCoordinates(e);
                ctx.beginPath();
                ctx.moveTo(coords.x, coords.y);
            }
            
            function draw(e) {
                if (!isDrawing) return;
                e.preventDefault();
                const coords = getCoordinates(e);
                ctx.lineTo(coords.x, coords.y);
                ctx.stroke();
            }
            
            function stopDrawing() {
                isDrawing = false;
            }
            
            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events
            canvas.addEventListener('touchstart', startDrawing);
            canvas.addEventListener('touchmove', draw);
            canvas.addEventListener('touchend', stopDrawing);
            
            ctx.strokeStyle = '#000';
            ctx.lineWidth = 2;
        }
        
        function clearCanvas() {
            const canvas = document.getElementById('drawingCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
        
        // Extension Activities
        function saveExtension() {
            awardXP(50, 'Extension Activity Completed');
            showAchievement('Going Beyond!');
            alert('Your work has been saved!');
        }
        
        // Hints
        function showHint(hintId) {
            document.getElementById(hintId).classList.add('show');
            awardXP(-5, 'Hint Used');
        }
        
        // Feedback System
        function openFeedback() {
            document.getElementById('feedbackModal').style.display = 'block';
        }
        
        function closeFeedback() {
            document.getElementById('feedbackModal').style.display = 'none';
            document.getElementById('feedbackText').value = '';
        }
        
        function sendFeedback() {
            const feedback = document.getElementById('feedbackText').value;
            const section = currentSection;
            const page = `Section ${section}: ${document.querySelector('.section.active h2').textContent}`;
            
            // In a real implementation, this would send an email
            console.log('Feedback:', feedback, 'Page:', page);
            alert('Thank you for your feedback!');
            closeFeedback();
        }
        
        // Accessibility Features
        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
        }
        
        function changeFontSize(delta) {
            const root = document.documentElement;
            const currentSize = parseFloat(getComputedStyle(root).fontSize);
            root.style.fontSize = (currentSize + delta) + 'px';
        }
        
        // Keyboard Navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowRight' && currentSection < 8) {
                showSection(currentSection + 1);
            } else if (e.key === 'ArrowLeft' && currentSection > 0) {
                showSection(currentSection - 1);
            }
        });
        
        // Touch/Swipe Navigation
        let touchStartX = 0;
        
        document.addEventListener('touchstart', function(e) {
            touchStartX = e.touches[0].clientX;
        });
        
        document.addEventListener('touchend', function(e) {
            const touchEndX = e.changedTouches[0].clientX;
            const diff = touchStartX - touchEndX;
            
            if (Math.abs(diff) > 50) {
                if (diff > 0 && currentSection < 8) {
                    showSection(currentSection + 1);
                } else if (diff < 0 && currentSection > 0) {
                    showSection(currentSection - 1);
                }
            }
        });
    </script>
</body>
</html>