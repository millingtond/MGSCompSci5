<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number Systems - A Level Computer Science</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #2563eb;
            --secondary-color: #10b981;
            --error-color: #ef4444;
            --warning-color: #f59e0b;
            --background: #f8fafc;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border-color: #e2e8f0;
            --shadow: 0 1px 3px rgba(0,0,0,0.1);
            --font-size: 16px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            font-size: var(--font-size);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Navigation */
        .nav-bar {
            background: white;
            padding: 15px 20px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-button {
            padding: 8px 16px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .nav-button:hover {
            background: #1d4ed8;
            transform: translateY(-1px);
        }

        .nav-button.active {
            background: var(--secondary-color);
        }

        /* Progress and XP */
        .progress-container {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .xp-display {
            font-weight: bold;
            color: var(--primary-color);
        }

        .level-display {
            background: var(--secondary-color);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 14px;
        }

        /* Sections */
        .section {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-top: 20px;
        }

        h1, h2, h3 {
            color: var(--text-primary);
            margin-bottom: 20px;
        }

        h1 { font-size: 2.5em; }
        h2 { font-size: 2em; }
        h3 { font-size: 1.5em; }

        /* Forms and Inputs */
        input[type="text"], input[type="number"], select, textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .button {
            padding: 12px 24px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            margin: 10px 5px;
        }

        .button:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .button.secondary {
            background: var(--secondary-color);
        }

        .button.secondary:hover {
            background: #059669;
        }

        /* Drag and Drop */
        .drag-container {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .draggable {
            padding: 10px 20px;
            background: #e0f2fe;
            border: 2px solid #0284c7;
            border-radius: 6px;
            cursor: grab;
            transition: all 0.3s;
            user-select: none;
        }

        .draggable:active {
            cursor: grabbing;
        }

        .drop-zone {
            min-height: 50px;
            padding: 10px;
            border: 2px dashed #cbd5e1;
            border-radius: 6px;
            background: #f1f5f9;
            transition: all 0.3s;
            flex: 1;
        }

        .drop-zone.hover {
            border-color: var(--primary-color);
            background: #dbeafe;
        }

        .drop-zone.correct {
            border-color: var(--secondary-color);
            background: #d1fae5;
        }

        .drop-zone.incorrect {
            border-color: var(--error-color);
            background: #fee2e2;
        }

        /* Canvas */
        .canvas-container {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            margin: 20px 0;
            background: white;
            position: relative;
        }

        #drawingCanvas {
            cursor: crosshair;
            touch-action: none;
        }

        .canvas-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        /* Simulations */
        .simulation {
            background: #f0f9ff;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }

        .binary-display {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .bit-box {
            width: 60px;
            height: 60px;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }

        .bit-box:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .bit-box.active {
            background: var(--primary-color);
            color: white;
        }

        .bit-value {
            font-size: 24px;
            font-weight: bold;
        }

        .bit-power {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Quiz and Questions */
        .question-container {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid var(--primary-color);
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 15px;
        }

        .option {
            padding: 12px;
            background: white;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: var(--primary-color);
            background: #f0f9ff;
        }

        .option.selected {
            border-color: var(--primary-color);
            background: #dbeafe;
        }

        .option.correct {
            border-color: var(--secondary-color);
            background: #d1fae5;
        }

        .option.incorrect {
            border-color: var(--error-color);
            background: #fee2e2;
        }

        /* Feedback */
        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }

        .feedback.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }

        .feedback.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }

        .feedback.show {
            display: block;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(-10px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* Achievement Popup */
        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
            animation: bounceIn 0.5s ease-out;
        }

        @keyframes bounceIn {
            0% { transform: scale(0); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .achievement-popup.show {
            display: block;
        }

        .achievement-icon {
            font-size: 48px;
            text-align: center;
            margin-bottom: 10px;
        }

        /* Feedback Button */
        .feedback-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            font-size: 24px;
            transition: all 0.3s;
        }

        .feedback-button:hover {
            transform: scale(1.1);
            background: #1d4ed8;
        }

        /* Feedback Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            animation: slideUp 0.3s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        /* Accessibility */
        .high-contrast {
            filter: contrast(1.5);
        }

        .dyslexia-font {
            font-family: 'OpenDyslexic', Arial, sans-serif !important;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .section-content {
                padding: 20px;
            }

            .drag-container {
                flex-direction: column;
            }

            .bit-box {
                width: 50px;
                height: 50px;
            }

            .nav-buttons {
                flex-direction: column;
                width: 100%;
            }

            .nav-button {
                width: 100%;
            }
        }

        /* Anti-paste */
        .no-paste {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }

        .paste-shame {
            color: var(--error-color);
            font-weight: bold;
            display: none;
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Mark Scheme */
        .mark-scheme {
            background: #fef3c7;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
            border: 2px solid #f59e0b;
        }

        .mark-scheme.show {
            display: block;
        }

        /* Navigation arrows */
        .section-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-arrow {
            padding: 10px 20px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
        }

        .nav-arrow:hover {
            background: #1d4ed8;
            transform: translateX(-2px);
        }

        .nav-arrow.next:hover {
            transform: translateX(2px);
        }

        .nav-arrow:disabled {
            background: #cbd5e1;
            cursor: not-allowed;
            transform: none !important;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="nav-bar">
        <div class="nav-buttons" role="navigation" aria-label="Section navigation">
            <button class="nav-button active" onclick="showSection(0)" aria-label="Introduction">Intro</button>
            <button class="nav-button" onclick="showSection(1)" aria-label="Starter Activity">Starter</button>
            <button class="nav-button" onclick="showSection(2)" aria-label="Denary System">Denary</button>
            <button class="nav-button" onclick="showSection(3)" aria-label="Binary System">Binary</button>
            <button class="nav-button" onclick="showSection(4)" aria-label="Hexadecimal System">Hex</button>
            <button class="nav-button" onclick="showSection(5)" aria-label="Binary Coded Decimal">BCD</button>
            <button class="nav-button" onclick="showSection(6)" aria-label="Data Storage Units">Storage Units</button>
            <button class="nav-button" onclick="showSection(7)" aria-label="Real World Applications">Real World</button>
            <button class="nav-button" onclick="showSection(8)" aria-label="Extension Activities">Extension</button>
            <button class="nav-button" onclick="showSection(9)" aria-label="Exam Practice">Exam</button>
            <button class="nav-button" onclick="showSection(10)" aria-label="Summary Quiz">Summary</button>
            <button class="nav-button" onclick="showSection(11)" aria-label="Videos">Videos</button>
        </div>
        <div class="progress-container">
            <span class="xp-display">XP: <span id="totalXP">0</span></span>
            <span class="level-display">Level <span id="currentLevel">0</span></span>
        </div>
    </nav>

    <div class="container">
        <!-- Section 0: Introduction -->
        <div class="section active" id="section-0">
            <div class="section-content">
                <h1>Number Systems</h1>
                <h2>Learning Outcomes</h2>
                <ul>
                    <li>Understand and convert between denary, binary, hexadecimal, and BCD number systems</li>
                    <li>Apply binary place values (128, 64, 32, 16, 8, 4, 2, 1) for conversions</li>
                    <li>Recognize real-world applications of different number systems</li>
                    <li>Perform calculations and conversions accurately</li>
                    <li>Identify common errors and misconceptions in number system conversions</li>
                </ul>
                
                <h3>Introduction</h3>
                <p>Number systems are fundamental to computer science. Computers process everything in binary (0s and 1s), but we use different number systems for various purposes:</p>
                <ul>
                    <li><strong>Denary (Base 10)</strong>: The number system we use daily</li>
                    <li><strong>Binary (Base 2)</strong>: The language of computers</li>
                    <li><strong>Hexadecimal (Base 16)</strong>: Compact representation of binary data</li>
                    <li><strong>Binary Coded Decimal (BCD)</strong>: Special encoding for decimal numbers</li>
                </ul>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" disabled>← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(1)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 1: Starter Activity -->
        <div class="section" id="section-1">
            <div class="section-content">
                <h2>Starter Activity: Test Your Knowledge</h2>
                <p>Let's begin by assessing what you already know about number systems. Complete this interactive quiz to earn your first XP!</p>
                
                <div class="question-container">
                    <h3>Question 1: Daily Number System</h3>
                    <p>Which number system do we use in everyday life for counting and calculations?</p>
                    <div class="options">
                        <div class="option" onclick="checkStarter(this, 'denary', 1)">Hexadecimal</div>
                        <div class="option" onclick="checkStarter(this, 'denary', 1)">Binary</div>
                        <div class="option" onclick="checkStarter(this, 'denary', 1)">Denary</div>
                        <div class="option" onclick="checkStarter(this, 'denary', 1)">Octal</div>
                    </div>
                    <div class="feedback" id="starter-feedback-1"></div>
                </div>

                <div class="question-container">
                    <h3>Question 2: Computer Language</h3>
                    <p>What are the only two digits used in the binary number system?</p>
                    <input type="text" id="starter-input-2" placeholder="Enter your answer" class="no-paste">
                    <button class="button" onclick="checkStarterInput(2, ['0 and 1', '0 1', '0, 1', 'zero and one', '0 & 1'])">Check Answer</button>
                    <div class="feedback" id="starter-feedback-2"></div>
                </div>

                <div class="question-container">
                    <h3>Question 3: Color Codes</h3>
                    <p>True or False: Hexadecimal is commonly used in web development for color codes.</p>
                    <div class="options">
                        <div class="option" onclick="checkStarter(this, true, 3)">True</div>
                        <div class="option" onclick="checkStarter(this, true, 3)">False</div>
                    </div>
                    <div class="feedback" id="starter-feedback-3"></div>
                </div>

                <button class="button secondary" onclick="resetSection(1)">Reset Activity</button>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(0)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(2)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 2: Denary System -->
        <div class="section" id="section-2">
            <div class="section-content">
                <h2>The Denary System (Base 10)</h2>
                
                <div class="simulation">
                    <h3>Interactive Place Value Demonstration</h3>
                    <p>The denary system uses 10 digits (0-9) and place values that are powers of 10.</p>
                    
                    <div style="display: flex; gap: 10px; justify-content: center; margin: 20px 0;">
                        <div class="bit-box">
                            <div class="bit-power">1000s</div>
                            <input type="number" min="0" max="9" value="2" onchange="updateDenary()" id="denary-1000" style="width: 40px; text-align: center;">
                        </div>
                        <div class="bit-box">
                            <div class="bit-power">100s</div>
                            <input type="number" min="0" max="9" value="5" onchange="updateDenary()" id="denary-100" style="width: 40px; text-align: center;">
                        </div>
                        <div class="bit-box">
                            <div class="bit-power">10s</div>
                            <input type="number" min="0" max="9" value="4" onchange="updateDenary()" id="denary-10" style="width: 40px; text-align: center;">
                        </div>
                        <div class="bit-box">
                            <div class="bit-power">1s</div>
                            <input type="number" min="0" max="9" value="7" onchange="updateDenary()" id="denary-1" style="width: 40px; text-align: center;">
                        </div>
                    </div>
                    
                    <p style="text-align: center; font-size: 20px;">Value: <strong id="denary-result">2547</strong></p>
                    <p style="text-align: center;">Calculation: <span id="denary-calc">(2×1000) + (5×100) + (4×10) + (7×1) = 2547</span></p>
                </div>

                <h3>Fill in the Blanks</h3>
                <p>Complete the following statements about the denary system. Choose from the options provided:</p>
                
                <div class="drag-container">
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="ten">ten</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="base">base</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="0-9">0-9</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="decimal">decimal</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="two">two</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="sixteen">sixteen</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="0-F">0-F</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="binary">binary</div>
                </div>

                <div class="question-container">
                    <p>1. The denary system is also known as the <span class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="decimal"></span> system.</p>
                    <p>2. Denary is a <span class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="base"></span> <span class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="ten"></span> number system.</p>
                    <p>3. It uses digits from <span class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="0-9"></span>.</p>
                </div>

                <button class="button" onclick="checkDragDrop()">Check Answers</button>
                <div class="feedback" id="denary-feedback"></div>

                <h3>Short Answer Practice</h3>
                <div class="question-container">
                    <p>Explain why humans primarily use the denary (base 10) system. Consider historical and practical reasons.</p>
                    <textarea id="denary-short" rows="4" placeholder="Write your answer here..." class="no-paste"></textarea>
                    <button class="button" onclick="checkDenaryShort()">Submit Answer</button>
                    <div class="feedback" id="denary-short-feedback"></div>
                </div>

                <button class="button secondary" onclick="resetSection(2)">Reset Section</button>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(1)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(3)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 3: Binary System -->
        <div class="section" id="section-3">
            <div class="section-content">
                <h2>The Binary System (Base 2)</h2>
                
                <div class="simulation">
                    <h3>Interactive Binary Counter</h3>
                    <p>Click on each bit to toggle between 0 and 1. Watch how the denary value changes!</p>
                    
                    <div class="binary-display">
                        <div class="bit-box" onclick="toggleBit(0)" data-bit="0">
                            <div class="bit-power">128</div>
                            <div class="bit-value" id="bit-0">0</div>
                        </div>
                        <div class="bit-box" onclick="toggleBit(1)" data-bit="0">
                            <div class="bit-power">64</div>
                            <div class="bit-value" id="bit-1">0</div>
                        </div>
                        <div class="bit-box" onclick="toggleBit(2)" data-bit="0">
                            <div class="bit-power">32</div>
                            <div class="bit-value" id="bit-2">0</div>
                        </div>
                        <div class="bit-box" onclick="toggleBit(3)" data-bit="0">
                            <div class="bit-power">16</div>
                            <div class="bit-value" id="bit-3">0</div>
                        </div>
                        <div class="bit-box" onclick="toggleBit(4)" data-bit="0">
                            <div class="bit-power">8</div>
                            <div class="bit-value" id="bit-4">0</div>
                        </div>
                        <div class="bit-box" onclick="toggleBit(5)" data-bit="0">
                            <div class="bit-power">4</div>
                            <div class="bit-value" id="bit-5">0</div>
                        </div>
                        <div class="bit-box" onclick="toggleBit(6)" data-bit="0">
                            <div class="bit-power">2</div>
                            <div class="bit-value" id="bit-6">0</div>
                        </div>
                        <div class="bit-box" onclick="toggleBit(7)" data-bit="0">
                            <div class="bit-power">1</div>
                            <div class="bit-value" id="bit-7">0</div>
                        </div>
                    </div>
                    
                    <p style="text-align: center; font-size: 20px; margin-top: 20px;">
                        Binary: <strong id="binary-value">00000000</strong> = Denary: <strong id="denary-value">0</strong>
                    </p>
                    <p style="text-align: center;">Calculation: <span id="binary-calc">No bits set</span></p>
                    
                    <button class="button" onclick="resetBinary()">Reset Binary Counter</button>
                </div>

                <h3>Binary Conversion Practice</h3>
                <div class="question-container">
                    <p>Convert the binary number 10110101 to denary. Show your working using the drawing canvas below.</p>
                    
                    <div class="canvas-container">
                        <canvas id="drawingCanvas" width="600" height="200"></canvas>
                    </div>
                    <div class="canvas-controls">
                        <button class="button secondary" onclick="clearCanvas()">Clear Canvas</button>
                        <button class="button" onclick="saveCanvas()">Save Work</button>
                    </div>
                    
                    <p>Enter your answer:</p>
                    <input type="number" id="binary-convert-answer" placeholder="Enter denary value" class="no-paste">
                    <button class="button" onclick="checkBinaryConversion()">Check Answer</button>
                    <div class="feedback" id="binary-convert-feedback"></div>
                </div>

                <h3>Drag and Drop Binary Conversion</h3>
                <p>Match the binary numbers to their denary equivalents:</p>
                
                <div style="display: flex; gap: 40px; margin: 20px 0;">
                    <div style="flex: 1;">
                        <h4>Binary Numbers</h4>
                        <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="5">00000101</div>
                        <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="15">00001111</div>
                        <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="128">10000000</div>
                        <div class="draggable" draggable="true" ondragstart="drag(event)" data-answer="255">11111111</div>
                    </div>
                    <div style="flex: 1;">
                        <h4>Denary Values</h4>
                        <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="128">128</div>
                        <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="5">5</div>
                        <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="255">255</div>
                        <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="15">15</div>
                    </div>
                </div>

                <button class="button" onclick="checkBinaryDragDrop()">Check Matches</button>
                <div class="feedback" id="binary-drag-feedback"></div>

                <h3>Reflection Questions</h3>
                <div class="question-container">
                    <p>1. Why do computers use binary instead of denary?</p>
                    <textarea id="binary-reflection-1" rows="3" placeholder="Consider electrical states and simplicity..." class="no-paste"></textarea>
                    
                    <p>2. What is the maximum denary value that can be represented with 8 bits?</p>
                    <input type="text" id="binary-reflection-2" placeholder="Think about all bits being 1..." class="no-paste">
                    
                    <button class="button" onclick="checkBinaryReflection()">Submit Reflections</button>
                    <div class="feedback" id="binary-reflection-feedback"></div>
                </div>

                <button class="button secondary" onclick="resetSection(3)">Reset Section</button>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(2)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(4)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 4: Hexadecimal System -->
        <div class="section" id="section-4">
            <div class="section-content">
                <h2>The Hexadecimal System (Base 16)</h2>
                
                <div class="simulation">
                    <h3>Interactive Hex Color Picker</h3>
                    <p>Hexadecimal is widely used in web development for colors. Each color component (Red, Green, Blue) uses two hex digits.</p>
                    
                    <div style="display: flex; gap: 20px; align-items: center; justify-content: center; margin: 20px 0;">
                        <div>
                            <label>Red (00-FF):</label>
                            <input type="text" id="hex-red" value="FF" maxlength="2" onchange="updateHexColor()" style="width: 50px;">
                        </div>
                        <div>
                            <label>Green (00-FF):</label>
                            <input type="text" id="hex-green" value="00" maxlength="2" onchange="updateHexColor()" style="width: 50px;">
                        </div>
                        <div>
                            <label>Blue (00-FF):</label>
                            <input type="text" id="hex-blue" value="00" maxlength="2" onchange="updateHexColor()" style="width: 50px;">
                        </div>
                    </div>
                    
                    <div id="color-display" style="width: 200px; height: 100px; margin: 20px auto; border: 2px solid #333; background: #FF0000;"></div>
                    
                    <p style="text-align: center;">Hex Color: <strong id="hex-color-code">#FF0000</strong></p>
                    <p style="text-align: center;">RGB Values: <span id="rgb-values">R: 255, G: 0, B: 0</span></p>
                </div>

                <h3>Hexadecimal Digits</h3>
                <p>Hexadecimal uses 16 digits: 0-9 and A-F (where A=10, B=11, C=12, D=13, E=14, F=15)</p>
                
                <div class="question-container">
                    <h4>Matching Exercise</h4>
                    <p>Match the hexadecimal values to their denary equivalents:</p>
                    
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 20px 0;">
                        <button class="option" onclick="checkHexMatch(this, 'A', 10)">A = ?</button>
                        <button class="option" onclick="checkHexMatch(this, 'C', 12)">C = ?</button>
                        <button class="option" onclick="checkHexMatch(this, 'F', 15)">F = ?</button>
                        <button class="option" onclick="checkHexMatch(this, 'B', 11)">B = ?</button>
                    </div>
                    
                    <p>Options: 15, 11, 10, 12</p>
                    <div class="feedback" id="hex-match-feedback"></div>
                </div>

                <h3>Hex Conversion Practice</h3>
                <div class="question-container">
                    <p>Convert the hexadecimal number 2AF to denary. Remember: 2AF = (2 × 16²) + (A × 16¹) + (F × 16⁰)</p>
                    
                    <div style="margin: 20px 0;">
                        <label>Step 1: What is A in denary?</label>
                        <input type="number" id="hex-a-value" placeholder="Enter value" class="no-paste">
                        
                        <label>Step 2: What is F in denary?</label>
                        <input type="number" id="hex-f-value" placeholder="Enter value" class="no-paste">
                        
                        <label>Step 3: Calculate the final answer:</label>
                        <input type="number" id="hex-final-answer" placeholder="Enter denary value" class="no-paste">
                    </div>
                    
                    <button class="button" onclick="checkHexConversion()">Check Answer</button>
                    <div class="feedback" id="hex-conversion-feedback"></div>
                </div>

                <h3>Multiple Choice Quiz</h3>
                <div class="question-container">
                    <p>Which of these is a valid reason for using hexadecimal in computing?</p>
                    <div class="options">
                        <div class="option" onclick="checkHexMC(this, 'compact')">It provides a more compact representation of binary data</div>
                        <div class="option" onclick="checkHexMC(this, 'faster')">Computers process hexadecimal faster than binary</div>
                        <div class="option" onclick="checkHexMC(this, 'natural')">It's the natural counting system for computers</div>
                        <div class="option" onclick="checkHexMC(this, 'memory')">It uses less computer memory than binary</div>
                    </div>
                    <div class="feedback" id="hex-mc-feedback"></div>
                </div>

                <button class="button secondary" onclick="resetSection(4)">Reset Section</button>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(3)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(5)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 5: Binary Coded Decimal (BCD) -->
        <div class="section" id="section-5">
            <div class="section-content">
                <h2>Binary Coded Decimal (BCD)</h2>
                
                <div class="simulation">
                    <h3>Step-by-Step BCD Converter</h3>
                    <p>BCD represents each decimal digit as a 4-bit binary number. Watch how we convert 938 to BCD:</p>
                    
                    <div id="bcd-steps" style="margin: 20px 0;">
                        <div style="display: flex; gap: 20px; justify-content: center; align-items: center;">
                            <div class="bit-box" style="width: 80px; height: 80px;">
                                <div class="bit-power">9</div>
                                <div class="bit-value" id="bcd-digit-1">1001</div>
                            </div>
                            <div class="bit-box" style="width: 80px; height: 80px;">
                                <div class="bit-power">3</div>
                                <div class="bit-value" id="bcd-digit-2">0011</div>
                            </div>
                            <div class="bit-box" style="width: 80px; height: 80px;">
                                <div class="bit-power">8</div>
                                <div class="bit-value" id="bcd-digit-3">1000</div>
                            </div>
                        </div>
                        
                        <p style="text-align: center; margin-top: 20px;">
                            938 in BCD = <strong>1001 0011 1000</strong>
                        </p>
                    </div>
                    
                    <div style="text-align: center;">
                        <label>Try your own number (0-999):</label>
                        <input type="number" id="bcd-input" min="0" max="999" value="938" onchange="updateBCD()" style="width: 100px;">
                        <p id="bcd-output" style="margin-top: 10px;">BCD: 1001 0011 1000</p>
                    </div>
                </div>

                <h3>BCD Addition Problem & Solution</h3>
                <div class="simulation">
                    <h4>The Problem: Adding 82 + 78 in BCD</h4>
                    <p>When we add BCD numbers directly, we can get invalid results:</p>
                    
                    <div style="background: #fee2e2; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <pre style="font-family: monospace; font-size: 16px;">
    82 in BCD:  1000 0010
  + 78 in BCD:  0111 1000
  ─────────────────────────
    Result:     1111 1010  ❌ Invalid!
                  ↑    ↑
                 15   10   (These aren't valid BCD digits!)</pre>
                    </div>
                    
                    <p>The problem: BCD only recognizes codes for single-digit denary numbers (0-9). Values like 10, 11, 15 are meaningless in BCD!</p>
                    
                    <h4>The Solution: Add 0110 (6 in binary)</h4>
                    <p>When we detect an invalid BCD digit (value > 9), we add 0110 to correct it:</p>
                    
                    <div style="background: #d1fae5; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <pre style="font-family: monospace; font-size: 16px;">
    Invalid:    1111 1010
    Add 0110:   0110 0110
  ─────────────────────────
    Fixed:    1 0110 0000  ✓ Valid!
                  ↑    ↑
                 160   0   = 160 in denary</pre>
                    </div>
                    
                    <button class="button" onclick="demonstrateBCDAddition()">Try Another Example</button>
                    <div id="bcd-addition-demo"></div>
                </div>

                <h3>Real-World Uses of BCD</h3>
                <div class="question-container">
                    <p>BCD is used in many practical applications:</p>
                    <ul>
                        <li><strong>Electronic Calculators</strong> - Display operations and results</li>
                        <li><strong>BIOS Date/Time</strong> - Store date and time in PC systems</li>
                        <li><strong>Financial Applications</strong> - Exact monetary value representation</li>
                        <li><strong>GPS Coordinates</strong> - Latitude/longitude in cell towers</li>
                        <li><strong>Barcodes</strong> - Product identification systems</li>
                    </ul>
                    
                    <h4>Interactive: Match BCD Applications</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div>
                            <h5>Applications</h5>
                            <div class="draggable" draggable="true" ondragstart="drag(event)" data-match="precision">Bank account balance</div>
                            <div class="draggable" draggable="true" ondragstart="drag(event)" data-match="display">Digital clock display</div>
                            <div class="draggable" draggable="true" ondragstart="drag(event)" data-match="precision">Scientific calculator</div>
                            <div class="draggable" draggable="true" ondragstart="drag(event)" data-match="conversion">Barcode scanner</div>
                        </div>
                        
                        <div>
                            <h5>BCD Benefits Used</h5>
                            <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="display">Easy to display digits</div>
                            <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="precision">Exact decimal values</div>
                            <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="conversion">Simple conversion</div>
                        </div>
                    </div>
                    
                    <button class="button" onclick="checkBCDApplications()">Check Matches</button>
                    <div class="feedback" id="bcd-apps-feedback"></div>
                </div>

                <h3>Benefits of BCD</h3>
                <div style="background: #f0f9ff; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4>✓ Key Advantages:</h4>
                    <ol>
                        <li><strong>Straightforward Conversion</strong> - Easy to convert between BCD and denary</li>
                        <li><strong>Less Complex for Programmers</strong> - Simple to encode and decode</li>
                        <li><strong>Display-Friendly</strong> - Digital equipment can easily use BCD for output</li>
                        <li><strong>Monetary Precision</strong> - Can represent financial values exactly without rounding errors</li>
                    </ol>
                </div>

                <h3>Categorization Exercise</h3>
                <p>Drag each characteristic to the correct number system:</p>
                
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin: 20px 0;">
                    <div>
                        <h4>BCD Characteristics</h4>
                        <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="bcd" style="min-height: 150px;"></div>
                    </div>
                    <div>
                        <h4>Pure Binary Characteristics</h4>
                        <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-category="binary" style="min-height: 150px;"></div>
                    </div>
                </div>
                
                <div class="drag-container">
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-category="bcd">Uses 4 bits per decimal digit</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-category="binary">Most efficient storage</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-category="bcd">Easy to convert to/from decimal</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-category="binary">Used for arithmetic in CPUs</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-category="bcd">Used in digital clocks</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-category="bcd">Wastes some bit patterns</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-category="bcd">No rounding errors for decimals</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-category="binary">Can cause floating point errors</div>
                </div>
                
                <button class="button" onclick="checkBCDCategories()">Check Categories</button>
                <div class="feedback" id="bcd-category-feedback"></div>

                <h3>Problem Solving: BCD Addition</h3>
                <div class="question-container">
                    <p>Calculate 47 + 38 using BCD. Show all steps including the correction process.</p>
                    
                    <div class="canvas-container">
                        <canvas id="bcdCanvas" width="600" height="300"></canvas>
                    </div>
                    <div class="canvas-controls">
                        <button class="button secondary" onclick="clearBCDCanvas()">Clear Canvas</button>
                    </div>
                    
                    <p>Enter your final answer in BCD format (use spaces between 4-bit groups):</p>
                    <input type="text" id="bcd-addition-answer" placeholder="e.g., 1000 0101" class="no-paste">
                    <button class="button" onclick="checkBCDAddition()">Check Answer</button>
                    <div class="feedback" id="bcd-addition-feedback"></div>
                </div>

                <button class="button secondary" onclick="resetSection(5)">Reset Section</button>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(4)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(6)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 6: Data Storage Units -->
        <div class="section" id="section-6">
            <div class="section-content">
                <h2>Data Storage Units</h2>
                
                <div class="simulation">
                    <h3>Interactive Storage Unit Converter</h3>
                    <p>Enter a value to see conversions between different units:</p>
                    
                    <div style="display: flex; gap: 20px; align-items: center; justify-content: center; margin: 20px 0;">
                        <input type="number" id="storage-input" value="1" min="0" style="width: 100px;">
                        <select id="storage-unit" onchange="updateStorageConversions()">
                            <option value="bit">Bits</option>
                            <option value="byte">Bytes</option>
                            <option value="kb">KB (Decimal)</option>
                            <option value="kib">KiB (Binary)</option>
                            <option value="mb">MB (Decimal)</option>
                            <option value="mib">MiB (Binary)</option>
                            <option value="gb">GB (Decimal)</option>
                            <option value="gib">GiB (Binary)</option>
                        </select>
                        <button class="button" onclick="updateStorageConversions()">Convert</button>
                    </div>
                    
                    <div id="conversion-results" style="background: #f0f9ff; padding: 20px; border-radius: 8px; margin: 20px 0;">
                        <h4>Conversion Results:</h4>
                        <div id="conversion-display"></div>
                    </div>
                </div>

                <h3>Basic Units</h3>
                <div class="question-container">
                    <p>The fundamental units of computer storage:</p>
                    <ul>
                        <li><strong>Bit</strong>: Binary Digit - Either 1 or 0, On or Off</li>
                        <li><strong>Byte</strong>: A collection of 8 bits</li>
                    </ul>
                    
                    <h4>Quick Check</h4>
                    <p>How many different values can be represented with 1 byte (8 bits)?</p>
                    <input type="number" id="byte-values" placeholder="Enter your answer" class="no-paste">
                    <button class="button" onclick="checkByteValues()">Check</button>
                    <div class="feedback" id="byte-feedback"></div>
                </div>

                <h3>SI (Decimal) vs IEC (Binary) Prefixes</h3>
                <div style="background: #fef3c7; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4>⚠️ Important Distinction</h4>
                    <p>There are two systems for measuring storage capacity:</p>
                    <ol>
                        <li><strong>SI (Decimal) System</strong> - Used by storage manufacturers (powers of 1000)</li>
                        <li><strong>IEC (Binary) System</strong> - Used by operating systems (powers of 1024)</li>
                    </ol>
                    <p>This is why a "1TB" hard drive shows as ~931GB in Windows!</p>
                </div>

                <h3>Comparison Table</h3>
                <div class="simulation">
                    <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                        <thead>
                            <tr style="background: #e0f2fe;">
                                <th style="padding: 10px; border: 1px solid #0284c7;">Unit Type</th>
                                <th style="padding: 10px; border: 1px solid #0284c7;">Decimal (SI)</th>
                                <th style="padding: 10px; border: 1px solid #0284c7;">Binary (IEC)</th>
                                <th style="padding: 10px; border: 1px solid #0284c7;">Difference</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">Kilo</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">1 KB = 1,000 bytes</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">1 KiB = 1,024 bytes</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">2.4%</td>
                            </tr>
                            <tr style="background: #f8fafc;">
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">Mega</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">1 MB = 1,000,000 bytes</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">1 MiB = 1,048,576 bytes</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">4.9%</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">Giga</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">1 GB = 1,000,000,000 bytes</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">1 GiB = 1,073,741,824 bytes</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">7.4%</td>
                            </tr>
                            <tr style="background: #f8fafc;">
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">Tera</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">1 TB = 1,000,000,000,000 bytes</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">1 TiB = 1,099,511,627,776 bytes</td>
                                <td style="padding: 10px; border: 1px solid #cbd5e1;">10%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <h3>Why Binary Prefixes Make Sense</h3>
                <div class="question-container">
                    <p>Consider why computers use binary prefixes:</p>
                    <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <p><strong>1024 in binary = 10000000000</strong> (2¹⁰) - A nice, round number!</p>
                        <p><strong>1000 in binary = 1111101000</strong> - Not an even power of 2</p>
                    </div>
                    
                    <p>Since computers work in binary, using powers of 2 (1024) is more natural than powers of 10 (1000).</p>
                    
                    <h4>Fill in the Powers</h4>
                    <p>Complete the binary prefix values:</p>
                    <ul>
                        <li>1 KiB = 2^<input type="number" id="kib-power" style="width: 50px;" class="no-paste"> bytes</li>
                        <li>1 MiB = 2^<input type="number" id="mib-power" style="width: 50px;" class="no-paste"> bytes</li>
                        <li>1 GiB = 2^<input type="number" id="gib-power" style="width: 50px;" class="no-paste"> bytes</li>
                        <li>1 TiB = 2^<input type="number" id="tib-power" style="width: 50px;" class="no-paste"> bytes</li>
                    </ul>
                    <button class="button" onclick="checkPowers()">Check Answers</button>
                    <div class="feedback" id="powers-feedback"></div>
                </div>

                <h3>Storage Capacity Problem</h3>
                <div class="question-container">
                    <p>A computer has 16 GiB of RAM. A software developer claims their program needs "only 15 GB" of memory.</p>
                    
                    <ol>
                        <li>Convert 16 GiB to GB (decimal). Show your calculation.</li>
                        <li>Will the program fit in the available memory? Explain why or why not.</li>
                        <li>What is the actual difference in bytes between 16 GiB and 15 GB?</li>
                    </ol>
                    
                    <textarea id="storage-problem" rows="8" placeholder="Show your working..." class="no-paste"></textarea>
                    <button class="button" onclick="checkStorageProblem()">Submit Solution</button>
                    <div class="feedback" id="storage-problem-feedback"></div>
                </div>

                <h3>Drag and Drop: Match the Units</h3>
                <p>Match each storage size to its correct category:</p>
                
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin: 20px 0;">
                    <div>
                        <h4>Small (< 1MB)</h4>
                        <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-size="small" style="min-height: 100px;"></div>
                    </div>
                    <div>
                        <h4>Medium (1MB - 1GB)</h4>
                        <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-size="medium" style="min-height: 100px;"></div>
                    </div>
                    <div>
                        <h4>Large (> 1GB)</h4>
                        <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-size="large" style="min-height: 100px;"></div>
                    </div>
                </div>
                
                <div class="drag-container">
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-size="small">Text file (5 KB)</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-size="medium">MP3 song (4 MB)</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-size="large">HD movie (4 GB)</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-size="small">Email (50 KB)</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-size="medium">High-res photo (10 MB)</div>
                    <div class="draggable" draggable="true" ondragstart="drag(event)" data-size="large">Game installation (50 GB)</div>
                </div>
                
                <button class="button" onclick="checkStorageSizes()">Check Categories</button>
                <div class="feedback" id="storage-size-feedback"></div>

                <button class="button secondary" onclick="resetSection(6)">Reset Section</button>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(5)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(7)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 7: Real-World Applications -->
        <div class="section" id="section-7">
            <div class="section-content">
                <h2>Real-World Applications</h2>
                
                <h3>Case Study: RGB Color in Web Development</h3>
                <div class="question-container">
                    <p>A web developer needs to create a specific shade of purple for a client's website. They know the RGB values should be: Red=128, Green=0, Blue=255.</p>
                    
                    <p>1. Convert each RGB value to hexadecimal:</p>
                    <div style="margin: 15px 0;">
                        <label>Red (128) in hex:</label>
                        <input type="text" id="rgb-red-hex" placeholder="Enter hex value" class="no-paste">
                        
                        <label>Green (0) in hex:</label>
                        <input type="text" id="rgb-green-hex" placeholder="Enter hex value" class="no-paste">
                        
                        <label>Blue (255) in hex:</label>
                        <input type="text" id="rgb-blue-hex" placeholder="Enter hex value" class="no-paste">
                    </div>
                    
                    <p>2. What is the complete hex color code?</p>
                    <input type="text" id="complete-hex" placeholder="#RRGGBB" class="no-paste">
                    
                    <button class="button" onclick="checkRGBCase()">Check Answers</button>
                    <div class="feedback" id="rgb-case-feedback"></div>
                </div>

                <h3>Common Mistakes to Avoid</h3>
                <div style="background: #fef3c7; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h4>⚠️ Watch Out For These Common Errors:</h4>
                    <ol>
                        <li><strong>Binary Addition Overflow:</strong> Remember that 1 + 1 = 10 in binary (not 2!)</li>
                        <li><strong>Hex Letter Confusion:</strong> A=10, not 11. The sequence is 0-9, then A-F.</li>
                        <li><strong>BCD vs Binary:</strong> BCD 1001 = 9, but binary 1001 = 9 (same in this case, but not always!)</li>
                        <li><strong>Leading Zeros:</strong> Don't forget them! 5 in 8-bit binary is 00000101, not just 101.</li>
                        <li><strong>Place Value Errors:</strong> Binary place values double (1,2,4,8...), not increase by 1!</li>
                    </ol>
                </div>

                <h3>Application Scenarios</h3>
                <div class="question-container">
                    <p>Match each scenario to the most appropriate number system:</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                        <div>
                            <h4>Scenarios</h4>
                            <div class="draggable" draggable="true" ondragstart="drag(event)" data-match="hex">MAC address storage</div>
                            <div class="draggable" draggable="true" ondragstart="drag(event)" data-match="binary">CPU arithmetic operations</div>
                            <div class="draggable" draggable="true" ondragstart="drag(event)" data-match="bcd">Digital clock display</div>
                            <div class="draggable" draggable="true" ondragstart="drag(event)" data-match="denary">Human-readable prices</div>
                        </div>
                        
                        <div>
                            <h4>Number Systems</h4>
                            <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="binary">Binary</div>
                            <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="denary">Denary</div>
                            <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="hex">Hexadecimal</div>
                            <div class="drop-zone" ondrop="drop(event)" ondragover="allowDrop(event)" data-correct="bcd">BCD</div>
                        </div>
                    </div>
                    
                    <button class="button" onclick="checkApplicationMatch()">Check Matches</button>
                    <div class="feedback" id="application-feedback"></div>
                </div>

                <button class="button secondary" onclick="resetSection(6)">Reset Section</button>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(6)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(8)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 8: Extension Activities -->
        <div class="section" id="section-8">
            <div class="section-content">
                <h2>Extension Activities</h2>
                <p>These challenges go beyond the specification. Complete them to reach Level 5!</p>
                
                <h3>Challenge 1: Create Your Own Number System</h3>
                <div class="question-container">
                    <p>Design a base-5 number system using the digits 0, 1, 2, 3, 4.</p>
                    <ol>
                        <li>What would the place values be?</li>
                        <li>Convert the base-5 number 234 to denary.</li>
                        <li>What real-world application might benefit from base-5?</li>
                    </ol>
                    
                    <textarea id="extension-1" rows="8" placeholder="Explain your number system here..." class="no-paste"></textarea>
                    <button class="button" onclick="checkExtension1()">Submit Design</button>
                    <div class="feedback" id="extension-1-feedback"></div>
                </div>

                <h3>Challenge 2: Binary Fractions</h3>
                <div class="question-container">
                    <p>In binary, we can represent fractions using negative powers of 2. For example:</p>
                    <p>0.1₂ = 2⁻¹ = 0.5₁₀</p>
                    <p>0.01₂ = 2⁻² = 0.25₁₀</p>
                    
                    <p>Convert the binary fraction 0.1011₂ to denary. Show all working.</p>
                    
                    <div class="canvas-container">
                        <canvas id="fractionCanvas" width="600" height="200"></canvas>
                    </div>
                    <div class="canvas-controls">
                        <button class="button secondary" onclick="clearFractionCanvas()">Clear Canvas</button>
                    </div>
                    
                    <input type="text" id="fraction-answer" placeholder="Enter your answer as a decimal" class="no-paste">
                    <button class="button" onclick="checkFractionAnswer()">Check Answer</button>
                    <div class="feedback" id="fraction-feedback"></div>
                </div>

                <h3>Challenge 3: Two's Complement (Negative Binary)</h3>
                <div class="question-container">
                    <p>Research two's complement representation for negative numbers in binary.</p>
                    <p>Using 8-bit two's complement, represent -42 in binary.</p>
                    
                    <p>Steps:</p>
                    <ol>
                        <li>First, what is +42 in 8-bit binary?</li>
                        <li>Invert all the bits (one's complement)</li>
                        <li>Add 1 to get two's complement</li>
                    </ol>
                    
                    <input type="text" id="twos-complement" placeholder="Enter 8-bit binary for -42" class="no-paste">
                    <button class="button" onclick="checkTwosComplement()">Check Answer</button>
                    <div class="feedback" id="twos-feedback"></div>
                </div>

                <button class="button secondary" onclick="resetSection(7)">Reset Section</button>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(7)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(9)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 9: Practice Exam Questions -->
        <div class="section" id="section-9">
            <div class="section-content">
                <h2>Practice Exam Questions</h2>
                <p>These questions are in the style of past A Level Computer Science exams.</p>
                
                <div class="question-container">
                    <h3>Question 1 (4 marks)</h3>
                    <p>A computer stores color information for each pixel using 24 bits.</p>
                    <p>(a) How many different colors can be represented using 24 bits? [1 mark]</p>
                    <textarea id="exam-1a" rows="2" placeholder="Show your calculation..." class="no-paste"></textarea>
                    
                    <p>(b) The color value is often displayed in hexadecimal. How many hexadecimal digits are needed to represent 24 bits? [1 mark]</p>
                    <textarea id="exam-1b" rows="2" placeholder="Explain your answer..." class="no-paste"></textarea>
                    
                    <p>(c) Explain why hexadecimal is preferred over binary for displaying color values to programmers. [2 marks]</p>
                    <textarea id="exam-1c" rows="3" placeholder="Give two reasons..." class="no-paste"></textarea>
                    
                    <div style="margin-top: 15px;">
                        <label>Predicted marks (out of 4):</label>
                        <input type="number" id="predicted-1" min="0" max="4" placeholder="?" style="width: 60px;">
                        <button class="button" onclick="checkExam1()">View Mark Scheme</button>
                    </div>
                    
                    <div class="mark-scheme" id="mark-scheme-1">
                        <h4>Mark Scheme:</h4>
                        <p>(a) 2²⁴ = 16,777,216 colors [1 mark]</p>
                        <p>(b) 6 hexadecimal digits [1 mark] - Because each hex digit represents 4 bits, and 24 ÷ 4 = 6</p>
                        <p>(c) Any two from: [2 marks]</p>
                        <ul>
                            <li>More compact/shorter representation (6 digits vs 24 digits)</li>
                            <li>Easier to read and remember</li>
                            <li>Less prone to errors when typing</li>
                            <li>Groups bits meaningfully (each hex digit = 4 bits)</li>
                        </ul>
                    </div>
                </div>

                <div class="question-container">
                    <h3>Question 2 (6 marks)</h3>
                    <p>A digital thermometer uses BCD to store temperature readings.</p>
                    
                    <p>(a) Convert the denary number 375 to BCD. [2 marks]</p>
                    <textarea id="exam-2a" rows="3" placeholder="Show each digit's conversion..." class="no-paste"></textarea>
                    
                    <p>(b) The same value (375) stored in pure binary would require how many bits? [1 mark]</p>
                    <textarea id="exam-2b" rows="2" placeholder="Calculate the minimum bits needed..." class="no-paste"></textarea>
                    
                    <p>(c) State one advantage and one disadvantage of using BCD instead of pure binary for this application. [2 marks]</p>
                    <textarea id="exam-2c" rows="3" placeholder="Advantage and disadvantage..." class="no-paste"></textarea>
                    
                    <p>(d) Why might BCD be particularly suitable for a digital thermometer display? [1 mark]</p>
                    <textarea id="exam-2d" rows="2" placeholder="Consider the display requirements..." class="no-paste"></textarea>
                    
                    <div style="margin-top: 15px;">
                        <label>Predicted marks (out of 6):</label>
                        <input type="number" id="predicted-2" min="0" max="6" placeholder="?" style="width: 60px;">
                        <button class="button" onclick="checkExam2()">View Mark Scheme</button>
                    </div>
                    
                    <div class="mark-scheme" id="mark-scheme-2">
                        <h4>Mark Scheme:</h4>
                        <p>(a) 3 = 0011, 7 = 0111, 5 = 0101 [1 mark]<br>
                        Therefore 375 in BCD = 0011 0111 0101 [1 mark]</p>
                        <p>(b) 9 bits [1 mark] - Because 2⁸ = 256 < 375 < 512 = 2⁹</p>
                        <p>(c) [2 marks]</p>
                        <ul>
                            <li>Advantage: Easy/direct conversion to decimal for display</li>
                            <li>Disadvantage: Uses more storage space / Less efficient / Wastes bit patterns</li>
                        </ul>
                        <p>(d) Because the display shows decimal digits directly, and BCD makes it simple to extract each decimal digit for display [1 mark]</p>
                    </div>
                </div>

                <button class="button secondary" onclick="resetSection(8)">Reset Section</button>
                
                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(8)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(10)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 10: Summary Quiz -->
        <div class="section" id="section-10">
            <div class="section-content">
                <h2>Summary Quiz</h2>
                <p>Test your understanding of all number systems. You need 6/8 to pass!</p>
                
                <div id="summary-quiz">
                    <div class="question-container">
                        <h3>Question 1</h3>
                        <p>What is 1010 in binary equal to in denary?</p>
                        <div class="options">
                            <div class="option" onclick="checkSummary(this, 10, 1)">8</div>
                            <div class="option" onclick="checkSummary(this, 10, 1)">10</div>
                            <div class="option" onclick="checkSummary(this, 10, 1)">12</div>
                            <div class="option" onclick="checkSummary(this, 10, 1)">16</div>
                        </div>
                    </div>

                    <div class="question-container">
                        <h3>Question 2</h3>
                        <p>Which number system uses base 16?</p>
                        <input type="text" id="summary-2" placeholder="Enter your answer" class="no-paste">
                        <button class="button" onclick="checkSummaryText(2, ['hexadecimal', 'hex'])">Check</button>
                    </div>

                    <div class="question-container">
                        <h3>Question 3</h3>
                        <p>True or False: BCD uses 4 bits to represent each decimal digit.</p>
                        <div class="options">
                            <div class="option" onclick="checkSummary(this, true, 3)">True</div>
                            <div class="option" onclick="checkSummary(this, true, 3)">False</div>
                        </div>
                    </div>

                    <div class="question-container">
                        <h3>Question 4</h3>
                        <p>Convert hex value 'FF' to denary:</p>
                        <div class="options">
                            <div class="option" onclick="checkSummary(this, 255, 4)">225</div>
                            <div class="option" onclick="checkSummary(this, 255, 4)">255</div>
                            <div class="option" onclick="checkSummary(this, 255, 4)">256</div>
                            <div class="option" onclick="checkSummary(this, 255, 4)">250</div>
                        </div>
                    </div>

                    <div class="question-container">
                        <h3>Question 5</h3>
                        <p>What is the maximum value that can be stored in 4 bits?</p>
                        <input type="number" id="summary-5" placeholder="Enter number" class="no-paste">
                        <button class="button" onclick="checkSummaryNumber(5, 15)">Check</button>
                    </div>

                    <div class="question-container">
                        <h3>Question 6</h3>
                        <p>Which of these is NOT a valid hexadecimal digit?</p>
                        <div class="options">
                            <div class="option" onclick="checkSummary(this, 'G', 6)">A</div>
                            <div class="option" onclick="checkSummary(this, 'G', 6)">F</div>
                            <div class="option" onclick="checkSummary(this, 'G', 6)">G</div>
                            <div class="option" onclick="checkSummary(this, 'G', 6)">9</div>
                        </div>
                    </div>

                    <div class="question-container">
                        <h3>Question 7</h3>
                        <p>Convert binary 11111111 to denary:</p>
                        <input type="number" id="summary-7" placeholder="Enter answer" class="no-paste">
                        <button class="button" onclick="checkSummaryNumber(7, 255)">Check</button>
                    </div>

                    <div class="question-container">
                        <h3>Question 8</h3>
                        <p>In BCD, the number 47 would be represented as:</p>
                        <div class="options">
                            <div class="option" onclick="checkSummary(this, '0100 0111', 8)">0100 0111</div>
                            <div class="option" onclick="checkSummary(this, '0100 0111', 8)">00101111</div>
                            <div class="option" onclick="checkSummary(this, '0100 0111', 8)">0111 0100</div>
                            <div class="option" onclick="checkSummary(this, '0100 0111', 8)">01000111</div>
                        </div>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <h3>Quiz Score: <span id="quiz-score">0</span>/8</h3>
                    <button class="button secondary" onclick="resetSummaryQuiz()">Reset Quiz</button>
                </div>

                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(9)">← Previous</button>
                    <button class="nav-arrow next" onclick="showSection(11)">Next →</button>
                </div>
            </div>
        </div>

        <!-- Section 11: Videos -->
        <div class="section" id="section-11">
            <div class="section-content">
                <h2>Video Resources</h2>
                <p>Additional video tutorials to reinforce your learning:</p>
                
                <div style="background: #f0f9ff; padding: 20px; border-radius: 8px; margin: 20px 0;">
                    <h3>📹 Recommended Videos</h3>
                    <ol>
                        <li><strong>Binary Number System Explained</strong> - 10 minutes</li>
                        <li><strong>Hexadecimal Made Easy</strong> - 8 minutes</li>
                        <li><strong>BCD vs Binary: When to Use Each</strong> - 12 minutes</li>
                        <li><strong>Number System Conversions Practice</strong> - 15 minutes</li>
                        <li><strong>Real World Applications</strong> - 20 minutes</li>
                    </ol>
                    <p><em>Videos will be embedded here when available.</em></p>
                </div>

                <h3>Congratulations!</h3>
                <p>You've completed the Number Systems lesson. Your final stats:</p>
                <div style="text-align: center; font-size: 24px; margin: 20px 0;">
                    <p>Total XP: <strong id="final-xp">0</strong></p>
                    <p>Level Achieved: <strong id="final-level">0</strong></p>
                </div>

                <div class="section-nav">
                    <button class="nav-arrow prev" onclick="showSection(10)">← Previous</button>
                    <button class="nav-arrow next" disabled>Next →</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Feedback Button -->
    <button class="feedback-button" onclick="openFeedbackModal()" aria-label="Send Feedback">💬</button>

    <!-- Feedback Modal -->
    <div class="modal" id="feedbackModal">
        <div class="modal-content">
            <h2>Send Feedback</h2>
            <p>Found a bug or have a suggestion? Let us know!</p>
            <textarea id="feedbackText" rows="6" placeholder="Describe the issue or suggestion..." style="width: 100%; margin: 15px 0;"></textarea>
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button class="button secondary" onclick="closeFeedbackModal()">Cancel</button>
                <button class="button" onclick="sendFeedback()">Send</button>
            </div>
        </div>
    </div>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <div class="achievement-icon">🏆</div>
        <h3 id="achievementTitle">Achievement Unlocked!</h3>
        <p id="achievementDesc">Description</p>
    </div>

    <!-- Paste Shame Message -->
    <div class="paste-shame" id="pasteShame">
        ❌ Pasting is disabled! Type your answer to learn better.
    </div>

    <script>
        // Global Variables
        let currentSection = 0;
        let totalXP = 0;
        let currentLevel = 0;
        let achievements = new Set();
        let sectionProgress = new Array(12).fill(false);
        let canvas, ctx;
        let isDrawing = false;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize drawing canvas
            canvas = document.getElementById('drawingCanvas');
            ctx = canvas.getContext('2d');
            setupCanvas();
            
            // Initialize fraction canvas
            const fractionCanvas = document.getElementById('fractionCanvas');
            if (fractionCanvas) {
                const fractionCtx = fractionCanvas.getContext('2d');
                setupCanvas(fractionCanvas, fractionCtx);
            }
            
            // Initialize BCD canvas
            const bcdCanvas = document.getElementById('bcdCanvas');
            if (bcdCanvas) {
                const bcdCtx = bcdCanvas.getContext('2d');
                setupCanvas(bcdCanvas, bcdCtx);
            }
            
            // Prevent paste
            document.addEventListener('paste', preventPaste);
            
            // Update display
            updateXPDisplay();
        });

        // Canvas Setup
        function setupCanvas(canvasEl = canvas, context = ctx) {
            canvasEl.addEventListener('mousedown', startDrawing);
            canvasEl.addEventListener('mousemove', draw);
            canvasEl.addEventListener('mouseup', stopDrawing);
            canvasEl.addEventListener('mouseout', stopDrawing);
            
            // Touch events
            canvasEl.addEventListener('touchstart', handleTouch);
            canvasEl.addEventListener('touchmove', handleTouch);
            canvasEl.addEventListener('touchend', stopDrawing);
        }

        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            ctx.beginPath();
            ctx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
        }

        function draw(e) {
            if (!isDrawing) return;
            const rect = canvas.getBoundingClientRect();
            ctx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            ctx.stroke();
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent(e.type === 'touchstart' ? 'mousedown' : 
                                            e.type === 'touchmove' ? 'mousemove' : 'mouseup', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            awardXP(5, 'Canvas Cleared');
        }

        function clearFractionCanvas() {
            const fractionCanvas = document.getElementById('fractionCanvas');
            const fractionCtx = fractionCanvas.getContext('2d');
            fractionCtx.clearRect(0, 0, fractionCanvas.width, fractionCanvas.height);
        }

        function saveCanvas() {
            const dataURL = canvas.toDataURL();
            awardXP(10, 'Work Saved');
        }

        // Navigation
        function showSection(index) {
            const sections = document.querySelectorAll('.section');
            const navButtons = document.querySelectorAll('.nav-button');
            
            sections.forEach(s => s.classList.remove('active'));
            navButtons.forEach(b => b.classList.remove('active'));
            
            sections[index].classList.add('active');
            navButtons[index].classList.add('active');
            currentSection = index;
            
            // Update final stats on last section
            if (index === 11) {
                document.getElementById('final-xp').textContent = totalXP;
                document.getElementById('final-level').textContent = currentLevel;
            }
        }

        // XP and Achievement System
        function awardXP(points, reason, achievementId = null) {
            if (achievementId && achievements.has(achievementId)) return;
            
            totalXP += points;
            updateXPDisplay();
            
            if (achievementId) {
                achievements.add(achievementId);
                showAchievement(reason, `+${points} XP`);
            }
        }

        function updateXPDisplay() {
            document.getElementById('totalXP').textContent = totalXP;
            
            // Calculate level (100 XP per level, max level 5)
            const newLevel = Math.min(5, Math.floor(totalXP / 100));
            if (newLevel > currentLevel) {
                currentLevel = newLevel;
                showAchievement(`Level ${currentLevel} Reached!`, 'Keep up the great work!');
            }
            document.getElementById('currentLevel').textContent = currentLevel;
        }

        function showAchievement(title, desc) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementTitle').textContent = title;
            document.getElementById('achievementDesc').textContent = desc;
            
            popup.classList.add('show');
            setTimeout(() => popup.classList.remove('show'), 3000);
        }

        // Prevent Paste
        function preventPaste(e) {
            e.preventDefault();
            const shame = document.getElementById('pasteShame');
            shame.style.display = 'block';
            setTimeout(() => shame.style.display = 'none', 2000);
        }

        // Section 1: Starter Activity
        function checkStarter(element, correct, questionNum) {
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => opt.onclick = null);
            
            const isCorrect = element.textContent.toLowerCase().includes(correct.toString());
            element.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            const feedback = document.getElementById(`starter-feedback-${questionNum}`);
            feedback.className = 'feedback show ' + (isCorrect ? 'success' : 'error');
            feedback.textContent = isCorrect ? '✓ Correct!' : '✗ Not quite. ' + getStarterHint(questionNum);
            
            if (isCorrect) {
                awardXP(10, 'Starter Question Correct', `starter-${questionNum}`);
            }
        }

        function checkStarterInput(questionNum, acceptableAnswers) {
            const input = document.getElementById(`starter-input-${questionNum}`).value.toLowerCase().trim();
            const isCorrect = acceptableAnswers.some(answer => input === answer.toLowerCase());
            
            const feedback = document.getElementById(`starter-feedback-${questionNum}`);
            feedback.className = 'feedback show ' + (isCorrect ? 'success' : 'error');
            feedback.textContent = isCorrect ? '✓ Correct!' : '✗ Not quite. Think about the fundamental digits in binary.';
            
            if (isCorrect) {
                awardXP(15, 'Starter Input Correct', `starter-input-${questionNum}`);
            }
        }

        function getStarterHint(questionNum) {
            const hints = {
                1: 'Think about the number system you use every day.',
                2: 'Binary only uses two digits.',
                3: 'Think about CSS color codes like #FF00FF.'
            };
            return hints[questionNum] || 'Try again!';
        }

        // Section 2: Denary System
        function updateDenary() {
            const thousands = parseInt(document.getElementById('denary-1000').value) || 0;
            const hundreds = parseInt(document.getElementById('denary-100').value) || 0;
            const tens = parseInt(document.getElementById('denary-10').value) || 0;
            const ones = parseInt(document.getElementById('denary-1').value) || 0;
            
            const total = thousands * 1000 + hundreds * 100 + tens * 10 + ones;
            document.getElementById('denary-result').textContent = total;
            document.getElementById('denary-calc').textContent = 
                `(${thousands}×1000) + (${hundreds}×100) + (${tens}×10) + (${ones}×1) = ${total}`;
            
            awardXP(5, 'Denary Exploration', 'denary-explore');
        }

        function checkDenaryShort() {
            const answer = document.getElementById('denary-short').value.toLowerCase();
            const keywords = ['finger', 'ten', 'digit', 'hand', 'count', 'historical', 'human'];
            const keywordCount = keywords.filter(keyword => answer.includes(keyword)).length;
            
            const feedback = document.getElementById('denary-short-feedback');
            
            if (answer.length < 50) {
                feedback.className = 'feedback show error';
                feedback.textContent = 'Please provide a more detailed answer.';
                return;
            }
            
            const xp = Math.min(keywordCount * 10, 30);
            if (xp > 0) {
                feedback.className = 'feedback show success';
                feedback.textContent = `✓ Good answer! You mentioned ${keywordCount} relevant concepts.`;
                awardXP(xp, 'Denary Explanation', 'denary-short');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = 'Consider mentioning fingers, historical context, or human counting methods.';
            }
        }

        // Section 3: Binary System
        let binaryBits = [0, 0, 0, 0, 0, 0, 0, 0];

        function toggleBit(index) {
            const bitElement = document.getElementById(`bit-${index}`);
            const bitBox = bitElement.parentElement;
            
            binaryBits[index] = binaryBits[index] === 0 ? 1 : 0;
            bitElement.textContent = binaryBits[index];
            
            if (binaryBits[index] === 1) {
                bitBox.classList.add('active');
            } else {
                bitBox.classList.remove('active');
            }
            
            updateBinaryDisplay();
            awardXP(2, 'Binary Bit Toggled', 'binary-toggle');
        }

        function updateBinaryDisplay() {
            const binaryString = binaryBits.join('');
            const denaryValue = parseInt(binaryString, 2);
            
            document.getElementById('binary-value').textContent = binaryString;
            document.getElementById('denary-value').textContent = denaryValue;
            
            // Calculate which bits contribute
            const powers = [128, 64, 32, 16, 8, 4, 2, 1];
            const contributions = [];
            binaryBits.forEach((bit, i) => {
                if (bit === 1) {
                    contributions.push(powers[i]);
                }
            });
            
            const calcText = contributions.length > 0 
                ? contributions.join(' + ') + ' = ' + denaryValue
                : 'No bits set';
            document.getElementById('binary-calc').textContent = calcText;
        }

        function resetBinary() {
            binaryBits = [0, 0, 0, 0, 0, 0, 0, 0];
            for (let i = 0; i < 8; i++) {
                document.getElementById(`bit-${i}`).textContent = '0';
                document.getElementById(`bit-${i}`).parentElement.classList.remove('active');
            }
            updateBinaryDisplay();
        }

        function checkBinaryConversion() {
            const answer = parseInt(document.getElementById('binary-convert-answer').value);
            const correct = 181; // 10110101 in denary
            
            const feedback = document.getElementById('binary-convert-feedback');
            if (answer === correct) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Correct! 10110101 = 128 + 32 + 16 + 4 + 1 = 181';
                awardXP(25, 'Binary Conversion Mastered', 'binary-convert');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = '✗ Not quite. Remember: 128 + 0 + 32 + 16 + 0 + 4 + 0 + 1';
            }
        }

        function checkBinaryReflection() {
            const answer1 = document.getElementById('binary-reflection-1').value;
            const answer2 = document.getElementById('binary-reflection-2').value;
            
            const feedback = document.getElementById('binary-reflection-feedback');
            let points = 0;
            let message = '';
            
            if (answer1.length > 30 && (answer1.includes('electronic') || answer1.includes('on') || answer1.includes('off') || answer1.includes('simple'))) {
                points += 15;
                message += '✓ Good explanation of why computers use binary. ';
            }
            
            if (answer2 === '255') {
                points += 10;
                message += '✓ Correct! 11111111 = 255';
            }
            
            if (points > 0) {
                feedback.className = 'feedback show success';
                feedback.textContent = message;
                awardXP(points, 'Binary Reflection Complete', 'binary-reflection');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = 'Please provide more detailed answers.';
            }
        }

        // Section 4: Hexadecimal
        function updateHexColor() {
            const red = document.getElementById('hex-red').value.toUpperCase();
            const green = document.getElementById('hex-green').value.toUpperCase();
            const blue = document.getElementById('hex-blue').value.toUpperCase();
            
            // Validate hex values
            const validHex = /^[0-9A-F]{2}$/;
            if (!validHex.test(red) || !validHex.test(green) || !validHex.test(blue)) {
                return;
            }
            
            const hexColor = `#${red}${green}${blue}`;
            document.getElementById('color-display').style.background = hexColor;
            document.getElementById('hex-color-code').textContent = hexColor;
            
            // Convert to RGB
            const r = parseInt(red, 16);
            const g = parseInt(green, 16);
            const b = parseInt(blue, 16);
            document.getElementById('rgb-values').textContent = `R: ${r}, G: ${g}, B: ${b}`;
            
            awardXP(5, 'Hex Color Explored', 'hex-color');
        }

        function checkHexMatch(element, hex, correct) {
            const userAnswer = prompt(`What is ${hex} in denary?`);
            if (parseInt(userAnswer) === correct) {
                element.classList.add('correct');
                element.textContent = `${hex} = ${correct} ✓`;
                element.onclick = null;
                awardXP(10, 'Hex Value Matched', `hex-match-${hex}`);
                
                // Check if all matched
                const allButtons = element.parentElement.querySelectorAll('.option');
                const completed = Array.from(allButtons).every(btn => btn.classList.contains('correct'));
                if (completed) {
                    const feedback = document.getElementById('hex-match-feedback');
                    feedback.className = 'feedback show success';
                    feedback.textContent = '✓ Excellent! You matched all hex values correctly!';
                    awardXP(20, 'All Hex Values Matched', 'hex-match-complete');
                }
            } else {
                element.classList.add('incorrect');
                setTimeout(() => element.classList.remove('incorrect'), 1000);
            }
        }

        function checkHexConversion() {
            const aValue = parseInt(document.getElementById('hex-a-value').value);
            const fValue = parseInt(document.getElementById('hex-f-value').value);
            const finalAnswer = parseInt(document.getElementById('hex-final-answer').value);
            
            const feedback = document.getElementById('hex-conversion-feedback');
            
            if (aValue === 10 && fValue === 15 && finalAnswer === 687) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Perfect! 2AF = (2×256) + (10×16) + (15×1) = 512 + 160 + 15 = 687';
                awardXP(30, 'Hex Conversion Mastered', 'hex-conversion');
            } else {
                feedback.className = 'feedback show error';
                let hint = '';
                if (aValue !== 10) hint = 'A = 10 in denary. ';
                if (fValue !== 15) hint += 'F = 15 in denary. ';
                if (finalAnswer !== 687) hint += 'Check your calculation: (2×256) + (10×16) + (15×1)';
                feedback.textContent = '✗ ' + hint;
            }
        }

        function checkHexMC(element, answer) {
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => opt.onclick = null);
            
            const isCorrect = answer === 'compact';
            element.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            const feedback = document.getElementById('hex-mc-feedback');
            feedback.className = 'feedback show ' + (isCorrect ? 'success' : 'error');
            feedback.textContent = isCorrect 
                ? '✓ Correct! Hex provides a compact way to represent binary data.'
                : '✗ Not quite. Think about readability and compactness.';
            
            if (isCorrect) {
                awardXP(15, 'Hex Purpose Understood', 'hex-mc');
            }
        }

        // Section 5: BCD
        function updateBCD() {
            const num = parseInt(document.getElementById('bcd-input').value);
            if (isNaN(num) || num < 0 || num > 999) return;
            
            const digits = num.toString().padStart(3, '0').split('');
            const bcdString = digits.map(d => parseInt(d).toString(2).padStart(4, '0')).join(' ');
            
            document.getElementById('bcd-output').textContent = `BCD: ${bcdString}`;
            
            // Update visual display
            const bcdDigits = ['bcd-digit-1', 'bcd-digit-2', 'bcd-digit-3'];
            digits.forEach((digit, index) => {
                const element = document.getElementById(bcdDigits[index]);
                if (element) {
                    element.textContent = parseInt(digit).toString(2).padStart(4, '0');
                    element.previousElementSibling.textContent = digit;
                }
            });
            
            awardXP(5, 'BCD Conversion Explored', 'bcd-explore');
        }

        function checkBCDCategories() {
            const bcdZone = document.querySelector('[data-category="bcd"]');
            const binaryZone = document.querySelector('[data-category="binary"]');
            
            const bcdItems = bcdZone.querySelectorAll('.draggable');
            const binaryItems = binaryZone.querySelectorAll('.draggable');
            
            let correct = 0;
            let total = 0;
            
            bcdItems.forEach(item => {
                total++;
                if (item.getAttribute('data-category') === 'bcd') correct++;
            });
            
            binaryItems.forEach(item => {
                total++;
                if (item.getAttribute('data-category') === 'binary') correct++;
            });
            
            const feedback = document.getElementById('bcd-category-feedback');
            if (correct === total && total === 8) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Perfect categorization! You understand the differences between BCD and binary.';
                awardXP(25, 'BCD Categories Mastered', 'bcd-categories');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = `✗ ${correct}/${total} correct. Remember: BCD is easier to read but less efficient than binary.`;
            }
        }

        // New BCD functions
        function demonstrateBCDAddition() {
            const examples = [
                { a: 45, b: 37, desc: "45 + 37" },
                { a: 28, b: 54, desc: "28 + 54" },
                { a: 69, b: 47, desc: "69 + 47" }
            ];
            
            const example = examples[Math.floor(Math.random() * examples.length)];
            const demo = document.getElementById('bcd-addition-demo');
            
            const aBCD = example.a.toString().split('').map(d => parseInt(d).toString(2).padStart(4, '0')).join(' ');
            const bBCD = example.b.toString().split('').map(d => parseInt(d).toString(2).padStart(4, '0')).join(' ');
            
            demo.innerHTML = `
                <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <p><strong>Example: ${example.desc}</strong></p>
                    <pre style="font-family: monospace;">
    ${example.a} in BCD: ${aBCD}
  + ${example.b} in BCD: ${bBCD}
  ─────────────────────────────</pre>
                    <p>Try calculating this yourself!</p>
                </div>
            `;
            
            awardXP(5, 'BCD Addition Example Viewed', 'bcd-demo');
        }

        function checkBCDApplications() {
            const dropZones = document.querySelectorAll('.drop-zone');
            let correct = 0;
            let total = 0;
            
            dropZones.forEach(zone => {
                const draggable = zone.querySelector('.draggable');
                if (draggable) {
                    total++;
                    const match = draggable.getAttribute('data-match');
                    const expected = zone.getAttribute('data-correct');
                    
                    if (match === expected) {
                        correct++;
                        zone.classList.add('correct');
                    } else {
                        zone.classList.add('incorrect');
                    }
                }
            });
            
            const feedback = document.getElementById('bcd-apps-feedback');
            if (correct === 3 && total === 3) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Excellent! You understand how BCD is used in real applications.';
                awardXP(20, 'BCD Applications Understood', 'bcd-apps');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = `✗ ${correct}/3 correct. Think about what each application needs most.`;
            }
        }

        function clearBCDCanvas() {
            const bcdCanvas = document.getElementById('bcdCanvas');
            const bcdCtx = bcdCanvas.getContext('2d');
            bcdCtx.clearRect(0, 0, bcdCanvas.width, bcdCanvas.height);
        }

        function checkBCDAddition() {
            const answer = document.getElementById('bcd-addition-answer').value.replace(/\s/g, '');
            const feedback = document.getElementById('bcd-addition-feedback');
            
            // 47 + 38 = 85
            // 47 = 0100 0111, 38 = 0011 1000
            // Direct add: 0111 1111 (invalid)
            // Add 0110: 1000 0101 (85 in BCD)
            
            if (answer === '10000101') {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Correct! 47 + 38 = 85, which is 1000 0101 in BCD after correction.';
                awardXP(30, 'BCD Addition Mastered', 'bcd-addition');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = '✗ Not quite. Remember to add 0110 when a 4-bit group exceeds 9.';
            }
        }

        // Storage Units functions
        function updateStorageConversions() {
            const value = parseFloat(document.getElementById('storage-input').value) || 0;
            const unit = document.getElementById('storage-unit').value;
            const display = document.getElementById('conversion-display');
            
            // Convert to bits first
            let bits = 0;
            switch(unit) {
                case 'bit': bits = value; break;
                case 'byte': bits = value * 8; break;
                case 'kb': bits = value * 1000 * 8; break;
                case 'kib': bits = value * 1024 * 8; break;
                case 'mb': bits = value * 1000000 * 8; break;
                case 'mib': bits = value * 1048576 * 8; break;
                case 'gb': bits = value * 1000000000 * 8; break;
                case 'gib': bits = value * 1073741824 * 8; break;
            }
            
            // Convert to all units
            const conversions = {
                'Bits': bits,
                'Bytes': bits / 8,
                'KB (Decimal)': bits / 8 / 1000,
                'KiB (Binary)': bits / 8 / 1024,
                'MB (Decimal)': bits / 8 / 1000000,
                'MiB (Binary)': bits / 8 / 1048576,
                'GB (Decimal)': bits / 8 / 1000000000,
                'GiB (Binary)': bits / 8 / 1073741824
            };
            
            let html = '<table style="width: 100%;">';
            for (const [unit, value] of Object.entries(conversions)) {
                if (value >= 0.001 && value <= 1000000000) {
                    html += `<tr><td>${unit}:</td><td><strong>${value.toFixed(3)}</strong></td></tr>`;
                }
            }
            html += '</table>';
            
            display.innerHTML = html;
            awardXP(5, 'Storage Conversion Used', 'storage-convert');
        }

        function checkByteValues() {
            const answer = parseInt(document.getElementById('byte-values').value);
            const feedback = document.getElementById('byte-feedback');
            
            if (answer === 256) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Correct! 2^8 = 256 different values (0-255).';
                awardXP(10, 'Byte Values Understood', 'byte-values');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = '✗ Not quite. Remember: 8 bits means 2^8 possible combinations.';
            }
        }

        function checkPowers() {
            const kib = parseInt(document.getElementById('kib-power').value);
            const mib = parseInt(document.getElementById('mib-power').value);
            const gib = parseInt(document.getElementById('gib-power').value);
            const tib = parseInt(document.getElementById('tib-power').value);
            
            const feedback = document.getElementById('powers-feedback');
            let correct = 0;
            
            if (kib === 10) correct++;
            if (mib === 20) correct++;
            if (gib === 30) correct++;
            if (tib === 40) correct++;
            
            if (correct === 4) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Perfect! You understand the binary prefix powers.';
                awardXP(20, 'Binary Prefixes Mastered', 'binary-prefixes');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = `✗ ${correct}/4 correct. Remember: Each level multiplies by 2^10 (1024).`;
            }
        }

        function checkStorageProblem() {
            const answer = document.getElementById('storage-problem').value.toLowerCase();
            const feedback = document.getElementById('storage-problem-feedback');
            
            const keywords = ['17.18', '17.2', 'yes', 'fit', '1610612736', 'difference'];
            const found = keywords.filter(k => answer.includes(k)).length;
            
            if (answer.length < 100) {
                feedback.className = 'feedback show error';
                feedback.textContent = 'Please show more working for all three parts.';
                return;
            }
            
            if (found >= 3) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Excellent! 16 GiB ≈ 17.18 GB, so yes it fits. Difference ≈ 1.61 GB.';
                awardXP(30, 'Storage Problem Solved', 'storage-problem');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = 'Include conversions and explain the binary vs decimal difference.';
            }
        }

        function checkStorageSizes() {
            const zones = document.querySelectorAll('[data-size]');
            let correct = 0;
            let total = 0;
            
            zones.forEach(zone => {
                const items = zone.querySelectorAll('.draggable');
                items.forEach(item => {
                    total++;
                    if (item.getAttribute('data-size') === zone.getAttribute('data-size')) {
                        correct++;
                    }
                });
            });
            
            const feedback = document.getElementById('storage-size-feedback');
            if (correct === 6 && total === 6) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Perfect! You understand typical file sizes.';
                awardXP(15, 'Storage Sizes Categorized', 'storage-sizes');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = `✗ ${correct}/6 correct. Think about typical sizes for each file type.`;
            }
        }

        function checkBCDProblem() {
            const answer = document.getElementById('bcd-problem').value.toLowerCase();
            const feedback = document.getElementById('bcd-problem-feedback');
            
            const keywords = ['0010', '0100', '0101', '12 bits', 'efficient', 'display', 'easier'];
            const foundKeywords = keywords.filter(k => answer.includes(k)).length;
            
            if (answer.length < 100) {
                feedback.className = 'feedback show error';
                feedback.textContent = 'Please provide more detail in your answer.';
                return;
            }
            
            if (foundKeywords >= 3) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Excellent problem-solving! You correctly identified that 2=0010, 4=0100, 5=0101 (12 bits total).';
                awardXP(30, 'BCD Problem Solved', 'bcd-problem');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = 'Include the BCD representations and discuss efficiency vs readability.';
            }
        }

        // Section 6: Real World
        function checkRGBCase() {
            const red = document.getElementById('rgb-red-hex').value.toUpperCase();
            const green = document.getElementById('rgb-green-hex').value.toUpperCase();
            const blue = document.getElementById('rgb-blue-hex').value.toUpperCase();
            const complete = document.getElementById('complete-hex').value.toUpperCase();
            
            const feedback = document.getElementById('rgb-case-feedback');
            
            if (red === '80' && green === '00' && blue === 'FF' && complete === '#8000FF') {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Perfect! You correctly converted RGB(128,0,255) to #8000FF';
                awardXP(25, 'RGB Case Study Complete', 'rgb-case');
            } else {
                feedback.className = 'feedback show error';
                let hint = '';
                if (red !== '80') hint = '128 ÷ 16 = 8 remainder 0, so 80 in hex. ';
                if (green !== '00') hint += '0 = 00 in hex. ';
                if (blue !== 'FF') hint += '255 = FF in hex. ';
                feedback.textContent = '✗ ' + hint;
            }
        }

        function checkApplicationMatch() {
            const dropZones = document.querySelectorAll('.drop-zone');
            let correct = 0;
            
            dropZones.forEach(zone => {
                const draggable = zone.querySelector('.draggable');
                if (draggable && draggable.getAttribute('data-match') === zone.getAttribute('data-correct')) {
                    correct++;
                    zone.classList.add('correct');
                } else if (draggable) {
                    zone.classList.add('incorrect');
                }
            });
            
            const feedback = document.getElementById('application-feedback');
            if (correct === 4) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Excellent! You understand where each number system is used.';
                awardXP(20, 'Applications Understood', 'applications');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = `✗ ${correct}/4 correct. Think about the practical uses of each system.`;
            }
        }

        // Section 7: Extension
        function checkExtension1() {
            const answer = document.getElementById('extension-1').value;
            const feedback = document.getElementById('extension-1-feedback');
            
            const keywords = ['125', '25', '5', '1', 'place value', 'power', 'base', '69'];
            const found = keywords.filter(k => answer.includes(k)).length;
            
            if (answer.length < 100) {
                feedback.className = 'feedback show error';
                feedback.textContent = 'Please provide a more detailed design.';
                return;
            }
            
            if (found >= 4) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Excellent design! Place values would be 125, 25, 5, 1. 234₅ = 69₁₀';
                awardXP(40, 'Custom Number System Created', 'extension-1');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = 'Include place values and show the conversion of 234 to denary.';
            }
        }

        function checkFractionAnswer() {
            const answer = document.getElementById('fraction-answer').value;
            const feedback = document.getElementById('fraction-feedback');
            
            // 0.1011 = 0.5 + 0.125 + 0.0625 = 0.6875
            if (answer === '0.6875' || answer === '.6875') {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Correct! 0.1011₂ = 0.5 + 0.125 + 0.0625 = 0.6875₁₀';
                awardXP(35, 'Binary Fractions Mastered', 'binary-fractions');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = '✗ Not quite. Remember: 2⁻¹=0.5, 2⁻²=0.25, 2⁻³=0.125, 2⁻⁴=0.0625';
            }
        }

        function checkTwosComplement() {
            const answer = document.getElementById('twos-complement').value.replace(/\s/g, '');
            const feedback = document.getElementById('twos-feedback');
            
            if (answer === '11010110') {
                feedback.className = 'feedback show success';
                feedback.textContent = "✓ Correct! +42 = 00101010, one's complement = 11010101, two's complement = 11010110";
                awardXP(40, "Two's Complement Mastered", 'twos-complement');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = "✗ Not quite. Start with +42 = 00101010, then invert all bits, then add 1.";
            }
        }

        // Section 8: Exam Questions
        function checkExam1() {
            const predicted = parseInt(document.getElementById('predicted-1').value);
            const markScheme = document.getElementById('mark-scheme-1');
            
            if (predicted >= 2) {
                markScheme.classList.add('show');
                awardXP(20, 'Exam Question 1 Attempted', 'exam-1');
            } else {
                alert('Please predict at least 2 marks to show your attempt before viewing the mark scheme.');
            }
        }

        function checkExam2() {
            const predicted = parseInt(document.getElementById('predicted-2').value);
            const markScheme = document.getElementById('mark-scheme-2');
            
            if (predicted >= 3) {
                markScheme.classList.add('show');
                awardXP(25, 'Exam Question 2 Attempted', 'exam-2');
            } else {
                alert('Please predict at least 3 marks to show your attempt before viewing the mark scheme.');
            }
        }

        // Section 9: Summary Quiz
        let summaryScore = 0;
        let summaryAnswered = new Set();

        function checkSummary(element, correct, questionNum) {
            if (summaryAnswered.has(questionNum)) return;
            
            const options = element.parentElement.querySelectorAll('.option');
            options.forEach(opt => opt.onclick = null);
            
            const userAnswer = element.textContent;
            let isCorrect = false;
            
            if (typeof correct === 'number') {
                isCorrect = parseInt(userAnswer) === correct;
            } else if (typeof correct === 'boolean') {
                isCorrect = (userAnswer === 'True') === correct;
            } else {
                isCorrect = userAnswer === correct;
            }
            
            element.classList.add(isCorrect ? 'correct' : 'incorrect');
            
            if (isCorrect) {
                summaryScore++;
                summaryAnswered.add(questionNum);
                updateSummaryScore();
            }
        }

        function checkSummaryText(questionNum, acceptableAnswers) {
            if (summaryAnswered.has(questionNum)) return;
            
            const input = document.getElementById(`summary-${questionNum}`).value.toLowerCase().trim();
            const isCorrect = acceptableAnswers.some(ans => input === ans.toLowerCase());
            
            if (isCorrect) {
                document.getElementById(`summary-${questionNum}`).style.borderColor = '#10b981';
                summaryScore++;
                summaryAnswered.add(questionNum);
                updateSummaryScore();
            } else {
                document.getElementById(`summary-${questionNum}`).style.borderColor = '#ef4444';
            }
        }

        function checkSummaryNumber(questionNum, correct) {
            if (summaryAnswered.has(questionNum)) return;
            
            const answer = parseInt(document.getElementById(`summary-${questionNum}`).value);
            
            if (answer === correct) {
                document.getElementById(`summary-${questionNum}`).style.borderColor = '#10b981';
                summaryScore++;
                summaryAnswered.add(questionNum);
                updateSummaryScore();
            } else {
                document.getElementById(`summary-${questionNum}`).style.borderColor = '#ef4444';
            }
        }

        function updateSummaryScore() {
            document.getElementById('quiz-score').textContent = summaryScore;
            
            if (summaryScore >= 6 && !achievements.has('quiz-passed')) {
                awardXP(50, 'Summary Quiz Passed!', 'quiz-passed');
            }
            
            if (summaryScore === 8 && !achievements.has('quiz-perfect')) {
                awardXP(100, 'Perfect Score!', 'quiz-perfect');
            }
        }

        function resetSummaryQuiz() {
            summaryScore = 0;
            summaryAnswered.clear();
            updateSummaryScore();
            
            // Reset all visual states
            document.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('correct', 'incorrect');
            });
            document.querySelectorAll('input').forEach(input => {
                input.style.borderColor = '';
                input.value = '';
            });
            
            // Re-enable all quiz options
            location.reload(); // Simple reset for now
        }

        // Drag and Drop
        function allowDrop(ev) {
            ev.preventDefault();
            ev.target.classList.add('hover');
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.outerHTML);
            ev.dataTransfer.setData("answer", ev.target.getAttribute('data-answer') || ev.target.getAttribute('data-match') || ev.target.getAttribute('data-category'));
        }

        function drop(ev) {
            ev.preventDefault();
            ev.target.classList.remove('hover');
            
            const data = ev.dataTransfer.getData("text");
            const answer = ev.dataTransfer.getData("answer");
            
            // Clear the drop zone first
            ev.target.innerHTML = '';
            
            // Add the dragged element
            ev.target.insertAdjacentHTML('beforeend', data);
            
            // Re-enable dragging on the new element
            const newElement = ev.target.querySelector('.draggable');
            if (newElement) {
                newElement.draggable = true;
                newElement.ondragstart = drag;
                newElement.setAttribute('data-answer', answer);
            }
        }

        function checkDragDrop() {
            const dropZones = document.querySelectorAll('.drop-zone');
            let correct = 0;
            let total = 0;
            
            dropZones.forEach(zone => {
                const draggable = zone.querySelector('.draggable');
                if (draggable) {
                    total++;
                    const userAnswer = draggable.getAttribute('data-answer');
                    const correctAnswer = zone.getAttribute('data-correct');
                    
                    if (userAnswer === correctAnswer) {
                        correct++;
                        zone.classList.add('correct');
                    } else {
                        zone.classList.add('incorrect');
                    }
                }
            });
            
            const feedback = document.getElementById('denary-feedback');
            if (correct === total && total === 3) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Perfect! You understand the denary system.';
                awardXP(20, 'Denary Drag-Drop Complete', 'denary-dragdrop');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = `✗ ${correct}/${total} correct. Try again!`;
            }
        }

        function checkBinaryDragDrop() {
            const dropZones = document.querySelectorAll('.drop-zone');
            let correct = 0;
            
            dropZones.forEach(zone => {
                const draggable = zone.querySelector('.draggable');
                if (draggable && draggable.getAttribute('data-answer') === zone.getAttribute('data-correct')) {
                    correct++;
                    zone.classList.add('correct');
                } else if (draggable) {
                    zone.classList.add('incorrect');
                }
            });
            
            const feedback = document.getElementById('binary-drag-feedback');
            if (correct === 4) {
                feedback.className = 'feedback show success';
                feedback.textContent = '✓ Excellent! All binary conversions correct.';
                awardXP(25, 'Binary Matching Complete', 'binary-match');
            } else {
                feedback.className = 'feedback show error';
                feedback.textContent = `✗ ${correct}/4 correct. Review your binary place values.`;
            }
        }

        // Reset Functions
        function resetSection(sectionNum) {
            // Clear all inputs in the section
            const section = document.getElementById(`section-${sectionNum}`);
            section.querySelectorAll('input').forEach(input => {
                input.value = '';
                input.style.borderColor = '';
            });
            section.querySelectorAll('textarea').forEach(textarea => {
                textarea.value = '';
            });
            
            // Reset visual states
            section.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('correct', 'incorrect', 'selected');
            });
            section.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.remove('correct', 'incorrect');
                zone.innerHTML = '';
            });
            section.querySelectorAll('.feedback').forEach(fb => {
                fb.classList.remove('show');
            });
            
            // Section-specific resets
            if (sectionNum === 3) {
                resetBinary();
            }
            if (sectionNum === 5) {
                document.getElementById('bcd-input').value = '938';
                updateBCD();
            }
            if (sectionNum === 6) {
                document.getElementById('storage-input').value = '1';
                document.getElementById('storage-unit').selectedIndex = 0;
                updateStorageConversions();
            }
            
            awardXP(5, 'Section Reset', `reset-${sectionNum}`);
        }

        // Feedback Modal
        function openFeedbackModal() {
            document.getElementById('feedbackModal').classList.add('show');
        }

        function closeFeedbackModal() {
            document.getElementById('feedbackModal').classList.remove('show');
            document.getElementById('feedbackText').value = '';
        }

        function sendFeedback() {
            const feedbackText = document.getElementById('feedbackText').value;
            if (!feedbackText.trim()) {
                alert('Please enter your feedback before sending.');
                return;
            }
            
            const sectionName = document.querySelector('.nav-button.active').textContent;
            const currentSectionId = `section-${currentSection}`;
            
            // In a real implementation, this would send an email
            // For now, we'll just show confirmation
            const subject = encodeURIComponent(`Feedback: Number Systems Lesson - ${sectionName}`);
            const body = encodeURIComponent(`Section: ${sectionName}\nSection ID: ${currentSectionId}\n\nFeedback:\n${feedbackText}`);
            
            // Create mailto link (won't work in all environments)
            window.location.href = `mailto:millingtond@mgs.org?subject=${subject}&body=${body}`;
            
            closeFeedbackModal();
            showAchievement('Feedback Sent', 'Thank you for your feedback!');
            awardXP(10, 'Feedback Provided', 'feedback-sent');
        }

        // Accessibility Features
        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
        }

        function toggleDyslexiaFont() {
            document.body.classList.toggle('dyslexia-font');
        }

        function adjustFontSize(change) {
            const root = document.documentElement;
            const currentSize = parseInt(getComputedStyle(root).getPropertyValue('--font-size'));
            const newSize = Math.max(12, Math.min(24, currentSize + change));
            root.style.setProperty('--font-size', newSize + 'px');
        }

        // Initialize on load
        window.addEventListener('load', function() {
            showSection(0);
            updateXPDisplay();
            updateStorageConversions();
        });
    </script>
</body>
</html>