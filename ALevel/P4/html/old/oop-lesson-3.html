<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 3: Methods and Behaviors</title>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
    background: #f5f7fa;
    color: #1a202c;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: transparent;
        }

        /* Header Styles */
        .lesson-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .lesson-header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }

        .lesson-meta {
            display: flex;
            gap: 2rem;
            font-size: 0.9rem;
            opacity: 0.9;
            flex-wrap: wrap;
        }

        .breadcrumb {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        /* Section Styles */
.section {
    background: #ffffff;
    color: #1a202c;
    padding: 2rem;
    border-radius: 10px;
    margin-bottom: 2rem;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

        .section.completed {
            border-left: 5px solid #48bb78;
        }

        .section.completed::after {
            content: "‚úì";
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: #48bb78;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

/* Fix section headers */
.section h2 {
    color: #2d3748;
    font-size: 1.8rem;
    margin-bottom: 1.5rem;
    font-weight: 700;
}

.section h3 {
    color: #4a5568;
    font-size: 1.4rem;
    margin: 1.5rem 0 1rem;
    font-weight: 600;
}

.section h4 {
    color: #667eea;
    font-size: 1.2rem;
    margin-bottom: 1rem;
    font-weight: 600;
}

        /* Starter Activity Styles */
        .starter-activity {
            background: #f0f4ff;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
        }

        /* Learning Outcomes */
        .outcomes {
            background: #e6fffa;
            border-left: 4px solid #38b2ac;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }
        .python-editor {
    min-height: 300px;
    margin: 1rem 0;
}

        .outcomes ul {
            list-style-position: inside;
            margin-top: 0.5rem;
        }

        .outcomes li {
            margin: 0.5rem 0;
        }

        /* Core Concepts */
        .concept-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }

.concept-card {
    background: #f8f9fa;  /* Light background */
    padding: 1.5rem;
    border-radius: 8px;
    border: 2px solid #e2e8f0;
    color: #2d3748;  /* Dark text for contrast */
}

.concept-card h4 {
    color: #667eea;
    margin-bottom: 0.8rem;
    font-size: 1.3rem;
}

.concept-card pre {
    background: #1a202c;  /* Dark background for code */
    color: #f0f0f0;      /* Light text for code */
    padding: 1rem;
    border-radius: 6px;
    margin: 1rem 0;
    font-size: 0.9rem;
    overflow-x: auto;
}

        .concept-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .concept-card h4 {
            color: #667eea;
            margin-bottom: 0.5rem;
        }

        /* Button Styles */
.button {
    background: #667eea;
    color: white;
    border: none;
    padding: 0.8rem 1.5rem;
    border-radius: 4px;
    font-weight: 600;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.button:hover {
    background: #5a67d8;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

        .button:active {
            transform: translateY(0);
        }

        .button:disabled {
            background: #a0aec0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

.button.secondary {
    background: #718096;
    color: white;
}

.button.secondary:hover {
    background: #4a5568;
}

.button.success {
    background: #48bb78;
    color: white;
}

        .button.success:hover {
            background: #38a169;
        }

.button.warning {
    background: #f6ad55;
    color: #2d3748;
}

        .button.warning:hover {
            background: #ed8936;
        }

        .button.danger {
            background: #e53e3e;
        }

        .button.danger:hover {
            background: #c53030;
        }

        /* Progress Bar */
        .progress-bar {
            background: #e2e8f0;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin: 2rem 0;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #667eea, #764ba2);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-text {
            position: absolute;
            top: -25px;
            right: 0;
            font-size: 0.8rem;
            color: #4a5568;
        }

        /* Robot Control Panel */
        .robot-panel {
            background: #1a202c;
            color: #f7fafc;
            border-radius: 10px;
            padding: 2rem;
            margin: 1.5rem 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }

        .robot-display {
            background: #2d3748;
            border: 2px solid #4a5568;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            margin-bottom: 2rem;
        }

        .robot-emoji {
            font-size: 4rem;
            margin: 1rem 0;
            transition: transform 0.3s ease;
            display: inline-block;
        }

        .robot-emoji.animate {
            animation: robotPulse 0.5s ease;
        }

        @keyframes robotPulse {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.2) rotate(10deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .robot-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .status-item {
            background: #4a5568;
            padding: 0.8rem;
            border-radius: 6px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .status-item.updated {
            background: #667eea;
            animation: statusPulse 0.5s ease;
        }

        @keyframes statusPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .status-label {
            font-size: 0.8rem;
            opacity: 0.8;
        }

        .status-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4299e1;
        }

        .robot-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

/* Fix code editor containers */
.code-editor-container {
    background: #f8f9fa;
    border: 1px solid #e2e8f0;
    padding: 1.5rem;
    border-radius: 8px;
    margin: 1.5rem 0;
}

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .editor-title {
            font-weight: bold;
            color: #4a5568;
        }

.editor-status {
    padding: 0.3rem 1rem;
    border-radius: 4px;
    font-size: 0.9rem;
    font-weight: bold;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.editor-status.ready {
    background: #48bb78;
    color: white;
}

        .editor-status.running {
            background: #f6ad55;
            color: white;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .editor-status.error {
            background: #e53e3e;
            color: white;
        }
/* Fix CodeMirror editor */
.CodeMirror {
    height: auto;
    min-height: 300px;
    background: #ffffff;
    border: 2px solid #e2e8f0;
    border-radius: 4px;
}
.code-editor-container .CodeMirror {
    display: block !important;
    visibility: visible !important;
}

/* Fix code output areas */
.code-output {
    background: #1a202c;
    color: #f0f0f0;
    border: 2px solid #2d3748;
    padding: 1rem;
    border-radius: 4px;
    margin-top: 1rem;
}

.output-clear {
    background: #4a5568;
    color: white;
    border: none;
    padding: 0.3rem 0.8rem;
    border-radius: 3px;
    font-size: 0.8rem;
    cursor: pointer;
    font-weight: 600;
    transition: background 0.3s ease;
}

.output-clear:hover {
    background: #2d3748;
}

        .code-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .code-timer {
            color: #718096;
            font-size: 0.9rem;
        }

        /* Method Type Cards */
        .method-type-card {
            background: white;
            border: 2px solid #667eea;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            position: relative;
            overflow: hidden;
        }

        .method-type-badge {
            position: absolute;
            top: 0;
            right: 0;
            background: #667eea;
            color: white;
            padding: 0.3rem 1rem;
            border-radius: 0 6px 0 8px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        /* State Viewer */
        .state-viewer {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .state-display {
            background: white;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 1rem;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            max-height: 300px;
            overflow-y: auto;
        }

        .state-property {
            display: flex;
            justify-content: space-between;
            padding: 0.5rem;
            border-bottom: 1px solid #e2e8f0;
            transition: background 0.3s ease;
        }

        .state-property:hover {
            background: #f8f9fa;
        }

        .state-property:last-child {
            border-bottom: none;
        }

        .property-name {
            font-weight: bold;
            color: #4a5568;
        }

        .property-value {
            color: #0ea5e9;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .property-value.string {
            color: #059669;
        }

        .property-value.number {
            color: #dc2626;
        }

        .property-value.boolean {
            color: #7c3aed;
        }

        .property-value.array {
            color: #ea580c;
        }

        /* Method Chain Builder */
        .chain-builder {
            background: #fef5e7;
            border: 2px solid #f6ad55;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .chain-step {
            background: white;
            border: 1px solid #f6ad55;
            border-radius: 6px;
            padding: 1rem;
            margin: 0.5rem 0;
            display: flex;
            align-items: center;
            gap: 1rem;
            transition: transform 0.2s ease;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .chain-step:hover {
            transform: translateX(5px);
        }

        .chain-arrow {
            color: #f6ad55;
            font-size: 1.5rem;
            font-weight: bold;
        }

        /* Real World Connection */
        .real-world {
            background: #fef5e7;
            border-left: 4px solid #f39c12;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .real-world h3 {
            color: #f39c12;
            margin-bottom: 1rem;
        }

        /* Exam Question Styles */
        .exam-question {
            background: #f7fafc;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            border: 2px solid #667eea;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .marks {
            background: #667eea;
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-weight: bold;
        }

        .answer-area {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            border: 2px solid #e2e8f0;
            border-radius: 4px;
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .answer-area:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .exam-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .predicted-mark {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .mark-scheme {
            background: #e6fffa;
            padding: 1rem;
            border-radius: 4px;
            margin-top: 1rem;
            display: none;
            border-left: 4px solid #38b2ac;
        }

        .mark-scheme.visible {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Key Takeaways */
        .key-takeaways {
            background: #f0fff4;
            border-left: 4px solid #48bb78;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .key-takeaways ul {
            list-style-type: none;
            padding-left: 0;
        }

        .key-takeaways li {
            margin: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .key-takeaways li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #48bb78;
            font-weight: bold;
        }

        /* Video Section */
        .video-container {
            margin: 1.5rem 0;
            background: #f7fafc;
            padding: 1rem;
            border-radius: 8px;
        }

        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            margin-bottom: 1rem;
            border-radius: 8px;
            background: #000;
        }

        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 8px;
        }

        .video-notes {
            margin-top: 1rem;
        }

        .video-notes textarea {
            width: 100%;
            min-height: 100px;
            padding: 0.8rem;
            border: 2px solid #e2e8f0;
            border-radius: 4px;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .video-notes textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        /* Extension Activities */
        .extension {
            background: #fef5e7;
            border-left: 4px solid #f39c12;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        /* What's Next */
        .whats-next {
            background: #f0f4ff;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
            text-align: center;
        }

        .next-lesson-card {
            display: inline-block;
            background: white;
            padding: 1rem 2rem;
            border-radius: 8px;
            margin-top: 1rem;
            text-decoration: none;
            color: #333;
            border: 2px solid #667eea;
            transition: all 0.3s ease;
        }

        .next-lesson-card:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        /* Loading Indicator */
        .loading {
            text-align: center;
            padding: 2rem;
            color: #667eea;
        }

        .loading::after {
            content: "...";
            animation: dots 1.5s steps(4, end) infinite;
        }

        @keyframes dots {
            0%, 20% { content: ""; }
            40% { content: "."; }
            60% { content: ".."; }
            80%, 100% { content: "..."; }
        }

        /* Method Builder Interface */
        .method-builder {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 2rem;
            margin: 1.5rem 0;
        }

        .method-template {
            background: white;
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        }

        .method-part {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            margin: 0.2rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .method-part.definition {
            background: #667eea;
            color: white;
        }

        .method-part.parameter {
            background: #48bb78;
            color: white;
        }

        .method-part.body {
            background: #f6ad55;
            color: white;
        }

        .method-part.return {
            background: #e53e3e;
            color: white;
        }
        .code-editor-container h4 {
    color: #2d3748;
    font-weight: 700;
    font-size: 1.3rem;
    margin-bottom: 1rem;
}
.button::before {
    margin-right: 0.5rem;
    font-weight: normal;
}

        /* Best Practices Box */
.best-practice {
    background: #f0fff4;
    border-left: 4px solid #48bb78;
    padding: 1.5rem;
    margin: 1rem 0;
    border-radius: 4px;
    color: #1a202c;
}

.best-practice h5 {
    color: #276749;
    margin-bottom: 0.5rem;
    font-weight: 600;
}

        /* Common Mistake Box */
        .common-mistake {
            background: #fff5f5;
            border-left: 4px solid #e53e3e;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .common-mistake h5 {
            color: #742a2a;
            margin-bottom: 0.5rem;
        }

        /* Success/Error Messages */
        .message {
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            font-weight: 500;
            animation: messageSlide 0.3s ease;
        }

        @keyframes messageSlide {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .message.success {
            background: #f0fff4;
            color: #276749;
            border: 1px solid #68d391;
        }

        .message.error {
            background: #fff5f5;
            color: #742a2a;
            border: 1px solid #fc8181;
        }

        .message.info {
            background: #ebf8ff;
            color: #2c5282;
            border: 1px solid #90cdf4;
        }

        .message.warning {
            background: #fffbeb;
            color: #92400e;
            border: 1px solid #fbbf24;
        }

        /* Hint System */
        .hint-container {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            display: none;
        }

        .hint-container.visible {
            display: block;
            animation: slideDown 0.3s ease;
        }

        .hint-container h5 {
            color: #0369a1;
            margin-bottom: 0.5rem;
        }

        .hint-container ul {
            list-style-position: inside;
        }

        .hint-container li {
            margin: 0.5rem 0;
        }

        /* Activity Complete Badge */
        .activity-badge {
            display: inline-block;
            background: #48bb78;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 1rem;
            animation: badgePop 0.5s ease;
        }

        @keyframes badgePop {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .lesson-header h1 {
                font-size: 1.8rem;
            }
            
            .lesson-meta {
                flex-direction: column;
                gap: 0.5rem;
            }
            
            .concept-grid {
                grid-template-columns: 1fr;
            }
            
            .robot-controls {
                grid-template-columns: 1fr 1fr;
            }
            
            .exam-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .code-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .robot-status {
                grid-template-columns: 1fr 1fr;
            }

            .chain-step {
                flex-direction: column;
                text-align: center;
            }

            .chain-arrow {
                transform: rotate(90deg);
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 10px;
            }

            .section {
                padding: 1rem;
            }

            .robot-controls {
                grid-template-columns: 1fr;
            }

            .robot-status {
                grid-template-columns: 1fr;
            }

            .robot-emoji {
                font-size: 3rem;
            }
        }

        /* Accessibility */
        .button:focus,
        .answer-area:focus,
        textarea:focus,
        input:focus {
            outline: 2px solid #667eea;
            outline-offset: 2px;
        }

        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            text-decoration: none;
            border-radius: 0 0 4px 0;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Print Styles */
        @media print {
            .code-controls,
            .robot-controls,
            .loading,
            .output-clear,
            .button {
                display: none;
            }
            
            .section {
                box-shadow: none;
                border: 1px solid #e2e8f0;
                page-break-inside: avoid;
            }

            .code-output {
                background: white;
                color: black;
                border: 1px solid #e2e8f0;
            }
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            body {
                background: #f5f7fa;
                color: #1a202c;
            }

            .section, .breadcrumb {
                background: #ffffff;
                color: #1a202c;
            }

            .concept-card {
                background: #374151;
                border-color: #4b5563;
            }

            .code-editor-container {
                background: #f8f9fa;
            }

            .answer-area, textarea {
                background: #1f2937;
                color: #f7fafc;
                border-color: #4b5563;
            }
        }

        /* Fix concept cards readability */
.concept-card {
    background: #ffffff;
    padding: 1.8rem;
    border-radius: 10px;
    border: 2px solid #e2e8f0;
    color: #2d3748;
    box-shadow: 0 2px 8px rgba(0,0,0,0.06);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.concept-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.concept-card h4 {
    color: #667eea;
    margin-bottom: 1rem;
    font-size: 1.3rem;
    font-weight: 600;
}

.concept-card p {
    color: #4a5568;
    margin-bottom: 1rem;
    line-height: 1.6;
}

.concept-card ul {
    color: #4a5568;
}

.concept-card pre {
    background: #1a202c;
    color: #e2e8f0;
    padding: 1.2rem;
    border-radius: 6px;
    margin: 1rem 0;
    font-size: 0.9rem;
    overflow-x: auto;
    border: 1px solid #2d3748;
}

/* Interactive code inputs */
.code-input {
    background: #fef5e7;
    border: 2px solid #f6ad55;
    border-radius: 4px;
    padding: 0.2rem 0.5rem;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 0.9em;
    width: auto;
    min-width: 120px;
    display: inline-block;
    margin: 0 0.2rem;
}

.code-input:focus {
    outline: none;
    border-color: #ed8936;
    background: #fffaf0;
}

.code-input.correct {
    border-color: #48bb78;
    background: #f0fff4;
}

.code-input.incorrect {
    border-color: #e53e3e;
    background: #fff5f5;
}

.method-template {
    background: #f8f9fa;
    color: #2d3748;
    padding: 1.5rem;
    border-radius: 8px;
    border: 2px solid #e2e8f0;
    font-size: 0.95rem;
    line-height: 1.8;
}

.feedback-message {
    margin-top: 1rem;
    padding: 1rem;
    border-radius: 6px;
    display: none;
}

.feedback-message.success {
    background: #f0fff4;
    color: #276749;
    border: 1px solid #48bb78;
    display: block;
}

.feedback-message.error {
    background: #fff5f5;
    color: #c53030;
    border: 1px solid #e53e3e;
    display: block;
}

/* Method Anatomy Styles */
.task-list {
    margin: 1rem 0;
}

.task-item {
    background: #f0f9ff;
    border-left: 4px solid #0ea5e9;
    padding: 1rem;
    margin: 0.8rem 0;
    border-radius: 4px;
    font-size: 0.95rem;
}

.task-item strong {
    color: #0369a1;
    display: block;
    margin-bottom: 0.5rem;
    font-size: 1.1rem;
}

.task-item code {
    background: #1e293b;
    color: #fbbf24;
    padding: 0.2rem 0.5rem;
    border-radius: 3px;
    font-size: 0.9rem;
}

.hint-box {
    background: #fef3c7;
    border: 2px solid #f59e0b;
    padding: 1rem;
    border-radius: 6px;
    margin-top: 1rem;
}

.method-explanation-box {
    background: #f0f9ff;
    border: 2px solid #0ea5e9;
    padding: 1.5rem;
    border-radius: 8px;
    margin-bottom: 1.5rem;
}

.method-explanation-box h4 {
    color: #0369a1;
    margin-bottom: 0.8rem;
}

.method-explanation-box li {
    margin: 0.5rem 0;
    line-height: 1.6;
}

.method-explanation-box strong {
    color: #0369a1;
    font-family: 'Monaco', 'Menlo', monospace;
}

/* Interactive code inputs */
.code-input {
    background: #fef5e7;
    border: 2px solid #f6ad55;
    border-radius: 4px;
    padding: 0.2rem 0.5rem;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 0.9em;
    width: auto;
    min-width: 120px;
    display: inline-block;
    margin: 0 0.2rem;
}

.code-input:focus {
    outline: none;
    border-color: #ed8936;
    background: #fffaf0;
}

.code-input.correct {
    border-color: #48bb78;
    background: #f0fff4;
}

.code-input.incorrect {
    border-color: #e53e3e;
    background: #fff5f5;
}

.method-template {
    background: #f8f9fa;
    color: #2d3748;
    padding: 1.5rem;
    border-radius: 8px;
    border: 2px solid #e2e8f0;
    font-size: 0.95rem;
    line-height: 1.8;
}

.feedback-message {
    margin-top: 1rem;
    padding: 1rem;
    border-radius: 6px;
    display: none;
}

.feedback-message.success {
    background: #f0fff4;
    color: #276749;
    border: 1px solid #48bb78;
    display: block;
}

.feedback-message.error {
    background: #fff5f5;
    color: #c53030;
    border: 1px solid #e53e3e;
    display: block;
}
    </style>
</head>
<body>
    <a href="#mainContent" class="skip-link">Skip to main content</a>
    
    <div class="container">
        <!-- Navigation Breadcrumb -->
        <nav class="breadcrumb" aria-label="Breadcrumb">
            <a href="hub.html">Hub</a> ‚Üí 
            <a href="python-oop.html">Python OOP</a> ‚Üí 
            <strong>Lesson 3: Methods and Behaviors</strong>
        </nav>

        <!-- Lesson Header -->
        <header class="lesson-header">
            <h1>Lesson 3: Methods and Behaviors</h1>
            <div class="lesson-meta">
                <span>üêç Language: Python</span>
                <span>‚è±Ô∏è Duration: 70 minutes</span>
                <span>üéØ Level: AS/A Level</span>
                <span>üìä Progress: <span id="progressPercent">0%</span></span>
            </div>
        </header>

        <!-- Progress Bar -->
        <div class="progress-bar" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
            <div class="progress-fill" id="progressBar"></div>
            <div class="progress-text" id="progressText">0% Complete</div>
        </div>

        <!-- Loading Indicator -->
        <div id="loadingIndicator" class="loading" aria-live="polite">
            Loading Python environment
        </div>

        <!-- Main Content (hidden until Python loads) -->
        <main id="mainContent" style="display: none;">
            <!-- Section 1: Starter Activity -->
            <section class="section" id="section-starter">
                <h2>üöÄ Starter Activity: Robot Programming Challenge</h2>
                <div class="starter-activity">
                    <p>You've been given control of a robot! But there's a problem - the robot can still move when it's in WORK mode, which is dangerous. Fix the code to prevent movement during work!</p>
                    
                    <div class="robot-panel">
                        <div class="robot-display">
                            <h3>ü§ñ Robot Status</h3>
                            <div class="robot-emoji" id="robotEmoji" aria-label="Robot">ü§ñ</div>
                            <div class="robot-status">
                                <div class="status-item" id="positionStatus">
                                    <div class="status-label">Position</div>
                                    <div class="status-value" id="robotPosition">(0, 0)</div>
                                </div>
                                <div class="status-item" id="batteryStatus">
                                    <div class="status-label">Battery</div>
                                    <div class="status-value" id="robotBattery">100%</div>
                                </div>
                                <div class="status-item" id="modeStatus">
                                    <div class="status-label">Mode</div>
                                    <div class="status-value" id="robotMode">IDLE</div>
                                </div>
                                <div class="status-item" id="taskStatus">
                                    <div class="status-label">Task Count</div>
                                    <div class="status-value" id="robotTasks">0</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="robot-controls">
                            <button class="button" onclick="moveRobot('up')" aria-label="Move robot up">‚¨ÜÔ∏è Move Up</button>
                            <button class="button" onclick="moveRobot('down')" aria-label="Move robot down">‚¨áÔ∏è Move Down</button>
                            <button class="button" onclick="moveRobot('left')" aria-label="Move robot left">‚¨ÖÔ∏è Move Left</button>
                            <button class="button" onclick="moveRobot('right')" aria-label="Move robot right">‚û°Ô∏è Move Right</button>
                            <button class="button warning" onclick="changeMode('WORK')">üíº Work Mode</button>
                            <button class="button success" onclick="changeMode('PLAY')">üéÆ Play Mode</button>
                            <button class="button secondary" onclick="changeMode('IDLE')">‚è∏Ô∏è Idle Mode</button>
                            <button class="button danger" onclick="performTask()">‚öôÔ∏è Do Task</button>
                            <button class="button secondary" onclick="chargeRobot()">üîã Charge</button>
                        </div>
                    </div>
                    
                    <div class="code-editor-container">
                        <div class="editor-header">
                            <h4 class="editor-title">üéØ Robot Challenge: Add Work Mode Restrictions</h4>
                            <span class="editor-status ready" id="robotEditorStatus">Ready</span>
                        </div>
                        
<div class="best-practice">
    <h5>üìã Your Tasks (Complete ONE at a time):</h5>
    
    <div class="task-list">
        <div class="task-item">
            <strong>Task 1:</strong> In the <code>move()</code> method, prevent movement when robot is in "WORK" mode<br>
            <small>Add a check at the beginning of the method that returns an error message</small>
        </div>
        
        <div class="task-item">
            <strong>Task 2:</strong> Fix the "left" direction in the moves dictionary<br>
            <small>The left direction should move negative on the x-axis</small>
        </div>
        
        <div class="task-item">
            <strong>Task 3:</strong> In <code>do_task()</code>, reduce PLAY mode battery cost<br>
            <small>Change it from 5 to 3</small>
        </div>
        
        <div class="task-item">
            <strong>Task 4:</strong> In <code>do_task()</code>, increase the low battery threshold<br>
            <small>Change it from 10 to 15</small>
        </div>
    </div>
    
    <div class="hint-box">
        üí° <strong>Test each change:</strong> Use the control panel above to test your fixes!
    </div>
</div>
                        
                        <div id="robot-code-editor" class="python-editor"></div>
                        <div class="code-controls">
                            <button class="button" onclick="runRobotCode()">‚ñ∂Ô∏è Test Robot</button>
                            <button class="button secondary" onclick="resetRobotCode()">üîÑ Reset Code</button>
                            <button class="button warning" onclick="showRobotHint()">üí° Get Hint</button>
                            <span class="code-timer" id="robotTimer"></span>
                        </div>
                        <div id="robotCodeOutput" class="code-output">
                            <button class="output-clear" onclick="clearOutput('robotCodeOutput')">Clear</button>
                            Robot test results will appear here...
                        </div>
                        <div id="robotHints" class="hint-container">
                            <h5>üí° Hints:</h5>
                            <ul id="robotHintsList"></ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Learning Outcomes -->
            <section class="section" id="section-outcomes">
                <h2>üéØ Learning Outcomes</h2>
                <div class="outcomes">
                    <p><strong>By the end of this lesson, you will be able to:</strong></p>
                    <ul>
                        <li>Write instance methods that perform actions and modify object state</li>
                        <li>Create methods with parameters and return values</li>
                        <li>Understand and implement accessor (getter) methods</li>
                        <li>Understand and implement mutator (setter) methods</li>
                        <li>Use method chaining to write elegant code</li>
                        <li>Follow best practices for method design and naming</li>
                        <li>Debug method-related errors effectively</li>
                    </ul>
                </div>
            </section>

            <!-- Section 3: Core Concepts -->
            <section class="section" id="section-concepts">
                <h2>üí° Core Concepts</h2>
                
                <div class="concept-grid">
                    <div class="concept-card">
                        <h4>What Are Methods?</h4>
                        <p>Methods are <strong>functions that belong to objects</strong>. They define what an object can DO.</p>
                        <pre style="background: #2d3748; color: #f0f0f0; padding: 1rem; border-radius: 4px; margin-top: 1rem;">
def method_name(self, parameters):
    # Method body
    return result  # Optional</pre>
                        <p style="margin-top: 1rem;">Methods always have <code>self</code> as the first parameter - it refers to the object calling the method!</p>
                    </div>
                    
                    <div class="concept-card">
                        <h4>Types of Methods</h4>
                        <ul>
                            <li><strong>Action Methods:</strong> Do something (e.g., <code>jump()</code>, <code>attack()</code>)</li>
                            <li><strong>Accessor/Getter:</strong> Return information (e.g., <code>get_health()</code>)</li>
                            <li><strong>Mutator/Setter:</strong> Change state (e.g., <code>set_name()</code>)</li>
                            <li><strong>Helper Methods:</strong> Internal use (often start with _)</li>
                            <li><strong>String Methods:</strong> Special like <code>__str__()</code></li>
                        </ul>
                    </div>
                    
                    <div class="concept-card">
                        <h4>Method Parameters & Returns</h4>
                        <p><strong>Parameters:</strong> Information the method needs</p>
                        <p><strong>Return Values:</strong> Information the method gives back</p>
                        <pre style="background: #2d3748; color: #f0f0f0; padding: 0.5rem; border-radius: 4px; margin: 1rem 0;">
def calculate_damage(self, attack_power):
    damage = attack_power * self.multiplier
    return damage  # Returns a value</pre>
                        <p>Not all methods need to return something - some just perform actions!</p>
                    </div>
                </div>

                    <section class="section" id="section-method-anatomy">
    <h2>üîç Method Anatomy Interactive</h2>
    
    <div class="method-anatomy-interactive">
        <h3>Complete the BankAccount Methods</h3>
        <p>Fill in the blanks to complete each method. Read the explanations carefully!</p>
        
        <div class="method-explanation-box">
            <h4>üìö What Each Method Should Do:</h4>
            <ul>
                <li><strong>get_balance():</strong> Simply returns the current balance value stored in self._balance</li>
                <li><strong>deposit():</strong> Adds money to the account ONLY if the amount is positive (greater than 0)</li>
                <li><strong>add_interest():</strong> Multiplies the balance by (1 + rate) and returns 'self' to enable method chaining</li>
            </ul>
        </div>
        
        <div class="method-exercise">
            <pre class="method-template">
class BankAccount:
    def __init__(self, balance):
        self._balance = balance  # This stores the account balance
    
    # Accessor (Getter) Method - just returns the balance
    def get_balance(self):
        """Return the current balance"""
        # Type the attribute that stores the balance:
        return <input type="text" class="code-input" id="getter-blank" placeholder="self.???" data-answer="self._balance">
    
    # Mutator (Setter) Method - only accepts positive amounts
    def deposit(self, amount):
        """Add money to the account"""
        # Check if amount is greater than zero:
        if <input type="text" class="code-input" id="deposit-check" placeholder="amount ?? 0" data-answer="amount > 0">:
            # Add the amount to balance using +=
            self._balance <input type="text" class="code-input" id="deposit-operator" placeholder="??" data-answer="+="> amount
            return True
        return False
    
    # Method Chaining - must return self
    def add_interest(self, rate):
        """Add interest and return self for chaining"""
        self._balance *= (1 + rate)
        # To enable chaining, return the object itself:
        return <input type="text" class="code-input" id="chaining-return" placeholder="???" data-answer="self">
</pre>
            <button class="button" onclick="checkMethodAnatomy()">Check Answers</button>
            <div id="anatomy-feedback" class="feedback-message"></div>
        </div>
    </div>
</section>

            <!-- Section 4: Main Activities -->
            <section class="section" id="section-activities">
                <h2>üîß Interactive Activities</h2>
                
                <h3>Activity 1: Method Types Challenge</h3>
                <div class="code-editor-container">
                    <div class="editor-header">
                        <h4 class="editor-title">üéØ Complete the SmartPhone Methods</h4>
                        <span class="editor-status ready" id="methodTypesStatus">Ready</span>
                    </div>
                    
<div class="best-practice">
    <h5>üìã Your Tasks (Complete ONE at a time):</h5>
    
    <div class="task-list">
        <div class="task-item">
            <strong>Task 1:</strong> In the <code>move()</code> method, add this check at the very beginning:<br>
            <code>if self.mode == "WORK":</code><br>
            <code>&nbsp;&nbsp;&nbsp;&nbsp;return "Cannot move in WORK mode!"</code>
        </div>
        
        <div class="task-item">
            <strong>Task 2:</strong> Fix the "left" direction tuple - it should be <code>(-1, 0)</code> not <code>(1, 0)</code>
        </div>
        
        <div class="task-item">
            <strong>Task 3:</strong> In <code>do_task()</code>, change PLAY mode battery cost from 5 to 3:<br>
            Change: <code>self.battery -= 5</code><br>
            To: <code>self.battery -= 3</code>
        </div>
        
        <div class="task-item">
            <strong>Task 4:</strong> In <code>do_task()</code>, change the low battery threshold from 10 to 15:<br>
            Change: <code>if self.battery < 10:</code><br>
            To: <code>if self.battery < 15:</code>
        </div>
    </div>
    
    <div class="hint-box">
        üí° <strong>Remember:</strong> The WORK mode check must go BEFORE the battery check in the move() method!
    </div>
</div>
                    
                    <div id="methodTypesEditor" class="python-editor"></div>
                    <div class="code-controls">
                        <button class="button" onclick="runMethodTypes()">‚ñ∂Ô∏è Test Methods</button>
                        <button class="button secondary" onclick="resetMethodTypes()">üîÑ Reset</button>
                        <button class="button warning" onclick="showMethodTypesHint()">üí° Get Hint</button>
                        <span class="code-timer" id="methodTypesTimer"></span>
                    </div>
                    <div id="methodTypesOutput" class="code-output">
                        <button class="output-clear" onclick="clearOutput('methodTypesOutput')">Clear</button>
                        Output will appear here...
                    </div>
                    <div id="methodTypesHints" class="hint-container">
                        <h5>üí° Method Hints:</h5>
                        <ul id="methodTypesHintsList"></ul>
                    </div>
                </div>

                <h3>Activity 2: Interactive State Viewer</h3>
                <div class="state-viewer">
                    <h4>üëÅÔ∏è Live Object State Monitor</h4>
                    <p>Watch how methods change an object's internal state in real-time!</p>
                    
<div class="code-editor-container">
    <div class="editor-header">
        <span class="editor-status ready" id="stateViewerStatus">Ready</span>
    </div>
    <div id="stateViewerEditor" class="python-editor"></div>  <!-- THIS IS THE IMPORTANT LINE -->
    <div class="code-controls">
        <button class="button" onclick="runStateViewer()">‚ñ∂Ô∏è Create Game Character</button>
        <button class="button success" onclick="updateStateDisplay()">üîÑ Refresh State</button>
        <span class="code-timer" id="stateViewerTimer"></span>
    </div>
    <div id="stateViewerOutput" class="code-output">
        <button class="output-clear" onclick="clearOutput('stateViewerOutput')">Clear</button>
        Output will appear here...
    </div>
</div>
                    
                    <div class="state-display" id="stateDisplay">
                        <h5>Current Object State:</h5>
                        <div id="stateProperties">
                            <p style="color: #718096;">Create an object to view its state...</p>
                        </div>
                    </div>
                </div>

                <h3>Activity 3: Method Chaining Playground</h3>
                <div class="chain-builder">
                    <h4>‚õìÔ∏è Master Method Chaining</h4>
                    <p>Method chaining allows you to call multiple methods in a row - elegant and efficient!</p>
                    
                    <div class="code-editor-container">
                        <div class="editor-header">
                            <span class="editor-status ready" id="chainingStatus">Ready</span>
                        </div>
                        <div id="chainingEditor" class="python-editor"></div>
                        <div class="code-controls">
                            <button class="button" onclick="runChaining()">‚ñ∂Ô∏è Run Chain</button>
                            <button class="button secondary" onclick="loadChainExample('builder')">üèóÔ∏è Builder Pattern</button>
                            <button class="button secondary" onclick="loadChainExample('query')">üîç Query Chain</button>
                            <button class="button secondary" onclick="loadChainExample('game')">üéÆ Game Actions</button>
                            <span class="code-timer" id="chainingTimer"></span>
                        </div>
                        <div id="chainingOutput" class="code-output">
                            <button class="output-clear" onclick="clearOutput('chainingOutput')">Clear</button>
                            Output will appear here...
                        </div>
                    </div>
                    
                    <div style="margin-top: 1.5rem;">
                        <h5>How Method Chaining Works:</h5>
                        <div class="chain-step">
                            <span>pizza</span>
                            <span class="chain-arrow">‚Üí</span>
                            <span>.add_topping("cheese")</span>
                            <span class="chain-arrow">‚Üí</span>
                            <span>.add_topping("pepperoni")</span>
                            <span class="chain-arrow">‚Üí</span>
                            <span>.bake()</span>
                        </div>
                        <p style="margin-top: 1rem; text-align: center;">Each method returns <code>self</code>, allowing the next method call!</p>
                    </div>
                </div>

                <h3>Activity 4: Getter/Setter Workshop</h3>
                <div class="code-editor-container">
                    <h4>üîê Accessor and Mutator Methods</h4>
                    <p>Learn to control access to object attributes with getters and setters:</p>
                    
                    <div class="best-practice">
                        <h5>üí° Why Use Getters/Setters?</h5>
                        <ul>
                            <li>Add validation when setting values</li>
                            <li>Calculate values dynamically when getting</li>
                            <li>Log access for debugging</li>
                            <li>Change internal implementation without breaking code</li>
                        </ul>
                    </div>
                    
                    <div class="editor-header">
                        <span class="editor-status ready" id="getterSetterStatus">Ready</span>
                    </div>
                    <div id="getterSetterEditor" class="python-editor"></div>
                    <div class="code-controls">
                        <button class="button" onclick="runGetterSetter()">‚ñ∂Ô∏è Run Code</button>
                        <button class="button secondary" onclick="loadGetterSetterExample('basic')">üìö Basic Example</button>
                        <button class="button secondary" onclick="loadGetterSetterExample('validation')">‚úÖ With Validation</button>
                        <button class="button secondary" onclick="loadGetterSetterExample('property')">üè† Using @property</button>
                        <span class="code-timer" id="getterSetterTimer"></span>
                    </div>
                    <div id="getterSetterOutput" class="code-output">
                        <button class="output-clear" onclick="clearOutput('getterSetterOutput')">Clear</button>
                        Output will appear here...
                    </div>
                </div>

                <h3>Activity 5: Method Builder Challenge</h3>
                <div class="method-builder">
                    <h4>üèóÔ∏è Build Methods Step by Step</h4>
                    <p>Complete the missing methods in this VideoGame class:</p>
                    
                    <div class="code-editor-container">
                        <div class="editor-header">
                            <span class="editor-status ready" id="methodBuilderStatus">Ready</span>
                        </div>
                        <div id="methodBuilderEditor" class="python-editor"></div>
                        <div class="code-controls">
                            <button class="button" onclick="runMethodBuilder()">‚ñ∂Ô∏è Test Your Methods</button>
                            <button class="button warning" onclick="showMethodBuilderHint()">üí° Get Hint</button>
                            <button class="button success" onclick="showMethodSolution()">‚úÖ Show Solution</button>
                            <span class="code-timer" id="methodBuilderTimer"></span>
                        </div>
                        <div id="methodBuilderOutput" class="code-output">
                            <button class="output-clear" onclick="clearOutput('methodBuilderOutput')">Clear</button>
                            Output will appear here...
                        </div>
                        <div id="methodBuilderHints" class="hint-container">
                            <h5>üí° Method Builder Hints:</h5>
                            <ul id="methodBuilderHintsList"></ul>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 5: Real World Connection -->
            <section class="section" id="section-realworld">
                <h2>üåç Real World Connection</h2>
                <div class="real-world">
                    <h3>Methods in Professional Software</h3>
                    
                    <h4>üéÆ Game Development Methods</h4>
                    <p><strong>Unity GameObject Class:</strong></p>
                    <ul>
                        <li><code>transform.Translate()</code> - Move objects</li>
                        <li><code>GetComponent()</code> - Access object parts</li>
                        <li><code>SetActive()</code> - Show/hide objects</li>
                        <li><code>Destroy()</code> - Remove from game</li>
                    </ul>
                    <p>Every frame, games call thousands of methods to update positions, check collisions, and render graphics!</p>
                    
                    <h4>üåê Web Development Methods</h4>
                    <p><strong>JavaScript DOM Methods:</strong></p>
                    <ul>
                        <li><code>getElementById()</code> - Find page elements</li>
                        <li><code>addEventListener()</code> - Handle user clicks</li>
                        <li><code>appendChild()</code> - Add new content</li>
                        <li><code>fetch()</code> - Get data from servers</li>
                    </ul>
                    
                    <h4>üìä Data Science Methods</h4>
                    <p><strong>Pandas DataFrame Methods:</strong></p>
                    <ul>
                        <li><code>df.head()</code> - View first rows</li>
                        <li><code>df.groupby()</code> - Aggregate data</li>
                        <li><code>df.plot()</code> - Create visualizations</li>
                        <li><code>df.to_csv()</code> - Export data</li>
                    </ul>
                    
                    <div class="best-practice">
                        <h5>üí° Industry Best Practice</h5>
                        <p><strong>Method Naming Conventions:</strong></p>
                        <ul>
                            <li>Action methods: verb (e.g., <code>calculate</code>, <code>process</code>)</li>
                            <li>Boolean methods: is/has prefix (e.g., <code>is_valid</code>, <code>has_permission</code>)</li>
                            <li>Getters: get_ prefix or property name (e.g., <code>get_total</code> or <code>total</code>)</li>
                            <li>Setters: set_ prefix (e.g., <code>set_password</code>)</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 6: Practice Exam Questions -->
            <section class="section" id="section-exam">
                <h2>üìù Practice Exam Questions</h2>
                
                <div class="exam-question">
                    <div class="question-header">
                        <h3>Question 1</h3>
                        <span class="marks">8 marks</span>
                    </div>
                    <p>A music streaming service needs a Song class with the following requirements:</p>
                    <ul>
                        <li>Attributes: title, artist, duration (in seconds), play_count</li>
                        <li>A method to play the song (increases play_count)</li>
                        <li>A method to get duration in minutes:seconds format</li>
                        <li>A method to check if the song is popular (play_count > 1000)</li>
                    </ul>
                    <p>Write the complete Song class with all required methods.</p>
                    <textarea class="answer-area" id="q1-answer" placeholder="Write your Python code here..." style="font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;"></textarea>
                    <div class="exam-controls">
                        <button class="button" onclick="toggleMarkScheme('q1')">Show Mark Scheme</button>
                        <div class="predicted-mark">
                            <label>Predicted Mark:</label>
                            <input type="number" min="0" max="8" id="q1-mark" style="width: 60px;">
                            <span>/ 8</span>
                        </div>
                    </div>
                    <div class="mark-scheme" id="q1-scheme">
                        <h4>Mark Scheme:</h4>
                        <ul>
                            <li>Class definition with correct syntax (1 mark)</li>
                            <li>__init__ method with all 4 attributes correctly initialized (2 marks)</li>
                            <li>play() method that increments play_count (2 marks)</li>
                            <li>get_duration_formatted() method with correct time conversion (2 marks)</li>
                            <li>is_popular() method returning boolean based on play_count (1 mark)</li>
                        </ul>
                        <p><strong>Example answer:</strong></p>
                        <pre style="background: #f8f9fa; padding: 1rem; border-radius: 4px;">
class Song:
    def __init__(self, title, artist, duration, play_count=0):
        self.title = title
        self.artist = artist
        self.duration = duration  # in seconds
        self.play_count = play_count
    
    def play(self):
        self.play_count += 1
        return f"Now playing: {self.title} by {self.artist}"
    
    def get_duration_formatted(self):
        minutes = self.duration // 60
        seconds = self.duration % 60
        return f"{minutes}:{seconds:02d}"
    
    def is_popular(self):
        return self.play_count > 1000</pre>
                    </div>
                </div>

                <div class="exam-question">
                    <div class="question-header">
                        <h3>Question 2</h3>
                        <span class="marks">6 marks</span>
                    </div>
                    <p>Explain the difference between accessor and mutator methods. For each type:</p>
                    <p>(a) Define what it does [2 marks]</p>
                    <p>(b) Give an example method signature [2 marks]</p>
                    <p>(c) Explain when you would use it [2 marks]</p>
                    <textarea class="answer-area" id="q2-answer" placeholder="Write your answer here..."></textarea>
                    <div class="exam-controls">
                        <button class="button" onclick="toggleMarkScheme('q2')">Show Mark Scheme</button>
                        <div class="predicted-mark">
                            <label>Predicted Mark:</label>
                            <input type="number" min="0" max="6" id="q2-mark" style="width: 60px;">
                            <span>/ 6</span>
                        </div>
                    </div>
                    <div class="mark-scheme" id="q2-scheme">
                        <h4>Mark Scheme:</h4>
                        <p>(a) Definitions [2 marks]:</p>
                        <ul>
                            <li>Accessor: Returns/gets information from object without changing it (1 mark)</li>
                            <li>Mutator: Changes/sets the state of the object (1 mark)</li>
                        </ul>
                        <p>(b) Examples [2 marks]:</p>
                        <ul>
                            <li>Accessor example: <code>def get_balance(self):</code> (1 mark)</li>
                            <li>Mutator example: <code>def set_balance(self, amount):</code> (1 mark)</li>
                        </ul>
                        <p>(c) When to use [2 marks]:</p>
                        <ul>
                            <li>Accessor: When you need to retrieve data, calculate derived values, or provide read-only access (1 mark)</li>
                            <li>Mutator: When you need to update state, validate input before setting, or trigger side effects on change (1 mark)</li>
                        </ul>
                    </div>
                </div>

                <div class="exam-question">
                    <div class="question-header">
                        <h3>Question 3</h3>
                        <span class="marks">5 marks</span>
                    </div>
                    <p>A ShoppingCart class has items stored in a list. Write a method called <code>calculate_total()</code> that:</p>
                    <ul>
                        <li>Accepts an optional discount parameter (default 0)</li>
                        <li>Calculates the sum of all item prices</li>
                        <li>Applies the discount as a percentage</li>
                        <li>Returns the final total</li>
                    </ul>
                    <p>Assume each item has a <code>price</code> attribute.</p>
                    <textarea class="answer-area" id="q3-answer" placeholder="Write your method here..." style="font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;"></textarea>
                    <div class="exam-controls">
                        <button class="button" onclick="toggleMarkScheme('q3')">Show Mark Scheme</button>
                        <div class="predicted-mark">
                            <label>Predicted Mark:</label>
                            <input type="number" min="0" max="5" id="q3-mark" style="width: 60px;">
                            <span>/ 5</span>
                        </div>
                    </div>
                    <div class="mark-scheme" id="q3-scheme">
                        <h4>Mark Scheme:</h4>
                        <ul>
                            <li>Method definition with self and discount parameter with default 0 (1 mark)</li>
                            <li>Loop through items to sum prices (2 marks)</li>
                            <li>Correct discount calculation (1 mark)</li>
                            <li>Return the final total (1 mark)</li>
                        </ul>
                        <p><strong>Example answer:</strong></p>
                        <pre style="background: #f8f9fa; padding: 1rem; border-radius: 4px;">
def calculate_total(self, discount=0):
    total = 0
    for item in self.items:
        total += item.price
    
    # Apply discount
    discount_amount = total * (discount / 100)
    final_total = total - discount_amount
    
    return final_total

# Alternative one-liner approach:
def calculate_total(self, discount=0):
    total = sum(item.price for item in self.items)
    return total * (1 - discount / 100)</pre>
                    </div>
                </div>
            </section>

            <!-- Section 7: Key Takeaways -->
            <section class="section" id="section-takeaways">
                <h2>‚ú® Key Takeaways</h2>
                <div class="key-takeaways">
                    <ul>
                        <li>Methods define what objects can DO - they are functions that belong to objects</li>
                        <li>Always include 'self' as the first parameter in instance methods</li>
                        <li>Methods can take parameters and return values just like regular functions</li>
                        <li>Accessor (getter) methods retrieve information without changing the object</li>
                        <li>Mutator (setter) methods change the object's state</li>
                        <li>Method chaining is achieved by returning 'self' from methods</li>
                        <li>Use descriptive method names that clearly indicate their purpose</li>
                        <li>Methods can call other methods of the same object using self.method_name()</li>
                        <li>Private methods (starting with _) indicate internal use only</li>
                    </ul>
                </div>
            </section>

            <!-- Section 8: Common Method Patterns -->
            <section class="section" id="section-patterns">
                <h2>üìã Common Method Patterns</h2>
                
                <div class="method-type-card">
                    <div class="method-type-badge">Toggle Pattern</div>
                    <pre style="background: #2d3748; color: #f0f0f0; padding: 1rem; border-radius: 4px;">
def toggle_power(self):
    """Toggle between on/off states"""
    self.is_on = not self.is_on
    return self.is_on</pre>
                </div>
                
                <div class="method-type-card">
                    <div class="method-type-badge">Validation Pattern</div>
                    <pre style="background: #2d3748; color: #f0f0f0; padding: 1rem; border-radius: 4px;">
def set_age(self, age):
    """Set age with validation"""
    if 0 <= age <= 150:
        self.age = age
        return True
    return False</pre>
                </div>
                
                <div class="method-type-card">
                    <div class="method-type-badge">Calculation Pattern</div>
                    <pre style="background: #2d3748; color: #f0f0f0; padding: 1rem; border-radius: 4px;">
def calculate_bmi(self):
    """Calculate and return BMI"""
    if self.height > 0:
        return self.weight / (self.height ** 2)
    return 0</pre>
                </div>
                
                <div class="method-type-card">
                    <div class="method-type-badge">String Representation</div>
                    <pre style="background: #2d3748; color: #f0f0f0; padding: 1rem; border-radius: 4px;">
def __str__(self):
    """Return string representation"""
    return f"{self.name} ({self.age} years old)"</pre>
                </div>
            </section>

            <!-- Section 9: Video Resources -->
            <section class="section" id="section-videos">
                <h2>üé• Video Resources</h2>
                
                <div class="video-container">
                    <h3>Video 1: Methods in Python OOP</h3>
                    <div class="video-wrapper">
                        <iframe src="https://www.youtube.com/embed/rq8cL2XMM5M" 
                                title="Python Methods Tutorial" 
                                frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                        </iframe>
                    </div>
                    <div class="video-notes">
                        <label for="video1-notes"><strong>Your Notes:</strong></label>
                        <textarea id="video1-notes" placeholder="Take notes on method concepts..."></textarea>
                    </div>
                </div>

                <div class="video-container">
                    <h3>Video 2: Getters, Setters, and Properties</h3>
                    <div class="video-wrapper">
                        <iframe src="https://www.youtube.com/embed/jCzT9XFZ5bw" 
                                title="Python Properties Tutorial" 
                                frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                        </iframe>
                    </div>
                    <div class="video-notes">
                        <label for="video2-notes"><strong>Your Notes:</strong></label>
                        <textarea id="video2-notes" placeholder="Take notes on getters and setters..."></textarea>
                    </div>
                </div>
            </section>

            <!-- Section 10: Extension Activities -->
            <section class="section" id="section-extension">
                <h2>üåü Extension Activities</h2>
                <div class="extension">
                    <h3>Challenge Tasks</h3>
                    
                    <h4>1. Advanced Calculator Class</h4>
                    <p>Create a Calculator class with:</p>
                    <ul>
                        <li>Methods for basic operations (+, -, *, /)</li>
                        <li>Memory functions (store, recall, clear)</li>
                        <li>Method chaining for complex calculations</li>
                        <li>History tracking of all operations</li>
                        <li>Undo/redo functionality</li>
                    </ul>
                    
                    <h4>2. Text-Based RPG Character</h4>
                    <p>Build a complete RPG character system:</p>
                    <ul>
                        <li>Multiple stats (health, mana, strength, etc.)</li>
                        <li>Inventory system with methods to add/remove items</li>
                        <li>Combat methods with damage calculation</li>
                        <li>Leveling system with stat increases</li>
                        <li>Save/load character state</li>
                    </ul>
                    
                    <h4>3. Smart Home Device Manager</h4>
                    <p>Design a system for smart home devices:</p>
                    <ul>
                        <li>Base Device class with common methods</li>
                        <li>Specific devices (Light, Thermostat, Lock)</li>
                        <li>Methods for scheduling and automation</li>
                        <li>Energy usage tracking methods</li>
                        <li>Remote control interface</li>
                    </ul>
                    
                    <h4>4. Data Validation Framework</h4>
                    <p>Create a validation system with:</p>
                    <ul>
                        <li>Methods for different validation types</li>
                        <li>Chainable validation rules</li>
                        <li>Custom error messages</li>
                        <li>Validation history logging</li>
                        <li>Export validation report</li>
                    </ul>
                </div>
            </section>

            <!-- Section 11: What's Next -->
            <section class="section" id="section-next">
                <h2>‚û°Ô∏è What's Next?</h2>
                <div class="whats-next">
                    <h3>Coming Up: Encapsulation and Data Hiding</h3>
                    <p>Now that you've mastered methods, let's learn how to protect and control access to object data!</p>
                    
                    <p><strong>In the next lesson, you'll learn:</strong></p>
                    <ul style="text-align: left; display: inline-block;">
                        <li>Public vs private attributes in Python</li>
                        <li>The underscore convention</li>
                        <li>Property decorators for elegant getters/setters</li>
                        <li>Benefits of encapsulation</li>
                        <li>Building secure, maintainable classes</li>
                    </ul>
                    
                    <a href="lesson-4-encapsulation.html" class="next-lesson-card">
                        <strong>Lesson 4: Encapsulation and Data Hiding</strong><br>
                        <small>Protecting your object's data</small>
                    </a>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Global variables
        let pyodide = null;
        let editors = {};
        let robotObject = null;
        let lessonsCompleted = 0;
        let totalSections = 11;
        let completedSections = new Set();
        let activityCompleted = {};
        
        // Hint systems
        let hintIndices = {
            robot: 0,
            methodTypes: 0,
            methodBuilder: 0
        };

        // Robot state
        let robotState = {
            x: 0,
            y: 0,
            battery: 100,
            mode: 'IDLE',
            tasks: 0,
            workModeFixed: false
        };

        // Robot action log
        let robotLog = [];

        // Initialize Python environment
        async function initializePython() {
            try {
                pyodide = await loadPyodide({
                    indexURL: "https://cdn.jsdelivr.net/pyodide/v0.24.1/full/"
                });
                
                document.getElementById('loadingIndicator').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
                
                initializeEditors();
                loadSavedProgress();
                updateProgress();
                initializeAutoSave();
                
                showMessage('Python environment loaded successfully!', 'success');
            } catch (error) {
                document.getElementById('loadingIndicator').innerHTML = 
                    `<div class="message error">Failed to load Python environment: ${error.message}</div>`;
                console.error('Failed to load Pyodide:', error);
            }
        }

        // Show status messages
        function showMessage(text, type = 'info') {
            const message = document.createElement('div');
            message.className = `message ${type}`;
            message.textContent = text;
            message.style.position = 'fixed';
            message.style.top = '20px';
            message.style.right = '20px';
            message.style.zIndex = '1000';
            message.style.maxWidth = '300px';
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.style.opacity = '0';
                setTimeout(() => message.remove(), 300);
            }, 3000);
        }

        // Initialize CodeMirror editors
        // Initialize CodeMirror editors
// Initialize CodeMirror editors
// Initialize CodeMirror editors
function initializeEditors() {
    console.log("Starting editor initialization...");
    
    const editorConfig = {
        mode: 'python',
        theme: 'default',
        lineNumbers: true,
        lineWrapping: true,
        autoCloseBrackets: true,
        matchBrackets: true,
        indentUnit: 4,
        tabSize: 4,
        indentWithTabs: false
    };

    // Robot code editor - matches HTML id="robotCodeEditor"
    const robotElement = document.getElementById('robotCodeEditor');
    if (robotElement) {
        editors.robotCode = CodeMirror(robotElement, {
            ...editorConfig,
            value: getRobotStarterCode()
        });
        console.log("Robot editor initialized");
    }

    // Method types editor - matches HTML id="methodTypesEditor"
    const methodElement = document.getElementById('methodTypesEditor');
    if (methodElement) {
        editors.methodTypes = CodeMirror(methodElement, {
            ...editorConfig,
            value: getMethodTypesStarterCode()
        });
        console.log("Method types editor initialized");
    }

    // State viewer editor - matches HTML id="stateViewerEditor"
    const stateElement = document.getElementById('stateViewerEditor');
    if (stateElement) {
        editors.stateViewer = CodeMirror(stateElement, {
            ...editorConfig,
            value: getStateViewerCode()
        });
        console.log("State viewer editor initialized");
    }

    // Chaining editor - matches HTML id="chainingEditor"
    const chainingElement = document.getElementById('chainingEditor');
    if (chainingElement) {
        editors.chaining = CodeMirror(chainingElement, {
            ...editorConfig,
            value: getChainingCode()
        });
        console.log("Chaining editor initialized");
    }

    // Getter/Setter editor - matches HTML id="getterSetterEditor"
    const getterElement = document.getElementById('getterSetterEditor');
    if (getterElement) {
        editors.getterSetter = CodeMirror(getterElement, {
            ...editorConfig,
            value: getGetterSetterCodeSafe()
        });
        console.log("Getter/setter editor initialized");
    }

    // Method builder editor - matches HTML id="methodBuilderEditor"
    const builderElement = document.getElementById('methodBuilderEditor');
    if (builderElement) {
        editors.methodBuilder = CodeMirror(builderElement, {
            ...editorConfig,
            value: getMethodBuilderCode()
        });
        console.log("Method builder editor initialized");
    }
}

        // Get starter code functions
        function getRobotStarterCode() {
    return `class Robot:
    def __init__(self, name="RoboBot"):
        self.name = name
        self.x = 0
        self.y = 0
        self.battery = 100
        self.mode = "IDLE"  # Can be: IDLE, WORK, PLAY
        self.tasks_completed = 0
    
    def move(self, direction):
        """Move the robot in a direction"""
        # TODO: Task 1 - Add code here
        
        if self.battery < 5:
            return "Battery too low to move!"
        
        moves = {
            "up": (0, 1),
            "down": (0, -1),
            "left": (1, 0),      # TODO: Task 2
            "right": (1, 0)
        }
        
        if direction in moves:
            dx, dy = moves[direction]
            self.x += dx
            self.y += dy
            self.battery -= 5
            return f"Moved {direction} to ({self.x}, {self.y})"
        return "Invalid direction!"
    
    def do_task(self):
        """Perform a task based on current mode"""
        if self.battery < 10:  # TODO: Task 4
            return "Battery too low for tasks!"
        
        if self.mode == "WORK":
            self.tasks_completed += 1
            self.battery -= 10
            return f"Task completed! Total: {self.tasks_completed}"
        elif self.mode == "PLAY":
            self.battery -= 5  # TODO: Task 3
            return "üéÆ Having fun!"
        else:
            return f"Cannot do tasks in {self.mode} mode"
    
    def change_mode(self, new_mode):
        """Change robot's operating mode"""
        valid_modes = ["IDLE", "WORK", "PLAY"]
        if new_mode in valid_modes:
            self.mode = new_mode
            return f"Mode changed to {new_mode}"
        return "Invalid mode!"
    
    def charge(self):
        """Charge the robot's battery"""
        old_battery = self.battery
        self.battery = min(100, self.battery + 20)
        charged = self.battery - old_battery
        return f"Charged {charged}%. Battery now at {self.battery}%"
    
    def status(self):
        """Get robot's current status"""
        return f"{self.name} at ({self.x}, {self.y}) | Battery: {self.battery}% | Mode: {self.mode} | Tasks: {self.tasks_completed}"

# Test the robot
robot = Robot("Helper Bot")
print(robot.status())

# Test your changes
robot.change_mode("WORK")
print(robot.move("up"))
print(robot.move("left"))`;
}





        function getStateViewerCode() {
    return `class GameCharacter:
    def __init__(self, name, character_class):
        self.name = name
        self.character_class = character_class
        self.level = 1
        self.health = 100
        self.max_health = 100
        self.mana = 50
        self.max_mana = 50
        self.experience = 0
        self.gold = 0
        self.inventory = []
        self.skills = []
    
    def take_damage(self, damage):
        """Reduce health by damage amount"""
        self.health = max(0, self.health - damage)
        print(f"{self.name} takes {damage} damage! Health: {self.health}/{self.max_health}")
        if self.health == 0:
            print(f"üíÄ {self.name} has been defeated!")
    
    def heal(self, amount):
        """Restore health"""
        old_health = self.health
        self.health = min(self.max_health, self.health + amount)
        healed = self.health - old_health
        print(f"‚ú® {self.name} healed for {healed} HP!")
    
    def get_state(self):
        """Return current state as dictionary"""
        return {
            "name": self.name,
            "class": self.character_class,
            "level": self.level,
            "health": f"{self.health}/{self.max_health}",
            "mana": f"{self.mana}/{self.max_mana}",
            "experience": self.experience,
            "gold": self.gold,
            "inventory": self.inventory,
            "skills": self.skills
        }

# Create a character
hero = GameCharacter("Aria", "Mage")
print(f"Created {hero.name} the {hero.character_class}")

# Perform various actions
hero.take_damage(30)
hero.heal(20)

# Print final state
print("\\nCurrent State:")
state = hero.get_state()
for key, value in state.items():
    print(f"{key}: {value}")`;
}

function getChainingCode() {
    return `class Pizza:
    def __init__(self):
        self.size = "medium"
        self.toppings = []
        self.cheese = "regular"
        self.cooked = False
        self.price = 10.0
    
    def set_size(self, size):
        """Set pizza size (with chaining)"""
        sizes = {"small": 8.0, "medium": 10.0, "large": 12.0}
        if size in sizes:
            self.size = size
            self.price = sizes[size]
            print(f"üìè Set size to {size}")
        return self  # Enable chaining!
    
    def add_topping(self, topping):
        """Add a topping (with chaining)"""
        self.toppings.append(topping)
        self.price += 1.5
        print(f"üçï Added {topping}")
        return self  # Enable chaining!

# Traditional way:
pizza = Pizza()
pizza.set_size("large")
pizza.add_topping("pepperoni")

# With chaining:
# pizza2 = Pizza().set_size("large").add_topping("pepperoni")`;
}

function getGetterSetterCode() {
    return `class BankAccount:
    def __init__(self, account_holder, initial_balance=0):
        self._holder = account_holder
        self._balance = initial_balance
    
    # TODO: Add a getter method for balance
    def get_balance(self):
        """Get current balance (Accessor/Getter)"""
        pass
    
    # TODO: Add a setter method for balance with validation
    def set_balance(self, new_balance):
        """Set balance with validation (Mutator/Setter)"""
        pass

# Test your implementation:
account = BankAccount("Alice Smith", 1000)
# print("Balance: $" + str(account.get_balance()))`;
}

function getGetterSetterCodeSafe() {
    // Using string concatenation to avoid template literal issues
    var code = 'class BankAccount:\n';
    code += '    def __init__(self, account_holder, initial_balance=0):\n';
    code += '        self._holder = account_holder\n';
    code += '        self._balance = initial_balance\n';
    code += '    \n';
    code += '    # TODO: Add a getter method for balance\n';
    code += '    def get_balance(self):\n';
    code += '        """Get current balance (Accessor/Getter)"""\n';
    code += '        pass\n';
    code += '    \n';
    code += '    # TODO: Add a setter method for balance with validation\n';
    code += '    def set_balance(self, new_balance):\n';
    code += '        """Set balance with validation (Mutator/Setter)"""\n';
    code += '        pass\n';
    code += '\n';
    code += '# Test your implementation:\n';
    code += 'account = BankAccount("Alice Smith", 1000)\n';
    code += '# print("Balance: $" + str(account.get_balance()))';
    
    return code;
}

function getMethodBuilderCode() {
    return `class VideoGame:
    def __init__(self, title, genre, price):
        self.title = title
        self.genre = genre
        self.price = price
        self.hours_played = 0
        self.achievements = []
        self.is_installed = False
        self.rating = None
    
    # TODO: Complete these methods!
    
    def install(self):
        """Install the game"""
        # TODO: Set is_installed to True and return a message
        pass
    
    def play(self, hours):
        """Play the game for specified hours"""
        # TODO: Check if installed, add hours, return message
        pass

# Test your methods here!
game = VideoGame("Cyberpunk 2077", "RPG", 59.99)`;
}

        function getMethodTypesStarterCode() {
    return `class SmartPhone:
    def __init__(self, brand, model):
        self.brand = brand
        self.model = model
        self.battery = 85
        self.is_on = True
        self.contacts = []
    
    def make_call(self, contact):
        """Make a phone call"""
        # TODO: Print a message saying "Calling {contact}..."
        # If battery < 5, return "Battery too low!"
        # Otherwise, reduce battery by 3
        pass
    
    def is_battery_low(self):
        """Check if battery is low (less than 20%)"""
        # TODO: Return True if battery < 20, False otherwise
        pass
    
    def charge(self):
        """Charge the phone"""
        # TODO: Add 25 to battery (but don't exceed 100)
        # Return a message about new battery level
        pass

# Test your methods!
phone = SmartPhone("Apple", "iPhone 15")
print(f"Phone: {phone.brand} {phone.model}")
print(f"Battery: {phone.battery}%")

# Uncomment these to test:
# print(phone.make_call("Mom"))
# print("Battery low?", phone.is_battery_low())
# print(phone.charge())`;
}

       function getStateViewerCode() {
    return `class GameCharacter:
    def __init__(self, name, character_class):
        self.name = name
        self.character_class = character_class
        self.level = 1
        self.health = 100
        self.max_health = 100
        self.mana = 50
        self.max_mana = 50
        self.experience = 0
        self.gold = 0
        self.inventory = []
        self.skills = []
    
    def take_damage(self, damage):
        """Reduce health by damage amount"""
        self.health = max(0, self.health - damage)
        print(f"{self.name} takes {damage} damage! Health: {self.health}/{self.max_health}")
        if self.health == 0:
            print(f"üíÄ {self.name} has been defeated!")
    
    def heal(self, amount):
        """Restore health"""
        old_health = self.health
        self.health = min(self.max_health, self.health + amount)
        healed = self.health - old_health
        print(f"‚ú® {self.name} healed for {healed} HP!")
    
    def get_state(self):
        """Return current state as dictionary"""
        return {
            "name": self.name,
            "class": self.character_class,
            "level": self.level,
            "health": f"{self.health}/{self.max_health}",
            "mana": f"{self.mana}/{self.max_mana}",
            "experience": self.experience,
            "gold": self.gold,
            "inventory": self.inventory,
            "skills": self.skills
        }

# Create a character
hero = GameCharacter("Aria", "Mage")
print(f"Created {hero.name} the {hero.character_class}")

# Perform various actions
hero.take_damage(30)
hero.heal(20)

# Print final state
print("\\nCurrent State:")
state = hero.get_state()
for key, value in state.items():
    print(f"{key}: {value}")`;
}

function getChainingCode() {
    return `class Pizza:
    def __init__(self):
        self.size = "medium"
        self.toppings = []
        self.cheese = "regular"
        self.cooked = False
        self.price = 10.0
    
    def set_size(self, size):
        """Set pizza size (with chaining)"""
        sizes = {"small": 8.0, "medium": 10.0, "large": 12.0}
        if size in sizes:
            self.size = size
            self.price = sizes[size]
            print(f"üìè Set size to {size}")
        return self  # Enable chaining!
    
    def add_topping(self, topping):
        """Add a topping (with chaining)"""
        self.toppings.append(topping)
        self.price += 1.5
        print(f"üçï Added {topping}")
        return self  # Enable chaining!

# Traditional way:
pizza = Pizza()
pizza.set_size("large")
pizza.add_topping("pepperoni")

# With chaining:
# pizza2 = Pizza().set_size("large").add_topping("pepperoni")`;
}

function getGetterSetterCode() {
    return `class BankAccount:
    def __init__(self, account_holder, initial_balance=0):
        self._holder = account_holder
        self._balance = initial_balance
    
    # TODO: Add a getter method for balance
    def get_balance(self):
        """Get current balance (Accessor/Getter)"""
        pass
    
    # TODO: Add a setter method for balance with validation
    def set_balance(self, new_balance):
        """Set balance with validation (Mutator/Setter)"""
        pass

# Test your implementation:
account = BankAccount("Alice Smith", 1000)
# print(f"Balance: ${account.get_balance()}")`;
}

function getMethodBuilderCode() {
    return `class VideoGame:
    def __init__(self, title, genre, price):
        self.title = title
        self.genre = genre
        self.price = price
        self.hours_played = 0
        self.achievements = []
        self.is_installed = False
        self.rating = None
    
    # TODO: Complete these methods!
    
    def install(self):
        """Install the game"""
        # TODO: Set is_installed to True and return a message
        pass
    
    def play(self, hours):
        """Play the game for specified hours"""
        # TODO: Check if installed, add hours, return message
        pass

# Test your methods here!
game = VideoGame("Cyberpunk 2077", "RPG", 59.99)`;
}

        // Robot control functions
        function moveRobot(direction) {
            if (robotState.mode === 'WORK' && !robotState.workModeFixed) {
                updateRobotLog("‚ö†Ô∏è Robot moved while in WORK mode - this is dangerous!");
            }
            
            if (robotState.battery < 5) {
                updateRobotLog("üîã Battery too low to move!");
                return;
            }
            
            const moves = {
                'up': [0, 1],
                'down': [0, -1],
                'left': [-1, 0],
                'right': [1, 0]
            };
            
            const [dx, dy] = moves[direction];
            robotState.x += dx;
            robotState.y += dy;
            robotState.battery -= 5;
            
            updateRobotDisplay();
            updateRobotLog(`üéØ Moved ${direction} to (${robotState.x}, ${robotState.y})`);
            animateRobot();
        }

        function changeMode(mode) {
            robotState.mode = mode;
            updateRobotDisplay();
            updateRobotLog(`‚öôÔ∏è Mode changed to ${mode}`);
            
            // Update emoji based on mode
            const modeEmojis = {
                'IDLE': 'ü§ñ',
                'WORK': 'üíº',
                'PLAY': 'üéÆ'
            };
            document.getElementById('robotEmoji').textContent = modeEmojis[mode] || 'ü§ñ';
        }

        function performTask() {
            if (robotState.battery < 10) {
                updateRobotLog("üîã Battery too low for tasks!");
                return;
            }
            
            if (robotState.mode === 'WORK') {
                robotState.tasks++;
                robotState.battery -= 10;
                updateRobotDisplay();
                updateRobotLog(`‚úÖ Task completed! Total: ${robotState.tasks}`);
                animateRobot();
            } else {
                updateRobotLog(`‚ùå Cannot do tasks in ${robotState.mode} mode`);
            }
        }

        function chargeRobot() {
            const oldBattery = robotState.battery;
            robotState.battery = Math.min(100, robotState.battery + 20);
            const charged = robotState.battery - oldBattery;
            
            updateRobotDisplay();
            updateRobotLog(`‚ö° Charged ${charged}%. Battery now at ${robotState.battery}%`);
        }

        function updateRobotDisplay() {
            // Update position
            document.getElementById('robotPosition').textContent = `(${robotState.x}, ${robotState.y})`;
            document.getElementById('positionStatus').classList.add('updated');
            setTimeout(() => document.getElementById('positionStatus').classList.remove('updated'), 500);
            
            // Update battery with color coding
            const batteryElement = document.getElementById('robotBattery');
            batteryElement.textContent = `${robotState.battery}%`;
            batteryElement.style.color = robotState.battery < 20 ? '#e53e3e' : 
                                        robotState.battery < 50 ? '#f6ad55' : '#4299e1';
            document.getElementById('batteryStatus').classList.add('updated');
            setTimeout(() => document.getElementById('batteryStatus').classList.remove('updated'), 500);
            
            // Update mode
            document.getElementById('robotMode').textContent = robotState.mode;
            document.getElementById('modeStatus').classList.add('updated');
            setTimeout(() => document.getElementById('modeStatus').classList.remove('updated'), 500);
            
            // Update tasks
            document.getElementById('robotTasks').textContent = robotState.tasks;
            document.getElementById('taskStatus').classList.add('updated');
            setTimeout(() => document.getElementById('taskStatus').classList.remove('updated'), 500);
        }

        function updateRobotLog(message) {
            const output = document.getElementById('robotCodeOutput');
            const timestamp = new Date().toLocaleTimeString();
            const newMessage = `[${timestamp}] ${message}`;
            
            robotLog.push(newMessage);
            
            // Keep only last 10 messages
            if (robotLog.length > 10) {
                robotLog.shift();
            }
            
            output.textContent = robotLog.join('\n');
            output.scrollTop = output.scrollHeight;
        }

        function animateRobot() {
            const robotEmoji = document.getElementById('robotEmoji');
            robotEmoji.classList.add('animate');
            setTimeout(() => robotEmoji.classList.remove('animate'), 500);
        }

        // Code running functions
        async function runCodeWithTimer(editorName, outputId, statusId) {
            const startTime = Date.now();
            const statusElement = document.getElementById(statusId);
            const timerElement = document.getElementById(editorName + 'Timer');
            
            statusElement.textContent = 'Running';
            statusElement.className = 'editor-status running';
            
            const timer = setInterval(() => {
                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                if (timerElement) {
                    timerElement.textContent = `‚è±Ô∏è ${elapsed}s`;
                }
            }, 100);
            
            try {
                const code = editors[editorName].getValue();
                const output = await runPythonCode(code);
                document.getElementById(outputId).innerHTML = 
                    `<button class="output-clear" onclick="clearOutput('${outputId}')">Clear</button>` + output;
                
                statusElement.textContent = 'Success';
                statusElement.className = 'editor-status ready';
                
                // Check for activity completion
                checkActivityCompletion(editorName, code, output);
                
                showMessage('Code executed successfully!', 'success');
            } catch (error) {
                document.getElementById(outputId).innerHTML = 
                    `<button class="output-clear" onclick="clearOutput('${outputId}')">Clear</button>Error: ${error.message}`;
                statusElement.textContent = 'Error';
                statusElement.className = 'editor-status error';
                showMessage(`Execution error: ${error.message}`, 'error');
            } finally {
                clearInterval(timer);
                const elapsed = ((Date.now() - startTime) / 1000).toFixed(1);
                if (timerElement) {
                    timerElement.textContent = `‚úÖ ${elapsed}s`;
                }
            }
        }

        // Check if activity is completed correctly
        function checkActivityCompletion(editorName, code, output) {
            switch (editorName) {
                case 'robotCode':
                    // Check if WORK mode protection is implemented
                    if (code.includes('if self.mode == "WORK"') && 
                        (code.includes('return "Cannot move in WORK mode"') || 
                         code.includes('return "Movement blocked in WORK mode"'))) {
                        robotState.workModeFixed = true;
                        markActivityComplete('robot');
                        showMessage('üéâ Great job! The robot is now safe in WORK mode!', 'success');
                    }
                    break;
                
                case 'methodTypes':
                    // Check if all methods are implemented
                    const hasCall = code.includes('print(') && code.includes('contact');
                    const hasBatteryCheck = code.includes('return') && code.includes('< 20');
                    const hasCharge = code.includes('self.battery') && (code.includes('+=') || code.includes('min('));
                    
                    if (hasCall && hasBatteryCheck && hasCharge) {
                        markActivityComplete('methodTypes');
                        showMessage('üéâ Excellent! All SmartPhone methods are working!', 'success');
                    }
                    break;
                
                case 'methodBuilder':
                    // Check if all methods are implemented
                    const methods = ['install', 'play', 'unlock_achievement', 'set_rating', 'get_play_time_hours', 'get_value_score'];
                    const implementedMethods = methods.filter(method => 
                        !code.includes(`def ${method}(self`) || !code.includes('pass')
                    );
                    
                    if (implementedMethods.length === methods.length) {
                        markActivityComplete('methodBuilder');
                        showMessage('üéâ Amazing! You\'ve completed all VideoGame methods!', 'success');
                    }
                    break;
            }
        }

        // Mark activity as complete
        function markActivityComplete(activityName) {
            if (!activityCompleted[activityName]) {
                activityCompleted[activityName] = true;
                completedSections.add(`activity-${activityName}`);
                updateProgress();
                
                // Add visual indicator
                const section = document.querySelector(`#section-${activityName === 'robot' ? 'starter' : 'activities'}`);
                if (section && !section.classList.contains('completed')) {
                    const badge = document.createElement('span');
                    badge.className = 'activity-badge';
                    badge.textContent = '‚úì Completed';
                    section.querySelector('h2').appendChild(badge);
                }
            }
        }

        // Individual run functions
        async function runRobotCode() {
            await runCodeWithTimer('robotCode', 'robotCodeOutput', 'robotEditorStatus');
            
            // Test the robot with the control panel
            try {
                const code = editors.robotCode.getValue();
                await pyodide.runPythonAsync(code);
                const testResult = await pyodide.runPythonAsync(`
robot = Robot("Test Bot")
robot.change_mode("WORK")
result = robot.move("up")
print(f"\\nTest Result: {result}")
"Cannot move" in result or "blocked" in result.lower()
                `);
                
                if (testResult) {
                    updateRobotLog("‚úÖ Work mode protection is working!");
                }
            } catch (error) {
                console.error('Robot test error:', error);
            }
        }

        async function runMethodTypes() {
            await runCodeWithTimer('methodTypes', 'methodTypesOutput', 'methodTypesStatus');
        }

        async function runStateViewer() {
            await runCodeWithTimer('stateViewer', 'stateViewerOutput', 'stateViewerStatus');
            await updateStateDisplay();
        }

        async function runChaining() {
            await runCodeWithTimer('chaining', 'chainingOutput', 'chainingStatus');
        }

        async function runGetterSetter() {
            await runCodeWithTimer('getterSetter', 'getterSetterOutput', 'getterSetterStatus');
        }

        async function runMethodBuilder() {
            await runCodeWithTimer('methodBuilder', 'methodBuilderOutput', 'methodBuilderStatus');
        }

        // State display update
        async function updateStateDisplay() {
            try {
                const result = await pyodide.runPythonAsync(`
import json
if 'hero' in globals() and hasattr(hero, 'get_state'):
    json.dumps(hero.get_state())
else:
    None
                `);
                
                if (result) {
                    const state = JSON.parse(result);
                    const stateDiv = document.getElementById('stateProperties');
                    stateDiv.innerHTML = '';
                    
                    for (const [key, value] of Object.entries(state)) {
                        const propDiv = document.createElement('div');
                        propDiv.className = 'state-property';
                        
                        let valueClass = 'property-value';
                        if (typeof value === 'string') valueClass += ' string';
                        else if (typeof value === 'number') valueClass += ' number';
                        else if (typeof value === 'boolean') valueClass += ' boolean';
                        else if (Array.isArray(value)) valueClass += ' array';
                        
                        propDiv.innerHTML = `
                            <span class="property-name">${key}:</span>
                            <span class="${valueClass}">${JSON.stringify(value)}</span>
                        `;
                        stateDiv.appendChild(propDiv);
                    }
                }
            } catch (error) {
                console.error('State display error:', error);
            }
        }

        // Load examples for chaining
        function loadChainExample(type) {
            const examples = {
                'builder': `class QueryBuilder:
    def __init__(self):
        self.query_parts = []
    
    def select(self, *fields):
        self.query_parts.append(f"SELECT {', '.join(fields)}")
        return self
    
    def from_table(self, table):
        self.query_parts.append(f"FROM {table}")
        return self
    
    def where(self, condition):
        self.query_parts.append(f"WHERE {condition}")
        return self
    
    def order_by(self, field, direction="ASC"):
        self.query_parts.append(f"ORDER BY {field} {direction}")
        return self
    
    def build(self):
        return ' '.join(self.query_parts)

# Build a complex query with chaining
query = (QueryBuilder()
    .select("name", "email", "created_at")
    .from_table("users")
    .where("age > 18")
    .order_by("created_at", "DESC")
    .build()
)

print("Generated SQL Query:")
print(query)`,
                
                'query': `class DataQuery:
    def __init__(self, data):
        self.data = data
        self.result = data.copy()
    
    def filter(self, condition):
        self.result = [item for item in self.result if condition(item)]
        return self
    
    def map(self, transform):
        self.result = [transform(item) for item in self.result]
        return self
    
    def sort(self, key=None, reverse=False):
        self.result = sorted(self.result, key=key, reverse=reverse)
        return self
    
    def limit(self, n):
        self.result = self.result[:n]
        return self
    
    def get(self):
        return self.result

# Sample data
products = [
    {"name": "Laptop", "price": 999, "category": "Electronics"},
    {"name": "Phone", "price": 699, "category": "Electronics"},
    {"name": "Desk", "price": 299, "category": "Furniture"},
    {"name": "Chair", "price": 199, "category": "Furniture"},
    {"name": "Monitor", "price": 399, "category": "Electronics"},
]

# Complex query with chaining
expensive_electronics = (DataQuery(products)
    .filter(lambda p: p["category"] == "Electronics")
    .filter(lambda p: p["price"] > 300)
    .sort(key=lambda p: p["price"], reverse=True)
    .limit(3)
    .get()
)

print("Expensive Electronics (Top 3):")
for product in expensive_electronics:
    print(f"  - {product['name']}: ${product['price']}")`,
                
                'game': `class GameCharacter:
    def __init__(self, name):
        self.name = name
        self.x = 0
        self.y = 0
        self.health = 100
        self.inventory = []
        self.effects = []
    
    def move_to(self, x, y):
        self.x = x
        self.y = y
        print(f"{self.name} moved to ({x}, {y})")
        return self
    
    def take_item(self, item):
        self.inventory.append(item)
        print(f"{self.name} picked up {item}")
        return self
    
    def use_item(self, item):
        if item in self.inventory:
            self.inventory.remove(item)
            print(f"{self.name} used {item}")
        else:
            print(f"{self.name} doesn't have {item}")
        return self
    
    def apply_effect(self, effect):
        self.effects.append(effect)
        print(f"{self.name} is now {effect}")
        return self
    
    def attack(self, target):
        damage = 20
        if "strengthened" in self.effects:
            damage *= 1.5
        print(f"{self.name} attacks {target} for {damage} damage!")
        return self
    
    def rest(self):
        self.health = min(100, self.health + 30)
        print(f"{self.name} rests and recovers health to {self.health}")
        return self

# Epic adventure with method chaining!
hero = GameCharacter("Aragorn")

(hero
    .move_to(10, 20)
    .take_item("Sword of Destiny")
    .take_item("Health Potion")
    .move_to(15, 25)
    .apply_effect("strengthened")
    .attack("Orc")
    .use_item("Health Potion")
    .rest()
    .move_to(20, 30)
    .attack("Dragon")
)

print(f"\\nFinal inventory: {hero.inventory}")
print(f"Active effects: {hero.effects}")`
            };
            
            if (examples[type]) {
                editors.chaining.setValue(examples[type]);
                showMessage(`Loaded ${type} chaining example!`, 'info');
            }
        }

        // Load getter/setter examples
        function loadGetterSetterExample(type) {
            const examples = {
                'basic': getGetterSetterCode(),
                
                'validation': `class Person:
    def __init__(self, name, age):
        self._name = name
        self._age = 0
        self.set_age(age)  # Use setter for validation
        self._email = None
    
    # Getter for name
    def get_name(self):
        return self._name
    
    # Setter for name with validation
    def set_name(self, name):
        if not name or not isinstance(name, str):
            raise ValueError("Name must be a non-empty string")
        if len(name) < 2:
            raise ValueError("Name must be at least 2 characters")
        self._name = name.strip().title()
    
    # Getter for age
    def get_age(self):
        return self._age
    
    # Setter for age with validation
    def set_age(self, age):
        if not isinstance(age, (int, float)):
            raise TypeError("Age must be a number")
        if age < 0:
            raise ValueError("Age cannot be negative")
        if age > 150:
            raise ValueError("Age cannot exceed 150")
        self._age = int(age)
    
    # Email with format validation
    def get_email(self):
        return self._email
    
    def set_email(self, email):
        if email and "@" not in email:
            raise ValueError("Invalid email format")
        self._email = email
    
    def __str__(self):
        return f"{self._name}, {self._age} years old"

# Test validation
try:
    person = Person("Alice", 25)
    print(f"Created: {person}")
    
    # Valid operations
    person.set_age(26)
    print(f"After birthday: {person}")
    
    person.set_email("alice@example.com")
    print(f"Email set to: {person.get_email()}")
    
    # These will raise errors:
    # person.set_age(-5)  # Negative age
    # person.set_age(200)  # Too old
    # person.set_name("")  # Empty name
    # person.set_email("invalid")  # Bad email format
    
except ValueError as e:
    print(f"Validation error: {e}")
except TypeError as e:
    print(f"Type error: {e}")`,
                
                'property': `class Temperature:
    def __init__(self, celsius=0):
        self._celsius = celsius
    
    # Using @property decorator for getter
    @property
    def celsius(self):
        return self._celsius
    
    # Using @setter decorator
    @celsius.setter
    def celsius(self, value):
        if value < -273.15:
            raise ValueError("Temperature cannot be below absolute zero")
        self._celsius = value
    
    # Computed property for Fahrenheit
    @property
    def fahrenheit(self):
        return (self._celsius * 9/5) + 32
    
    @fahrenheit.setter
    def fahrenheit(self, value):
        self._celsius = (value - 32) * 5/9
    
    # Computed property for Kelvin
    @property
    def kelvin(self):
        return self._celsius + 273.15
    
    @kelvin.setter
    def kelvin(self, value):
        self.celsius = value - 273.15  # Uses celsius setter for validation
    
    def __str__(self):
        return f"{self.celsius:.1f}¬∞C / {self.fahrenheit:.1f}¬∞F / {self.kelvin:.1f}K"

# Using properties like regular attributes!
temp = Temperature(25)
print(f"Room temperature: {temp}")

# Set using different scales
temp.fahrenheit = 86  # Set using Fahrenheit
print(f"After setting 86¬∞F: {temp}")

temp.kelvin = 300  # Set using Kelvin
print(f"After setting 300K: {temp}")

# Properties provide clean syntax
print(f"\\nDirect access:")
print(f"  Celsius: {temp.celsius}¬∞C")
print(f"  Fahrenheit: {temp.fahrenheit}¬∞F")
print(f"  Kelvin: {temp.kelvin}K")

# Validation still works
try:
    temp.celsius = -300  # Below absolute zero!
except ValueError as e:
    print(f"\\nError: {e}")`
            };
            
            if (examples[type]) {
                editors.getterSetter.setValue(examples[type]);
                showMessage(`Loaded ${type} getter/setter example!`, 'info');
            }
        }

        // Hint functions
        function showRobotHint() {
            const hints = [
                "Look at the move() method - you need to add a check at the beginning",
                "Check if self.mode equals 'WORK' before allowing movement",
                "Use an if statement: if self.mode == 'WORK': return 'error message'",
                "The complete check might look like: if self.mode == 'WORK': return 'Cannot move in WORK mode!'",
                "Make sure your check comes BEFORE the battery check"
            ];
            
            showHint('robot', hints, 'robotHints', 'robotHintsList');
        }

        function showMethodTypesHint() {
            const hints = [
                "For make_call(): Use print() to show who you're calling",
                "Don't forget to check battery before making the call",
                "For is_battery_low(): Compare self.battery with 20",
                "For charge(): Use min() to ensure battery doesn't exceed 100",
                "Example: self.battery = min(100, self.battery + 25)"
            ];
            
            showHint('methodTypes', hints, 'methodTypesHints', 'methodTypesHintsList');
        }

        function showMethodBuilderHint() {
            const hints = [
                "For install(): Check if is_installed is already True, then set it to True",
                "For play(): First check if the game is installed with an if statement",
                "For unlock_achievement(): Use 'in' to check if achievement already exists",
                "For set_rating(): Validate that 1 <= rating <= 5",
                "For get_play_time_hours(): Use // for hours and % for minutes",
                "For get_value_score(): Remember to handle division by zero if price is 0"
            ];
            
            showHint('methodBuilder', hints, 'methodBuilderHints', 'methodBuilderHintsList');
        }

        function showHint(hintType, hints, containerId, listId) {
            const container = document.getElementById(containerId);
            const list = document.getElementById(listId);
            
            if (hintIndices[hintType] < hints.length) {
                if (hintIndices[hintType] === 0) {
                    list.innerHTML = '';
                }
                
                const li = document.createElement('li');
                li.textContent = hints[hintIndices[hintType]];
                li.style.animation = 'slideDown 0.3s ease';
                list.appendChild(li);
                
                hintIndices[hintType]++;
                container.classList.add('visible');
            } else {
                showMessage('All hints shown! Try to complete the task now.', 'info');
            }
        }

        // Show method solution
        function showMethodSolution() {
            editors.methodBuilder.setValue(getMethodBuilderSolution());
            showMessage('Solution loaded! Study the code and try to understand each method.', 'success');
        }

        function getMethodBuilderSolution() {
            return `class VideoGame:
    def __init__(self, title, genre, price):
        self.title = title
        self.genre = genre
        self.price = price
        self.hours_played = 0
        self.achievements = []
        self.is_installed = False
        self.rating = None
    
    def install(self):
        """Install the game"""
        if self.is_installed:
            return f"{self.title} is already installed"
        
        self.is_installed = True
        return f"‚úÖ {self.title} has been installed successfully!"
    
    def play(self, hours):
        """Play the game for specified hours"""
        if not self.is_installed:
            return f"‚ùå Please install {self.title} first!"
        
        self.hours_played += hours
        return f"üéÆ Played {self.title} for {hours} hours. Total playtime: {self.hours_played} hours"
    
    def unlock_achievement(self, achievement_name):
        """Unlock a new achievement"""
        if achievement_name in self.achievements:
            return f"üèÜ You already have the '{achievement_name}' achievement!"
        
        self.achievements.append(achievement_name)
        return f"üéâ Achievement Unlocked: {achievement_name}!"
    
    def set_rating(self, rating):
        """Set game rating (1-5 stars)"""
        if not isinstance(rating, (int, float)):
            return "‚ùå Rating must be a number"
        
        if 1 <= rating <= 5:
            self.rating = rating
            stars = "‚≠ê" * int(rating)
            return f"‚úÖ You rated {self.title}: {stars} ({rating}/5)"
        else:
            return "‚ùå Rating must be between 1 and 5 stars"
    
    def get_play_time_hours(self):
        """Get total play time in hours and minutes"""
        hours = int(self.hours_played)
        minutes = int((self.hours_played - hours) * 60)
        
        if hours == 0 and minutes == 0:
            return "No playtime yet"
        elif hours == 0:
            return f"{minutes} minutes"
        elif minutes == 0:
            return f"{hours} hours"
        else:
            return f"{hours} hours {minutes} minutes"
    
    def get_value_score(self):
        """Calculate value (hours played per dollar)"""
        if self.price == 0:
            return float('inf')  # Free game = infinite value!
        
        value = self.hours_played / self.price
        return round(value, 2)

# Test all methods
game = VideoGame("Cyberpunk 2077", "RPG", 59.99)

print("=== Testing VideoGame Methods ===")
print(game.install())
print(game.install())  # Try installing again

print("\\n" + game.play(5.5))
print(game.play(3.25))

print("\\n" + game.unlock_achievement("First Steps"))
print(game.unlock_achievement("Night City Legend"))
print(game.unlock_achievement("First Steps"))  # Try unlocking again

print("\\n" + game.set_rating(4.5))
print(game.set_rating(6))  # Invalid rating

print(f"\\nTotal playtime: {game.get_play_time_hours()}")
print(f"Value score: {game.get_value_score()} hours per dollar")

# Test with free game
free_game = VideoGame("Fortnite", "Battle Royale", 0)
free_game.hours_played = 100
print(f"\\nFree game value score: {free_game.get_value_score()}")`;
        }

        // Reset functions
        function resetRobotCode() {
            editors.robotCode.setValue(getRobotStarterCode());
            clearOutput('robotCodeOutput');
            robotState.workModeFixed = false;
            showMessage('Robot code reset to starter template', 'info');
        }

        function resetMethodTypes() {
            editors.methodTypes.setValue(getMethodTypesStarterCode());
            clearOutput('methodTypesOutput');
            showMessage('Method types code reset to starter template', 'info');
        }

        // Utility functions
        async function runPythonCode(code) {
            // Capture stdout
            await pyodide.runPythonAsync(`
import sys
from io import StringIO
import traceback

_stdout = StringIO()
_original_stdout = sys.stdout
sys.stdout = _stdout
            `);
            
            try {
                await pyodide.runPythonAsync(code);
            } catch (error) {
                // Capture the error traceback
                await pyodide.runPythonAsync(`
import traceback
traceback.print_exc()
                `);
            }
            
            // Get output and restore stdout
            const output = await pyodide.runPythonAsync(`
sys.stdout = _original_stdout
_stdout.getvalue()
            `);
            
            return output || 'No output';
        }

        function clearOutput(outputId) {
            const outputElement = document.getElementById(outputId);
            outputElement.innerHTML = `<button class="output-clear" onclick="clearOutput('${outputId}')">Clear</button>Output cleared...`;
        }

        // Mark scheme functionality
        function toggleMarkScheme(questionId) {
            const scheme = document.getElementById(`${questionId}-scheme`);
            const button = scheme.previousElementSibling.querySelector('.button');
            
            if (scheme.classList.contains('visible')) {
                scheme.classList.remove('visible');
                button.textContent = 'Show Mark Scheme';
            } else {
                const answer = document.getElementById(`${questionId}-answer`).value;
                if (answer.length < 30) {
                    showMessage('Please write a more detailed answer before viewing the mark scheme.', 'warning');
                    return;
                }
                
                scheme.classList.add('visible');
                button.textContent = 'Hide Mark Scheme';
            }
        }

        // Progress tracking
        function updateProgress() {
            // Calculate progress based on scroll position
            const calculateScrollProgress = () => {
                const windowHeight = window.innerHeight;
                const documentHeight = document.documentElement.scrollHeight - windowHeight;
                const scrolled = window.scrollY;
                const scrollProgress = Math.min(100, (scrolled / documentHeight) * 100);
                
                // Also consider completed sections
                const sectionProgress = (completedSections.size / totalSections) * 100;
                
                // Weight: 70% activities, 30% scroll
                const totalProgress = Math.min(100, (sectionProgress * 0.7) + (scrollProgress * 0.3));
                
                document.getElementById('progressBar').style.width = `${totalProgress}%`;
                document.getElementById('progressText').textContent = `${Math.round(totalProgress)}% Complete`;
                document.getElementById('progressPercent').textContent = `${Math.round(totalProgress)}%`;
                
                // Update ARIA attributes
                const progressBar = document.querySelector('.progress-bar');
                progressBar.setAttribute('aria-valuenow', Math.round(totalProgress));
                
                // Save progress
                saveProgress(totalProgress);
            };
            
            // Update immediately and on scroll
            calculateScrollProgress();
            
            // Remove existing listener before adding new one
            window.removeEventListener('scroll', calculateScrollProgress);
            window.addEventListener('scroll', calculateScrollProgress, { passive: true });
        }

        // Save and load progress
        function saveProgress(progress) {
            try {
                localStorage.setItem('oop-lesson3-progress', JSON.stringify({
                    percentage: progress,
                    completedSections: Array.from(completedSections),
                    activityCompleted: activityCompleted,
                    robotState: robotState,
                    timestamp: new Date().toISOString()
                }));
            } catch (e) {
                console.warn('Failed to save progress:', e);
            }
        }

        function loadSavedProgress() {
            try {
                const saved = localStorage.getItem('oop-lesson3-progress');
                if (saved) {
                    const data = JSON.parse(saved);
                    completedSections = new Set(data.completedSections || []);
                    activityCompleted = data.activityCompleted || {};
                    
                    // Restore robot state
                    if (data.robotState) {
                        Object.assign(robotState, data.robotState);
                        updateRobotDisplay();
                    }
                    
                    // Mark completed activities
                    Object.keys(activityCompleted).forEach(activity => {
                        if (activityCompleted[activity]) {
                            markActivityComplete(activity);
                        }
                    });
                    
                    showMessage(`Welcome back! Progress restored from ${new Date(data.timestamp).toLocaleDateString()}`, 'info');
                }
            } catch (e) {
                console.warn('Failed to load saved progress:', e);
            }
        }

        // Auto-save functionality
        function initializeAutoSave() {
            // Save editor content periodically
            const saveEditorContent = () => {
                Object.keys(editors).forEach(key => {
                    if (editors[key] && editors[key].getValue) {
                        try {
                            localStorage.setItem(`oop-lesson3-${key}`, editors[key].getValue());
                        } catch (e) {
                            console.warn('Failed to save editor content:', e);
                        }
                    }
                });
            };
            
            // Save on change with debouncing
            let saveTimeout;
            Object.keys(editors).forEach(key => {
                if (editors[key] && editors[key].on) {
                    editors[key].on('change', () => {
                        clearTimeout(saveTimeout);
                        saveTimeout = setTimeout(saveEditorContent, 2000);
                    });
                }
            });
            
            // Save other inputs
            document.querySelectorAll('textarea[id$="-notes"], textarea[id$="-answer"], input[type="number"]').forEach(element => {
                element.addEventListener('input', (e) => {
                    try {
                        localStorage.setItem(`oop-lesson3-${element.id}`, element.value);
                    } catch (err) {
                        console.warn('Failed to save input:', err);
                    }
                });
                
                // Load saved content
                try {
                    const saved = localStorage.getItem(`oop-lesson3-${element.id}`);
                    if (saved) {
                        element.value = saved;
                    }
                } catch (err) {
                    console.warn('Failed to load saved content:', err);
                }
            });
            
            // Auto-save every 30 seconds
            setInterval(() => {
                saveEditorContent();
                updateProgress();
            }, 30000);
        }

        // Section tracking
        function trackSectionView() {
            const sections = document.querySelectorAll('.section');
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting && entry.intersectionRatio > 0.5) {
                        const sectionId = entry.target.id;
                        if (sectionId && !completedSections.has(sectionId)) {
                            completedSections.add(sectionId);
                            updateProgress();
                        }
                    }
                });
            }, { threshold: 0.5 });
            
            sections.forEach(section => observer.observe(section));
        }

        function checkMethodAnatomy() {
    const inputs = document.querySelectorAll('.code-input');
    let allCorrect = true;
    
    inputs.forEach(input => {
        const userAnswer = input.value.trim();
        const correctAnswer = input.dataset.answer;
        
        if (userAnswer === correctAnswer) {
            input.classList.add('correct');
            input.classList.remove('incorrect');
        } else {
            input.classList.add('incorrect');
            input.classList.remove('correct');
            allCorrect = false;
        }
    });
    
    const feedback = document.getElementById('anatomy-feedback');
    if (allCorrect) {
        feedback.className = 'feedback-message success';
        feedback.textContent = 'üéâ Excellent! All methods completed correctly!';
    } else {
        feedback.className = 'feedback-message error';
        feedback.textContent = '‚ùå Some answers need correction. Check the highlighted fields.';
    }
}

        // Keyboard shortcuts
        function initializeKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Ctrl/Cmd + Enter to run code
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    e.preventDefault();
                    const activeElement = document.activeElement;
                    
                    // Find the closest editor container
                    const findEditorContainer = (element) => {
                        let current = element;
                        while (current && current !== document.body) {
                            if (current.classList && current.classList.contains('code-editor-container')) {
                                return current;
                            }
                            current = current.parentElement;
                        }
                        return null;
                    };
                    
                    const editorContainer = findEditorContainer(activeElement);
                    if (editorContainer) {
                        const runButton = editorContainer.querySelector('.button[onclick*="run"]');
                        if (runButton) {
                            runButton.click();
                        }
                    }
                }
                
                // Ctrl/Cmd + S to save
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    showMessage('Progress saved!', 'success');
                    updateProgress();
                }
                
                // Escape to close hints
                if (e.key === 'Escape') {
                    document.querySelectorAll('.hint-container.visible').forEach(container => {
                        container.classList.remove('visible');
                    });
                }
            });
        }

        // Enhanced error handling for Pyodide
        window.addEventListener('error', (e) => {
            if (e.message && e.message.includes('pyodide')) {
                console.error('Pyodide error:', e);
                showMessage('Python environment error. Please refresh the page.', 'error');
            }
        });

        // Performance optimization - throttle scroll events
        function throttle(func, delay) {
            let timeoutId;
            let lastExecTime = 0;
            return function (...args) {
                const currentTime = Date.now();
                if (currentTime - lastExecTime > delay) {
                    func.apply(this, args);
                    lastExecTime = currentTime;
                } else {
                    clearTimeout(timeoutId);
                    timeoutId = setTimeout(() => {
                        func.apply(this, args);
                        lastExecTime = Date.now();
                    }, delay - (currentTime - lastExecTime));
                }
            };
        }

        // Initialize everything when page loads
        window.addEventListener('load', () => {
            initializePython();
            // Debug: Check if editors are initialized
setTimeout(() => {
    console.log('Checking editors...');
    Object.keys(editors).forEach(key => {
        console.log(`Editor ${key}:`, editors[key] ? 'Initialized' : 'Not initialized');
        if (editors[key]) {
            const wrapper = editors[key].getWrapperElement();
            console.log(`Editor ${key} visible:`, wrapper.style.display !== 'none');
        }
    });
}, 2000);
            updateRobotDisplay();
            initializeKeyboardShortcuts();
            trackSectionView();
            
            // Add smooth scrolling
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                });
            });
            
            // Mobile menu toggle (if needed)
            const mobileMenuToggle = () => {
                const container = document.querySelector('.container');
                if (window.innerWidth < 768) {
                    container.style.padding = '10px';
                } else {
                    container.style.padding = '20px';
                }
            };
            
            window.addEventListener('resize', throttle(mobileMenuToggle, 250));
            mobileMenuToggle();
        });

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            // Save final state
            updateProgress();
            
            // Clear timers
            if (window.autoSaveInterval) {
                clearInterval(window.autoSaveInterval);
            }
        });

        // Export functions for testing (optional)
        if (typeof module !== 'undefined' && module.exports) {
            module.exports = {
                showMessage,
                updateProgress,
                runPythonCode,
                checkActivityCompletion
            };
        }
    </script>
</body>
</html>