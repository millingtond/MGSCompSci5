<!DOCTYPE html>
<html lang="en-GB">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Big O Notation - Interactive Lesson</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #8b5cf6;
            --accent: #ec4899;
            --bg-dark: #0f172a;
            --bg-medium: #1e293b;
            --bg-light: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-dark: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            --shadow-glow: 0 0 40px rgba(99, 102, 241, 0.3);
            --transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            min-height: 100vh;
            position: relative;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(236, 72, 153, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: -2;
            animation: bgPulse 20s ease-in-out infinite;
        }

        @keyframes bgPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .animated-bg {
            position: fixed;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            z-index: -1;
            opacity: 0.03;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255, 255, 255, 0.05) 10px,
                rgba(255, 255, 255, 0.05) 20px
            );
            animation: bgMove 20s linear infinite;
        }

        @keyframes bgMove {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .header {
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 1000;
            transition: all 0.3s var(--transition-smooth);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
            contain: layout style;
        }

        .header.scrolled {
            padding: 0.75rem 2rem;
            background: rgba(15, 23, 42, 0.95);
            box-shadow: 0 8px 40px rgba(0, 0, 0, 0.2);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .title {
            font-size: clamp(1.25rem, 3vw, 1.75rem);
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            background-size: 200% 200%;
            animation: gradientShift 5s ease infinite;
            letter-spacing: -0.02em;
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .xp-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            background: rgba(255, 255, 255, 0.05);
            padding: 0.5rem 1rem;
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            min-width: 200px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .xp-container::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }

        .xp-container:hover::before {
            transform: translateX(100%);
        }

        .level-badge {
            background: var(--gradient-2);
            color: white;
            padding: 0.35rem 0.85rem;
            border-radius: 2rem;
            font-weight: 600;
            font-size: 0.875rem;
            box-shadow: 0 2px 10px rgba(236, 72, 153, 0.3);
            animation: levelPulse 2s ease infinite;
        }

        @keyframes levelPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .xp-bar {
            flex: 1;
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 50%, #4facfe 100%);
            background-size: 200% 100%;
            border-radius: 5px;
            transition: width 0.6s var(--transition-smooth);
            position: relative;
            transform: translateZ(0);
            will-change: width;
            animation: xpGradient 3s ease infinite;
            box-shadow: 0 0 20px rgba(79, 172, 254, 0.5);
        }

        @keyframes xpGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .xp-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.6), transparent);
            animation: shine 2s infinite;
        }

        .nav-menu {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 1rem;
            max-width: 1200px;
            margin: 1rem auto;
            backdrop-filter: blur(10px);
            contain: layout;
        }

        .nav-button {
            padding: 0.6rem 1.2rem;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 0.75rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            font-size: 0.875rem;
            font-weight: 500;
            transform: translateZ(0);
            position: relative;
            overflow: hidden;
            will-change: transform;
        }

        .nav-button::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--gradient-1);
            opacity: 0;
            transition: opacity 0.3s ease;
            border-radius: 0.75rem;
        }

        .nav-button span {
            position: relative;
            z-index: 1;
        }

        .nav-button.active {
            color: white;
            border-color: transparent;
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        }

        .nav-button.active::before {
            opacity: 1;
        }

        .nav-button:hover:not(.active) {
            background: rgba(255, 255, 255, 0.12);
            transform: translateY(-1px);
            border-color: rgba(99, 102, 241, 0.5);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.2);
        }

        .section {
            display: none;
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem 4rem;
            animation: fadeInUp 0.6s var(--transition-smooth);
            contain: layout style;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }

        .card {
            background: rgba(255, 255, 255, 0.06);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1.25rem;
            padding: 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
            transform: translateZ(0);
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            contain: layout style;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
            border-color: rgba(99, 102, 241, 0.3);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            right: -100%;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
            animation: cardGlow 3s ease infinite;
        }

        @keyframes cardGlow {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .button {
            padding: 0.75rem 1.75rem;
            background: var(--gradient-1);
            border: none;
            border-radius: 0.75rem;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            position: relative;
            overflow: hidden;
            transform: translateZ(0);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-size: 0.875rem;
            will-change: transform;
        }

        .button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.6s ease, height 0.6s ease;
        }

        .button:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 10px 35px rgba(99, 102, 241, 0.4);
        }

        .button:hover::before {
            width: 300px;
            height: 300px;
        }

        .button:active {
            transform: translateY(-1px) scale(0.98);
        }

        .button.secondary {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.2);
        }

        .button.secondary:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 10px 35px rgba(99, 102, 241, 0.4);
        }

        .quiz-option {
            display: block;
            width: 100%;
            padding: 1.25rem;
            margin: 0.75rem 0;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            color: var(--text-primary);
            text-align: left;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            position: relative;
            overflow: hidden;
            font-weight: 500;
            transform: translateZ(0);
        }

        .quiz-option::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--gradient-1);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .quiz-option:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--primary);
            transform: translateX(8px);
            box-shadow: 0 4px 20px rgba(99, 102, 241, 0.2);
        }

        .quiz-option:hover::before {
            transform: scaleY(1);
        }

        .quiz-option.correct {
            background: rgba(16, 185, 129, 0.15);
            border-color: var(--success);
            color: var(--success);
            animation: correctPulse 0.6s ease;
        }

        .quiz-option.correct::before {
            background: var(--success);
            transform: scaleY(1);
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.02); }
        }

        .quiz-option.incorrect {
            background: rgba(239, 68, 68, 0.15);
            border-color: var(--error);
            color: var(--error);
            animation: shake 0.4s ease;
        }

        .quiz-option.incorrect::before {
            background: var(--error);
            transform: scaleY(1);
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-8px); }
            40% { transform: translateX(8px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        .achievement-popup {
            position: fixed;
            top: 100px;
            right: 20px;
            background: linear-gradient(135deg, rgba(30, 41, 59, 0.98) 0%, rgba(51, 65, 85, 0.98) 100%);
            backdrop-filter: blur(20px) saturate(200%);
            -webkit-backdrop-filter: blur(20px) saturate(200%);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1rem;
            padding: 1.5rem 2rem;
            min-width: 320px;
            transform: translateX(400px);
            transition: transform 0.5s var(--transition-smooth);
            z-index: 2000;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.4);
            contain: layout style;
        }

        .achievement-popup.show {
            transform: translateX(0);
            animation: achievementBounce 0.6s var(--transition-smooth);
        }

        @keyframes achievementBounce {
            0% { transform: translateX(400px); }
            70% { transform: translateX(-20px); }
            100% { transform: translateX(0); }
        }

        .achievement-popup::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(45deg, #f093fb, #f5576c, #4facfe, #00f2fe);
            background-size: 400% 400%;
            border-radius: 1rem;
            z-index: -1;
            opacity: 0.7;
            animation: achievementGradient 3s ease infinite;
        }

        @keyframes achievementGradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        .achievement-icon {
            font-size: 3rem;
            animation: achievementSpin 1s ease;
            display: inline-block;
            margin-bottom: 0.5rem;
        }

        @keyframes achievementSpin {
            0% { transform: rotateY(0deg) scale(0); }
            50% { transform: rotateY(180deg) scale(1.2); }
            100% { transform: rotateY(360deg) scale(1); }
        }

        .simulation-container {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 0, 0, 0.2) 100%);
            border-radius: 1rem;
            padding: 2rem;
            margin: 1rem 0;
            position: relative;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .simulation-controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }

        .array-element {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 55px;
            height: 55px;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            margin: 0.35rem;
            font-weight: 600;
            transition: all 0.3s var(--transition-smooth);
            transform: translateZ(0);
            position: relative;
            font-size: 1.1rem;
            will-change: transform;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .array-element::before {
            content: '';
            position: absolute;
            inset: -4px;
            background: var(--gradient-1);
            border-radius: 0.75rem;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
            filter: blur(10px);
        }

        .array-element.active {
            background: var(--primary);
            border-color: var(--primary);
            transform: scale(1.15) translateY(-5px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.4);
            color: white;
            z-index: 10;
        }

        .array-element.active::before {
            opacity: 0.7;
        }

        .array-element.found {
            background: var(--success);
            border-color: var(--success);
            animation: foundPulse 0.6s ease;
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.4);
            color: white;
        }

        @keyframes foundPulse {
            0% { transform: scale(1) rotateZ(0deg); }
            50% { transform: scale(1.3) rotateZ(5deg); }
            100% { transform: scale(1.15) rotateZ(0deg); }
        }

        .canvas-container {
            background: white;
            border-radius: 1rem;
            margin: 1rem 0;
            position: relative;
            touch-action: none;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
            overflow: hidden;
        }

        #drawingCanvas {
            display: block;
            cursor: crosshair;
            border-radius: 1rem;
        }

        .feedback-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--gradient-dark);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 0;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            z-index: 1000;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            font-size: 1.5rem;
            transform: translateZ(0);
        }

        .feedback-button:hover {
            transform: scale(1.1) rotate(10deg);
            box-shadow: 0 12px 35px rgba(0, 0, 0, 0.4);
        }

        .feedback-button:active {
            transform: scale(0.95);
        }

        .feedback-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 3000;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .feedback-modal.show {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .feedback-content {
            background: var(--bg-medium);
            border-radius: 1.25rem;
            padding: 2.5rem;
            max-width: 500px;
            width: 100%;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: modalSlideIn 0.4s var(--transition-smooth);
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .feedback-textarea {
            width: 100%;
            min-height: 150px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            padding: 1rem;
            color: var(--text-primary);
            resize: vertical;
            margin: 1rem 0;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .feedback-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }

        .navigation-arrows {
            display: flex;
            justify-content: space-between;
            margin: 3rem 0 2rem;
            gap: 1rem;
        }

        .nav-arrow {
            padding: 0.875rem 1.75rem;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            border-radius: 0.75rem;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .nav-arrow::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--gradient-1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .nav-arrow span {
            position: relative;
            z-index: 1;
        }

        .nav-arrow:hover:not(:disabled) {
            border-color: transparent;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
            color: white;
        }

        .nav-arrow:hover:not(:disabled)::before {
            opacity: 1;
        }

        .nav-arrow:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .xp-popup {
            position: fixed;
            color: var(--warning);
            font-weight: 700;
            font-size: 2rem;
            pointer-events: none;
            z-index: 2000;
            animation: xpFloatUp 2.5s var(--transition-smooth) forwards;
            text-shadow: 0 2px 10px rgba(245, 158, 11, 0.5);
        }

        @keyframes xpFloatUp {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.5);
            }
            20% {
                opacity: 1;
                transform: translateY(0) scale(1.2);
            }
            40% {
                transform: translateY(-20px) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-120px) scale(0.8);
            }
        }

        .particle {
            position: fixed;
            pointer-events: none;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            animation: particleAnimation 1.5s var(--transition-smooth) forwards;
            box-shadow: 0 0 10px rgba(245, 158, 11, 0.8);
        }

        @keyframes particleAnimation {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(0);
            }
            50% {
                opacity: 1;
                transform: translate(var(--x), var(--y)) scale(1.5);
            }
            100% {
                opacity: 0;
                transform: translate(calc(var(--x) * 2), calc(var(--y) * 2)) scale(0.5);
            }
        }

        .hint-box {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.15) 0%, rgba(245, 158, 11, 0.05) 100%);
            border: 1px solid var(--warning);
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin: 1rem 0;
            display: none;
            position: relative;
            overflow: hidden;
        }

        .hint-box::before {
            content: '💡';
            position: absolute;
            top: -10px;
            right: -10px;
            font-size: 3rem;
            opacity: 0.1;
        }

        .hint-box.show {
            display: block;
            animation: hintSlideIn 0.4s var(--transition-smooth);
        }

        @keyframes hintSlideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .step-indicator {
            text-align: center;
            margin: 1.5rem 0;
            color: var(--text-secondary);
            font-weight: 500;
            font-size: 1.1rem;
            position: relative;
        }

        .step-indicator::before,
        .step-indicator::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 80px;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2));
        }

        .step-indicator::before {
            left: 0;
        }

        .step-indicator::after {
            right: 0;
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.2), transparent);
        }

        .complexity-visual {
            display: flex;
            justify-content: space-around;
            align-items: flex-end;
            height: 250px;
            margin: 2rem 0;
            padding: 2rem 1rem 3rem;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.3) 0%, rgba(0, 0, 0, 0.1) 100%);
            border-radius: 1rem;
            position: relative;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.2);
        }

        .complexity-bar {
            width: 80px;
            background: var(--gradient-1);
            border-radius: 0.5rem 0.5rem 0 0;
            transition: height 0.8s var(--transition-smooth);
            position: relative;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 0.5rem;
            box-shadow: 0 -5px 20px rgba(99, 102, 241, 0.3);
            transform: translateZ(0);
            will-change: height;
        }

        .complexity-bar span {
            font-weight: 600;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }

        .complexity-label {
            position: absolute;
            bottom: -40px;
            font-size: 0.875rem;
            white-space: nowrap;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .fill-blank-option {
            display: inline-block;
            padding: 0.6rem 1.2rem;
            margin: 0.35rem;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .fill-blank-option::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--gradient-1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .fill-blank-option span {
            position: relative;
            z-index: 1;
        }

        .fill-blank-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.2);
        }

        .fill-blank-option:hover::before {
            opacity: 0.1;
        }

        .fill-blank-option.used {
            opacity: 0.4;
            cursor: not-allowed;
            transform: scale(0.95);
        }

        .fill-blank-input {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem;
            padding: 0.6rem 1rem;
            color: var(--text-primary);
            min-width: 180px;
            margin: 0 0.35rem;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .fill-blank-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }

        .matching-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }

        .matching-item {
            padding: 1.25rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.3s var(--transition-smooth);
            text-align: center;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .matching-item::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--gradient-1);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .matching-item span {
            position: relative;
            z-index: 1;
        }

        .matching-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.2);
        }

        .matching-item:hover::before {
            opacity: 0.1;
        }

        .matching-item.selected {
            border-color: var(--primary);
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }

        .matching-item.selected::before {
            opacity: 0.2;
        }

        .matching-item.matched {
            background: rgba(16, 185, 129, 0.15);
            border-color: var(--success);
            cursor: default;
            animation: matchSuccess 0.6s ease;
        }

        @keyframes matchSuccess {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.08); }
        }

        .sort-container {
            list-style: none;
            padding: 0;
            margin: 1rem 0;
        }

        .sort-item {
            background: rgba(255, 255, 255, 0.06);
            border: 2px solid rgba(255, 255, 255, 0.15);
            border-radius: 0.75rem;
            padding: 1.25rem;
            margin: 0.75rem 0;
            cursor: move;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            transform: translateZ(0);
        }

        .sort-item::before {
            content: '☰';
            position: absolute;
            left: 1rem;
            color: var(--text-secondary);
            opacity: 0.5;
        }

        .sort-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .sort-item.dragging {
            opacity: 0.5;
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .graph-container {
            position: relative;
            height: 300px;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.4) 0%, rgba(0, 0, 0, 0.2) 100%);
            border-radius: 1rem;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .axis {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
        }

        .x-axis {
            bottom: 40px;
            left: 40px;
            right: 20px;
            height: 2px;
        }

        .y-axis {
            left: 40px;
            top: 20px;
            bottom: 40px;
            width: 2px;
        }

        /* Loading states */
        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* Confetti effect */
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background: var(--primary);
            animation: confettiFall 3s linear forwards;
            z-index: 2000;
        }

        @keyframes confettiFall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Mobile optimizations */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 0.75rem;
            }

            .xp-container {
                width: 100%;
                justify-content: center;
            }

            .card {
                padding: 1.5rem;
                margin-bottom: 1.5rem;
            }

            .array-element {
                width: 45px;
                height: 45px;
                font-size: 0.95rem;
                margin: 0.25rem;
            }

            .navigation-arrows {
                flex-direction: column;
            }

            .nav-arrow {
                width: 100%;
                justify-content: center;
            }

            .matching-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }

            .complexity-visual {
                padding: 1rem 0.5rem 3rem;
            }

            .complexity-bar {
                width: 60px;
            }

            .achievement-popup {
                right: 10px;
                left: 10px;
                min-width: auto;
            }

            .feedback-button {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 1.25rem;
            }
        }

        /* High contrast mode */
        @media (prefers-contrast: high) {
            :root {
                --primary: #5b6eff;
                --bg-dark: #000;
                --bg-medium: #111;
                --text-primary: #fff;
                --text-secondary: #eee;
            }

            .card {
                border-width: 2px;
            }

            .button {
                border: 2px solid currentColor;
            }
        }

        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }

            .xp-popup,
            .particle,
            .achievement-popup {
                display: none;
            }
        }

        /* Print styles */
        @media print {
            body {
                background: white;
                color: black;
            }

            .header,
            .feedback-button,
            .navigation-arrows,
            .simulation-controls {
                display: none;
            }

            .card {
                break-inside: avoid;
                background: white;
                border: 1px solid #ddd;
                box-shadow: none;
            }
        }

        /* Performance optimizations */
        .will-change-transform {
            will-change: transform;
        }

        .will-change-opacity {
            will-change: opacity;
        }

        /* Contain paint for performance */
        .contain-paint {
            contain: paint;
        }

        /* Hardware acceleration */
        .gpu-accelerated {
            transform: translateZ(0);
            will-change: transform;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Focus styles */
        *:focus-visible {
            outline: 2px solid var(--primary);
            outline-offset: 2px;
        }

        /* Selection styles */
        ::selection {
            background: var(--primary);
            color: white;
        }

        /* Scrollbar styles */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-medium);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-light);
            border-radius: 6px;
            border: 2px solid var(--bg-medium);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        /* Additional text styles */
        h2 {
            font-size: clamp(1.5rem, 4vw, 2rem);
            margin-bottom: 1.5rem;
            font-weight: 700;
            letter-spacing: -0.02em;
            line-height: 1.2;
        }

        h3 {
            font-size: clamp(1.25rem, 3vw, 1.5rem);
            margin-bottom: 1rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        h4 {
            font-size: 1.125rem;
            margin-bottom: 0.75rem;
            font-weight: 600;
            color: var(--text-secondary);
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        ul, ol {
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
            line-height: 1.6;
        }

        strong {
            font-weight: 600;
            color: var(--primary);
        }

        code {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9em;
        }

        pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            border-radius: 0.75rem;
            overflow-x: auto;
            margin: 1rem 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        pre code {
            background: none;
            padding: 0;
        }

        /* Table styles */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 0.75rem;
            overflow: hidden;
        }

        th {
            background: rgba(255, 255, 255, 0.08);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        /* Input and textarea consistent styles */
        input[type="text"],
        input[type="number"],
        select,
        textarea {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            color: var(--text-primary);
            font-family: inherit;
            font-size: inherit;
            transition: all 0.3s ease;
            width: 100%;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }

        select {
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23cbd5e1' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1rem center;
            padding-right: 3rem;
        }

        select option {
            background: var(--bg-medium);
            color: var(--text-primary);
        }

        /* Iframe styles */
        iframe {
            width: 100%;
            height: 80vh;
            border: none;
            display: block;
            border-radius: 0.75rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
        }

        /* Prevent text selection on interactive elements */
        .button,
        .nav-button,
        .quiz-option,
        .array-element,
        .matching-item,
        .fill-blank-option {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        /* Allow text selection in input fields */
        input,
        textarea {
            user-select: auto !important;
            -webkit-user-select: auto !important;
            -moz-user-select: auto !important;
            -ms-user-select: auto !important;
        }
    </style>
</head>
<body>
    <div class="animated-bg"></div>
    
    <header class="header" id="header">
        <div class="header-content">
            <h1 class="title">Big O Notation</h1>
            <div class="xp-container">
                <span class="level-badge">Level <span id="level">1</span></span>
                <div class="xp-bar">
                    <div class="xp-fill" id="xpBar" style="width: 0%"></div>
                </div>
                <span id="xpText">0/100 XP</span>
            </div>
        </div>
    </header>

    <nav class="nav-menu">
        <button class="nav-button active" onclick="showSection(0)"><span>Starter</span></button>
        <button class="nav-button" onclick="showSection(1)"><span>Introduction</span></button>
        <button class="nav-button" onclick="showSection(2)"><span>Linear Search</span></button>
        <button class="nav-button" onclick="showSection(3)"><span>Binary Search</span></button>
        <button class="nav-button" onclick="showSection(4)"><span>Bubble Sort</span></button>
        <button class="nav-button" onclick="showSection(5)"><span>Comparison</span></button>
        <button class="nav-button" onclick="showSection(6)"><span>Real World</span></button>
        <button class="nav-button" onclick="showSection(7)"><span>Common Mistakes</span></button>
        <button class="nav-button" onclick="showSection(8)"><span>Practice</span></button>
        <button class="nav-button" onclick="showSection(9)"><span>Extension</span></button>
        <button class="nav-button" onclick="showSection(10)"><span>Summary</span></button>
        <button class="nav-button" onclick="showSection(11)"><span>Videos</span></button>
    </nav>

    <!-- Section 0: Starter Activity -->
    <section class="section active">
        <div class="card contain-paint">
            <h2>Starter Activity: Algorithm Race 🏁</h2>
            <p>Let's see how different search algorithms perform! Click "Start Race" to watch linear and binary search compete to find a number.</p>
            
            <div class="simulation-container">
                <h3>Find the number: <span id="targetNumber" style="color: var(--warning);">42</span></h3>
                
                <div style="margin: 2rem 0;">
                    <h4>Linear Search (checks each element)</h4>
                    <div id="linearArray" style="margin: 1rem 0; min-height: 80px;"></div>
                    <p class="step-indicator">Steps: <span id="linearSteps" style="color: var(--success); font-weight: 700;">0</span></p>
                </div>
                
                <div style="margin: 2rem 0;">
                    <h4>Binary Search (divides in half)</h4>
                    <div id="binaryArray" style="margin: 1rem 0; min-height: 80px;"></div>
                    <p class="step-indicator">Steps: <span id="binarySteps" style="color: var(--primary); font-weight: 700;">0</span></p>
                </div>
            </div>
            
            <div class="simulation-controls">
                <button class="button" onclick="startRace()">Start Race</button>
                <button class="button secondary" onclick="resetRace()">Reset</button>
            </div>
            
            <div class="card" style="margin-top: 2rem; background: rgba(99, 102, 241, 0.1);">
                <h3>Quick Knowledge Check</h3>
                <p>Based on what you just saw, which statement is true?</p>
                <div id="starterQuiz">
                    <button class="quiz-option" onclick="checkStarterAnswer(this, false)">Both algorithms always take the same time</button>
                    <button class="quiz-option" onclick="checkStarterAnswer(this, false)">Linear search is always faster</button>
                    <button class="quiz-option" onclick="checkStarterAnswer(this, true)">Binary search generally takes fewer steps</button>
                    <button class="quiz-option" onclick="checkStarterAnswer(this, false)">The speed depends on the computer</button>
                </div>
            </div>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" disabled><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(1)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 1: Introduction -->
    <section class="section">
        <div class="card contain-paint">
            <h2>What is Big O Notation? 🎯</h2>
            <p>Big O notation is a mathematical way to describe how the performance of an algorithm changes as the input size grows. It focuses on the <strong>worst-case scenario</strong> and helps us compare algorithms objectively.</p>
            
            <div class="card" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(99, 102, 241, 0.05) 100%); margin: 1.5rem 0; border-color: var(--primary);">
                <h3 style="color: var(--primary);">Key Concept</h3>
                <p>Big O notation tells us how an algorithm's runtime grows relative to its input size, ignoring constants and lower-order terms.</p>
            </div>

            <h3>Why is it important?</h3>
            <ul style="margin-left: 2rem; list-style-type: none;">
                <li style="position: relative; padding-left: 1.5rem;"><span style="position: absolute; left: 0; color: var(--primary);">▸</span> Compare algorithm efficiency objectively</li>
                <li style="position: relative; padding-left: 1.5rem;"><span style="position: absolute; left: 0; color: var(--primary);">▸</span> Predict performance on large datasets</li>
                <li style="position: relative; padding-left: 1.5rem;"><span style="position: absolute; left: 0; color: var(--primary);">▸</span> Make informed decisions about which algorithm to use</li>
                <li style="position: relative; padding-left: 1.5rem;"><span style="position: absolute; left: 0; color: var(--primary);">▸</span> Understand scalability limitations</li>
            </ul>

            <div class="complexity-visual">
                <div class="complexity-bar" style="height: 20%; background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                    <span style="color: white;">O(1)</span>
                    <span class="complexity-label">Constant</span>
                </div>
                <div class="complexity-bar" style="height: 40%; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                    <span style="color: white;">O(log n)</span>
                    <span class="complexity-label">Logarithmic</span>
                </div>
                <div class="complexity-bar" style="height: 60%; background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
                    <span style="color: white;">O(n)</span>
                    <span class="complexity-label">Linear</span>
                </div>
                <div class="complexity-bar" style="height: 100%; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                    <span style="color: white;">O(n²)</span>
                    <span class="complexity-label">Quadratic</span>
                </div>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Interactive: Fill in the Blanks</h3>
            <p>Complete the sentence by clicking the correct options:</p>
            
            <p style="line-height: 3; margin: 1.5rem 0; font-size: 1.1rem;">
                Big O notation describes the 
                <input type="text" class="fill-blank-input" id="blank1" readonly placeholder="Click option">
                runtime of an algorithm. It helps us understand how performance changes as
                <input type="text" class="fill-blank-input" id="blank2" readonly placeholder="Click option">
                increases.
            </p>
            
            <div style="margin: 1.5rem 0;">
                <span class="fill-blank-option" onclick="fillBlank('blank1', 'best-case')"><span>best-case</span></span>
                <span class="fill-blank-option" onclick="fillBlank('blank1', 'worst-case')"><span>worst-case</span></span>
                <span class="fill-blank-option" onclick="fillBlank('blank1', 'average-case')"><span>average-case</span></span>
                <span class="fill-blank-option" onclick="fillBlank('blank2', 'memory usage')"><span>memory usage</span></span>
                <span class="fill-blank-option" onclick="fillBlank('blank2', 'input size')"><span>input size</span></span>
                <span class="fill-blank-option" onclick="fillBlank('blank2', 'complexity')"><span>complexity</span></span>
            </div>
            
            <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                <button class="button" onclick="checkFillBlanks()">Check Answers</button>
                <button class="button secondary" onclick="resetFillBlanks()">Reset</button>
            </div>
            
            <div id="fillBlankFeedback" style="margin-top: 1rem;"></div>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(0)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(2)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 2: Linear Search -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Linear Search: O(n) 📊</h2>
            <p>Linear search checks each element one by one until it finds the target. Its time complexity is <strong>O(n)</strong> because in the worst case, it needs to check all n elements.</p>
            
            <div class="simulation-container">
                <h3>Interactive Linear Search Simulation</h3>
                <p>Enter a number to search for (1-20):</p>
                <input type="number" id="linearSearchTarget" min="1" max="20" value="15" style="max-width: 200px; margin: 1rem 0;">
                
                <div id="linearSearchArray" style="margin: 2rem 0; min-height: 120px;"></div>
                
                <div class="step-indicator">
                    Step <span id="linearSearchStep" style="color: var(--primary); font-weight: 700;">0</span> of <span id="linearSearchTotal">0</span>
                </div>
                
                <div class="simulation-controls">
                    <button class="button" onclick="startLinearSearch()">Start Search</button>
                    <button class="button secondary" onclick="stepLinearSearch()">Next Step</button>
                    <button class="button secondary" onclick="resetLinearSearch()">Reset</button>
                </div>
                
                <div id="linearSearchResult" style="margin-top: 1.5rem; font-weight: 500;"></div>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Understanding O(n)</h3>
            <p>The time taken grows linearly with input size:</p>
            <ul style="margin-left: 2rem; list-style-type: none;">
                <li style="padding: 0.5rem 0;"><code style="color: var(--warning);">10</code> elements → up to <strong>10</strong> checks</li>
                <li style="padding: 0.5rem 0;"><code style="color: var(--warning);">100</code> elements → up to <strong>100</strong> checks</li>
                <li style="padding: 0.5rem 0;"><code style="color: var(--warning);">1000</code> elements → up to <strong>1000</strong> checks</li>
            </ul>
            
            <button class="button secondary" onclick="showHint('linearHint')" style="margin-top: 1rem;">Show Hint</button>
            <div id="linearHint" class="hint-box">
                <p>💡 Think about searching for a word in a dictionary by reading every single word from the beginning!</p>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Quick Quiz: Linear Search</h3>
            <p>If you have an array of 50 elements, what's the maximum number of comparisons linear search might need?</p>
            <div id="linearQuiz">
                <button class="quiz-option" onclick="checkAnswer(this, false, 'linearQuiz')">25</button>
                <button class="quiz-option" onclick="checkAnswer(this, false, 'linearQuiz')">1</button>
                <button class="quiz-option" onclick="checkAnswer(this, true, 'linearQuiz')">50</button>
                <button class="quiz-option" onclick="checkAnswer(this, false, 'linearQuiz')">100</button>
            </div>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(1)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(3)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 3: Binary Search -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Binary Search: O(log n) 🔍</h2>
            <p>Binary search works on <strong>sorted arrays</strong> by repeatedly dividing the search space in half. Its time complexity is <strong>O(log n)</strong>.</p>
            
            <div class="simulation-container">
                <h3>Interactive Binary Search Simulation</h3>
                <p>The array is sorted. Enter a number to search for (1-16):</p>
                <input type="number" id="binarySearchTarget" min="1" max="16" value="11" style="max-width: 200px; margin: 1rem 0;">
                
                <div id="binarySearchArray" style="margin: 2rem 0; min-height: 120px;"></div>
                
                <div class="step-indicator" style="font-size: 1rem;">
                    Step <span id="binarySearchStep" style="color: var(--primary); font-weight: 700;">0</span> | 
                    Low: <span id="binaryLow" style="color: var(--success);">-</span> | 
                    Mid: <span id="binaryMid" style="color: var(--warning);">-</span> | 
                    High: <span id="binaryHigh" style="color: var(--error);">-</span>
                </div>
                
                <div class="simulation-controls">
                    <button class="button" onclick="startBinarySearch()">Start Search</button>
                    <button class="button secondary" onclick="stepBinarySearch()">Next Step</button>
                    <button class="button secondary" onclick="resetBinarySearch()">Reset</button>
                </div>
                
                <div id="binarySearchResult" style="margin-top: 1.5rem; font-weight: 500;"></div>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Understanding O(log n)</h3>
            <p>Logarithmic time means the number of steps grows much slower than the input size. Adjust the slider below to see how the number of operations for O(log n) compares to O(n) as the input size (n) increases.</p>
            
            <div class="simulation-container" style="margin-top: 2rem;">
                <div style="margin-bottom: 1.5rem;">
                    <label style="font-weight: 500;">Input Size (n): <span id="logNSizeDisplay" style="color: var(--warning); font-size: 1.25rem; font-weight: 700;">1000</span></label>
                    <input type="range" id="logNSizeSlider" min="10" max="1000000" value="1000" step="10" style="width: 100%; margin: 1rem 0;" oninput="updateLogNGraph()">
                </div>
                
                <div id="logNComparison" style="padding: 1rem; background: rgba(0,0,0,0.2); border-radius: 0.75rem;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <span style="color: #3b82f6; font-weight: 600;">O(log n) Operations:</span>
                        <span id="logNValue" style="font-size: 1.5rem; font-weight: 700; color: #3b82f6;">10</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span style="color: #10b981; font-weight: 600;">O(n) Operations:</span>
                        <span id="nValue" style="font-size: 1.5rem; font-weight: 700; color: #10b981;">1000</span>
                    </div>
                </div>
            </div>
            
            <table style="margin-top: 2rem;">
                <tr>
                    <th>Array Size</th>
                    <th>Max Steps (Binary Search)</th>
                    <th>Max Steps (Linear Search)</th>
                </tr>
                <tr>
                    <td>16</td>
                    <td style="color: var(--primary); font-weight: 600;">4</td>
                    <td style="color: var(--text-secondary);">16</td>
                </tr>
                <tr>
                    <td>1,024</td>
                    <td style="color: var(--primary); font-weight: 600;">10</td>
                    <td style="color: var(--text-secondary);">1,024</td>
                </tr>
                <tr>
                    <td>1,000,000</td>
                    <td style="color: var(--primary); font-weight: 600;">20</td>
                    <td style="color: var(--text-secondary);">1,000,000</td>
                </tr>
            </table>
        </div>

        <div class="card contain-paint">
            <h3>True or False?</h3>
            <div style="margin: 1.5rem 0;">
                <p style="font-weight: 500;">1. Binary search can work on any array</p>
                <div style="display: flex; gap: 1rem;">
                    <button class="quiz-option" style="flex: 1;" onclick="checkTrueFalse(this, false, 'tf1')">True</button>
                    <button class="quiz-option" style="flex: 1;" onclick="checkTrueFalse(this, true, 'tf1')">False</button>
                </div>
            </div>
            <div style="margin: 1.5rem 0;">
                <p style="font-weight: 500;">2. O(log n) grows slower than O(n)</p>
                <div style="display: flex; gap: 1rem;">
                    <button class="quiz-option" style="flex: 1;" onclick="checkTrueFalse(this, true, 'tf2')">True</button>
                    <button class="quiz-option" style="flex: 1;" onclick="checkTrueFalse(this, false, 'tf2')">False</button>
                </div>
            </div>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(2)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(4)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 4: Bubble Sort -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Bubble Sort: O(n²) 🫧</h2>
            <p>Bubble sort repeatedly compares adjacent elements and swaps them if they're in the wrong order. Its time complexity is <strong>O(n²)</strong>.</p>
            
            <div class="simulation-container">
                <h3>Interactive Bubble Sort Simulation</h3>
                <p>Watch how bubble sort organises an array:</p>
                
                <div id="bubbleSortArray" style="margin: 2rem 0; min-height: 120px;"></div>
                
                <div class="step-indicator" style="font-size: 1rem;">
                    Pass <span id="bubblePass" style="color: var(--primary); font-weight: 700;">0</span> | 
                    Comparisons: <span id="bubbleComparisons" style="color: var(--warning); font-weight: 700;">0</span> | 
                    Swaps: <span id="bubbleSwaps" style="color: var(--error); font-weight: 700;">0</span>
                </div>
                
                <div class="simulation-controls">
                    <button class="button" onclick="startBubbleSort()">Start Sort</button>
                    <button class="button secondary" onclick="stepBubbleSort()">Next Step</button>
                    <button class="button secondary" onclick="resetBubbleSort()">Reset</button>
                </div>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Understanding O(n²)</h3>
            <p>Quadratic time complexity means performance degrades rapidly with larger inputs:</p>
            
            <ul style="margin-left: 2rem; list-style-type: none;">
                <li style="padding: 0.5rem 0;"><code style="color: var(--warning);">10</code> elements → up to <strong style="color: var(--error);">100</strong> comparisons</li>
                <li style="padding: 0.5rem 0;"><code style="color: var(--warning);">100</code> elements → up to <strong style="color: var(--error);">10,000</strong> comparisons</li>
                <li style="padding: 0.5rem 0;"><code style="color: var(--warning);">1000</code> elements → up to <strong style="color: var(--error);">1,000,000</strong> comparisons!</li>
            </ul>
            
            <div class="card" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(239, 68, 68, 0.05) 100%); margin: 1.5rem 0; border-color: var(--error);">
                <p><strong style="color: var(--error);">⚠️ Warning:</strong> O(n²) algorithms become impractical for large datasets!</p>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Matching Exercise</h3>
            <p>Match each algorithm to its Big O notation. Click items to match them:</p>
            
            <div class="matching-container">
                <div>
                    <h4 style="text-align: center; margin-bottom: 1rem;">Algorithms</h4>
                    <div class="matching-item" data-match="linear" onclick="selectMatch(this, 'algo')"><span>Linear Search</span></div>
                    <div class="matching-item" data-match="binary" onclick="selectMatch(this, 'algo')"><span>Binary Search</span></div>
                    <div class="matching-item" data-match="bubble" onclick="selectMatch(this, 'algo')"><span>Bubble Sort</span></div>
                </div>
                <div>
                    <h4 style="text-align: center; margin-bottom: 1rem;">Big O Notation</h4>
                    <div class="matching-item" data-match="bubble" onclick="selectMatch(this, 'notation')"><span>O(n²)</span></div>
                    <div class="matching-item" data-match="linear" onclick="selectMatch(this, 'notation')"><span>O(n)</span></div>
                    <div class="matching-item" data-match="binary" onclick="selectMatch(this, 'notation')"><span>O(log n)</span></div>
                </div>
            </div>
            
            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem;">
                <button class="button" onclick="checkMatching()">Check Matches</button>
                <button class="button secondary" onclick="resetMatching()">Reset</button>
            </div>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(3)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(5)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 5: Algorithm Comparison -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Comparing Algorithms 📈</h2>
            <p>Let's see how different algorithms perform as input size increases.</p>
            
            <div class="simulation-container">
                <h3>Performance Comparison Tool</h3>
                <p>Adjust the input size to see how each algorithm scales:</p>
                
                <div style="margin: 1.5rem 0;">
                    <label style="font-weight: 500;">Input Size: <span id="sizeDisplay" style="color: var(--warning); font-size: 1.25rem; font-weight: 700;">100</span></label>
                    <input type="range" id="sizeSlider" min="10" max="1000" value="100" step="10" style="width: 100%; margin: 1rem 0;" oninput="updateComparison()">
                </div>
                
                <div class="complexity-visual" id="comparisonBars" style="height: 300px;">
                    <div class="complexity-bar" id="linearBar" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                        <span style="color: white;" id="linearValue">100</span>
                        <span class="complexity-label">Linear O(n)</span>
                    </div>
                    <div class="complexity-bar" id="logBar" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                        <span style="color: white;" id="logValue">7</span>
                        <span class="complexity-label">Binary O(log n)</span>
                    </div>
                    <div class="complexity-bar" id="quadraticBar" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                        <span style="color: white;" id="quadraticValue">10000</span>
                        <span class="complexity-label">Bubble O(n²)</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Scenario Analysis</h3>
            <p>You need to search through a customer database. Which algorithm would you choose?</p>
            
            <div style="margin: 1.5rem 0; padding: 1.5rem; background: rgba(255, 255, 255, 0.03); border-radius: 0.75rem; border: 1px solid rgba(255, 255, 255, 0.1);">
                <p><strong style="color: var(--primary);">Scenario A:</strong> 50 customers, data arrives randomly</p>
                <div style="margin-top: 1rem;">
                    <button class="quiz-option" onclick="checkScenario(this, true, 'scenarioA')">Linear Search</button>
                    <button class="quiz-option" onclick="checkScenario(this, false, 'scenarioA')">Binary Search</button>
                </div>
            </div>
            
            <div style="margin: 1.5rem 0; padding: 1.5rem; background: rgba(255, 255, 255, 0.03); border-radius: 0.75rem; border: 1px solid rgba(255, 255, 255, 0.1);">
                <p><strong style="color: var(--primary);">Scenario B:</strong> 1 million customers, sorted by ID</p>
                <div style="margin-top: 1rem;">
                    <button class="quiz-option" onclick="checkScenario(this, false, 'scenarioB')">Linear Search</button>
                    <button class="quiz-option" onclick="checkScenario(this, true, 'scenarioB')">Binary Search</button>
                </div>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Sequencing Challenge</h3>
            <p>Arrange these complexities from fastest to slowest growth:</p>
            
            <ul id="sortList" class="sort-container">
                <li class="sort-item" draggable="true" data-order="3">O(n²) - Quadratic</li>
                <li class="sort-item" draggable="true" data-order="1">O(log n) - Logarithmic</li>
                <li class="sort-item" draggable="true" data-order="2">O(n) - Linear</li>
            </ul>
            
            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem;">
                <button class="button" onclick="checkSequence()">Check Order</button>
                <button class="button secondary" onclick="resetSequence()">Reset</button>
            </div>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(4)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(6)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 6: Real World Applications -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Real-World Applications 🌍</h2>
            <p>Big O notation isn't just theory - it has massive implications in real software!</p>
            
            <div class="card" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(99, 102, 241, 0.05) 100%); border-color: var(--primary);">
                <h3 style="color: var(--primary);">📱 Case Study: Social Media Feed</h3>
                <p>Facebook has over 2 billion users. When loading your feed:</p>
                <ul style="margin-left: 2rem;">
                    <li><strong style="color: var(--error);">O(n²) algorithm:</strong> Would take hours to load!</li>
                    <li><strong style="color: var(--success);">O(n log n) algorithm:</strong> Takes milliseconds</li>
                </ul>
                <p style="margin-top: 1rem;">The difference? Billions of pounds in server costs and user satisfaction!</p>
            </div>
            
            <div class="card" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%); border-color: var(--success);">
                <h3 style="color: var(--success);">🔍 Case Study: Google Search</h3>
                <p>Google indexes trillions of web pages. They use:</p>
                <ul style="margin-left: 2rem;">
                    <li><strong>O(1) hash tables</strong> for instant keyword lookup</li>
                    <li><strong>O(log n) trees</strong> for ranking results</li>
                    <li>Never O(n²) for core operations!</li>
                </ul>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Industry Examples</h3>
            <p>Match each scenario to the most suitable algorithm complexity:</p>
            
            <div style="margin: 1.5rem 0;">
                <p><strong>1. Finding a contact in your phone (sorted alphabetically)</strong></p>
                <select id="example1" style="max-width: 300px; margin: 0.5rem 0;">
                    <option value="">Choose complexity...</option>
                    <option value="n">O(n) - Linear</option>
                    <option value="logn">O(log n) - Logarithmic</option>
                    <option value="n2">O(n²) - Quadratic</option>
                </select>
            </div>
            
            <div style="margin: 1.5rem 0;">
                <p><strong>2. Checking if a username is already taken</strong></p>
                <select id="example2" style="max-width: 300px; margin: 0.5rem 0;">
                    <option value="">Choose complexity...</option>
                    <option value="1">O(1) - Constant (hash table)</option>
                    <option value="n">O(n) - Linear</option>
                    <option value="n2">O(n²) - Quadratic</option>
                </select>
            </div>
            
            <div style="margin: 1.5rem 0;">
                <p><strong>3. Finding duplicates by comparing every item with every other item</strong></p>
                <select id="example3" style="max-width: 300px; margin: 0.5rem 0;">
                    <option value="">Choose complexity...</option>
                    <option value="n">O(n) - Linear</option>
                    <option value="logn">O(log n) - Logarithmic</option>
                    <option value="n2">O(n²) - Quadratic</option>
                </select>
            </div>
            
            <button class="button" onclick="checkExamples()" style="margin-top: 1rem;">Check Answers</button>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(5)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(7)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 7: Common Mistakes -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Common Mistakes to Avoid ⚠️</h2>
            <p>Understanding these common pitfalls will help you master Big O notation!</p>
            
            <div class="card" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(239, 68, 68, 0.05) 100%); border-color: var(--error);">
                <h3 style="color: var(--error);">❌ Mistake #1: Ignoring the Worst Case</h3>
                <p>Big O describes the <strong>worst-case</strong> scenario, not the average or best case.</p>
                <p style="margin-top: 0.5rem;">Example: Linear search might find the item on the first try, but Big O assumes it's at the end.</p>
            </div>
            
            <div class="card" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(239, 68, 68, 0.05) 100%); border-color: var(--error);">
                <h3 style="color: var(--error);">❌ Mistake #2: Including Constants</h3>
                <p>O(2n) and O(n) are the same! We drop constants in Big O notation.</p>
                <p style="margin-top: 0.5rem;">Why? As n approaches infinity, constants become insignificant.</p>
            </div>
            
            <div class="card" style="background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(239, 68, 68, 0.05) 100%); border-color: var(--error);">
                <h3 style="color: var(--error);">❌ Mistake #3: Forgetting Prerequisites</h3>
                <p>Binary search requires a <strong>sorted array</strong>. Using it on unsorted data won't work!</p>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Spot the Mistake!</h3>
            <p>Which of these statements contains an error?</p>
            
            <div id="mistakeQuiz">
                <button class="quiz-option" onclick="checkMistake(this, false)">Binary search has O(log n) complexity</button>
                <button class="quiz-option" onclick="checkMistake(this, true)">O(3n) is different from O(n) in Big O notation</button>
                <button class="quiz-option" onclick="checkMistake(this, false)">Bubble sort has O(n²) complexity</button>
                <button class="quiz-option" onclick="checkMistake(this, false)">Linear search works on unsorted arrays</button>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Fix the Code</h3>
            <p>This student claims their search algorithm is O(log n). What's wrong?</p>
            
            <pre><code>function search(arr, target):
    for i from 0 to length(arr):
        if arr[i] == target:
            return i
    return -1</code></pre>
            
            <textarea id="codeFixAnswer" rows="3" style="margin: 1rem 0;" placeholder="Explain what's wrong..."></textarea>
            
            <button class="button" onclick="checkCodeFix()">Submit Answer</button>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(6)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(8)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 8: Practice Exam Questions -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Practice Exam Questions 📝</h2>
            <p>These questions are similar to what you might see in your A-level exam.</p>
        </div>

        <div class="card contain-paint">
            <h3>Question 1 (4 marks)</h3>
            <p>Explain what Big O notation represents and why it is useful when comparing algorithms.</p>
            
            <textarea id="examQ1" rows="6" placeholder="Write your answer here..."></textarea>
            
            <div style="margin: 1rem 0; display: flex; align-items: center; gap: 1rem;">
                <label>Predicted marks: </label>
                <input type="number" id="marksQ1" min="0" max="4" style="width: 80px;">
                <button class="button" onclick="showMarkScheme('q1')">Show Mark Scheme</button>
            </div>
            
            <div id="markSchemeQ1" style="display: none; background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%); padding: 1.5rem; border-radius: 0.75rem; margin-top: 1rem; border: 1px solid var(--success);">
                <h4>Mark Scheme:</h4>
                <ul style="margin-left: 1.5rem;">
                    <li>1 mark: States that Big O represents worst-case time complexity</li>
                    <li>1 mark: Mentions it shows how runtime grows with input size</li>
                    <li>1 mark: Explains it allows objective comparison of algorithms</li>
                    <li>1 mark: Gives an example or mentions ignoring constants/lower terms</li>
                </ul>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Question 2 (3 marks)</h3>
            <p>State the Big O notation for each of the following algorithms and briefly explain why:</p>
            <ol style="margin-left: 2rem;">
                <li>Linear search</li>
                <li>Binary search</li>
                <li>Bubble sort</li>
            </ol>
            
            <textarea id="examQ2" rows="6" placeholder="Write your answer here..."></textarea>
            
            <div style="margin: 1rem 0; display: flex; align-items: center; gap: 1rem;">
                <label>Predicted marks: </label>
                <input type="number" id="marksQ2" min="0" max="3" style="width: 80px;">
                <button class="button" onclick="showMarkScheme('q2')">Show Mark Scheme</button>
            </div>
            
            <div id="markSchemeQ2" style="display: none; background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%); padding: 1.5rem; border-radius: 0.75rem; margin-top: 1rem; border: 1px solid var(--success);">
                <h4>Mark Scheme:</h4>
                <ul style="margin-left: 1.5rem;">
                    <li>1 mark: Linear search - O(n), must check each element</li>
                    <li>1 mark: Binary search - O(log n), divides search space in half</li>
                    <li>1 mark: Bubble sort - O(n²), nested loops/compares each with each</li>
                </ul>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Question 3 (5 marks)</h3>
            <p>A programmer needs to search through a list of 1,000,000 student records. Compare the maximum number of operations required by linear search and binary search. Show your working.</p>
            
            <div class="canvas-container" style="height: 200px;">
                <canvas id="drawingCanvas" width="800" height="200"></canvas>
                <button class="button secondary" style="position: absolute; top: 10px; right: 10px; padding: 0.5rem 1rem;" onclick="clearCanvas()">Clear</button>
            </div>
            
            <textarea id="examQ3" rows="4" placeholder="Write your answer here..."></textarea>
            
            <div style="margin: 1rem 0; display: flex; align-items: center; gap: 1rem;">
                <label>Predicted marks: </label>
                <input type="number" id="marksQ3" min="0" max="5" style="width: 80px;">
                <button class="button" onclick="showMarkScheme('q3')">Show Mark Scheme</button>
            </div>
            
            <div id="markSchemeQ3" style="display: none; background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%); padding: 1.5rem; border-radius: 0.75rem; margin-top: 1rem; border: 1px solid var(--success);">
                <h4>Mark Scheme:</h4>
                <ul style="margin-left: 1.5rem;">
                    <li>1 mark: Linear search requires up to 1,000,000 operations</li>
                    <li>2 marks: Binary search calculation - log₂(1,000,000) ≈ 20</li>
                    <li>1 mark: Shows working (e.g., 2²⁰ = 1,048,576)</li>
                    <li>1 mark: Concludes binary search is significantly faster</li>
                </ul>
            </div>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(7)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(9)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 9: Extension Activities -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Extension Activities 🚀</h2>
            <p>Ready to go beyond the specification? These challenges will deepen your understanding!</p>
        </div>

        <div class="card contain-paint">
            <h3>Challenge 1: Other Complexities</h3>
            <p>Research and explain these additional Big O complexities:</p>
            <ul style="margin-left: 2rem;">
                <li><strong>O(n log n)</strong> - Found in efficient sorting algorithms</li>
                <li><strong>O(2ⁿ)</strong> - Exponential time</li>
                <li><strong>O(n!)</strong> - Factorial time</li>
            </ul>
            
            <textarea id="extension1" rows="4" placeholder="Research and explain..."></textarea>
            
            <button class="button" onclick="checkExtension('extension1')" style="margin-top: 1rem;">Submit</button>
        </div>

        <div class="card contain-paint">
            <h3>Challenge 2: Best vs Worst Case</h3>
            <p>Some algorithms have different complexities for best and worst cases. Research:</p>
            <ul style="margin-left: 2rem;">
                <li>What is the best-case complexity of bubble sort?</li>
                <li>What modification makes it achieve this?</li>
                <li>What is Omega (Ω) notation?</li>
            </ul>
            
            <textarea id="extension2" rows="4" placeholder="Your findings..."></textarea>
            
            <button class="button" onclick="checkExtension('extension2')" style="margin-top: 1rem;">Submit</button>
        </div>

        <div class="card contain-paint">
            <h3>Challenge 3: Space Complexity</h3>
            <p>Big O isn't just about time - it's also used for space (memory) complexity!</p>
            <p>Research and explain the space complexity of:</p>
            <ul style="margin-left: 2rem;">
                <li>Linear search</li>
                <li>Binary search (iterative vs recursive)</li>
                <li>Merge sort</li>
            </ul>
            
            <textarea id="extension3" rows="4" placeholder="Explain space complexity..."></textarea>
            
            <button class="button" onclick="checkExtension('extension3')" style="margin-top: 1rem;">Submit</button>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(8)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(10)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 10: Summary -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Summary & Final Assessment 🎯</h2>
            <p>Let's review what you've learned about Big O notation!</p>
            
            <div class="card" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(99, 102, 241, 0.05) 100%); border-color: var(--primary);">
                <h3 style="color: var(--primary);">🔑 Key Takeaways</h3>
                <ul style="margin-left: 2rem;">
                    <li><strong>Big O notation</strong> describes worst-case time complexity</li>
                    <li><strong>O(n)</strong> - Linear time (e.g., linear search)</li>
                    <li><strong>O(log n)</strong> - Logarithmic time (e.g., binary search on sorted data)</li>
                    <li><strong>O(n²)</strong> - Quadratic time (e.g., bubble sort)</li>
                    <li>Lower complexity = better performance on large datasets</li>
                    <li>Constants and lower-order terms are ignored</li>
                </ul>
            </div>
        </div>

        <div class="card contain-paint">
            <h3>Final Assessment Quiz</h3>
            <p>Complete this quiz to test your understanding:</p>
            
            <div style="margin: 2rem 0;">
                <h4>Question 1: What does Big O notation represent?</h4>
                <div id="finalQ1">
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ1')">The exact runtime of an algorithm</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ1')">The best-case performance</button>
                    <button class="quiz-option" onclick="checkFinal(this, true, 'finalQ1')">The worst-case growth rate</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ1')">The memory usage</button>
                </div>
            </div>

            <div style="margin: 2rem 0;">
                <h4>Question 2: Which has the best performance on large datasets?</h4>
                <div id="finalQ2">
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ2')">O(n²)</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ2')">O(n)</button>
                    <button class="quiz-option" onclick="checkFinal(this, true, 'finalQ2')">O(log n)</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ2')">O(2n)</button>
                </div>
            </div>

            <div style="margin: 2rem 0;">
                <h4>Question 3: Binary search requires:</h4>
                <div id="finalQ3">
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ3')">Any type of list</button>
                    <button class="quiz-option" onclick="checkFinal(this, true, 'finalQ3')">A sorted list</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ3')">A small list</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ3')">A linked list</button>
                </div>
            </div>

            <div style="margin: 2rem 0;">
                <h4>Question 4: For 1024 elements, binary search needs at most:</h4>
                <div id="finalQ4">
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ4')">1024 comparisons</button>
                    <button class="quiz-option" onclick="checkFinal(this, true, 'finalQ4')">10 comparisons</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ4')">512 comparisons</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ4')">100 comparisons</button>
                </div>
            </div>

            <div style="margin: 2rem 0;">
                <h4>Question 5: Which statement is correct?</h4>
                <div id="finalQ5">
                    <button class="quiz-option" onclick="checkFinal(this, true, 'finalQ5')">O(3n) is the same as O(n)</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ5')">Bubble sort is O(n)</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ5')">Linear search is O(log n)</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ5')">Constants matter in Big O</button>
                </div>
            </div>

            <div style="margin: 2rem 0;">
                <h4>Question 6: Bubble sort compares:</h4>
                <div id="finalQ6">
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ6')">Random elements</button>
                    <button class="quiz-option" onclick="checkFinal(this, true, 'finalQ6')">Adjacent elements</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ6')">First and last elements</button>
                    <button class="quiz-option" onclick="checkFinal(this, false, 'finalQ6')">Middle elements</button>
                </div>
            </div>

            <div id="finalScore" style="display: none; margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%); border-radius: 0.75rem; border: 1px solid var(--success);">
                <h3>Your Score: <span id="finalScoreValue" style="color: var(--success);">0</span>/6</h3>
                <p id="finalFeedback" style="margin-top: 0.5rem;"></p>
            </div>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(9)"><span>← Previous</span></button>
            <button class="nav-arrow" onclick="showSection(11)"><span>Next →</span></button>
        </div>
    </section>

    <!-- Section 11: Videos -->
    <section class="section">
        <div class="card contain-paint">
            <h2>Video Resources 📹</h2>
            <p>These videos will help reinforce your understanding of Big O notation:</p>
            
            <div class="card" style="background: rgba(255, 255, 255, 0.03);">
                <h3>Recommended Videos</h3>
                <p style="margin: 1rem 0;"><em>Videos would be embedded here. Topics to cover:</em></p>
                <ul style="margin-left: 2rem;">
                    <li>📺 Introduction to Big O Notation (10 mins)</li>
                    <li>📺 Visualising Algorithm Complexity (8 mins)</li>
                    <li>📺 Linear vs Binary Search Comparison (12 mins)</li>
                    <li>📺 Understanding Bubble Sort (7 mins)</li>
                    <li>📺 Real-world Applications of Big O (15 mins)</li>
                </ul>
            </div>
            
            <div class="card" style="background: linear-gradient(135deg, rgba(99, 102, 241, 0.15) 0%, rgba(99, 102, 241, 0.05) 100%); border-color: var(--primary);">
                <h3 style="color: var(--primary);">🎉 Course Complete!</h3>
                <p>Congratulations on completing the Big O Notation lesson!</p>
                <p style="margin: 1rem 0;">Your final level: <strong style="font-size: 1.25rem; color: var(--warning);">Level <span id="finalLevel">1</span></strong></p>
                <p>Total XP earned: <strong style="font-size: 1.25rem; color: var(--success);"><span id="totalXP">0</span> XP</strong></p>
                
                <div style="margin-top: 1.5rem;">
                    <h4>Next Steps:</h4>
                    <ul style="margin-left: 2rem;">
                        <li>Review any sections you found challenging</li>
                        <li>Complete the extension activities for extra practice</li>
                        <li>Try implementing these algorithms in your preferred programming language</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="navigation-arrows">
            <button class="nav-arrow" onclick="showSection(10)"><span>← Previous</span></button>
            <button class="nav-arrow" disabled><span>Next →</span></button>
        </div>
    </section>

    <!-- Feedback Button -->
    <button class="feedback-button" onclick="openFeedback()">💬</button>

    <!-- Feedback Modal -->
    <div class="feedback-modal" id="feedbackModal">
        <div class="feedback-content">
            <h3 style="margin-bottom: 1rem;">Send Feedback</h3>
            <p style="color: var(--text-secondary);">Found a bug or have a suggestion? Let us know!</p>
            <textarea class="feedback-textarea" id="feedbackText" placeholder="Describe the issue or suggestion..."></textarea>
            <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                <button class="button secondary" onclick="closeFeedback()">Cancel</button>
                <button class="button" onclick="sendFeedback()">Send</button>
            </div>
        </div>
    </div>

    <script>
        // Make all functions globally accessible for onclick handlers
        
        // Performance optimization: Debounce function
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Performance optimization: RequestAnimationFrame throttle
        function rafThrottle(callback) {
            let requestId = null;
            return function(...args) {
                if (requestId === null) {
                    requestId = requestAnimationFrame(() => {
                        callback.apply(this, args);
                        requestId = null;
                    });
                }
            };
        }

        // Global state
        let currentSection = 0;
        let currentLevel = 1;
        let currentXP = 0;
        let totalXPEarned = 0;
        const xpPerLevel = 100;
        const maxLevel = 5;
        let earnedActions = new Set();
        let achievements = [];

        // DOM cache for performance
        const domCache = {
            header: null,
            sections: null,
            navButtons: null,
            xpBar: null,
            xpText: null,
            levelSpan: null,
            finalLevel: null,
            totalXP: null
        };

        // Initialize DOM cache
        function initDOMCache() {
            domCache.header = document.getElementById('header');
            domCache.sections = document.querySelectorAll('.section');
            domCache.navButtons = document.querySelectorAll('.nav-button');
            domCache.xpBar = document.getElementById('xpBar');
            domCache.xpText = document.getElementById('xpText');
            domCache.levelSpan = document.getElementById('level');
            domCache.finalLevel = document.getElementById('finalLevel');
            domCache.totalXP = document.getElementById('totalXP');
        }

        // Header scroll effect
        const handleScroll = rafThrottle(() => {
            if (window.scrollY > 50) {
                domCache.header.classList.add('scrolled');
            } else {
                domCache.header.classList.remove('scrolled');
            }
        });

        window.addEventListener('scroll', handleScroll, { passive: true });

        // XP and Achievement System
        window.addXP = function(amount, action, showPopup = true) {
            if (earnedActions.has(action)) return;
            earnedActions.add(action);
            
            currentXP += amount;
            totalXPEarned += amount;
            
            if (showPopup) {
                createXPPopup(amount);
            }
            
            while (currentXP >= xpPerLevel && currentLevel < maxLevel) {
                currentXP -= xpPerLevel;
                currentLevel++;
                showAchievement('Level Up!', `You reached Level ${currentLevel}!`);
                createParticles();
                createConfetti();
            }
            
            updateXPDisplay();
        }

        function updateXPDisplay() {
            const xpPercent = (currentXP / xpPerLevel) * 100;
            domCache.xpBar.style.width = xpPercent + '%';
            domCache.xpText.textContent = `${currentXP}/${xpPerLevel} XP`;
            domCache.levelSpan.textContent = currentLevel;
            domCache.finalLevel.textContent = currentLevel;
            domCache.totalXP.textContent = totalXPEarned;
        }

        function createXPPopup(amount) {
            const popup = document.createElement('div');
            popup.className = 'xp-popup';
            popup.textContent = `+${amount} XP`;
            popup.style.left = (Math.random() * window.innerWidth * 0.8 + window.innerWidth * 0.1) + 'px';
            popup.style.top = (window.innerHeight * 0.5) + 'px';
            document.body.appendChild(popup);
            
            setTimeout(() => popup.remove(), 2500);
        }

        function createParticles() {
            const colors = ['#f59e0b', '#ec4899', '#8b5cf6', '#3b82f6', '#10b981'];
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.className = 'particle';
                    const x = (Math.random() - 0.5) * 200;
                    const y = (Math.random() - 0.5) * 200;
                    particle.style.setProperty('--x', x + 'px');
                    particle.style.setProperty('--y', y + 'px');
                    particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.left = (window.innerWidth / 2) + 'px';
                    particle.style.top = '100px';
                    document.body.appendChild(particle);
                    
                    setTimeout(() => particle.remove(), 1500);
                }, i * 30);
            }
        }

        function createConfetti() {
            const colors = ['#f59e0b', '#ec4899', '#8b5cf6', '#3b82f6', '#10b981', '#ef4444'];
            for (let i = 0; i < 50; i++) {
                setTimeout(() => {
                    const confetti = document.createElement('div');
                    confetti.className = 'confetti';
                    confetti.style.left = Math.random() * 100 + '%';
                    confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.animationDelay = Math.random() * 0.5 + 's';
                    confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
                    document.body.appendChild(confetti);
                    
                    setTimeout(() => confetti.remove(), 3500);
                }, i * 20);
            }
        }

        window.showAchievement = function(title, description) {
            const popup = document.createElement('div');
            popup.className = 'achievement-popup';
            popup.innerHTML = `
                <div class="achievement-icon">🏆</div>
                <h3 style="margin-bottom: 0.5rem; color: var(--warning);">${title}</h3>
                <p style="color: var(--text-secondary);">${description}</p>
            `;
            document.body.appendChild(popup);
            
            requestAnimationFrame(() => {
                popup.classList.add('show');
            });
            
            setTimeout(() => {
                popup.classList.remove('show');
                setTimeout(() => popup.remove(), 500);
            }, 3500);
        }

        // Navigation with lazy loading - Make it globally accessible
        window.showSection = function(index) {
            if (!domCache.sections) {
                initDOMCache();
            }
            
            domCache.sections.forEach(s => {
                s.classList.remove('active');
                s.style.display = 'none';
            });
            domCache.navButtons.forEach(b => b.classList.remove('active'));
            
            const targetSection = domCache.sections[index];
            targetSection.style.display = 'block';
            requestAnimationFrame(() => {
                targetSection.classList.add('active');
            });
            
            domCache.navButtons[index].classList.add('active');
            currentSection = index;
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Event delegation for quiz options
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('quiz-option')) {
                // Handle quiz clicks
            }
        });

        // Prevent paste - more efficient method
        document.addEventListener('paste', (e) => {
            const target = e.target;
            if (target.tagName === 'TEXTAREA' || target.tagName === 'INPUT') {
                if (!target.classList.contains('allow-paste')) {
                    e.preventDefault();
                }
            }
        });

        // Section 0: Starter Activity - Make functions global
        const raceArray = [2, 5, 8, 12, 15, 18, 22, 27, 31, 35, 38, 42, 47, 52, 58, 65];
        let linearIndex = 0;
        let binaryLow = 0;
        let binaryHigh = raceArray.length - 1;
        let binaryMid = 0;
        let linearSteps = 0;
        let binarySteps = 0;
        let raceInterval;
        let raceTarget = 42;
        let linearSearchFinished = false;
        let binarySearchFinished = false;

        window.initializeRaceArrays = function() {
            const linearDiv = document.getElementById('linearArray');
            const binaryDiv = document.getElementById('binaryArray');
            
            linearDiv.innerHTML = '';
            binaryDiv.innerHTML = '';
            
            raceArray.forEach(num => {
                const linearEl = document.createElement('span');
                linearEl.className = 'array-element gpu-accelerated';
                linearEl.textContent = num;
                linearDiv.appendChild(linearEl);
                
                const binaryEl = document.createElement('span');
                binaryEl.className = 'array-element gpu-accelerated';
                binaryEl.textContent = num;
                binaryDiv.appendChild(binaryEl);
            });
        }

        window.startRace = function() {
            resetRace();
            raceInterval = setInterval(raceStep, 600);
        }

        window.raceStep = function() {
            // Linear search step
            if (!linearSearchFinished) {
                const linearElements = document.getElementById('linearArray').children;
                Array.from(linearElements).forEach(el => el.classList.remove('active'));

                if (linearIndex < raceArray.length) {
                    linearElements[linearIndex].classList.add('active');
                    linearSteps++;
                    document.getElementById('linearSteps').textContent = linearSteps;
                    
                    if (raceArray[linearIndex] === raceTarget) {
                        linearElements[linearIndex].classList.add('found');
                        linearSearchFinished = true;
                    }
                    linearIndex++;
                } else {
                     linearSearchFinished = true;
                }
            }
            
            // Binary search step
            if (!binarySearchFinished) {
                if (binaryLow <= binaryHigh) {
                    const binaryElements = document.getElementById('binaryArray').children;
                    Array.from(binaryElements).forEach(el => el.classList.remove('active'));
                    
                    binaryMid = Math.floor((binaryLow + binaryHigh) / 2);
                    binaryElements[binaryMid].classList.add('active');
                    binarySteps++;
                    document.getElementById('binarySteps').textContent = binarySteps;
                    
                    if (raceArray[binaryMid] === raceTarget) {
                        binaryElements[binaryMid].classList.add('found');
                        binarySearchFinished = true;
                        addXP(10, 'starter-race');
                    } else if (raceArray[binaryMid] < raceTarget) {
                        binaryLow = binaryMid + 1;
                    } else {
                        binaryHigh = binaryMid - 1;
                    }
                } else {
                    binarySearchFinished = true;
                }
            }

            if (linearSearchFinished && binarySearchFinished) {
                clearInterval(raceInterval);
            }
        }

        window.resetRace = function() {
            clearInterval(raceInterval);
            linearIndex = 0;
            binaryLow = 0;
            binaryHigh = raceArray.length - 1;
            linearSteps = 0;
            binarySteps = 0;
            document.getElementById('linearSteps').textContent = '0';
            document.getElementById('binarySteps').textContent = '0';
            initializeRaceArrays();
            linearSearchFinished = false;
            binarySearchFinished = false;
        }

        window.checkStarterAnswer = function(button, isCorrect) {
            const buttons = button.parentElement.querySelectorAll('.quiz-option');
            buttons.forEach(b => {
                b.disabled = true;
                b.style.cursor = 'not-allowed';
            });
            
            if (isCorrect) {
                button.classList.add('correct');
                addXP(15, 'starter-quiz');
            } else {
                button.classList.add('incorrect');
            }
        }

        // Section 1: Fill in the blanks - Make functions global
        window.fillBlank = function(inputId, value) {
            document.getElementById(inputId).value = value;
        }

        window.checkFillBlanks = function() {
            const blank1 = document.getElementById('blank1').value;
            const blank2 = document.getElementById('blank2').value;
            const feedback = document.getElementById('fillBlankFeedback');
            
            if (blank1 === 'worst-case' && blank2 === 'input size') {
                feedback.innerHTML = '<p style="color: var(--success); font-weight: 500;">✓ Correct! Big O describes worst-case runtime as input size grows.</p>';
                addXP(20, 'fill-blanks');
            } else {
                feedback.innerHTML = '<p style="color: var(--error); font-weight: 500;">✗ Not quite right. Remember: Big O focuses on worst-case performance and how it scales with input size.</p>';
            }
        }

        window.resetFillBlanks = function() {
            document.getElementById('blank1').value = '';
            document.getElementById('blank2').value = '';
            document.getElementById('fillBlankFeedback').innerHTML = '';
        }

        // Section 2: Linear Search - Make functions global
        let linearSearchArray = [];
        let linearSearchTarget = 15;
        let linearSearchIndex = 0;
        let linearSearchFound = false;
        let linearSearchInterval = null;

        window.initializeLinearSearch = function() {
            linearSearchArray = [];
            for (let i = 1; i <= 20; i++) {
                linearSearchArray.push(i);
            }
            
            const container = document.getElementById('linearSearchArray');
            container.innerHTML = '';
            linearSearchArray.forEach(num => {
                const el = document.createElement('span');
                el.className = 'array-element gpu-accelerated';
                el.textContent = num;
                container.appendChild(el);
            });
        }

        window.startLinearSearch = function() {
            resetLinearSearch();
            linearSearchTarget = parseInt(document.getElementById('linearSearchTarget').value);
            document.getElementById('linearSearchTotal').textContent = linearSearchArray.length;
            linearSearchInterval = setInterval(stepLinearSearch, 400);
        }

        window.stepLinearSearch = function() {
            if (linearSearchIndex >= linearSearchArray.length || linearSearchFound) {
                clearInterval(linearSearchInterval);
                return;
            }
            
            const elements = document.getElementById('linearSearchArray').children;
            Array.from(elements).forEach(el => el.classList.remove('active'));
            
            elements[linearSearchIndex].classList.add('active');
            document.getElementById('linearSearchStep').textContent = linearSearchIndex + 1;
            
            if (linearSearchArray[linearSearchIndex] === linearSearchTarget) {
                elements[linearSearchIndex].classList.add('found');
                linearSearchFound = true;
                document.getElementById('linearSearchResult').innerHTML = 
                    `<p style="color: var(--success);">✓ Found ${linearSearchTarget} at index ${linearSearchIndex} after ${linearSearchIndex + 1} steps!</p>`;
                addXP(15, 'linear-search-sim');
                clearInterval(linearSearchInterval);
            } else {
                linearSearchIndex++;
                if (linearSearchIndex >= linearSearchArray.length) {
                    document.getElementById('linearSearchResult').innerHTML = 
                        `<p style="color: var(--error);">✗ Not found after checking all ${linearSearchArray.length} elements!</p>`;
                    clearInterval(linearSearchInterval);
                }
            }
        }

        window.resetLinearSearch = function() {
            clearInterval(linearSearchInterval);
            initializeLinearSearch();
            linearSearchIndex = 0;
            linearSearchFound = false;
            document.getElementById('linearSearchStep').textContent = '0';
            document.getElementById('linearSearchResult').innerHTML = '';
        }

        window.showHint = function(hintId) {
            const hint = document.getElementById(hintId);
            hint.classList.add('show');
            addXP(5, `hint-${hintId}`);
        }

        // Section 3: Binary Search - Make functions global
        let binarySearchArray = [];
        let binarySearchTarget = 11;
        let binarySearchLow = 0;
        let binarySearchHigh = 15;
        let binarySearchMid = 0;
        let binarySearchStep = 0;
        let binarySearchFound = false;
        let binarySearchInterval = null;

        window.initializeBinarySearch = function() {
            binarySearchArray = [];
            for (let i = 1; i <= 16; i++) {
                binarySearchArray.push(i);
            }
            
            const container = document.getElementById('binarySearchArray');
            container.innerHTML = '';
            binarySearchArray.forEach(num => {
                const el = document.createElement('span');
                el.className = 'array-element gpu-accelerated';
                el.textContent = num;
                container.appendChild(el);
            });
            
            // Initialize the interactive graph
            updateLogNGraph();
        }

        window.updateLogNGraph = function() {
            const slider = document.getElementById('logNSizeSlider');
            if (!slider) return;

            const size = parseInt(slider.value);
            const logNValue = Math.ceil(Math.log2(size));
            
            document.getElementById('logNSizeDisplay').textContent = size.toLocaleString();
            document.getElementById('logNValue').textContent = logNValue.toLocaleString();
            document.getElementById('nValue').textContent = size.toLocaleString();
        }

        window.startBinarySearch = function() {
            resetBinarySearch();
            binarySearchTarget = parseInt(document.getElementById('binarySearchTarget').value);
            binarySearchInterval = setInterval(stepBinarySearch, 800);
        }

        window.stepBinarySearch = function() {
            if (binarySearchLow > binarySearchHigh || binarySearchFound) {
                clearInterval(binarySearchInterval);
                if (!binarySearchFound) {
                     document.getElementById('binarySearchResult').innerHTML = 
                        `<p style="color: var(--error);">✗ Not found after ${binarySearchStep} steps!</p>`;
                }
                return;
            }
            
            const elements = document.getElementById('binarySearchArray').children;
            Array.from(elements).forEach(el => el.classList.remove('active'));
            
            // Highlight the current search range
            for (let i = 0; i < elements.length; i++) {
                elements[i].style.opacity = (i >= binarySearchLow && i <= binarySearchHigh) ? '1' : '0.3';
            }
            
            binarySearchMid = Math.floor((binarySearchLow + binarySearchHigh) / 2);
            elements[binarySearchMid].classList.add('active');
            binarySearchStep++;
            
            updateBinarySearchDisplay();
            
            if (binarySearchArray[binarySearchMid] === binarySearchTarget) {
                elements[binarySearchMid].classList.add('found');
                binarySearchFound = true;
                document.getElementById('binarySearchResult').innerHTML = 
                    `<p style="color: var(--success);">✓ Found ${binarySearchTarget} at index ${binarySearchMid} after ${binarySearchStep} steps!</p>`;
                addXP(20, 'binary-search-sim');
                clearInterval(binarySearchInterval);
            } else if (binarySearchArray[binarySearchMid] < binarySearchTarget) {
                binarySearchLow = binarySearchMid + 1;
            } else {
                binarySearchHigh = binarySearchMid - 1;
            }
        }

        window.updateBinarySearchDisplay = function() {
            document.getElementById('binarySearchStep').textContent = binarySearchStep;
            document.getElementById('binaryLow').textContent = binarySearchLow;
            document.getElementById('binaryMid').textContent = binarySearchMid;
            document.getElementById('binaryHigh').textContent = binarySearchHigh;
        }

        window.resetBinarySearch = function() {
            clearInterval(binarySearchInterval);
            initializeBinarySearch();
            binarySearchLow = 0;
            binarySearchHigh = binarySearchArray.length - 1;
            binarySearchStep = 0;
            binarySearchFound = false;
            updateBinarySearchDisplay();
            document.getElementById('binarySearchResult').innerHTML = '';
            
            // Reset opacity
            const elements = document.getElementById('binarySearchArray').children;
            Array.from(elements).forEach(el => el.style.opacity = '1');
        }

        // Section 4: Bubble Sort - Make functions global
        let bubbleSortArray = [];
        let bubblePass = 0;
        let bubbleIndex = 0;
        let bubbleComparisons = 0;
        let bubbleSwaps = 0;
        let bubbleSorting = false;
        let bubbleInterval;

        window.initializeBubbleSort = function() {
            bubbleSortArray = [8, 3, 5, 4, 7, 6, 1, 2];
            renderBubbleArray();
        }

        window.renderBubbleArray = function() {
            const container = document.getElementById('bubbleSortArray');
            container.innerHTML = '';
            bubbleSortArray.forEach((num, idx) => {
                const el = document.createElement('span');
                el.className = 'array-element gpu-accelerated';
                el.textContent = num;
                el.id = `bubble-${idx}`;
                el.style.backgroundColor = `rgba(99, 102, 241, ${num / 10})`;
                container.appendChild(el);
            });
        }

        window.startBubbleSort = function() {
            resetBubbleSort();
            bubbleSorting = true;
            bubbleInterval = setInterval(stepBubbleSort, 400);
        }

        window.stepBubbleSort = function() {
            if (!bubbleSorting) {
                clearInterval(bubbleInterval);
                return;
            }
            
            const elements = document.getElementById('bubbleSortArray').children;
            Array.from(elements).forEach(el => el.classList.remove('active'));
            
            if (bubbleIndex < bubbleSortArray.length - 1 - bubblePass) {
                elements[bubbleIndex].classList.add('active');
                elements[bubbleIndex + 1].classList.add('active');
                
                bubbleComparisons++;
                
                if (bubbleSortArray[bubbleIndex] > bubbleSortArray[bubbleIndex + 1]) {
                    // Swap with animation
                    const temp = bubbleSortArray[bubbleIndex];
                    bubbleSortArray[bubbleIndex] = bubbleSortArray[bubbleIndex + 1];
                    bubbleSortArray[bubbleIndex + 1] = temp;
                    bubbleSwaps++;
                    
                    // Animate swap
                    elements[bubbleIndex].style.transform = 'translateX(65px)';
                    elements[bubbleIndex + 1].style.transform = 'translateX(-65px)';
                    
                    setTimeout(() => {
                        renderBubbleArray();
                    }, 300);
                }
                
                bubbleIndex++;
            } else {
                bubblePass++;
                bubbleIndex = 0;
                
                // Highlight sorted elements
                for (let i = bubbleSortArray.length - bubblePass; i < bubbleSortArray.length; i++) {
                    if(elements[i]) {
                        elements[i].style.backgroundColor = 'var(--success)';
                        elements[i].style.color = 'white';
                    }
                }
                
                if (bubblePass >= bubbleSortArray.length - 1) {
                    bubbleSorting = false;
                    if(elements[0]) {
                        elements[0].style.backgroundColor = 'var(--success)';
                        elements[0].style.color = 'white';
                    }
                    addXP(25, 'bubble-sort-sim');
                    showAchievement('Sorting Master!', 'You completed the bubble sort simulation!');
                    clearInterval(bubbleInterval);
                }
            }
            
            updateBubbleSortDisplay();
        }

        window.updateBubbleSortDisplay = function() {
            document.getElementById('bubblePass').textContent = bubblePass;
            document.getElementById('bubbleComparisons').textContent = bubbleComparisons;
            document.getElementById('bubbleSwaps').textContent = bubbleSwaps;
        }

        window.resetBubbleSort = function() {
            clearInterval(bubbleInterval);
            bubbleInterval = null;
            bubblePass = 0;
            bubbleIndex = 0;
            bubbleComparisons = 0;
            bubbleSwaps = 0;
            bubbleSorting = false;
            initializeBubbleSort();
            updateBubbleSortDisplay();
        }

        // Section 5: Comparison - Make functions global
        window.updateComparison = function() {
            const size = parseInt(document.getElementById('sizeSlider').value);
            document.getElementById('sizeDisplay').textContent = size;
            
            const maxHeight = 85;
            const linearHeight = Math.min(maxHeight, (size / 1000) * maxHeight);
            const logHeight = Math.min(maxHeight, (Math.log2(size) / Math.log2(1000)) * maxHeight);
            const quadraticHeight = Math.min(maxHeight, Math.pow(size / 1000, 2) * maxHeight);
            
            requestAnimationFrame(() => {
                document.getElementById('linearBar').style.height = linearHeight + '%';
                document.getElementById('logBar').style.height = logHeight + '%';
                document.getElementById('quadraticBar').style.height = quadraticHeight + '%';
                
                document.getElementById('linearValue').textContent = size;
                document.getElementById('logValue').textContent = Math.ceil(Math.log2(size));
                document.getElementById('quadraticValue').textContent = size * size;
            });
        }

        window.checkScenario = function(button, isCorrect, scenario) {
            const buttons = button.parentElement.querySelectorAll('.quiz-option');
            buttons.forEach(b => {
                b.disabled = true;
                b.style.cursor = 'not-allowed';
            });
            
            if (isCorrect) {
                button.classList.add('correct');
                addXP(15, `scenario-${scenario}`);
            } else {
                button.classList.add('incorrect');
            }
        }

        // Drag and drop for sequencing
        let draggedItem = null;

        function setupDragAndDrop() {
            const sortItems = document.querySelectorAll('.sort-item');
            
            sortItems.forEach(item => {
                item.addEventListener('dragstart', (e) => {
                    draggedItem = e.target;
                    e.target.classList.add('dragging');
                });
                
                item.addEventListener('dragend', (e) => {
                    e.target.classList.remove('dragging');
                });
                
                item.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    const container = document.getElementById('sortList');
                    const afterElement = getDragAfterElement(container, e.clientY);
                    if (afterElement == null) {
                        container.appendChild(draggedItem);
                    } else {
                        container.insertBefore(draggedItem, afterElement);
                    }
                });
                
                item.addEventListener('touchstart', handleTouchStart, { passive: false });
                item.addEventListener('touchmove', handleTouchMove, { passive: false });
                item.addEventListener('touchend', handleTouchEnd, { passive: false });
            });
        }

        // Touch support for drag and drop
        let touchItem = null;
        let touchOffset = { x: 0, y: 0 };

        function handleTouchStart(e) {
            touchItem = e.target;
            const touch = e.touches[0];
            const rect = touchItem.getBoundingClientRect();
            touchOffset.x = touch.clientX - rect.left;
            touchOffset.y = touch.clientY - rect.top;
            touchItem.style.position = 'fixed';
            touchItem.style.zIndex = '1000';
            touchItem.classList.add('dragging');
        }

        function handleTouchMove(e) {
            if (!touchItem) return;
            e.preventDefault();
            const touch = e.touches[0];
            touchItem.style.left = (touch.clientX - touchOffset.x) + 'px';
            touchItem.style.top = (touch.clientY - touchOffset.y) + 'px';
        }

        function handleTouchEnd(e) {
            if (!touchItem) return;
            touchItem.style.position = '';
            touchItem.style.zIndex = '';
            touchItem.style.left = '';
            touchItem.style.top = '';
            touchItem.classList.remove('dragging');
            touchItem = null;
        }

        function getDragAfterElement(container, y) {
            const draggableElements = [...container.querySelectorAll('.sort-item:not(.dragging)')];
            
            return draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY }).element;
        }

        function checkSequence() {
            const items = document.querySelectorAll('.sort-item');
            let correct = true;
            
            items.forEach((item, index) => {
                if (parseInt(item.getAttribute('data-order')) !== index + 1) {
                    correct = false;
                }
            });
            
            if (correct) {
                items.forEach(item => {
                    item.style.background = 'rgba(16, 185, 129, 0.2)';
                    item.style.borderColor = 'var(--success)';
                });
                addXP(20, 'sequence-sort');
            } else {
                items.forEach(item => {
                    item.style.background = 'rgba(239, 68, 68, 0.2)';
                    item.style.borderColor = 'var(--error)';
                });
            }
        }

        function resetSequence() {
            const container = document.getElementById('sortList');
            const items = Array.from(container.children);
            items.forEach(item => {
                item.style.background = '';
                item.style.borderColor = '';
            });
            
            // Shuffle
            for (let i = items.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                container.appendChild(items[j]);
            }
        }

        // Section 6: Real World
        function checkExamples() {
            const example1 = document.getElementById('example1').value;
            const example2 = document.getElementById('example2').value;
            const example3 = document.getElementById('example3').value;
            
            let correct = 0;
            if (example1 === 'logn') correct++;
            if (example2 === '1') correct++;
            if (example3 === 'n2') correct++;
            
            if (correct === 3) {
                addXP(25, 'real-world-examples');
                showAchievement('Industry Expert!', 'You understand real-world applications!');
                alert('Perfect! All 3 answers are correct! 🎉');
            } else {
                alert(`You got ${correct}/3 correct. Keep thinking about how these algorithms scale!`);
            }
        }

        // Quiz functions - Make global
        window.checkAnswer = function(button, isCorrect, quizId) {
            const buttons = document.getElementById(quizId).querySelectorAll('.quiz-option');
            buttons.forEach(b => {
                b.disabled = true;
                b.style.cursor = 'not-allowed';
            });
            
            if (isCorrect) {
                button.classList.add('correct');
                addXP(10, `quiz-${quizId}`);
            } else {
                button.classList.add('incorrect');
            }
        }

        window.checkTrueFalse = function(button, isCorrect, questionId) {
            const buttons = button.parentElement.querySelectorAll('.quiz-option');
            buttons.forEach(b => {
                b.disabled = true;
                b.style.cursor = 'not-allowed';
            });
            
            if (isCorrect) {
                button.classList.add('correct');
                addXP(10, `true-false-${questionId}`);
            } else {
                button.classList.add('incorrect');
            }
        }

        // Matching exercise
        let selectedAlgo = null;
        let selectedNotation = null;
        let matchedPairs = new Set();

        function selectMatch(element, type) {
            if (element.classList.contains('matched')) return;
            
            if (type === 'algo') {
                if (selectedAlgo) selectedAlgo.classList.remove('selected');
                selectedAlgo = element;
                element.classList.add('selected');
            } else {
                if (selectedNotation) selectedNotation.classList.remove('selected');
                selectedNotation = element;
                element.classList.add('selected');
            }
            
            if (selectedAlgo && selectedNotation) {
                if (selectedAlgo.getAttribute('data-match') === selectedNotation.getAttribute('data-match')) {
                    selectedAlgo.classList.add('matched');
                    selectedNotation.classList.add('matched');
                    matchedPairs.add(selectedAlgo.getAttribute('data-match'));
                    
                    if (matchedPairs.size === 3) {
                        addXP(20, 'matching-exercise');
                        showAchievement('Pattern Master!', 'You matched all algorithms correctly!');
                    }
                }
                
                setTimeout(() => {
                    selectedAlgo.classList.remove('selected');
                    selectedNotation.classList.remove('selected');
                    selectedAlgo = null;
                    selectedNotation = null;
                }, 300);
            }
        }

        function checkMatching() {
            if (matchedPairs.size === 3) {
                alert('Perfect! All matches are correct! 🎉');
            } else {
                alert(`You have ${matchedPairs.size}/3 correct matches. Keep trying!`);
            }
        }

        function resetMatching() {
            const items = document.querySelectorAll('.matching-item');
            items.forEach(item => {
                item.classList.remove('selected', 'matched');
            });
            selectedAlgo = null;
            selectedNotation = null;
            matchedPairs.clear();
        }

        // Section 7: Common Mistakes
        function checkMistake(button, isIncorrect) {
            const buttons = document.getElementById('mistakeQuiz').querySelectorAll('.quiz-option');
            buttons.forEach(b => {
                b.disabled = true;
                b.style.cursor = 'not-allowed';
            });
            
            if (isIncorrect) {
                button.classList.add('correct');
                addXP(15, 'mistake-quiz');
            } else {
                button.classList.add('incorrect');
            }
        }

        function checkCodeFix() {
            const answer = document.getElementById('codeFixAnswer').value.toLowerCase();
            const keywords = ['linear', 'loop', 'for', 'o(n)', 'not binary', 'not logarithmic', 'each element', 'one by one'];
            const matchedKeywords = keywords.filter(keyword => answer.includes(keyword));
            
            if (matchedKeywords.length >= 2 && answer.length > 30) {
                addXP(25, 'code-fix');
                alert('Excellent analysis! This is indeed linear search (O(n)), not binary search (O(log n)).');
            } else {
                alert('Think about what the code is actually doing - it checks each element one by one. What complexity is that?');
            }
        }

        // Section 8: Practice Exam Questions
        function showMarkScheme(question) {
            const answer = document.getElementById(`exam${question.toUpperCase()}`).value;
            const marks = document.getElementById(`marks${question.toUpperCase()}`).value;
            
            if (answer.length < 50) {
                alert('Please write a more complete answer before viewing the mark scheme.');
                return;
            }
            
            document.getElementById(`markScheme${question.toUpperCase()}`).style.display = 'block';
            addXP(30, `exam-${question}`);
        }

        // Drawing canvas
        const canvas = document.getElementById('drawingCanvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;
        let lastX = 0;
        let lastY = 0;

        function getCoordinates(e) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            
            if (e.touches) {
                return {
                    x: (e.touches[0].clientX - rect.left) * scaleX,
                    y: (e.touches[0].clientY - rect.top) * scaleY
                };
            }
            return {
                x: (e.clientX - rect.left) * scaleX,
                y: (e.clientY - rect.top) * scaleY
            };
        }

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);

        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousedown', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }, { passive: false });

        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousemove', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }, { passive: false });

        canvas.addEventListener('touchend', (e) => {
            e.preventDefault();
            const mouseEvent = new MouseEvent('mouseup', {});
            canvas.dispatchEvent(mouseEvent);
        }, { passive: false });

        function startDrawing(e) {
            isDrawing = true;
            const coords = getCoordinates(e);
            lastX = coords.x;
            lastY = coords.y;
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const coords = getCoordinates(e);
            
            ctx.strokeStyle = '#1e293b';
            ctx.lineWidth = 2;
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            
            ctx.beginPath();
            ctx.moveTo(lastX, lastY);
            ctx.lineTo(coords.x, coords.y);
            ctx.stroke();
            
            lastX = coords.x;
            lastY = coords.y;
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        // Section 9: Extension Activities
        function checkExtension(textareaId) {
            const answer = document.getElementById(textareaId).value;
            const minLength = 100;
            
            if (answer.length >= minLength) {
                addXP(40, `extension-${textareaId}`);
                showAchievement('Going Beyond!', 'Great work on the extension activity!');
            } else {
                alert(`Please provide a more detailed answer (at least ${minLength} characters). You currently have ${answer.length} characters.`);
            }
        }

        // Section 10: Final Assessment
        let finalScore = 0;
        let finalAnswered = new Set();

        function checkFinal(button, isCorrect, questionId) {
            if (finalAnswered.has(questionId)) return;
            finalAnswered.add(questionId);
            
            const buttons = document.getElementById(questionId).querySelectorAll('.quiz-option');
            buttons.forEach(b => {
                b.disabled = true;
                b.style.cursor = 'not-allowed';
            });
            
            if (isCorrect) {
                button.classList.add('correct');
                finalScore++;
                addXP(15, `final-${questionId}`);
            } else {
                button.classList.add('incorrect');
            }
            
            if (finalAnswered.size === 6) {
                showFinalScore();
            }
        }

        function showFinalScore() {
            const scoreDiv = document.getElementById('finalScore');
            const scoreValue = document.getElementById('finalScoreValue');
            const feedback = document.getElementById('finalFeedback');
            
            scoreDiv.style.display = 'block';
            scoreValue.textContent = finalScore;
            
            if (finalScore === 6) {
                feedback.textContent = 'Perfect score! You have mastered Big O notation!';
                showAchievement('Perfect Score!', 'You aced the final assessment!');
                addXP(50, 'perfect-final');
                createConfetti();
            } else if (finalScore >= 4) {
                feedback.textContent = 'Great job! You have a solid understanding of Big O notation.';
                addXP(25, 'good-final');
            } else {
                feedback.textContent = 'Keep practicing! Review the sections you found challenging.';
            }
        }

        // Feedback system
        function openFeedback() {
            document.getElementById('feedbackModal').classList.add('show');
        }

        function closeFeedback() {
            document.getElementById('feedbackModal').classList.remove('show');
        }

        function sendFeedback() {
            const feedbackText = document.getElementById('feedbackText').value;
            if (!feedbackText.trim()) {
                alert('Please enter your feedback before sending.');
                return;
            }
            
            const sectionTitle = domCache.sections[currentSection].querySelector('h2').textContent;
            const pageUrl = window.location.href;
            
            // Construct email
            const subject = encodeURIComponent(`Feedback: Big O Notation Lesson - ${sectionTitle}`);
            const body = encodeURIComponent(`Feedback from: ${sectionTitle}\n\nPage URL: ${pageUrl}\n\nCurrent Section: ${currentSection + 1}\n\nFeedback:\n${feedbackText}`);
            const mailtoLink = `mailto:millingtond@mgs.org?subject=${subject}&body=${body}`;
            
            window.location.href = mailtoLink;
            closeFeedback();
            document.getElementById('feedbackText').value = '';
            
            addXP(10, 'feedback-sent');
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft' && currentSection > 0) {
                showSection(currentSection - 1);
            } else if (e.key === 'ArrowRight' && currentSection < domCache.sections.length - 1) {
                showSection(currentSection + 1);
            }
        });

        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            initDOMCache();
            initializeRaceArrays();
            initializeLinearSearch();
            initializeBinarySearch();
            initializeBubbleSort();
            setupDragAndDrop();
            updateXPDisplay();
            updateComparison();
            
            // Preload achievement sound (optional)
            const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBCtxzPDZhjMGHWS97OScTgwOUqzn77VmGwU6k9n1Y3RVFRYACAoMBQAFBAcLBAk5aVNwUAAAAAAAtgAAAAAA');
            audio.volume = 0.3;
            
            // Add intersection observer for animations
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.animationPlayState = 'running';
                    }
                });
            }, { threshold: 0.1 });
            
            document.querySelectorAll('.card').forEach(card => {
                card.style.animationPlayState = 'paused';
                observer.observe(card);
            });
            
            // Smooth section transitions
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });
        });

        // Save progress to localStorage (with error handling)
        function saveProgress() {
            try {
                const progress = {
                    level: currentLevel,
                    xp: currentXP,
                    totalXP: totalXPEarned,
                    section: currentSection,
                    earnedActions: Array.from(earnedActions)
                };
                localStorage.setItem('bigOProgress', JSON.stringify(progress));
            } catch (e) {
                console.log('Could not save progress');
            }
        }

        // Load progress from localStorage (with error handling)
        function loadProgress() {
            try {
                const saved = localStorage.getItem('bigOProgress');
                if (saved) {
                    const progress = JSON.parse(saved);
                    currentLevel = progress.level || 1;
                    currentXP = progress.xp || 0;
                    totalXPEarned = progress.totalXP || 0;
                    earnedActions = new Set(progress.earnedActions || []);
                    updateXPDisplay();
                    
                    if (progress.section) {
                        showSection(progress.section);
                    }
                }
            } catch (e) {
                console.log('Could not load progress');
            }
        }

        // Auto-save progress
        setInterval(saveProgress, 30000); // Save every 30 seconds

        // Save on page unload
        window.addEventListener('beforeunload', saveProgress);

        // Try to load saved progress
        loadProgress();
        
        // Performance monitoring (optional)
        if (window.performance && performance.mark) {
            performance.mark('worksheet-loaded');
            performance.measure('load-time', 'navigationStart', 'worksheet-loaded');
            const loadTime = performance.getEntriesByName('load-time')[0];
            console.log(`Worksheet loaded in ${Math.round(loadTime.duration)}ms`);
        }
    </script>
</body>
</html>
<!-- Big O Notation Interactive Worksheet v2.0
     Enhanced with:
     - Improved performance (debouncing, RAF, DOM caching)
     - Better visual design (gradients, animations, glassmorphism)
     - Touch support for mobile devices
     - Accessibility improvements
     - Progress saving/loading
     - Keyboard navigation
     - Smooth animations and transitions
-->