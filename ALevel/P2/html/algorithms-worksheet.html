<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algorithms - A Level Computer Science Interactive Worksheet</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --error-color: #e74c3c;
            --warning-color: #f39c12;
            --background-color: #ecf0f1;
            --text-color: #2c3e50;
            --card-bg: #ffffff;
            --shadow: 0 2px 10px rgba(0,0,0,0.1);
            --font-size: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            font-size: var(--font-size);
            transition: all 0.3s ease;
        }

        body.high-contrast {
            --background-color: #000000;
            --text-color: #ffffff;
            --card-bg: #1a1a1a;
            --primary-color: #ffff00;
            --secondary-color: #00ffff;
        }

        body.dyslexia-font {
            font-family: 'OpenDyslexic', 'Comic Sans MS', sans-serif;
            letter-spacing: 0.1em;
            word-spacing: 0.2em;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            background: var(--primary-color);
            color: white;
            padding: 2rem;
            text-align: center;
            position: relative;
            box-shadow: var(--shadow);
        }

        header h1 {
            margin-bottom: 1rem;
            font-size: 2.5rem;
        }

        .xp-container {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.1);
            padding: 10px 20px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .xp-bar {
            width: 200px;
            height: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .xp-fill {
            height: 100%;
            background: linear-gradient(90deg, #f39c12, #f1c40f);
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .xp-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .level-badge {
            font-size: 1.2rem;
            font-weight: bold;
        }

        nav {
            background: var(--card-bg);
            padding: 1rem;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .nav-btn {
            padding: 8px 16px;
            background: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .nav-btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: var(--primary-color);
        }

        .nav-btn.completed {
            background: var(--success-color);
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--card-bg);
            padding: 2rem;
            margin: 20px 0;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .learning-outcomes {
            background: #e8f5e9;
            padding: 1.5rem;
            border-radius: 10px;
            border-left: 5px solid var(--success-color);
            margin: 20px 0;
        }

        .learning-outcomes h3 {
            color: var(--success-color);
            margin-bottom: 1rem;
        }

        .learning-outcomes ul {
            list-style-position: inside;
            line-height: 2;
        }

        .interactive-area {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px dashed #dee2e6;
            transition: all 0.3s ease;
        }

        .interactive-area.highlight {
            border-color: var(--secondary-color);
            background: #e3f2fd;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: var(--secondary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-reset {
            background: var(--warning-color);
            color: white;
        }

        .btn-hint {
            background: #9b59b6;
            color: white;
        }

        .quiz-option {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: var(--card-bg);
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
        }

        .quiz-option:hover {
            border-color: var(--secondary-color);
            transform: translateX(5px);
        }

        .quiz-option.selected {
            background: #e3f2fd;
            border-color: var(--secondary-color);
        }

        .quiz-option.correct {
            background: #d4edda;
            border-color: var(--success-color);
            color: var(--success-color);
        }

        .quiz-option.incorrect {
            background: #f8d7da;
            border-color: var(--error-color);
            color: var(--error-color);
        }

        input[type="text"], textarea, select {
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            border: 2px solid #dee2e6;
            border-radius: 5px;
            font-size: 1rem;
            font-family: inherit;
        }

        input[type="text"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--secondary-color);
        }

        .draggable-item {
            padding: 10px;
            margin: 5px;
            background: var(--secondary-color);
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .draggable-item:hover {
            transform: scale(1.05);
        }

        .draggable-item.selected {
            background: var(--primary-color);
            transform: scale(1.1);
        }

        .drop-zone {
            min-height: 50px;
            padding: 15px;
            margin: 10px 0;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            background: #f8f9fa;
            transition: all 0.3s ease;
        }

        .drop-zone.highlight {
            border-color: var(--secondary-color);
            background: #e3f2fd;
        }

        .drop-zone.filled {
            border-style: solid;
            background: #d1ecf1;
        }

        .feedback-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: var(--secondary-color);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 24px;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .feedback-btn:hover {
            transform: scale(1.1);
            background: #2980b9;
        }

        .feedback-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .feedback-content {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            box-shadow: var(--shadow);
        }

        .achievement-popup {
            position: fixed;
            top: 100px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            transform: translateX(400px);
            transition: transform 0.5s ease;
            z-index: 1000;
        }

        .achievement-popup.show {
            transform: translateX(0);
        }

        .achievement-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .nav-arrows {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
        }

        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 1.5rem;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 20px 0;
        }

        .identifier-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .identifier-table th, .identifier-table td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }

        .identifier-table th {
            background: var(--primary-color);
            color: white;
        }

        .identifier-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .flowchart-symbols {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .symbol-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .symbol-card:hover {
            transform: translateY(-5px);
        }

        .symbol-shape {
            width: 100px;
            height: 60px;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .oval {
            background: #3498db;
            border-radius: 50%;
            color: white;
        }

        .rectangle {
            background: #2ecc71;
            color: white;
        }

        .diamond {
            background: #e74c3c;
            transform: rotate(45deg);
            color: white;
        }

        .diamond span {
            transform: rotate(-45deg);
        }

        .parallelogram {
            background: #f39c12;
            transform: skewX(-20deg);
            color: white;
        }

        .parallelogram span {
            transform: skewX(20deg);
            display: block;
        }

        .hint-box {
            display: none;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #9b59b6;
            margin: 15px 0;
        }

        .hint-box.show {
            display: block;
        }

        .shame-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: var(--error-color);
            color: white;
            padding: 20px 40px;
            border-radius: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            z-index: 3000;
            transition: transform 0.3s ease;
        }

        .shame-message.show {
            transform: translate(-50%, -50%) scale(1);
        }

        .accessibility-controls {
            position: fixed;
            top: 20px;
            left: 20px;
            background: var(--card-bg);
            padding: 15px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            z-index: 1000;
        }

        .font-controls button {
            padding: 5px 10px;
            margin: 2px;
            border: 1px solid #dee2e6;
            background: white;
            cursor: pointer;
            border-radius: 3px;
        }

        canvas {
            border: 2px solid #dee2e6;
            border-radius: 8px;
            background: white;
            touch-action: none;
            cursor: crosshair;
        }

        .mark-scheme {
            display: none;
            background: #e8f5e9;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 5px solid var(--success-color);
        }

        .mark-scheme.show {
            display: block;
        }

        .particle {
            position: fixed;
            pointer-events: none;
            animation: particle-float 3s ease-out forwards;
        }

        @keyframes particle-float {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) scale(0);
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            header h1 {
                font-size: 1.8rem;
            }
            
            .xp-container {
                position: relative;
                margin-top: 20px;
                right: auto;
                top: auto;
            }
            
            .nav-buttons {
                flex-direction: column;
            }
            
            .nav-btn {
                width: 100%;
            }
            
            .flowchart-symbols {
                grid-template-columns: 1fr;
            }
            
            .accessibility-controls {
                position: relative;
                margin-bottom: 20px;
            }
        }

        /* Touch-friendly styles */
        @media (hover: none) {
            .quiz-option:hover {
                transform: none;
            }
            
            .btn:hover {
                transform: none;
            }
        }
    </style>
</head>
<body>
    <!-- Accessibility Controls -->
    <div class="accessibility-controls">
        <h4>Accessibility</h4>
        <div class="font-controls">
            <button onclick="changeFontSize('decrease')">A-</button>
            <button onclick="changeFontSize('normal')">A</button>
            <button onclick="changeFontSize('increase')">A+</button>
        </div>
        <button class="btn btn-primary" onclick="toggleHighContrast()">High Contrast</button>
        <button class="btn btn-primary" onclick="toggleDyslexiaFont()">Dyslexia Font</button>
    </div>

    <!-- Header -->
    <header>
        <h1>Algorithms</h1>
        <p>A Level Computer Science - Cambridge 9618</p>
        <div class="xp-container">
            <div class="level-badge">Level <span id="level">1</span></div>
            <div class="xp-bar">
                <div class="xp-fill" id="xpBar" style="width: 0%"></div>
            </div>
            <div class="xp-text"><span id="currentXP">0</span> / <span id="requiredXP">200</span> XP</div>
        </div>
    </header>

    <!-- Navigation -->
    <nav>
        <div class="nav-buttons">
            <button class="nav-btn active" onclick="showSection('intro')">Introduction</button>
            <button class="nav-btn" onclick="showSection('starter')">Starter Activity</button>
            <button class="nav-btn" onclick="showSection('what-is')">What is an Algorithm?</button>
            <button class="nav-btn" onclick="showSection('identifiers')">Identifiers</button>
            <button class="nav-btn" onclick="showSection('structured-english')">Structured English</button>
            <button class="nav-btn" onclick="showSection('flowcharts')">Flowcharts</button>
            <button class="nav-btn" onclick="showSection('pseudocode')">Pseudocode</button>
            <button class="nav-btn" onclick="showSection('refinement')">Stepwise Refinement</button>
            <button class="nav-btn" onclick="showSection('logic')">Logic Statements</button>
            <button class="nav-btn" onclick="showSection('summary')">Summary & Quiz</button>
            <button class="nav-btn" onclick="showSection('exam')">Exam Practice</button>
            <button class="nav-btn" onclick="showSection('extension')">Extension</button>
            <button class="nav-btn" onclick="showSection('videos')">Videos</button>
        </div>
    </nav>

    <div class="container">
        <!-- Introduction Section -->
        <section id="intro" class="section active">
            <div class="card">
                <h2>Welcome to Algorithms!</h2>
                <p>In this lesson, you'll master the fundamental concepts of algorithms and learn how to design, document, and refine them effectively.</p>
                
                <div class="learning-outcomes">
                    <h3>Learning Outcomes</h3>
                    <ul>
                        <li>Understand that an algorithm is a solution to a problem expressed as a sequence of defined steps</li>
                        <li>Use suitable identifier names for data representation and create identifier tables</li>
                        <li>Document algorithms using structured English, flowcharts, or pseudocode</li>
                        <li>Apply stepwise refinement to express algorithms at programming level detail</li>
                        <li>Use logic statements to define parts of algorithm solutions</li>
                    </ul>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" disabled>← Previous</button>
                <button class="btn btn-primary" onclick="showSection('starter')">Next →</button>
            </div>
        </section>

        <!-- Starter Activity -->
        <section id="starter" class="section">
            <div class="card">
                <h2>Starter Activity: Algorithm Knowledge Check</h2>
                <p>Let's see what you already know about algorithms!</p>
                
                <div class="interactive-area">
                    <h3>Question 1: What best describes an algorithm?</h3>
                    <button class="quiz-option" onclick="checkAnswer(this, 'starter1', 'b')">A computer program written in Python</button>
                    <button class="quiz-option" onclick="checkAnswer(this, 'starter1', 'a')">A sequence of defined steps to solve a problem</button>
                    <button class="quiz-option" onclick="checkAnswer(this, 'starter1', 'c')">A type of computer hardware</button>
                    <button class="quiz-option" onclick="checkAnswer(this, 'starter1', 'd')">A mathematical equation</button>
                </div>

                <div class="interactive-area" style="margin-top: 20px;">
                    <h3>Question 2: Match the algorithm representations</h3>
                    <p>Click a representation type, then click its description:</p>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>Representations:</h4>
                            <div class="draggable-item" onclick="selectItem(this, 'Flowchart')">Flowchart</div>
                            <div class="draggable-item" onclick="selectItem(this, 'Pseudocode')">Pseudocode</div>
                            <div class="draggable-item" onclick="selectItem(this, 'Structured English')">Structured English</div>
                        </div>
                        <div>
                            <h4>Descriptions:</h4>
                            <div class="drop-zone" onclick="matchItem(this, 'Flowchart')">Visual diagram with shapes and arrows</div>
                            <div class="drop-zone" onclick="matchItem(this, 'Pseudocode')">Code-like notation without specific syntax</div>
                            <div class="drop-zone" onclick="matchItem(this, 'Structured English')">Plain language with defined formatting</div>
                        </div>
                    </div>
                    
                    <button class="btn btn-reset" onclick="resetMatching()">Reset</button>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('intro')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('what-is')">Next →</button>
            </div>
        </section>

        <!-- What is an Algorithm -->
        <section id="what-is" class="section">
            <div class="card">
                <h2>What is an Algorithm?</h2>
                
                <p>An <strong>algorithm</strong> is a solution to a problem expressed as a sequence of defined steps. It's like a recipe that tells you exactly what to do to achieve a specific outcome.</p>
                
                <div class="interactive-area highlight">
                    <h3>Key Characteristics of Algorithms:</h3>
                    <ul>
                        <li><strong>Precise:</strong> Each step is clearly defined</li>
                        <li><strong>Finite:</strong> The algorithm must terminate</li>
                        <li><strong>Effective:</strong> Each step must be achievable</li>
                        <li><strong>Input/Output:</strong> Takes input and produces output</li>
                    </ul>
                </div>

                <div class="interactive-area">
                    <h3>Interactive Exercise: Sequencing Steps</h3>
                    <p>Put these steps for making tea in the correct order (click to select, then click the position):</p>
                    
                    <div id="tea-steps" style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h4>Steps (click to select):</h4>
                            <div class="draggable-item" onclick="selectStep(this, 1)">Pour hot water into cup</div>
                            <div class="draggable-item" onclick="selectStep(this, 2)">Add milk/sugar if desired</div>
                            <div class="draggable-item" onclick="selectStep(this, 3)">Boil water in kettle</div>
                            <div class="draggable-item" onclick="selectStep(this, 4)">Remove tea bag</div>
                            <div class="draggable-item" onclick="selectStep(this, 5)">Put tea bag in cup</div>
                            <div class="draggable-item" onclick="selectStep(this, 6)">Let tea steep for 3-5 minutes</div>
                        </div>
                        <div>
                            <h4>Correct Order (click to place):</h4>
                            <div class="drop-zone" onclick="placeStep(this, 1)">1. <span></span></div>
                            <div class="drop-zone" onclick="placeStep(this, 2)">2. <span></span></div>
                            <div class="drop-zone" onclick="placeStep(this, 3)">3. <span></span></div>
                            <div class="drop-zone" onclick="placeStep(this, 4)">4. <span></span></div>
                            <div class="drop-zone" onclick="placeStep(this, 5)">5. <span></span></div>
                            <div class="drop-zone" onclick="placeStep(this, 6)">6. <span></span></div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" onclick="checkSequence()">Check Order</button>
                    <button class="btn btn-reset" onclick="resetSequence()">Reset</button>
                    <button class="btn btn-hint" onclick="showHint('sequence')">Hint (-5 XP)</button>
                    
                    <div class="hint-box" id="hint-sequence">
                        Think about what needs to happen first - can you pour water before boiling it?
                    </div>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('starter')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('identifiers')">Next →</button>
            </div>
        </section>

        <!-- Identifiers Section -->
        <section id="identifiers" class="section">
            <div class="card">
                <h2>Identifier Names and Tables</h2>
                
                <p>When designing algorithms, we use <strong>identifiers</strong> (variable names) to represent data. Good identifier names make algorithms easier to understand.</p>
                
                <div class="interactive-area highlight">
                    <h3>Rules for Good Identifier Names:</h3>
                    <ul>
                        <li>Be descriptive (e.g., <code>studentAge</code> not <code>x</code>)</li>
                        <li>Use camelCase or snake_case consistently</li>
                        <li>Start with a letter</li>
                        <li>Avoid reserved words</li>
                        <li>Keep them reasonably short but meaningful</li>
                    </ul>
                </div>

                <div class="interactive-area">
                    <h3>Exercise: Improve These Identifiers</h3>
                    <p>Replace these poor identifier names with better ones:</p>
                    
                    <table class="identifier-table">
                        <tr>
                            <th>Poor Name</th>
                            <th>Purpose</th>
                            <th>Better Name</th>
                        </tr>
                        <tr>
                            <td>x</td>
                            <td>Stores a student's test score</td>
                            <td><input type="text" id="id1" placeholder="Enter better name"></td>
                        </tr>
                        <tr>
                            <td>temp</td>
                            <td>Stores the current room temperature in Celsius</td>
                            <td><input type="text" id="id2" placeholder="Enter better name"></td>
                        </tr>
                        <tr>
                            <td>flag</td>
                            <td>Indicates if a user is logged in</td>
                            <td><input type="text" id="id3" placeholder="Enter better name"></td>
                        </tr>
                    </table>
                    
                    <button class="btn btn-primary" onclick="checkIdentifiers()">Check Answers</button>
                    <button class="btn btn-hint" onclick="showHint('identifiers')">Hint (-5 XP)</button>
                    
                    <div class="hint-box" id="hint-identifiers">
                        Think about what the variable stores and make the name descriptive of that purpose.
                    </div>
                </div>

                <div class="interactive-area">
                    <h3>Create an Identifier Table</h3>
                    <p>For a program that calculates circle properties, complete this identifier table:</p>
                    
                    <table class="identifier-table">
                        <tr>
                            <th>Identifier Name</th>
                            <th>Description</th>
                            <th>Data Type</th>
                        </tr>
                        <tr>
                            <td>radius</td>
                            <td>The radius of the circle</td>
                            <td>
                                <select id="type1">
                                    <option value="">Select type...</option>
                                    <option value="string">String</option>
                                    <option value="real">Real/Float</option>
                                    <option value="integer">Integer</option>
                                    <option value="boolean">Boolean</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td>area</td>
                            <td><input type="text" id="desc1" placeholder="Describe this identifier"></td>
                            <td>
                                <select id="type2">
                                    <option value="">Select type...</option>
                                    <option value="string">String</option>
                                    <option value="real">Real/Float</option>
                                    <option value="integer">Integer</option>
                                    <option value="boolean">Boolean</option>
                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td><input type="text" id="name1" placeholder="Name for pi constant"></td>
                            <td>Mathematical constant pi (3.14159...)</td>
                            <td>
                                <select id="type3">
                                    <option value="">Select type...</option>
                                    <option value="string">String</option>
                                    <option value="real">Real/Float</option>
                                    <option value="integer">Integer</option>
                                    <option value="boolean">Boolean</option>
                                </select>
                            </td>
                        </tr>
                    </table>
                    
                    <button class="btn btn-primary" onclick="checkIdentifierTable()">Check Table</button>
                    <button class="btn btn-reset" onclick="resetIdentifierTable()">Reset</button>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('what-is')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('structured-english')">Next →</button>
            </div>
        </section>

        <!-- Structured English Section -->
        <section id="structured-english" class="section">
            <div class="card">
                <h2>Documenting Algorithms: Structured English</h2>
                
                <p><strong>Structured English</strong> is a way to describe algorithms using natural language with a defined structure. It bridges the gap between human language and programming code.</p>
                
                <div class="interactive-area highlight">
                    <h3>Structured English Keywords:</h3>
                    <ul>
                        <li><strong>SEQUENCE:</strong> Steps performed one after another</li>
                        <li><strong>IF...THEN...ELSE:</strong> Decision making</li>
                        <li><strong>WHILE...DO:</strong> Repetition with condition at start</li>
                        <li><strong>REPEAT...UNTIL:</strong> Repetition with condition at end</li>
                        <li><strong>FOR...TO...DO:</strong> Counted repetition</li>
                    </ul>
                </div>

                <div class="code-block">
                    <h4>Example: Finding Maximum of Two Numbers</h4>
                    <pre>
BEGIN
    INPUT number1
    INPUT number2
    IF number1 > number2 THEN
        OUTPUT number1
    ELSE
        OUTPUT number2
    ENDIF
END</pre>
                </div>

                <div class="interactive-area">
                    <h3>Exercise: Convert to Structured English</h3>
                    <p>Convert this process into structured English: "Check each student's grade. If it's 70 or above, add their name to the distinction list."</p>
                    
                    <p>Fill in the blanks with appropriate keywords:</p>
                    
                    <div style="font-family: monospace; background: #f8f9fa; padding: 20px; border-radius: 8px;">
                        BEGIN<br>
                        &nbsp;&nbsp;<select id="se1" style="width: 150px;">
                            <option value="">Choose keyword...</option>
                            <option value="FOR">FOR</option>
                            <option value="IF">IF</option>
                            <option value="WHILE">WHILE</option>
                            <option value="INPUT">INPUT</option>
                        </select> each student in class <select id="se2" style="width: 150px;">
                            <option value="">Choose keyword...</option>
                            <option value="DO">DO</option>
                            <option value="THEN">THEN</option>
                            <option value="REPEAT">REPEAT</option>
                            <option value="BEGIN">BEGIN</option>
                        </select><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<select id="se3" style="width: 150px;">
                            <option value="">Choose keyword...</option>
                            <option value="FOR">FOR</option>
                            <option value="IF">IF</option>
                            <option value="WHILE">WHILE</option>
                            <option value="OUTPUT">OUTPUT</option>
                        </select> student.grade >= 70 <select id="se4" style="width: 150px;">
                            <option value="">Choose keyword...</option>
                            <option value="DO">DO</option>
                            <option value="THEN">THEN</option>
                            <option value="ELSE">ELSE</option>
                            <option value="UNTIL">UNTIL</option>
                        </select><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD student.name TO distinctionList<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<select id="se5" style="width: 150px;">
                            <option value="">Choose keyword...</option>
                            <option value="ENDIF">ENDIF</option>
                            <option value="ENDFOR">ENDFOR</option>
                            <option value="ENDWHILE">ENDWHILE</option>
                            <option value="NEXT">NEXT</option>
                        </select><br>
                        &nbsp;&nbsp;<select id="se6" style="width: 150px;">
                            <option value="">Choose keyword...</option>
                            <option value="ENDIF">ENDIF</option>
                            <option value="ENDFOR">ENDFOR</option>
                            <option value="NEXT">NEXT</option>
                            <option value="LOOP">LOOP</option>
                        </select><br>
                        END
                    </div>
                    
                    <button class="btn btn-primary" onclick="checkStructuredEnglish()">Check Answer</button>
                    <button class="btn btn-reset" onclick="resetStructuredEnglish()">Reset</button>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('identifiers')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('flowcharts')">Next →</button>
            </div>
        </section>

        <!-- Flowcharts Section -->
        <section id="flowcharts" class="section">
            <div class="card">
                <h2>Flowcharts</h2>
                
                <p>A <strong>flowchart</strong> is a visual representation of an algorithm using shapes and arrows to show the sequence of steps and decisions.</p>
                
                <div class="flowchart-symbols">
                    <div class="symbol-card">
                        <div class="symbol-shape oval">Start/End</div>
                        <p>Terminal: Marks the beginning or end</p>
                    </div>
                    <div class="symbol-card">
                        <div class="symbol-shape rectangle">Process</div>
                        <p>Process: An action or calculation</p>
                    </div>
                    <div class="symbol-card">
                        <div class="symbol-shape diamond"><span>Decision</span></div>
                        <p>Decision: A yes/no question</p>
                    </div>
                    <div class="symbol-card">
                        <div class="symbol-shape parallelogram"><span>Input/Output</span></div>
                        <p>Input/Output: Data entry or display</p>
                    </div>
                </div>

                <div class="interactive-area">
                    <h3>Interactive: Identify Flowchart Symbols</h3>
                    <p>Match each scenario to the correct flowchart symbol:</p>
                    
                    <div style="margin: 20px 0;">
                        <p>1. "Display the result to the user" requires a:</p>
                        <select id="fc1">
                            <option value="">Select symbol...</option>
                            <option value="oval">Oval (Terminal)</option>
                            <option value="rectangle">Rectangle (Process)</option>
                            <option value="diamond">Diamond (Decision)</option>
                            <option value="parallelogram">Parallelogram (Input/Output)</option>
                        </select>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <p>2. "Is the password correct?" requires a:</p>
                        <select id="fc2">
                            <option value="">Select symbol...</option>
                            <option value="oval">Oval (Terminal)</option>
                            <option value="rectangle">Rectangle (Process)</option>
                            <option value="diamond">Diamond (Decision)</option>
                            <option value="parallelogram">Parallelogram (Input/Output)</option>
                        </select>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <p>3. "Calculate the average" requires a:</p>
                        <select id="fc3">
                            <option value="">Select symbol...</option>
                            <option value="oval">Oval (Terminal)</option>
                            <option value="rectangle">Rectangle (Process)</option>
                            <option value="diamond">Diamond (Decision)</option>
                            <option value="parallelogram">Parallelogram (Input/Output)</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary" onclick="checkFlowchartSymbols()">Check Answers</button>
                </div>

                <div class="interactive-area highlight">
                    <h3>Flowchart Simulation Placeholder</h3>
                    <p>Your interactive flowchart simulation will be embedded here.</p>
                    <div style="border: 2px dashed #3498db; padding: 40px; text-align: center; background: #ecf0f1;">
                        <p>[ Flowchart Simulation Placeholder ]</p>
                    </div>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('structured-english')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('pseudocode')">Next →</button>
            </div>
        </section>

        <!-- Pseudocode Section -->
        <section id="pseudocode" class="section">
            <div class="card">
                <h2>Pseudocode</h2>
                
                <p><strong>Pseudocode</strong> is a method of describing algorithms that resembles programming code but uses more natural language and isn't tied to any specific programming language syntax.</p>
                
                <div class="code-block">
                    <h4>Example: Linear Search</h4>
                    <pre>
FUNCTION linearSearch(array, target)
    FOR i ← 0 TO LENGTH(array) - 1
        IF array[i] = target THEN
            RETURN i
        ENDIF
    ENDFOR
    RETURN -1
ENDFUNCTION</pre>
                </div>

                <div class="interactive-area">
                    <h3>Exercise: Complete the Pseudocode</h3>
                    <p>Complete this pseudocode for calculating the factorial of a number:</p>
                    
                    <div style="font-family: monospace; background: #f8f9fa; padding: 20px; border-radius: 8px;">
                        FUNCTION factorial(n)<br>
                        &nbsp;&nbsp;IF n = 0 <select id="ps1" style="width: 100px;">
                            <option value="">Choose...</option>
                            <option value="THEN">THEN</option>
                            <option value="AND">AND</option>
                            <option value="OR">OR</option>
                            <option value="DO">DO</option>
                        </select><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<select id="ps2" style="width: 100px;">
                            <option value="">Choose...</option>
                            <option value="INPUT">INPUT</option>
                            <option value="OUTPUT">OUTPUT</option>
                            <option value="RETURN">RETURN</option>
                            <option value="PRINT">PRINT</option>
                        </select> 1<br>
                        &nbsp;&nbsp;<select id="ps3" style="width: 100px;">
                            <option value="">Choose...</option>
                            <option value="ELSE">ELSE</option>
                            <option value="ELIF">ELIF</option>
                            <option value="THEN">THEN</option>
                            <option value="ENDIF">ENDIF</option>
                        </select><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;result ← n<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<select id="ps4" style="width: 100px;">
                            <option value="">Choose...</option>
                            <option value="WHILE">WHILE</option>
                            <option value="FOR">FOR</option>
                            <option value="IF">IF</option>
                            <option value="REPEAT">REPEAT</option>
                        </select> i ← n-1 <select id="ps5" style="width: 100px;">
                            <option value="">Choose...</option>
                            <option value="TO">TO</option>
                            <option value="DOWNTO">DOWNTO</option>
                            <option value="UNTIL">UNTIL</option>
                            <option value="WHILE">WHILE</option>
                        </select> 1<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result ← result * i<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<select id="ps6" style="width: 100px;">
                            <option value="">Choose...</option>
                            <option value="NEXT">NEXT</option>
                            <option value="ENDFOR">ENDFOR</option>
                            <option value="ENDWHILE">ENDWHILE</option>
                            <option value="LOOP">LOOP</option>
                        </select><br>
                        &nbsp;&nbsp;&nbsp;&nbsp;RETURN result<br>
                        &nbsp;&nbsp;ENDIF<br>
                        ENDFUNCTION
                    </div>
                    
                    <button class="btn btn-primary" onclick="checkPseudocode()">Check Answer</button>
                    <button class="btn btn-reset" onclick="resetPseudocode()">Reset</button>
                </div>

                <div class="interactive-area">
                    <h3>Write Your Own Pseudocode</h3>
                    <p>Write pseudocode to find the largest number in an array:</p>
                    <textarea id="pseudocodeAnswer" rows="10" placeholder="Write your pseudocode here..."></textarea>
                    <button class="btn btn-primary" onclick="checkUserPseudocode()">Submit (Min 50 chars)</button>
                    
                    <div class="hint-box" id="hint-pseudocode">
                        Start by setting the first element as the maximum, then compare with each other element.
                    </div>
                    <button class="btn btn-hint" onclick="showHint('pseudocode')">Hint (-5 XP)</button>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('flowcharts')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('refinement')">Next →</button>
            </div>
        </section>

        <!-- Stepwise Refinement Section -->
        <section id="refinement" class="section">
            <div class="card">
                <h2>Stepwise Refinement</h2>
                
                <p><strong>Stepwise refinement</strong> is the process of breaking down a problem into smaller, more manageable parts, increasing the level of detail until the algorithm can be easily programmed.</p>
                
                <div class="interactive-area highlight">
                    <h3>The Process:</h3>
                    <ol>
                        <li>Start with a high-level description</li>
                        <li>Break each step into sub-steps</li>
                        <li>Continue refining until each step is simple enough to code</li>
                        <li>Ensure all steps are at the same level of detail</li>
                    </ol>
                </div>

                <div class="interactive-area">
                    <h3>Interactive: Stepwise Refinement Exercise</h3>
                    <p>Let's refine "Make a sandwich" step by step. Click each level to see the refinement:</p>
                    
                    <div style="margin: 20px 0;">
                        <div class="card" style="background: #e3f2fd; cursor: pointer;" onclick="toggleRefinement('level1')">
                            <h4>Level 1: High Level</h4>
                            <p>Make a sandwich</p>
                        </div>
                        
                        <div id="level1" style="display: none; margin-left: 40px;">
                            <div class="card" style="background: #bbdefb; margin: 10px 0; cursor: pointer;" onclick="toggleRefinement('level2')">
                                <h4>Level 2: Main Steps</h4>
                                <ol>
                                    <li>Get ingredients</li>
                                    <li>Prepare sandwich</li>
                                    <li>Serve sandwich</li>
                                </ol>
                            </div>
                            
                            <div id="level2" style="display: none; margin-left: 40px;">
                                <div class="card" style="background: #90caf9; margin: 10px 0;">
                                    <h4>Level 3: Detailed Steps</h4>
                                    <p><strong>1. Get ingredients:</strong></p>
                                    <ul>
                                        <li>Open refrigerator</li>
                                        <li>Take out bread, butter, filling</li>
                                        <li>Get knife and plate</li>
                                    </ul>
                                    <p><strong>2. Prepare sandwich:</strong></p>
                                    <ul>
                                        <li>Take two slices of bread</li>
                                        <li>Spread butter on each slice</li>
                                        <li>Add filling to one slice</li>
                                        <li>Place other slice on top</li>
                                    </ul>
                                    <p><strong>3. Serve sandwich:</strong></p>
                                    <ul>
                                        <li>Cut sandwich if desired</li>
                                        <li>Place on plate</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-primary" onclick="awardXP(10, 'Explored stepwise refinement')">Mark as Understood</button>
                </div>

                <div class="interactive-area">
                    <h3>Practice: Apply Stepwise Refinement</h3>
                    <p>Refine "Calculate student's final grade" to Level 2. Enter at least 3 sub-steps:</p>
                    
                    <input type="text" id="refine1" placeholder="Step 1">
                    <input type="text" id="refine2" placeholder="Step 2">
                    <input type="text" id="refine3" placeholder="Step 3">
                    <input type="text" id="refine4" placeholder="Step 4 (optional)">
                    
                    <button class="btn btn-primary" onclick="checkRefinement()">Check Refinement</button>
                    <button class="btn btn-hint" onclick="showHint('refinement')">Hint (-5 XP)</button>
                    
                    <div class="hint-box" id="hint-refinement">
                        Think about what data you need to collect and what calculations to perform.
                    </div>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('pseudocode')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('logic')">Next →</button>
            </div>
        </section>

        <!-- Logic Statements Section -->
        <section id="logic" class="section">
            <div class="card">
                <h2>Logic Statements in Algorithms</h2>
                
                <p>Logic statements allow algorithms to make decisions and control flow based on conditions.</p>
                
                <div class="interactive-area highlight">
                    <h3>Common Logic Operators:</h3>
                    <ul>
                        <li><strong>AND:</strong> Both conditions must be true</li>
                        <li><strong>OR:</strong> At least one condition must be true</li>
                        <li><strong>NOT:</strong> Reverses the truth value</li>
                        <li><strong>Comparison:</strong> =, ≠, <, >, ≤, ≥</li>
                    </ul>
                </div>

                <div class="interactive-area">
                    <h3>Logic Practice: True or False?</h3>
                    <p>Given: age = 16, hasLicense = false, isStudent = true</p>
                    
                    <div style="margin: 20px 0;">
                        <p>1. age >= 18 AND hasLicense</p>
                        <select id="logic1">
                            <option value="">Select...</option>
                            <option value="true">True</option>
                            <option value="false">False</option>
                        </select>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <p>2. age < 18 OR NOT isStudent</p>
                        <select id="logic2">
                            <option value="">Select...</option>
                            <option value="true">True</option>
                            <option value="false">False</option>
                        </select>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <p>3. (age = 16 AND isStudent) OR hasLicense</p>
                        <select id="logic3">
                            <option value="">Select...</option>
                            <option value="true">True</option>
                            <option value="false">False</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary" onclick="checkLogic()">Check Answers</button>
                </div>

                <div class="interactive-area">
                    <h3>Build a Logic Statement</h3>
                    <p>Create a logic statement for: "A person can enter if they are over 18 OR they are accompanied by an adult AND have a ticket"</p>
                    
                    <div style="font-family: monospace; background: #f8f9fa; padding: 20px; border-radius: 8px;">
                        IF (<select id="build1" style="width: 100px;">
                            <option value="">Variable...</option>
                            <option value="age">age</option>
                            <option value="ticket">ticket</option>
                            <option value="adult">adult</option>
                        </select> 
                        <select id="build2" style="width: 80px;">
                            <option value="">Op...</option>
                            <option value=">">></option>
                            <option value="<"><</option>
                            <option value="=">=</option>
                        </select> 18) 
                        <select id="build3" style="width: 80px;">
                            <option value="">Logic...</option>
                            <option value="AND">AND</option>
                            <option value="OR">OR</option>
                            <option value="NOT">NOT</option>
                        </select> 
                        (<select id="build4" style="width: 120px;">
                            <option value="">Variable...</option>
                            <option value="isAccompanied">isAccompanied</option>
                            <option value="hasTicket">hasTicket</option>
                            <option value="isAdult">isAdult</option>
                        </select> 
                        <select id="build5" style="width: 80px;">
                            <option value="">Logic...</option>
                            <option value="AND">AND</option>
                            <option value="OR">OR</option>
                            <option value="NOT">NOT</option>
                        </select> 
                        <select id="build6" style="width: 100px;">
                            <option value="">Variable...</option>
                            <option value="hasTicket">hasTicket</option>
                            <option value="isAdult">isAdult</option>
                            <option value="age">age</option>
                        </select>) THEN<br>
                        &nbsp;&nbsp;Allow entry<br>
                        ENDIF
                    </div>
                    
                    <button class="btn btn-primary" onclick="checkLogicBuilder()">Check Statement</button>
                    <button class="btn btn-reset" onclick="resetLogicBuilder()">Reset</button>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('refinement')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('summary')">Next →</button>
            </div>
        </section>

        <!-- Summary & Quiz Section -->
        <section id="summary" class="section">
            <div class="card">
                <h2>Summary & Knowledge Check</h2>
                
                <div class="interactive-area highlight">
                    <h3>Key Takeaways:</h3>
                    <ul>
                        <li>Algorithms are step-by-step solutions to problems</li>
                        <li>Good identifier names make algorithms readable</li>
                        <li>Algorithms can be documented using structured English, flowcharts, or pseudocode</li>
                        <li>Stepwise refinement breaks complex problems into manageable parts</li>
                        <li>Logic statements control algorithm flow</li>
                    </ul>
                </div>

                <div class="interactive-area">
                    <h3>Final Quiz</h3>
                    
                    <!-- Question 1 -->
                    <div style="margin: 20px 0;">
                        <h4>1. Which is NOT a characteristic of a good algorithm?</h4>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q1', 'b')">It must be precise and unambiguous</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q1', 'a')">It can run forever without stopping</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q1', 'c')">Each step must be achievable</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q1', 'd')">It takes input and produces output</button>
                    </div>

                    <!-- Question 2 -->
                    <div style="margin: 20px 0;">
                        <h4>2. In an identifier table, what information is typically included?</h4>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q2', 'b')">Only the variable names</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q2', 'd')">The algorithm's flowchart</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q2', 'a')">Name, description, and data type</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q2', 'c')">The program's output</button>
                    </div>

                    <!-- Question 3 -->
                    <div style="margin: 20px 0;">
                        <h4>3. Which flowchart symbol represents a decision?</h4>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q3', 'c')">Rectangle</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q3', 'b')">Oval</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q3', 'd')">Parallelogram</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q3', 'a')">Diamond</button>
                    </div>

                    <!-- Question 4 -->
                    <div style="margin: 20px 0;">
                        <h4>4. What is stepwise refinement?</h4>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q4', 'a')">Breaking down a problem into increasingly detailed steps</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q4', 'c')">Writing code in multiple programming languages</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q4', 'b')">Testing an algorithm multiple times</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q4', 'd')">Converting pseudocode to flowcharts</button>
                    </div>

                    <!-- Question 5 -->
                    <div style="margin: 20px 0;">
                        <h4>5. In logic statements, when is "A AND B" true?</h4>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q5', 'b')">When A is true</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q5', 'c')">When B is true</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q5', 'd')">When either A or B is true</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q5', 'a')">When both A and B are true</button>
                    </div>

                    <!-- Question 6 -->
                    <div style="margin: 20px 0;">
                        <h4>6. Which is the correct pseudocode for a FOR loop?</h4>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q6', 'c')">FOR i = 1 TO 10</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q6', 'a')">FOR i ← 1 TO 10</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q6', 'b')">FOR (i=1; i<=10; i++)</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q6', 'd')">LOOP i FROM 1 TO 10</button>
                    </div>

                    <!-- Question 7 -->
                    <div style="margin: 20px 0;">
                        <h4>7. True or False: Structured English uses specific programming syntax</h4>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q7', 'a')">False</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q7', 'b')">True</button>
                    </div>

                    <!-- Question 8 -->
                    <div style="margin: 20px 0;">
                        <h4>8. What makes a good identifier name?</h4>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q8', 'b')">Using single letters like x, y, z</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q8', 'c')">Making it as long as possible</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q8', 'a')">Being descriptive and meaningful</button>
                        <button class="quiz-option" onclick="checkAnswer(this, 'q8', 'd')">Using only numbers</button>
                    </div>
                    
                    <div id="quiz-score" style="margin-top: 20px; font-size: 1.2rem; font-weight: bold;"></div>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('logic')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('exam')">Next →</button>
            </div>
        </section>

        <!-- Exam Practice Section -->
        <section id="exam" class="section">
            <div class="card">
                <h2>Exam Practice Questions</h2>
                
                <div class="interactive-area">
                    <h3>Question 1 (4 marks)</h3>
                    <p>Define the term 'algorithm' and explain three characteristics that all algorithms must have.</p>
                    
                    <textarea id="exam1" rows="8" placeholder="Write your answer here..."></textarea>
                    
                    <div style="margin-top: 10px;">
                        <label>Predicted marks: <input type="number" id="marks1" min="0" max="4" style="width: 50px;"></label>
                        <button class="btn btn-primary" onclick="showMarkScheme('exam1', 'marks1', 'scheme1')">Show Mark Scheme</button>
                    </div>
                    
                    <div class="mark-scheme" id="scheme1">
                        <h4>Mark Scheme:</h4>
                        <ul>
                            <li>Definition: A sequence of defined steps to solve a problem (1 mark)</li>
                            <li>Characteristic 1: Precise/unambiguous - each step clearly defined (1 mark)</li>
                            <li>Characteristic 2: Finite - must terminate/have an end (1 mark)</li>
                            <li>Characteristic 3: Effective - each step must be achievable (1 mark)</li>
                        </ul>
                    </div>
                </div>

                <div class="interactive-area">
                    <h3>Question 2 (6 marks)</h3>
                    <p>A library needs an algorithm to calculate late fees. The fee is £0.50 per day for the first 7 days, then £1.00 per day after that, with a maximum fee of £20.</p>
                    <p>Write this algorithm using pseudocode.</p>
                    
                    <textarea id="exam2" rows="12" placeholder="Write your pseudocode here..."></textarea>
                    
                    <div style="margin-top: 10px;">
                        <label>Predicted marks: <input type="number" id="marks2" min="0" max="6" style="width: 50px;"></label>
                        <button class="btn btn-primary" onclick="showMarkScheme('exam2', 'marks2', 'scheme2')">Show Mark Scheme</button>
                    </div>
                    
                    <div class="mark-scheme" id="scheme2">
                        <h4>Mark Scheme:</h4>
                        <ul>
                            <li>Input days late (1 mark)</li>
                            <li>Initialize fee to 0 (1 mark)</li>
                            <li>Correct calculation for first 7 days (1 mark)</li>
                            <li>Correct calculation for days after 7 (1 mark)</li>
                            <li>Check for maximum fee of £20 (1 mark)</li>
                            <li>Output the fee (1 mark)</li>
                        </ul>
                    </div>
                </div>

                <div class="interactive-area">
                    <h3>Working Space</h3>
                    <p>Use this canvas for rough work:</p>
                    <canvas id="canvas" width="600" height="300"></canvas>
                    <button class="btn btn-reset" onclick="clearCanvas()">Clear Canvas</button>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('summary')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('extension')">Next →</button>
            </div>
        </section>

        <!-- Extension Section -->
        <section id="extension" class="section">
            <div class="card">
                <h2>Extension Activities</h2>
                
                <div class="interactive-area">
                    <h3>Beyond the Specification</h3>
                    
                    <h4>1. Algorithm Efficiency</h4>
                    <p>Research and explain the concept of "Big O notation" and how it's used to describe algorithm efficiency:</p>
                    <textarea id="ext1" rows="6" placeholder="Your explanation here..."></textarea>
                    
                    <h4>2. Sorting Algorithms</h4>
                    <p>Compare bubble sort and merge sort algorithms. Which is more efficient and why?</p>
                    <textarea id="ext2" rows="6" placeholder="Your comparison here..."></textarea>
                    
                    <h4>3. Real-World Application</h4>
                    <p>Design an algorithm for a real-world problem of your choice. Include identifier table, pseudocode, and explanation:</p>
                    <textarea id="ext3" rows="10" placeholder="Your algorithm design here..."></textarea>
                    
                    <button class="btn btn-success" onclick="submitExtension()">Submit Extension Work</button>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('exam')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('videos')">Next →</button>
            </div>
        </section>

        <!-- Videos Section -->
        <section id="videos" class="section">
            <div class="card">
                <h2>Video Resources</h2>
                
                <div class="interactive-area">
                    <h3>Supplementary Videos</h3>
                    <p>Your teacher will add video links here to support your learning.</p>
                    
                    <div style="border: 2px dashed #3498db; padding: 40px; text-align: center; background: #ecf0f1; margin: 20px 0;">
                        <p>[ Video placeholder - Links to be added by teacher ]</p>
                    </div>
                </div>
            </div>
            
            <div class="nav-arrows">
                <button class="btn btn-primary" onclick="showSection('extension')">← Previous</button>
                <button class="btn btn-primary" onclick="showSection('intro')">Start Over →</button>
            </div>
        </section>
    </div>

    <!-- Feedback Button -->
    <button class="feedback-btn" onclick="openFeedback()">💬</button>

    <!-- Feedback Modal -->
    <div class="feedback-modal" id="feedbackModal">
        <div class="feedback-content">
            <h3>Send Feedback</h3>
            <p>Found a bug or have a suggestion?</p>
            <textarea id="feedbackText" rows="5" placeholder="Describe the issue or suggestion..."></textarea>
            <button class="btn btn-primary" onclick="sendFeedback()">Send</button>
            <button class="btn btn-reset" onclick="closeFeedback()">Cancel</button>
        </div>
    </div>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <div class="achievement-icon">🏆</div>
        <h3 id="achievementTitle">Achievement Unlocked!</h3>
        <p id="achievementText">Description</p>
    </div>

    <!-- Shame Message -->
    <div class="shame-message" id="shameMessage">
        🚫 No pasting allowed! Do your own work! 🚫
    </div>

    <script>
        // Game state
        let gameState = {
            currentSection: 'intro',
            xp: 0,
            level: 1,
            completedActions: new Set(),
            selectedItem: null,
            matchedItems: new Set(),
            quizScore: 0,
            quizAnswered: new Set(),
            achievements: new Set(),
            hintPenalties: new Set()
        };

        // XP requirements per level
        const xpRequirements = [0, 200, 400, 600, 800, 1000];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            updateXPDisplay();
            setupEventListeners();
            
            // Initialize canvas
            const canvas = document.getElementById('canvas');
            if (canvas) {
                initCanvas();
            }
        });

        // Event Listeners
        function setupEventListeners() {
            // Prevent paste
            document.addEventListener('paste', function(e) {
                e.preventDefault();
                showShame();
                return false;
            });
            
            // Keyboard navigation
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'v') {
                    e.preventDefault();
                    showShame();
                }
            });
            
            // Touch support for mobile
            if ('ontouchstart' in window) {
                document.body.classList.add('touch-device');
            }
        }

        // Section Navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).classList.add('active');
            
            // Update nav buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('onclick').includes(sectionId)) {
                    btn.classList.add('active');
                }
            });
            
            // Update game state
            gameState.currentSection = sectionId;
            
            // Award XP for first visit
            const actionId = `visit_${sectionId}`;
            if (!gameState.completedActions.has(actionId)) {
                awardXP(5, `Visited ${sectionId} section`);
                gameState.completedActions.add(actionId);
            }
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        // XP System
        function awardXP(amount, action) {
            gameState.xp += amount;
            updateXPDisplay();
            checkLevelUp();
            showXPGain(amount);
            
            // Save state
            saveGameState();
        }

        function updateXPDisplay() {
            const currentXP = gameState.xp;
            const level = gameState.level;
            const requiredXP = xpRequirements[level] || xpRequirements[xpRequirements.length - 1];
            const progress = (currentXP / requiredXP) * 100;
            
            document.getElementById('currentXP').textContent = currentXP;
            document.getElementById('requiredXP').textContent = requiredXP;
            document.getElementById('level').textContent = level;
            document.getElementById('xpBar').style.width = progress + '%';
        }

        function checkLevelUp() {
            const currentLevel = gameState.level;
            const requiredXP = xpRequirements[currentLevel];
            
            if (gameState.xp >= requiredXP && currentLevel < 5) {
                gameState.level++;
                showAchievement('Level Up!', `You reached Level ${gameState.level}!`);
                createParticles();
                
                // Mark nav button as completed
                if (gameState.level > 1) {
                    const prevSection = document.querySelector('.nav-btn.active');
                    if (prevSection) {
                        prevSection.classList.add('completed');
                    }
                }
            }
        }

        function showXPGain(amount) {
            const xpPopup = document.createElement('div');
            xpPopup.textContent = `+${amount} XP`;
            xpPopup.style.cssText = `
                position: fixed;
                top: 100px;
                right: 200px;
                background: #f39c12;
                color: white;
                padding: 10px 20px;
                border-radius: 20px;
                font-weight: bold;
                animation: xpFloat 2s ease-out forwards;
                z-index: 1000;
            `;
            document.body.appendChild(xpPopup);
            
            setTimeout(() => xpPopup.remove(), 2000);
        }

        // Add XP float animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes xpFloat {
                0% { transform: translateY(0); opacity: 1; }
                100% { transform: translateY(-50px); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Achievement System
        function showAchievement(title, text) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementTitle').textContent = title;
            document.getElementById('achievementText').textContent = text;
            
            popup.classList.add('show');
            
            setTimeout(() => {
                popup.classList.remove('show');
            }, 3000);
            
            // Haptic feedback for mobile
            if ('vibrate' in navigator) {
                navigator.vibrate(200);
            }
        }

        function createParticles() {
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * window.innerWidth + 'px';
                particle.style.top = '100px';
                particle.style.width = particle.style.height = Math.random() * 10 + 5 + 'px';
                particle.style.backgroundColor = ['#f39c12', '#e74c3c', '#3498db', '#2ecc71'][Math.floor(Math.random() * 4)];
                document.body.appendChild(particle);
                
                setTimeout(() => particle.remove(), 3000);
            }
        }

        // Starter Activity Functions
        function checkAnswer(button, questionId, correctAnswer) {
            const actionId = `answer_${questionId}`;
            if (gameState.completedActions.has(actionId)) return;
            
            const buttons = button.parentElement.querySelectorAll('.quiz-option');
            buttons.forEach(btn => {
                btn.classList.remove('selected', 'correct', 'incorrect');
                btn.disabled = true;
            });
            
            if (button.getAttribute('onclick').includes(correctAnswer)) {
                button.classList.add('correct');
                awardXP(10, 'Correct answer!');
                
                // Check if first correct answer achievement
                if (!gameState.achievements.has('first_correct')) {
                    gameState.achievements.add('first_correct');
                    showAchievement('First Steps!', 'Got your first correct answer!');
                }
            } else {
                button.classList.add('incorrect');
                // Find and highlight correct answer
                buttons.forEach(btn => {
                    if (btn.getAttribute('onclick').includes(correctAnswer)) {
                        btn.classList.add('correct');
                    }
                });
            }
            
            gameState.completedActions.add(actionId);
        }

        // Matching Activity
        function selectItem(item, value) {
            // Clear previous selection
            document.querySelectorAll('.draggable-item').forEach(i => {
                i.classList.remove('selected');
            });
            
            // Select new item
            item.classList.add('selected');
            gameState.selectedItem = value;
        }

        function matchItem(zone, expectedValue) {
            if (!gameState.selectedItem) return;
            
            if (gameState.selectedItem === expectedValue) {
                zone.classList.add('filled');
                zone.innerHTML = `<strong>${gameState.selectedItem}:</strong> ${zone.textContent}`;
                
                // Mark item as matched
                document.querySelectorAll('.draggable-item').forEach(item => {
                    if (item.textContent === gameState.selectedItem) {
                        item.style.opacity = '0.5';
                        item.style.pointerEvents = 'none';
                    }
                });
                
                gameState.matchedItems.add(gameState.selectedItem);
                awardXP(5, 'Correct match!');
                
                // Check if all matched
                if (gameState.matchedItems.size === 3) {
                    awardXP(15, 'Completed matching activity!');
                }
            } else {
                zone.style.backgroundColor = '#f8d7da';
                setTimeout(() => {
                    zone.style.backgroundColor = '';
                }, 1000);
            }
            
            gameState.selectedItem = null;
            document.querySelectorAll('.draggable-item').forEach(i => {
                i.classList.remove('selected');
            });
        }

        function resetMatching() {
            gameState.matchedItems.clear();
            gameState.selectedItem = null;
            
            document.querySelectorAll('.draggable-item').forEach(item => {
                item.style.opacity = '1';
                item.style.pointerEvents = 'auto';
                item.classList.remove('selected');
            });
            
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.classList.remove('filled');
                zone.innerHTML = zone.getAttribute('onclick').split("'")[3];
            });
        }

        // Sequencing Activity
        let sequenceState = {
            selectedStep: null,
            placedSteps: {},
            correctOrder: [3, 5, 1, 6, 4, 2] // Correct order of steps
        };

        function selectStep(item, stepNumber) {
            document.querySelectorAll('.draggable-item').forEach(i => {
                i.classList.remove('selected');
            });
            
            if (!Object.values(sequenceState.placedSteps).includes(stepNumber)) {
                item.classList.add('selected');
                sequenceState.selectedStep = {
                    number: stepNumber,
                    text: item.textContent
                };
            }
        }

        function placeStep(zone, position) {
            if (!sequenceState.selectedStep) return;
            
            // Clear any existing step in this position
            if (sequenceState.placedSteps[position]) {
                const oldStep = sequenceState.placedSteps[position];
                document.querySelectorAll('.draggable-item').forEach(item => {
                    if (item.textContent === oldStep.text) {
                        item.style.opacity = '1';
                    }
                });
            }
            
            // Place the step
            sequenceState.placedSteps[position] = sequenceState.selectedStep;
            zone.querySelector('span').textContent = sequenceState.selectedStep.text;
            zone.classList.add('filled');
            
            // Mark original item as used
            document.querySelectorAll('.draggable-item').forEach(item => {
                if (item.textContent === sequenceState.selectedStep.text) {
                    item.style.opacity = '0.5';
                    item.classList.remove('selected');
                }
            });
            
            sequenceState.selectedStep = null;
        }

        function checkSequence() {
            let correct = 0;
            for (let i = 1; i <= 6; i++) {
                if (sequenceState.placedSteps[i] && 
                    sequenceState.placedSteps[i].number === sequenceState.correctOrder[i-1]) {
                    correct++;
                    document.querySelectorAll('.drop-zone')[i-1].style.backgroundColor = '#d4edda';
                } else {
                    document.querySelectorAll('.drop-zone')[i-1].style.backgroundColor = '#f8d7da';
                }
            }
            
            if (correct === 6) {
                awardXP(25, 'Perfect sequence!');
                showAchievement('Algorithm Master!', 'Correctly sequenced all steps!');
            } else {
                awardXP(correct * 3, `${correct}/6 steps correct`);
            }
        }

        function resetSequence() {
            sequenceState.selectedStep = null;
            sequenceState.placedSteps = {};
            
            document.querySelectorAll('.draggable-item').forEach(item => {
                item.style.opacity = '1';
                item.classList.remove('selected');
            });
            
            document.querySelectorAll('.drop-zone').forEach((zone, index) => {
                zone.classList.remove('filled');
                zone.querySelector('span').textContent = '';
                zone.style.backgroundColor = '';
            });
        }

        // Identifier checking
        function checkIdentifiers() {
            const answers = {
                'id1': ['testScore', 'studentScore', 'score'],
                'id2': ['roomTemp', 'temperatureCelsius', 'currentTemp', 'temperature'],
                'id3': ['isLoggedIn', 'userLoggedIn', 'loggedIn']
            };
            
            let correct = 0;
            for (let id in answers) {
                const input = document.getElementById(id);
                const value = input.value.trim();
                
                if (answers[id].some(ans => ans.toLowerCase() === value.toLowerCase())) {
                    input.style.borderColor = '#27ae60';
                    correct++;
                } else if (value.length > 3 && /^[a-zA-Z]/.test(value)) {
                    // Partial credit for reasonable attempts
                    input.style.borderColor = '#f39c12';
                    correct += 0.5;
                } else {
                    input.style.borderColor = '#e74c3c';
                }
            }
            
            awardXP(Math.floor(correct * 10), 'Identifier naming');
        }

        function checkIdentifierTable() {
            let correct = 0;
            
            // Check data types
            if (document.getElementById('type1').value === 'real') correct++;
            if (document.getElementById('type2').value === 'real') correct++;
            if (document.getElementById('type3').value === 'real') correct++;
            
            // Check description
            const desc = document.getElementById('desc1').value.toLowerCase();
            if (desc.includes('area') && desc.includes('circle')) correct++;
            
            // Check identifier name
            const name = document.getElementById('name1').value.toLowerCase();
            if (name === 'pi' || name === 'pie' || name.includes('pi')) correct++;
            
            awardXP(correct * 5, 'Identifier table completion');
            
            if (correct === 5) {
                showAchievement('Table Master!', 'Perfect identifier table!');
            }
        }

        function resetIdentifierTable() {
            ['type1', 'type2', 'type3', 'desc1', 'name1'].forEach(id => {
                const element = document.getElementById(id);
                if (element.tagName === 'SELECT') {
                    element.value = '';
                } else {
                    element.value = '';
                }
            });
        }

        // Structured English checking
        function checkStructuredEnglish() {
            const correct = {
                'se1': 'FOR',
                'se2': 'DO',
                'se3': 'IF',
                'se4': 'THEN',
                'se5': 'ENDIF',
                'se6': 'ENDFOR'
            };
            
            let score = 0;
            for (let id in correct) {
                if (document.getElementById(id).value === correct[id]) {
                    score++;
                    document.getElementById(id).style.borderColor = '#27ae60';
                } else {
                    document.getElementById(id).style.borderColor = '#e74c3c';
                }
            }
            
            awardXP(score * 5, 'Structured English exercise');
            
            if (score === 6) {
                showAchievement('Structure Perfect!', 'Mastered structured English!');
            }
        }

        function resetStructuredEnglish() {
            ['se1', 'se2', 'se3', 'se4', 'se5', 'se6'].forEach(id => {
                document.getElementById(id).value = '';
                document.getElementById(id).style.borderColor = '';
            });
        }

        // Flowchart symbol checking
        function checkFlowchartSymbols() {
            const correct = {
                'fc1': 'parallelogram',
                'fc2': 'diamond',
                'fc3': 'rectangle'
            };
            
            let score = 0;
            for (let id in correct) {
                if (document.getElementById(id).value === correct[id]) {
                    score++;
                    document.getElementById(id).style.borderColor = '#27ae60';
                } else {
                    document.getElementById(id).style.borderColor = '#e74c3c';
                }
            }
            
            awardXP(score * 10, 'Flowchart symbols');
        }

        // Pseudocode checking
        function checkPseudocode() {
            const correct = {
                'ps1': 'THEN',
                'ps2': 'RETURN',
                'ps3': 'ELSE',
                'ps4': 'FOR',
                'ps5': 'DOWNTO',
                'ps6': 'ENDFOR'
            };
            
            let score = 0;
            for (let id in correct) {
                if (document.getElementById(id).value === correct[id]) {
                    score++;
                    document.getElementById(id).style.borderColor = '#27ae60';
                } else {
                    document.getElementById(id).style.borderColor = '#e74c3c';
                }
            }
            
            awardXP(score * 5, 'Pseudocode completion');
        }

        function resetPseudocode() {
            ['ps1', 'ps2', 'ps3', 'ps4', 'ps5', 'ps6'].forEach(id => {
                document.getElementById(id).value = '';
                document.getElementById(id).style.borderColor = '';
            });
        }

        function checkUserPseudocode() {
            const answer = document.getElementById('pseudocodeAnswer').value;
            
            if (answer.length < 50) {
                alert('Please write at least 50 characters');
                return;
            }
            
            // Check for key concepts
            const keywords = ['function', 'max', 'maximum', 'largest', 'array', 'for', 'if', 'return', 'compare'];
            let score = 0;
            
            keywords.forEach(keyword => {
                if (answer.toLowerCase().includes(keyword)) {
                    score++;
                }
            });
            
            awardXP(score * 5, 'Pseudocode writing');
            
            if (score >= 6) {
                showAchievement('Pseudocode Pro!', 'Excellent algorithm design!');
            }
        }

        // Refinement functions
        function toggleRefinement(levelId) {
            const element = document.getElementById(levelId);
            if (element.style.display === 'none') {
                element.style.display = 'block';
                awardXP(5, `Explored ${levelId}`);
            } else {
                element.style.display = 'none';
            }
        }

        function checkRefinement() {
            const steps = [
                document.getElementById('refine1').value,
                document.getElementById('refine2').value,
                document.getElementById('refine3').value
            ];
            
            let validSteps = 0;
            steps.forEach(step => {
                if (step.trim().length > 10) {
                    validSteps++;
                }
            });
            
            if (validSteps >= 3) {
                awardXP(20, 'Stepwise refinement exercise');
                
                // Check for good refinement keywords
                const allSteps = steps.join(' ').toLowerCase();
                if (allSteps.includes('collect') && allSteps.includes('calculate') && 
                    (allSteps.includes('average') || allSteps.includes('grade'))) {
                    awardXP(10, 'Excellent refinement!');
                }
            } else {
                alert('Please provide at least 3 detailed steps');
            }
        }

        // Logic checking
        function checkLogic() {
            const correct = {
                'logic1': 'false', // 16 >= 18 AND false = false
                'logic2': 'true',  // 16 < 18 OR NOT true = true OR false = true
                'logic3': 'true'   // (16 = 16 AND true) OR false = true OR false = true
            };
            
            let score = 0;
            for (let id in correct) {
                if (document.getElementById(id).value === correct[id]) {
                    score++;
                    document.getElementById(id).style.borderColor = '#27ae60';
                } else {
                    document.getElementById(id).style.borderColor = '#e74c3c';
                }
            }
            
            awardXP(score * 10, 'Logic evaluation');
        }

        function checkLogicBuilder() {
            const values = {
                'build1': 'age',
                'build2': '>',
                'build3': 'OR',
                'build4': 'isAccompanied',
                'build5': 'AND',
                'build6': 'hasTicket'
            };
            
            let correct = 0;
            for (let id in values) {
                if (document.getElementById(id).value === values[id]) {
                    correct++;
                }
            }
            
            if (correct === 6) {
                awardXP(30, 'Perfect logic statement!');
                showAchievement('Logic Master!', 'Built a complex logic statement!');
            } else {
                awardXP(correct * 4, 'Logic statement attempt');
            }
        }

        function resetLogicBuilder() {
            ['build1', 'build2', 'build3', 'build4', 'build5', 'build6'].forEach(id => {
                document.getElementById(id).value = '';
            });
        }

        // Hint system
        function showHint(hintId) {
            const hintBox = document.getElementById(`hint-${hintId}`);
            hintBox.classList.add('show');
            
            // Apply penalty only once per hint
            if (!gameState.hintPenalties.has(hintId)) {
                gameState.xp = Math.max(0, gameState.xp - 5);
                updateXPDisplay();
                gameState.hintPenalties.add(hintId);
            }
        }

        // Mark scheme
        function showMarkScheme(textareaId, marksId, schemeId) {
            const textarea = document.getElementById(textareaId);
            const marks = document.getElementById(marksId);
            const scheme = document.getElementById(schemeId);
            
            if (textarea.value.length < 50 || !marks.value) {
                alert('Please write a substantial answer and enter predicted marks first');
                return;
            }
            
            scheme.classList.add('show');
            awardXP(10, 'Exam practice attempt');
        }

        // Extension submission
        function submitExtension() {
            const ext1 = document.getElementById('ext1').value;
            const ext2 = document.getElementById('ext2').value;
            const ext3 = document.getElementById('ext3').value;
            
            const totalLength = ext1.length + ext2.length + ext3.length;
            
            if (totalLength < 200) {
                alert('Please provide more detailed responses (minimum 200 characters total)');
                return;
            }
            
            awardXP(50, 'Extension work completed!');
            showAchievement('Going Beyond!', 'Completed extension activities!');
            
            // Check for complete worksheet
            if (gameState.level === 5 && gameState.xp >= 1000) {
                showAchievement('Master of Algorithms!', 'Completed the entire worksheet at max level!');
                createParticles();
            }
        }

        // Canvas functions
        function initCanvas() {
            const canvas = document.getElementById('canvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            let isDrawing = false;
            let lastX = 0;
            let lastY = 0;
            
            function getCoordinates(e) {
                const rect = canvas.getBoundingClientRect();
                const scaleX = canvas.width / rect.width;
                const scaleY = canvas.height / rect.height;
                
                if (e.touches) {
                    return {
                        x: (e.touches[0].clientX - rect.left) * scaleX,
                        y: (e.touches[0].clientY - rect.top) * scaleY
                    };
                }
                return {
                    x: (e.clientX - rect.left) * scaleX,
                    y: (e.clientY - rect.top) * scaleY
                };
            }
            
            function startDrawing(e) {
                isDrawing = true;
                const coords = getCoordinates(e);
                lastX = coords.x;
                lastY = coords.y;
            }
            
            function draw(e) {
                if (!isDrawing) return;
                
                const coords = getCoordinates(e);
                
                ctx.beginPath();
                ctx.moveTo(lastX, lastY);
                ctx.lineTo(coords.x, coords.y);
                ctx.strokeStyle = '#2c3e50';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.stroke();
                
                lastX = coords.x;
                lastY = coords.y;
            }
            
            function stopDrawing() {
                isDrawing = false;
            }
            
            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events
            canvas.addEventListener('touchstart', function(e) {
                e.preventDefault();
                startDrawing(e);
            });
            canvas.addEventListener('touchmove', function(e) {
                e.preventDefault();
                draw(e);
            });
            canvas.addEventListener('touchend', function(e) {
                e.preventDefault();
                stopDrawing();
            });
        }

        function clearCanvas() {
            const canvas = document.getElementById('canvas');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            awardXP(1, 'Cleared canvas');
        }

        // Accessibility functions
        function changeFontSize(action) {
            const root = document.documentElement;
            const currentSize = parseInt(getComputedStyle(root).getPropertyValue('--font-size'));
            
            if (action === 'increase' && currentSize < 20) {
                root.style.setProperty('--font-size', (currentSize + 2) + 'px');
            } else if (action === 'decrease' && currentSize > 12) {
                root.style.setProperty('--font-size', (currentSize - 2) + 'px');
            } else if (action === 'normal') {
                root.style.setProperty('--font-size', '16px');
            }
        }

        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
            awardXP(2, 'Toggled high contrast');
        }

        function toggleDyslexiaFont() {
            document.body.classList.toggle('dyslexia-font');
            awardXP(2, 'Toggled dyslexia font');
        }

        // Feedback system
        function openFeedback() {
            document.getElementById('feedbackModal').style.display = 'flex';
        }

        function closeFeedback() {
            document.getElementById('feedbackModal').style.display = 'none';
            document.getElementById('feedbackText').value = '';
        }

        function sendFeedback() {
            const feedback = document.getElementById('feedbackText').value;
            if (!feedback.trim()) {
                alert('Please enter your feedback');
                return;
            }
            
            const section = gameState.currentSection;
            const subject = encodeURIComponent('Algorithm Worksheet Feedback');
            const body = encodeURIComponent(`Section: ${section}\n\nFeedback: ${feedback}\n\nXP: ${gameState.xp}, Level: ${gameState.level}`);
            
            window.location.href = `mailto:millingtond@mgs.org?subject=${subject}&body=${body}`;
            
            closeFeedback();
            awardXP(5, 'Provided feedback');
        }

        // Shame message
        function showShame() {
            const shame = document.getElementById('shameMessage');
            shame.classList.add('show');
            
            setTimeout(() => {
                shame.classList.remove('show');
            }, 2000);
            
            // Penalty
            gameState.xp = Math.max(0, gameState.xp - 10);
            updateXPDisplay();
        }

        // Save/Load game state
        function saveGameState() {
            try {
                const state = JSON.stringify(gameState);
                // Using sessionStorage to avoid persistence across sessions
                sessionStorage.setItem('algorithmGameState', state);
            } catch (e) {
                console.log('Could not save game state');
            }
        }

        function loadGameState() {
            try {
                const saved = sessionStorage.getItem('algorithmGameState');
                if (saved) {
                    const loadedState = JSON.parse(saved);
                    // Restore state but convert arrays back to Sets
                    gameState = {
                        ...loadedState,
                        completedActions: new Set(loadedState.completedActions),
                        matchedItems: new Set(loadedState.matchedItems),
                        quizAnswered: new Set(loadedState.quizAnswered),
                        achievements: new Set(loadedState.achievements),
                        hintPenalties: new Set(loadedState.hintPenalties)
                    };
                    updateXPDisplay();
                }
            } catch (e) {
                console.log('Could not load game state');
            }
        }

        // Load state on page load
        window.addEventListener('load', loadGameState);

        // Easter egg - Konami code
        let konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
        let konamiIndex = 0;

        document.addEventListener('keydown', function(e) {
            if (e.key === konamiCode[konamiIndex]) {
                konamiIndex++;
                if (konamiIndex === konamiCode.length) {
                    showAchievement('Secret Found!', 'You discovered the Konami code!');
                    awardXP(100, 'Konami code');
                    createParticles();
                    konamiIndex = 0;
                }
            } else {
                konamiIndex = 0;
            }
        });
    </script>
</body>
</html>