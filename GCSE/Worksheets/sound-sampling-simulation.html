<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sound Sampling Adventure - OCR J277</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            animation: slideDown 0.8s ease-out;
        }
        
        h1 {
            color: white;
            font-size: 3em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #f0f0f0;
            font-size: 1.2em;
        }
        
        .game-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .panel {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            animation: fadeIn 1s ease-out;
        }
        
        .simulation-panel {
            grid-column: span 2;
        }
        
        .wave-container {
            position: relative;
            background: linear-gradient(to bottom, #1a1a2e, #16213e);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .wave-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.05) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }
        
        canvas {
            display: block;
            width: 100%;
            height: 300px;
            position: relative;
            z-index: 1;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .control-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            padding: 20px;
            color: white;
            transition: transform 0.3s ease;
        }
        
        .control-card:hover {
            transform: translateY(-5px);
        }
        
        .control-card h3 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .icon {
            font-size: 24px;
        }
        
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: rgba(255,255,255,0.3);
            outline: none;
            -webkit-appearance: none;
            margin: 15px 0;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: white;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }
        
        .value-display {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 10px;
        }
        
        .preset-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .preset-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.2s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .preset-btn:hover {
            transform: scale(1.05);
        }
        
        .preset-btn.active {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .info-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .info-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            min-height: 120px;
        }
        
        .info-card::after {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.1);
            transform: rotate(45deg);
        }
        
        .info-card h4 {
            margin-bottom: 10px;
            font-size: 18px;
        }
        
        .info-card p {
            font-size: 16px;
            position: relative;
            z-index: 1;
        }
        
        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            transform: translateX(400px);
            transition: transform 0.5s ease;
            z-index: 1000;
        }
        
        .achievement-popup.show {
            transform: translateX(0);
        }
        
        .achievement-popup h3 {
            margin-bottom: 5px;
        }
        
        .tutorial-section {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .step-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .step-card {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s;
        }
        
        .step-card:hover {
            transform: translateY(-5px);
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-weight: bold;
            font-size: 20px;
            color: #667eea;
        }
        
        .quiz-container {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .quiz-progress {
            background: #e0e0e0;
            height: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .quiz-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .quiz-question {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            transform: scale(0.95);
            opacity: 0;
            animation: questionAppear 0.5s forwards;
        }
        
        .quiz-question h3 {
            color: #333;
            margin-bottom: 20px;
            font-size: 20px;
        }
        
        .quiz-option {
            background: white;
            padding: 15px 20px;
            margin: 10px 0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .quiz-option:hover {
            border-color: #667eea;
            transform: translateX(10px);
        }
        
        .quiz-option.selected {
            background: #667eea;
            color: white;
        }
        
        .quiz-option.correct {
            background: #4caf50;
            color: white;
            animation: correctPulse 0.6s;
        }
        
        .quiz-option.incorrect {
            background: #f44336;
            color: white;
            animation: shake 0.5s;
        }
        
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .btn {
            padding: 15px 40px;
            border: none;
            border-radius: 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }
        
        .score-display {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            margin-top: 20px;
            font-size: 24px;
            display: none;
        }
        
        .stars {
            font-size: 40px;
            margin: 20px 0;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes pulse {
            0%, 100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 0.5;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
                opacity: 0.8;
            }
        }
        
        @keyframes questionAppear {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        
        @keyframes correctPulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }
        
        @keyframes shake {
            0%, 100% {
                transform: translateX(0);
            }
            25% {
                transform: translateX(-10px);
            }
            75% {
                transform: translateX(10px);
            }
        }
        
        .comparison-mode {
            background: rgba(255,255,255,0.1);
            border: 2px dashed rgba(255,255,255,0.5);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            text-align: center;
            color: white;
        }
        
        .wave-type-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .wave-type-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .wave-type-btn:hover {
            background: white;
            color: #333;
        }
        
        .wave-type-btn.active {
            background: white;
            color: #333;
        }
        
        @media (max-width: 768px) {
            .game-container {
                grid-template-columns: 1fr;
            }
            
            .simulation-panel {
                grid-column: span 1;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <header>
            <h1>🎵 Sound Sampling Adventure</h1>
            <p class="subtitle">Master Digital Audio - OCR J277 Computer Science</p>
        </header>
        
        <div class="achievement-popup" id="achievementPopup">
            <h3>🏆 Achievement Unlocked!</h3>
            <p id="achievementText">Explorer</p>
        </div>
        
        <div class="tutorial-section">
            <h2>🎯 Your Mission: Become a Sound Sampling Expert!</h2>
            <div class="step-cards">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h4>Explore</h4>
                    <p>Adjust sampling rate and bit depth to see effects</p>
                </div>
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h4>Compare</h4>
                    <p>Try different presets and wave types</p>
                </div>
                <div class="step-card">
                    <div class="step-number">3</div>
                    <h4>Learn</h4>
                    <p>Understand quality vs file size trade-offs</p>
                </div>
                <div class="step-card">
                    <div class="step-number">4</div>
                    <h4>Master</h4>
                    <p>Ace the quiz and earn all achievements!</p>
                </div>
            </div>
        </div>
        
        <div class="panel simulation-panel">
            <h2>🔊 Interactive Sound Wave Laboratory</h2>
            
            <div class="wave-type-selector">
                <button class="wave-type-btn active" data-wave="sine">Sine Wave</button>
                <button class="wave-type-btn" data-wave="square">Square Wave</button>
                <button class="wave-type-btn" data-wave="sawtooth">Sawtooth Wave</button>
                <button class="wave-type-btn" data-wave="complex">Complex Wave</button>
            </div>
            
            <div class="wave-container">
                <canvas id="waveCanvas"></canvas>
                <div class="comparison-mode">
                    <label>
                        <input type="checkbox" id="comparisonMode"> Enable Split-Screen Comparison Mode
                    </label>
                </div>
            </div>
            
            <div class="preset-buttons">
                <button class="preset-btn" data-rate="8" data-depth="8">📞 Telephone (8kHz, 8-bit)</button>
                <button class="preset-btn" data-rate="22" data-depth="16">📻 FM Radio (22kHz, 16-bit)</button>
                <button class="preset-btn" data-rate="44" data-depth="16">💿 CD Quality (44kHz, 16-bit)</button>
                <button class="preset-btn" data-rate="48" data-depth="24">🎬 Studio (48kHz, 24-bit)</button>
                <button class="preset-btn" data-rate="96" data-depth="24">🎧 Hi-Res (96kHz, 24-bit)</button>
            </div>
            
            <div class="controls-grid">
                <div class="control-card">
                    <h3><span class="icon">⏱️</span> Sampling Rate</h3>
                    <input type="range" id="samplingRate" min="1" max="96" value="10">
                    <div class="value-display" id="samplingRateValue">10 Hz</div>
                    <p style="font-size: 14px; margin-top: 10px;">Samples per second</p>
                </div>
                
                <div class="control-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h3><span class="icon">📊</span> Bit Depth</h3>
                    <input type="range" id="bitDepth" min="1" max="24" value="4">
                    <div class="value-display" id="bitDepthValue">4 bits</div>
                    <p style="font-size: 14px; margin-top: 10px;">Precision per sample</p>
                </div>
                
                <div class="control-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                    <h3><span class="icon">📈</span> Wave Zoom</h3>
                    <input type="range" id="waveZoom" min="0.5" max="3" step="0.1" value="1">
                    <div class="value-display" id="zoomValue">1.0x</div>
                    <p style="font-size: 14px; margin-top: 10px;">Zoom level</p>
                </div>
            </div>
            
            <div class="info-cards">
                <div class="info-card">
                    <h4>📊 Quality Score</h4>
                    <p id="qualityScore">★★☆☆☆</p>
                </div>
                <div class="info-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
                    <h4>💾 File Size (1 sec)</h4>
                    <p id="fileSizeInfo">40 bits</p>
                </div>
                <div class="info-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <h4>🎯 Accuracy</h4>
                    <p id="accuracyInfo">25%</p>
                </div>
                <div class="info-card" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
                    <h4>🔢 Total Levels</h4>
                    <p id="levelsInfo">16 levels</p>
                </div>
            </div>
        </div>
        
        <div class="quiz-container">
            <h2>🧠 Challenge Mode: Test Your Knowledge!</h2>
            <div class="quiz-progress">
                <div class="quiz-progress-bar" id="progressBar"></div>
            </div>
            
            <div id="quizQuestions">
                <!-- Questions will be dynamically inserted here -->
            </div>
            
            <div class="button-group">
                <button class="btn btn-primary" id="checkAnswers">Check My Answers</button>
                <button class="btn btn-secondary" id="resetBtn">Reset Everything</button>
            </div>
            
            <div class="score-display" id="scoreDisplay">
                <h2>🎉 Quiz Complete!</h2>
                <div class="stars" id="starsDisplay">⭐⭐⭐</div>
                <p>Your Score: <span id="score">0</span>/10</p>
                <p id="gradeMessage">Great job!</p>
            </div>
        </div>
    </div>
    
    <script>
        // Enhanced quiz questions
        const quizData = [
            {
                question: "What does sampling rate measure?",
                options: [
                    "The volume of the sound",
                    "The frequency at which samples are measured per second",
                    "The number of bits per sample",
                    "The length of the recording"
                ],
                correct: 1,
                explanation: "Sampling rate is measured in Hz and tells us how many times per second we measure the sound wave."
            },
            {
                question: "If the sampling rate is 44Hz, how many samples are taken per second?",
                options: [
                    "1 sample",
                    "22 samples",
                    "44 samples",
                    "88 samples"
                ],
                correct: 2,
                explanation: "Hz means 'per second', so 44Hz = 44 samples per second."
            },
            {
                question: "What happens to file size when you increase the sampling rate?",
                options: [
                    "File size decreases",
                    "File size stays the same",
                    "File size increases",
                    "File size becomes zero"
                ],
                correct: 2,
                explanation: "More samples mean more data to store, increasing file size."
            },
            {
                question: "What is bit depth (sample resolution)?",
                options: [
                    "The number of samples per second",
                    "The number of bits used to record each measurement",
                    "The frequency of the sound wave",
                    "The duration of the recording"
                ],
                correct: 1,
                explanation: "Bit depth determines how precisely we can measure the amplitude of each sample."
            },
            {
                question: "How does increasing bit depth affect sound quality?",
                options: [
                    "It makes the sound louder",
                    "It has no effect on quality",
                    "It enables more accurate measurement of wave height",
                    "It reduces the quality"
                ],
                correct: 2,
                explanation: "Higher bit depth allows more precise amplitude measurements, improving quality."
            },
            {
                question: "In the process of digital sampling, what happens at regular intervals?",
                options: [
                    "The sound is made louder",
                    "The height of the wave is measured",
                    "The sound is compressed",
                    "The frequency is changed"
                ],
                correct: 1,
                explanation: "At each sample point, we measure the amplitude (height) of the wave."
            },
            {
                question: "How are the sampled measurements stored in a computer?",
                options: [
                    "As decimal numbers",
                    "As letters",
                    "As binary numbers",
                    "As images"
                ],
                correct: 2,
                explanation: "All data in computers is stored as binary (0s and 1s)."
            },
            {
                question: "With 8-bit depth, how many different amplitude levels can be represented?",
                options: [
                    "8 levels",
                    "64 levels",
                    "128 levels",
                    "256 levels"
                ],
                correct: 3,
                explanation: "8 bits can represent 2^8 = 256 different values."
            },
            {
                question: "Why does a higher sampling rate create a more accurate digital representation?",
                options: [
                    "It makes the sound louder",
                    "It captures more points along the wave",
                    "It uses more bits per sample",
                    "It compresses the file better"
                ],
                correct: 1,
                explanation: "More samples mean we capture the wave's shape more accurately."
            },
            {
                question: "CD quality audio uses 44.1kHz sampling rate. How many samples per minute?",
                options: [
                    "44,100 samples",
                    "441,000 samples",
                    "2,646,000 samples",
                    "26,460,000 samples"
                ],
                correct: 2,
                explanation: "44,100 samples/second × 60 seconds = 2,646,000 samples per minute."
            }
        ];
        
        // Canvas setup
        const canvas = document.getElementById('waveCanvas');
        const ctx = canvas.getContext('2d');
        
        // Set canvas size
        function resizeCanvas() {
            canvas.width = canvas.offsetWidth;
            canvas.height = 300;
        }
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        
        // Control elements
        const samplingRateSlider = document.getElementById('samplingRate');
        const bitDepthSlider = document.getElementById('bitDepth');
        const waveZoomSlider = document.getElementById('waveZoom');
        const comparisonMode = document.getElementById('comparisonMode');
        
        // Display elements
        const samplingRateValue = document.getElementById('samplingRateValue');
        const bitDepthValue = document.getElementById('bitDepthValue');
        const zoomValue = document.getElementById('zoomValue');
        const qualityScore = document.getElementById('qualityScore');
        const fileSizeInfo = document.getElementById('fileSizeInfo');
        const accuracyInfo = document.getElementById('accuracyInfo');
        const levelsInfo = document.getElementById('levelsInfo');
        
        // Quiz elements
        const checkAnswersBtn = document.getElementById('checkAnswers');
        const resetBtn = document.getElementById('resetBtn');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const scoreSpan = document.getElementById('score');
        const progressBar = document.getElementById('progressBar');
        const quizQuestions = document.getElementById('quizQuestions');
        const starsDisplay = document.getElementById('starsDisplay');
        const gradeMessage = document.getElementById('gradeMessage');
        
        // Achievement system
        const achievements = {
            firstChange: false,
            maxQuality: false,
            minQuality: false,
            presetExplorer: false,
            quizMaster: false,
            waveExplorer: false
        };
        
        // Wave type
        let currentWaveType = 'sine';
        let animationFrame = 0;
        
        // Show achievement
        function showAchievement(text) {
            const popup = document.getElementById('achievementPopup');
            document.getElementById('achievementText').textContent = text;
            popup.classList.add('show');
            setTimeout(() => popup.classList.remove('show'), 3000);
        }
        
        // Wave functions
        function getWaveValue(x, type) {
            const frequency = 0.02;
            switch(type) {
                case 'sine':
                    return Math.sin(x * frequency);
                case 'square':
                    return Math.sin(x * frequency) > 0 ? 1 : -1;
                case 'sawtooth':
                    return ((x * frequency) % (2 * Math.PI)) / Math.PI - 1;
                case 'complex':
                    return Math.sin(x * frequency) + 
                           0.3 * Math.sin(x * frequency * 3) + 
                           0.2 * Math.sin(x * frequency * 5);
                default:
                    return Math.sin(x * frequency);
            }
        }
        
        // Main drawing function
        function drawWave() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const samplingRate = parseInt(samplingRateSlider.value);
            const bitDepth = parseInt(bitDepthSlider.value);
            const zoom = parseFloat(waveZoomSlider.value);
            const maxLevels = Math.pow(2, bitDepth);
            
            // Cap visual levels at 8 bits (256) for performance
            const visualBitDepth = Math.min(bitDepth, 8);
            const visualMaxLevels = Math.pow(2, visualBitDepth);
            
            // Update displays with actual values
            levelsInfo.textContent = `${maxLevels.toLocaleString()} levels`;
            
            // Draw grid (limited to max 256 lines for performance)
            ctx.strokeStyle = 'rgba(255,255,255,0.1)';
            ctx.lineWidth = 1;
            
            // Only draw grid lines if there are 256 or fewer levels
            if (visualMaxLevels <= 256) {
                const step = Math.max(1, Math.floor(visualMaxLevels / 32)); // Draw every nth line if many levels
                for (let i = 0; i <= visualMaxLevels; i += step) {
                    const y = 50 + (i / visualMaxLevels) * 200;
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(canvas.width, y);
                    ctx.stroke();
                }
            }
            
            const halfWidth = comparisonMode.checked ? canvas.width / 2 : canvas.width;
            
            // Draw original wave
            ctx.strokeStyle = '#00f2fe';
            ctx.lineWidth = 3;
            ctx.shadowBlur = 10;
            ctx.shadowColor = '#00f2fe';
            ctx.beginPath();
            
            for (let x = 0; x < halfWidth; x++) {
                const waveX = (x / zoom) + animationFrame;
                const y = canvas.height/2 + getWaveValue(waveX, currentWaveType) * 100;
                if (x === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            ctx.shadowBlur = 0;
            
            // Draw samples and digital wave
            const sampleInterval = halfWidth / samplingRate;
            const samples = [];
            
            // Collect samples
            for (let i = 0; i < samplingRate; i++) {
                const x = i * sampleInterval;
                const waveX = (x / zoom) + animationFrame;
                const originalY = canvas.height/2 + getWaveValue(waveX, currentWaveType) * 100;
                
                // Quantize
                const normalized = (originalY - 50) / 200;
                const quantized = Math.round(normalized * (maxLevels - 1)) / (maxLevels - 1);
                const y = 50 + quantized * 200;
                
                samples.push({x, y});
            }
            
            // Draw digital wave
            ctx.strokeStyle = '#f5576c';
            ctx.lineWidth = 2;
            ctx.shadowBlur = 8;
            ctx.shadowColor = '#f5576c';
            ctx.beginPath();
            
            for (let i = 0; i < samples.length - 1; i++) {
                ctx.moveTo(samples[i].x, samples[i].y);
                ctx.lineTo(samples[i+1].x, samples[i+1].y);
            }
            ctx.stroke();
            ctx.shadowBlur = 0;
            
            // Draw sample points
            ctx.fillStyle = '#fee140';
            ctx.shadowBlur = 15;
            ctx.shadowColor = '#fee140';
            samples.forEach(sample => {
                ctx.beginPath();
                ctx.arc(sample.x, sample.y, 6, 0, 2 * Math.PI);
                ctx.fill();
            });
            ctx.shadowBlur = 0;
            
            // Comparison mode - draw second wave
            if (comparisonMode.checked) {
                ctx.strokeStyle = 'rgba(255,255,255,0.3)';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(halfWidth, 0);
                ctx.lineTo(halfWidth, canvas.height);
                ctx.stroke();
                
                // Draw high quality version on right
                const hqRate = 96;
                const hqDepth = 24;
                const hqLevels = Math.pow(2, hqDepth);
                const hqInterval = halfWidth / hqRate;
                
                ctx.strokeStyle = '#4caf50';
                ctx.lineWidth = 2;
                ctx.beginPath();
                
                for (let i = 0; i < hqRate; i++) {
                    const x = halfWidth + i * hqInterval;
                    const waveX = ((i * hqInterval) / zoom) + animationFrame;
                    const y = canvas.height/2 + getWaveValue(waveX, currentWaveType) * 100;
                    
                    if (i === 0) {
                        ctx.moveTo(x, y);
                    } else {
                        ctx.lineTo(x, y);
                    }
                }
                ctx.stroke();
            }
            
            updateInfo(samplingRate, bitDepth);
        }
        
        // Update information displays
        function updateInfo(samplingRate, bitDepth) {
            // Quality score
            const qualityPercent = (samplingRate / 96) * (bitDepth / 24) * 100;
            let stars = '★☆☆☆☆';
            if (qualityPercent > 80) stars = '★★★★★';
            else if (qualityPercent > 60) stars = '★★★★☆';
            else if (qualityPercent > 40) stars = '★★★☆☆';
            else if (qualityPercent > 20) stars = '★★☆☆☆';
            qualityScore.textContent = stars;
            
            // File size
            const bitsPerSecond = samplingRate * bitDepth;
            const bytesPerSecond = Math.ceil(bitsPerSecond / 8);
            const kb = (bytesPerSecond / 1024).toFixed(2);
            fileSizeInfo.innerHTML = `${bitsPerSecond} bits<br>(${kb} KB)`;
            
            // Accuracy
            const accuracy = Math.min(100, (samplingRate / 44) * (bitDepth / 16) * 100);
            accuracyInfo.textContent = `${Math.round(accuracy)}%`;
            
            // Check achievements
            if (!achievements.maxQuality && samplingRate >= 96 && bitDepth >= 24) {
                achievements.maxQuality = true;
                showAchievement('Audiophile - Maximum Quality!');
            }
            
            if (!achievements.minQuality && samplingRate <= 5 && bitDepth <= 2) {
                achievements.minQuality = true;
                showAchievement('Retro Gamer - 8-bit Style!');
            }
        }
        
        // Animation loop
        function animate() {
            animationFrame += 0.5;
            drawWave();
            requestAnimationFrame(animate);
        }
        
        // Event listeners
        samplingRateSlider.addEventListener('input', function() {
            samplingRateValue.textContent = this.value + ' Hz';
            if (!achievements.firstChange) {
                achievements.firstChange = true;
                showAchievement('Explorer - First Adjustment!');
            }
        });
        
        bitDepthSlider.addEventListener('input', function() {
            bitDepthValue.textContent = this.value + ' bits';
        });
        
        waveZoomSlider.addEventListener('input', function() {
            zoomValue.textContent = this.value + 'x';
        });
        
        comparisonMode.addEventListener('change', drawWave);
        
        // Preset buttons
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                samplingRateSlider.value = this.dataset.rate;
                bitDepthSlider.value = this.dataset.depth;
                samplingRateValue.textContent = this.dataset.rate + ' Hz';
                bitDepthValue.textContent = this.dataset.depth + ' bits';
                
                if (!achievements.presetExplorer) {
                    achievements.presetExplorer = true;
                    showAchievement('Time Traveler - Explored Presets!');
                }
            });
        });
        
        // Wave type buttons
        document.querySelectorAll('.wave-type-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.wave-type-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentWaveType = this.dataset.wave;
                
                if (!achievements.waveExplorer) {
                    achievements.waveExplorer = true;
                    showAchievement('Wave Master - Explored Different Waves!');
                }
            });
        });
        
        // Generate quiz HTML
        function generateQuiz() {
            let html = '';
            quizData.forEach((q, index) => {
                html += `
                    <div class="quiz-question" data-question="${index}">
                        <h3>Question ${index + 1}: ${q.question}</h3>
                        <div class="quiz-options">
                            ${q.options.map((opt, i) => `
                                <div class="quiz-option" data-question="${index}" data-option="${i}">
                                    ${opt}
                                </div>
                            `).join('')}
                        </div>
                        <div class="feedback" id="feedback${index}" style="display: none;">
                            <p class="explanation">${q.explanation}</p>
                        </div>
                    </div>
                `;
            });
            quizQuestions.innerHTML = html;
            
            // Add click handlers
            document.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', function() {
                    const question = this.dataset.question;
                    const selected = this.dataset.option;
                    
                    // Clear other selections for this question
                    document.querySelectorAll(`.quiz-option[data-question="${question}"]`).forEach(opt => {
                        opt.classList.remove('selected');
                    });
                    
                    this.classList.add('selected');
                });
            });
        }
        
        // Check answers
        checkAnswersBtn.addEventListener('click', function() {
            let score = 0;
            let answered = 0;
            
            quizData.forEach((q, index) => {
                const selected = document.querySelector(`.quiz-option[data-question="${index}"].selected`);
                if (selected) {
                    answered++;
                    const selectedOption = parseInt(selected.dataset.option);
                    const options = document.querySelectorAll(`.quiz-option[data-question="${index}"]`);
                    
                    if (selectedOption === q.correct) {
                        score++;
                        selected.classList.add('correct');
                    } else {
                        selected.classList.add('incorrect');
                        options[q.correct].classList.add('correct');
                    }
                    
                    document.getElementById(`feedback${index}`).style.display = 'block';
                }
            });
            
            // Update progress bar
            progressBar.style.width = `${(answered / quizData.length) * 100}%`;
            
            // Show score
            scoreSpan.textContent = score;
            scoreDisplay.style.display = 'block';
            
            // Update stars and message
            const percentage = (score / quizData.length) * 100;
            if (percentage === 100) {
                starsDisplay.textContent = '⭐⭐⭐⭐⭐';
                gradeMessage.textContent = 'Perfect! You\'re a Sound Sampling Master!';
                if (!achievements.quizMaster) {
                    achievements.quizMaster = true;
                    showAchievement('Quiz Master - Perfect Score!');
                }
            } else if (percentage >= 80) {
                starsDisplay.textContent = '⭐⭐⭐⭐';
                gradeMessage.textContent = 'Excellent work! Nearly perfect!';
            } else if (percentage >= 60) {
                starsDisplay.textContent = '⭐⭐⭐';
                gradeMessage.textContent = 'Good job! Keep practicing!';
            } else if (percentage >= 40) {
                starsDisplay.textContent = '⭐⭐';
                gradeMessage.textContent = 'Nice try! Review the material and try again.';
            } else {
                starsDisplay.textContent = '⭐';
                gradeMessage.textContent = 'Keep learning! You\'ll get there!';
            }
        });
        
        // Reset button
        resetBtn.addEventListener('click', function() {
            // Reset controls
            samplingRateSlider.value = 10;
            bitDepthSlider.value = 4;
            waveZoomSlider.value = 1;
            samplingRateValue.textContent = '10 Hz';
            bitDepthValue.textContent = '4 bits';
            zoomValue.textContent = '1.0x';
            comparisonMode.checked = false;
            
            // Reset wave type
            currentWaveType = 'sine';
            document.querySelectorAll('.wave-type-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.wave === 'sine') btn.classList.add('active');
            });
            
            // Reset presets
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Reset quiz
            generateQuiz();
            scoreDisplay.style.display = 'none';
            progressBar.style.width = '0%';
            
            drawWave();
        });
        
        // Initialize
        generateQuiz();
        animate();
    </script>
</body>
</html>