<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Components - GCSE Computer Science Lesson</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: #f5f7fa;
            color: #2c3e50;
            line-height: 1.6;
            position: relative;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header with XP and Level */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .progress-bar {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.2);
            border-radius: 25px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .xp-display {
            font-weight: bold;
            font-size: 1.1em;
        }

        .level-badge {
            background: #ffd700;
            color: #2c3e50;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        /* Navigation */
        .nav-container {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 10px;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9em;
        }

        .nav-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: #764ba2;
        }

        .nav-arrows {
            display: flex;
            gap: 10px;
        }

        .arrow-btn {
            background: #e0e0e0;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .arrow-btn:hover {
            background: #d0d0d0;
        }

        .arrow-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Sections */
        .section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: relative;
        }

        /* Feedback Button */
        .feedback-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #34495e;
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.3s;
            z-index: 1000;
            font-size: 20px;
        }

        .feedback-btn:hover {
            transform: scale(1.1);
            background: #2c3e50;
        }

        /* Feedback Modal */
        .feedback-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }

        .feedback-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            position: relative;
        }

        .close-feedback {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        /* Achievement Popup */
        .achievement-popup {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 20px 30px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            transform: translateX(400px);
            transition: transform 0.5s;
            z-index: 3000;
        }

        .achievement-popup.show {
            transform: translateX(0);
        }

        .achievement-popup h3 {
            margin-bottom: 5px;
        }

        /* Learning Outcomes */
        .learning-outcomes {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
        }

        .learning-outcomes h3 {
            color: #1976d2;
            margin-bottom: 10px;
        }

        .learning-outcomes ul {
            list-style: none;
            padding-left: 0;
        }

        .learning-outcomes li {
            padding: 5px 0;
            position: relative;
            padding-left: 25px;
        }

        .learning-outcomes li:before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #4caf50;
            font-weight: bold;
        }

        /* Quiz Styles */
        .quiz-container {
            margin: 20px 0;
        }

        .question {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        .question h4 {
            margin-bottom: 10px;
            color: #34495e;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option {
            background: white;
            border: 2px solid #e0e0e0;
            padding: 12px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .option:hover {
            border-color: #667eea;
            background: #f5f7ff;
        }

        .option.selected {
            border-color: #667eea;
            background: #e8edff;
        }

        .option.correct {
            border-color: #4caf50;
            background: #e8f5e9;
        }

        .option.incorrect {
            border-color: #f44336;
            background: #ffebee;
        }

        /* Simulation Container */
        .simulation-container {
            background: #f0f4f8;
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            position: relative;
            min-height: 450px;
            overflow: hidden;
        }

        .simulation-container h3 {
            margin-bottom: 10px;
            color: #2c3e50;
        }

        .simulation-container p {
            margin-bottom: 20px;
            color: #4a5568;
        }

        #routerSimulation button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .device-icon {
            background: white;
            border: 3px solid #667eea;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: absolute;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 10px;
            text-align: center;
            z-index: 10;
        }

        .device-icon:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .device-icon.active {
            background: #667eea;
            color: white;
        }

        #switch-device.active {
            background: #38b2ac !important;
            border-color: #319795 !important;
        }

        #switch-device.active div {
            color: white !important;
        }

        #wap-device.active {
            background: #4caf50 !important;
            border-color: #388e3c !important;
        }

        #wap-device.active div {
            color: white !important;
        }

        .data-packet {
            width: 35px;
            height: 35px;
            background: #ffd700;
            border-radius: 50%;
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 1s ease-in-out;
            z-index: 100;
            box-shadow: 0 3px 15px rgba(0,0,0,0.3);
            border: 2px solid #f39c12;
        }

        .connection-line {
            position: absolute;
            height: 3px;
            background: #ddd;
            transform-origin: left center;
            z-index: 1;
            transition: all 0.3s;
        }

        .connection-line.active {
            background: #4caf50;
            animation: pulse 1s infinite;
            box-shadow: 0 0 10px #4caf50;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* Info Box */
        .info-box {
            background: #e3f2fd;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-size: 14px;
        }

        .info-box h4 {
            color: #1976d2;
            margin-bottom: 5px;
        }

        /* Button Styles */
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            margin: 5px;
        }

        .btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-success {
            background: #4caf50;
        }

        .btn-success:hover {
            background: #45a049;
        }

        .btn-danger {
            background: #f44336;
        }

        .btn-danger:hover {
            background: #da190b;
        }

        /* Reset Button */
        .reset-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin: 10px 0;
            transition: all 0.3s;
        }

        .reset-btn:hover {
            background: #c0392b;
        }

        /* Hint System */
        .hint-container {
            margin: 10px 0;
        }

        .hint-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .hint-btn:hover {
            background: #2980b9;
        }

        .hint-text {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            display: none;
        }

        /* Accessibility */
        .high-contrast {
            background: black !important;
            color: yellow !important;
        }

        .high-contrast * {
            background: black !important;
            color: yellow !important;
            border-color: yellow !important;
        }

        .dyslexia-font {
            font-family: 'OpenDyslexic', Arial, sans-serif !important;
        }

        /* Font Size Controls */
        .accessibility-controls {
            position: fixed;
            top: 20px;
            left: 20px;
            background: white;
            border-radius: 5px;
            padding: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .font-size-btn {
            background: #34495e;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            margin: 0 5px;
            border-radius: 5px;
            cursor: pointer;
        }

        /* Paste Detection */
        .paste-warning {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #e74c3c;
            color: white;
            padding: 20px 40px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            display: none;
            z-index: 5000;
            font-size: 18px;
            font-weight: bold;
        }

        /* Drag and Drop */
        .drag-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .drag-source, .drop-zone {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 8px;
            min-height: 200px;
        }

        .draggable {
            background: white;
            border: 2px solid #667eea;
            padding: 10px 15px;
            margin: 5px 0;
            border-radius: 5px;
            cursor: move;
            transition: all 0.3s;
        }

        .draggable.dragging {
            opacity: 0.5;
        }

        .drop-slot {
            background: white;
            border: 2px dashed #ccc;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            min-height: 40px;
            transition: all 0.3s;
        }

        .drop-slot.drag-over {
            border-color: #667eea;
            background: #f5f7ff;
        }

        .drop-slot.filled {
            border-style: solid;
            border-color: #4caf50;
        }

        /* Fill in the Blank */
        .word-bank {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .word-option {
            display: inline-block;
            background: white;
            border: 2px solid #667eea;
            padding: 5px 10px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .word-option:hover {
            background: #f5f7ff;
        }

        .word-option.used {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .fill-blank {
            display: inline-block;
            min-width: 100px;
            border-bottom: 2px solid #667eea;
            padding: 2px 5px;
            margin: 0 5px;
        }

        /* Common Mistakes */
        .mistake-alert {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .mistake-alert h4 {
            color: #856404;
            margin-bottom: 5px;
        }

        /* Real World Context */
        .real-world {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
        }

        .real-world h4 {
            color: #2e7d32;
            margin-bottom: 5px;
        }

        /* Summary Card */
        .summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .key-takeaway {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        /* Canvas */
        .canvas-container {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            margin: 20px 0;
            padding: 10px;
        }

        canvas {
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: crosshair;
            touch-action: none;
            width: 100%;
            max-width: 600px;
        }

        .canvas-controls {
            margin-top: 10px;
            display: flex;
            gap: 10px;
        }

        /* Exam Question */
        .exam-question {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .marks-box {
            float: right;
            background: white;
            border: 2px solid #ffc107;
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
        }

        .answer-box {
            width: 100%;
            min-height: 150px;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 5px;
            font-family: inherit;
            font-size: 16px;
            resize: vertical;
        }

        .mark-scheme {
            background: #e8f5e9;
            border: 2px solid #4caf50;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        /* Extension Box */
        .extension-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .extension-box h3 {
            margin-bottom: 10px;
        }

        /* Video Placeholder */
        .video-placeholder {
            background: #f0f0f0;
            border: 2px dashed #999;
            padding: 40px;
            text-align: center;
            border-radius: 10px;
            margin: 20px 0;
        }

        /* Writing Scorer */
        #writingScorer {
            border: 2px solid #667eea;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        #scoreCircle {
            width: 100px;
            height: 100px;
            border: 5px solid #ccc;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            font-size: 36px;
            font-weight: bold;
            transition: all 0.5s;
        }

        #scoreCircle.high-score {
            border-color: #4caf50;
            color: #4caf50;
        }

        #scoreCircle.medium-score {
            border-color: #ff9800;
            color: #ff9800;
        }

        #scoreCircle.low-score {
            border-color: #f44336;
            color: #f44336;
        }

        #successList li, #improvementList li {
            list-style: none;
            padding: 5px 0;
        }

        #successList li {
            color: #4caf50;
        }

        #improvementList li {
            color: #f44336;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .progress-bar {
                position: static;
                margin-top: 15px;
            }

            .nav-buttons {
                flex-direction: column;
                width: 100%;
            }

            .nav-btn {
                width: 100%;
            }

            .drag-container {
                grid-template-columns: 1fr;
            }

            .simulation-container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="accessibility-controls">
        <button class="font-size-btn" onclick="changeFontSize(-2)">A-</button>
        <button class="font-size-btn" onclick="changeFontSize(2)">A+</button>
        <button class="font-size-btn" onclick="toggleHighContrast()">HC</button>
        <button class="font-size-btn" onclick="toggleDyslexiaFont()">DF</button>
    </div>

    <div class="paste-warning" id="pasteWarning">
        üö´ Nice try! Pasting is disabled. Type it yourself! üòä
    </div>

    <div class="achievement-popup" id="achievementPopup">
        <h3>Achievement Unlocked!</h3>
        <p id="achievementText"></p>
    </div>

    <button class="feedback-btn" onclick="openFeedback()">üí¨</button>

    <div class="feedback-modal" id="feedbackModal">
        <div class="feedback-content">
            <button class="close-feedback" onclick="closeFeedback()">√ó</button>
            <h3>Send Feedback</h3>
            <p>Found a bug or have a suggestion? Let us know!</p>
            <textarea id="feedbackText" rows="5" style="width: 100%; margin: 10px 0; padding: 10px; border: 2px solid #e0e0e0; border-radius: 5px;" placeholder="Describe the issue or suggestion..."></textarea>
            <button class="btn" onclick="sendFeedback()">Send Feedback</button>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <h1>Network Components</h1>
            <p>GCSE Computer Science - OCR J277</p>
            <div class="progress-bar">
                <span class="xp-display">XP: <span id="currentXP">0</span></span>
                <span class="level-badge">Level <span id="currentLevel">0</span> / 5</span>
            </div>
        </div>

        <div class="nav-container">
            <div class="nav-buttons">
                <button class="nav-btn active" onclick="showSection(0)">Starter</button>
                <button class="nav-btn" onclick="showSection(1)">Learning</button>
                <button class="nav-btn" onclick="showSection(2)">Router</button>
                <button class="nav-btn" onclick="showSection(3)">Switch</button>
                <button class="nav-btn" onclick="showSection(4)">NIC</button>
                <button class="nav-btn" onclick="showSection(5)">WAP</button>
                <button class="nav-btn" onclick="showSection(6)">Repeater</button>
                <button class="nav-btn" onclick="showSection(7)">Cables</button>
                <button class="nav-btn" onclick="showSection(8)">Big Sim</button>
                <button class="nav-btn" onclick="showSection(9)">Practice</button>
                <button class="nav-btn" onclick="showSection(10)">Extension</button>
                <button class="nav-btn" onclick="showSection(11)">Summary</button>
                <button class="nav-btn" onclick="showSection(12)">Videos</button>
            </div>
            <div class="nav-arrows">
                <button class="arrow-btn" id="prevBtn" onclick="previousSection()">‚Üê</button>
                <button class="arrow-btn" id="nextBtn" onclick="nextSection()">‚Üí</button>
            </div>
        </div>

        <div class="section active" id="section0">
            <div class="card">
                <h2>Starter Activity: Network Basics Recap</h2>
                <p>Let's start by checking your existing knowledge about computer networks!</p>
                
                <div class="quiz-container">
                    <div class="question">
                        <h4>1. What is the main purpose of a computer network?</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'q1', 'b')">To make computers run faster</div>
                            <div class="option" onclick="selectOption(this, 'q1', 'a')">To share resources and communicate</div>
                            <div class="option" onclick="selectOption(this, 'q1', 'c')">To increase storage space</div>
                            <div class="option" onclick="selectOption(this, 'q1', 'd')">To prevent viruses</div>
                        </div>
                    </div>

                    <div class="question">
                        <h4>2. Which of these is NOT a type of network?</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'q2', 'a')">LAN</div>
                            <div class="option" onclick="selectOption(this, 'q2', 'c')">WAN</div>
                            <div class="option" onclick="selectOption(this, 'q2', 'b')">RAM</div>
                            <div class="option" onclick="selectOption(this, 'q2', 'd')">MAN</div>
                        </div>
                    </div>

                    <div class="question">
                        <h4>3. What does IP stand for in networking?</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'q3', 'b')">Internal Program</div>
                            <div class="option" onclick="selectOption(this, 'q3', 'c')">Information Processing</div>
                            <div class="option" onclick="selectOption(this, 'q3', 'd')">Input Port</div>
                            <div class="option" onclick="selectOption(this, 'q3', 'a')">Internet Protocol</div>
                        </div>
                    </div>
                </div>

                <button class="btn" onclick="checkStarterQuiz()">Check Answers</button>
                <button class="reset-btn" onclick="resetStarterQuiz()">Reset Quiz</button>
            </div>
        </div>

        <div class="section" id="section1">
            <div class="card">
                <h2>Learning Outcomes</h2>
                <div class="learning-outcomes">
                    <h3>By the end of this lesson, you will be able to:</h3>
                    <ul>
                        <li>Identify and explain the function of different network hardware components</li>
                        <li>Compare and contrast switches, hubs, and routers</li>
                        <li>Understand the role of Network Interface Cards (NICs) in networking</li>
                        <li>Explain the differences between copper and fiber optic cables</li>
                        <li>Describe how wireless access points and repeaters extend network coverage</li>
                        <li>Apply your knowledge to real-world networking scenarios</li>
                    </ul>
                </div>

                <div class="real-world">
                    <h4>üåç Real World Context</h4>
                    <p>Network components are everywhere! From your home WiFi router to the massive data centers powering the internet, understanding these components helps you appreciate how billions of devices communicate globally every second.</p>
                </div>
            </div>
        </div>

        <div class="section" id="section2">
            <div class="card">
                <h2>Router</h2>
                
                <div class="info-box">
                    <h4>üìö Definition</h4>
                    <p>A router joins two LANs or a LAN to a WAN. It directs packets to their destination using IP addresses.</p>
                </div>

                <h3>Key Functions:</h3>
                <ul>
                    <li>Receives packets from the internet</li>
                    <li>Has a public IP address for the LAN</li>
                    <li>Designates private IP addresses to network nodes</li>
                    <li>Maintains a routing table to identify efficient routes</li>
                </ul>

                <div id="routerSimulation" class="simulation-container" style="background: white; padding: 30px; border-radius: 10px;">
                    </div>

                <div class="question">
                    <h4>Quick Check: What type of address does a router use?</h4>
                    <div class="options">
                        <div class="option" onclick="selectOption(this, 'router-quick', 'b')">MAC address</div>
                        <div class="option" onclick="selectOption(this, 'router-quick', 'a')">IP address</div>
                        <div class="option" onclick="selectOption(this, 'router-quick', 'c')">URL</div>
                        <div class="option" onclick="selectOption(this, 'router-quick', 'd')">Port number</div>
                    </div>
                </div>
                <button class="btn" onclick="checkRouterQuickCheck()">Check Answer</button>
                <button class="reset-btn" onclick="resetRouterSim()">Reset Page</button>

                <div class="mistake-alert">
                    <h4>‚ö†Ô∏è Common Mistake</h4>
                    <p>Don't confuse routers with switches! Routers connect different networks (like your home to the internet), while switches connect devices within the same network.</p>
                </div>
            </div>
        </div>

        <div class="section" id="section3">
            <div class="card">
                <h2>Switch</h2>
                
                <div class="info-box">
                    <h4>üìö Definition</h4>
                    <p>A switch connects devices together within a network and directs data only to its intended destination using MAC addresses.</p>
                </div>

                <h3>Key Functions:</h3>
                <ul>
                    <li>Receives data/packets/traffic</li>
                    <li>Directs data <strong>only</strong> to its <strong>destination</strong></li>
                    <li>Creates a list of devices connected to it</li>
                    <li>Uses MAC addresses of devices</li>
                </ul>

                <iframe 
                    src="SwitchSim.html" 
                    title="Interactive Network Switch Simulation"
                    style="width: 100%; height: 800px; border: none; border-radius: 10px; margin-top: 20px;">
                </iframe>
                
                <div class="hint-container">
                    <button class="hint-btn" onclick="toggleHint('switchHint')">Need a hint?</button>
                    <div class="hint-text" id="switchHint">
                        A switch is smart! It learns which devices are connected to which ports by reading the source MAC address from data packets. This allows it to send future packets directly to the correct device instead of to everyone.
                    </div>
                </div>

            </div>
        </div>

        <div class="section" id="section4">
            <div class="card">
                <h2>Network Interface Card (NIC)</h2>
                
                <div class="info-box">
                    <h4>üìö Definition</h4>
                    <p>A NIC is a hardware component that connects a device to a computer network. Every networked device needs one!</p>
                </div>

                <h3>Key Points:</h3>
                <ul>
                    <li>Physical hardware inside your device</li>
                    <li>Has a unique MAC address (like a fingerprint)</li>
                    <li>Converts data into signals for transmission</li>
                    <li>Can be wired (Ethernet) or wireless (WiFi)</li>
                </ul>

                <div class="question">
                    <h4>Fill in the blanks about NICs:</h4>
                    <p>A NIC is a <span class="fill-blank" data-answer="hardware"></span> component that connects a device to a computer <span class="fill-blank" data-answer="network"></span>. Every networked device needs one, and each NIC has a unique <span class="fill-blank" data-answer="MAC"></span> address.</p>
                    
                    <div class="word-bank">
                        <h5>Word Bank:</h5>
                        <span class="word-option" onclick="fillBlank(this, 'software')">software</span>
                        <span class="word-option" onclick="fillBlank(this, 'hardware')">hardware</span>
                        <span class="word-option" onclick="fillBlank(this, 'network')">network</span>
                        <span class="word-option" onclick="fillBlank(this, 'internet')">internet</span>
                        <span class="word-option" onclick="fillBlank(this, 'MAC')">MAC</span>
                        <span class="word-option" onclick="fillBlank(this, 'IP')">IP</span>
                        <span class="word-option" onclick="fillBlank(this, 'USB')">USB</span>
                        <span class="word-option" onclick="fillBlank(this, 'CPU')">CPU</span>
                    </div>
                </div>
                <button class="btn" onclick="checkFillBlanks()">Check Answers</button>
                <button class="reset-btn" onclick="resetFillBlanks()">Reset</button>

                <div class="mistake-alert">
                    <h4>‚ö†Ô∏è Common Mistake</h4>
                    <p>MAC addresses are NOT the same as IP addresses! MAC addresses are permanent and burned into the NIC hardware, while IP addresses can change.</p>
                </div>
            </div>
        </div>

        <div class="section" id="section5">
            <div class="card">
                <h2>Wireless Access Point (WAP)</h2>
                
                <div class="info-box">
                    <h4>üìö Definition</h4>
                    <p>A WAP allows WiFi-enabled devices to connect to a network. Usually built into routers, and you'll see them on ceilings in schools and public buildings.</p>
                </div>

                <h3>Key Functions:</h3>
                <ul>
                    <li>Creates a wireless hotspot</li>
                    <li>Bridges wireless devices to wired network</li>
                    <li>Can extend network coverage</li>
                    <li>Supports multiple simultaneous connections</li>
                </ul>

                <div class="simulation-container">
                    <h3>WAP Coverage Simulation</h3>
                    <p>Click the WAP to see its coverage area and connected devices!</p>
                    
                    <div class="device-icon" style="left: 350px; top: 150px; width: 100px; height: 100px; background: #e6fffa; border-color: #38b2ac;" onclick="toggleWAPCoverage()" id="wap-device">
                        <div style="font-size: 48px; margin-bottom: 5px;">üì°</div>
                        <div style="font-size: 14px; font-weight: bold; color: #319795;">WAP</div>
                    </div>
                    
                    <div id="coverage-circle" style="position: absolute; width: 300px; height: 300px; border: 3px dashed #4caf50; border-radius: 50%; left: 250px; top: 50px; display: none; background: rgba(76, 175, 80, 0.1);"></div>
                    
                    <div class="device-icon" style="left: 150px; top: 100px; width: 80px; height: 80px;" id="phone1">
                        <div style="font-size: 32px;">üì±</div>
                        <div style="font-size: 11px; font-weight: bold;">Phone 1</div>
                    </div>
                    
                    <div class="device-icon" style="left: 500px; top: 100px; width: 80px; height: 80px;" id="laptop-wifi">
                        <div style="font-size: 32px;">üíª</div>
                        <div style="font-size: 11px; font-weight: bold;">Laptop</div>
                    </div>
                    
                    <div class="device-icon" style="left: 300px; top: 300px; width: 80px; height: 80px;" id="tablet1">
                        <div style="font-size: 32px;">üì±</div>
                        <div style="font-size: 11px; font-weight: bold;">Tablet</div>
                    </div>
                    
                    <div class="device-icon" style="left: 600px; top: 250px; width: 80px; height: 80px;" id="phone2">
                        <div style="font-size: 32px;">üì±</div>
                        <div style="font-size: 11px; font-weight: bold;">Phone 2</div>
                        <div style="font-size: 9px; color: #e74c3c;">(Out of range)</div>
                    </div>
                </div>

                <div class="info-box" id="wap-info" style="display: none; margin-top: 20px;">
                    <h4>üì° WAP Status</h4>
                    <p id="wap-status"></p>
                </div>

                <div class="hint-container">
                    <button class="hint-btn" onclick="toggleHint('wapHint')">Need a hint?</button>
                    <div class="hint-text" id="wapHint">
                        WAPs have limited range. The further you are, the weaker the signal. Walls and obstacles also reduce signal strength!
                    </div>
                </div>

                <button class="reset-btn" onclick="resetWAPSim()">Reset Simulation</button>
            </div>
        </div>

        <div class="section" id="section6">
            <div class="card">
                <h2>Repeater</h2>
                
                <div class="info-box">
                    <h4>üìö Definition</h4>
                    <p>A repeater receives and repeats a signal to extend its attenuation or range.</p>
                </div>

                <h3>Key Functions:</h3>
                <ul>
                    <li>Amplifies weakened signals</li>
                    <li>Extends network range</li>
                    <li>Overcomes distance limitations</li>
                    <li>Works with both wired and wireless networks</li>
                </ul>

                <div class="question">
                    <h4>Scenario: Your school WiFi doesn't reach the sports field. Which combination would work best?</h4>
                    <div class="options">
                        <div class="option" onclick="selectOption(this, 'repeater-q', 'a')">Just add more routers</div>
                        <div class="option" onclick="selectOption(this, 'repeater-q', 'b')">WAP + Repeater to extend signal</div>
                        <div class="option" onclick="selectOption(this, 'repeater-q', 'c')">Replace all cables with longer ones</div>
                        <div class="option" onclick="selectOption(this, 'repeater-q', 'd')">Install a hub in the field</div>
                    </div>
                </div>
                <button class="btn" onclick="checkRepeaterQuiz()">Check Answer</button>

                <div class="real-world">
                    <h4>üåç Real World Example</h4>
                    <p>Undersea internet cables use repeaters every 50-100km to boost signals across oceans. Without them, your Instagram photos couldn't travel from the UK to America!</p>
                </div>
            </div>
        </div>

        <div class="section" id="section7">
			<div class="card">
				<iframe src="fibrecopper.html" style="width: 100%; height: 900px; border: none; border-radius: 10px;" title="Fibre Optic vs. Copper Cable Simulation"></iframe>
				
				<button class="reset-btn" onclick="resetCablesSim()">Reset Simulation</button>
			</div>
		</div>

        <div class="section" id="section8">
            <div class="card">
                <h2>üè´ Complete Network Simulation</h2>
                <p>Now let's see how all components work together in a school network!</p>
                
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 20px; border-radius: 15px; margin: 20px 0;">
                    <div style="background: rgba(255,255,255,0.95); border-radius: 20px; padding: 20px; margin-bottom: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                        <div style="text-align: center; margin-bottom: 20px;" id="simScenarioButtons">
                            <button class="btn" style="background: #48bb78;" onclick="simStartScenario('classroom')">üìö Student visits YouTube</button>
                            <button class="btn" style="background: #48bb78;" onclick="simStartScenario('library')">üìñ Library prints to Office</button>
                            <button class="btn" style="background: #48bb78;" onclick="simStartScenario('internet')">üåê Website sends video back</button>
                        </div>
                        
                        <div style="background: #f0f4f8; border: 3px solid #5a67d8; border-radius: 15px; padding: 20px; min-height: 100px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                            <div style="text-align: center; color: #2d3748; width: 100%;">
                                <div style="font-size: 24px; font-weight: bold; color: #5a67d8; margin-bottom: 10px;" id="simStatusStep">Ready to Learn!</div>
                                <div style="font-size: 18px; line-height: 1.4; color: #2d3748; margin-bottom: 15px;" id="simStatusText">Choose a scenario above to see how the router directs information through the school network</div>
                                
                                <div style="display: none; gap: 10px; justify-content: center; margin-top: 10px;" id="simStepControls">
                                    <button class="btn" style="background: #4299e1; font-size: 18px; padding: 15px 30px;" onclick="simNextStep()" id="simBtnNext">Next Step ‚Üí</button>
                                    <button class="btn" style="background: #f56565;" onclick="simResetSimulation()">Start Over</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 250px 1fr 250px; gap: 20px; margin-bottom: 20px;">
                        <div style="display: flex; flex-direction: column; gap: 20px;">
                            <div style="background: rgba(255,255,255,0.95); border-radius: 15px; padding: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); color: #333;">
                                <div style="font-size: 18px; font-weight: bold; margin-bottom: 15px; text-align: center; color: #5a67d8;">üìö Classroom</div>
                                <div class="sim-device" id="sim-device-192.168.1.10" style="background: #f7fafc; border: 2px solid #5a67d8; border-radius: 10px; padding: 10px; margin-bottom: 10px; text-align: center; transition: all 0.3s; position: relative;">
                                    <div style="font-size: 24px; margin-bottom: 3px;">üíª</div>
                                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 3px;">Student Laptop</div>
                                    <div style="font-size: 11px; color: #718096; background: #e2e8f0; padding: 2px 6px; border-radius: 6px; display: inline-block;">192.168.1.10</div>
                                </div>
                                <div class="sim-device" id="sim-device-192.168.1.20" style="background: #f7fafc; border: 2px solid #5a67d8; border-radius: 10px; padding: 10px; margin-bottom: 10px; text-align: center; transition: all 0.3s; position: relative;">
                                    <div style="font-size: 24px; margin-bottom: 3px;">üñ•Ô∏è</div>
                                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 3px;">Teacher PC</div>
                                    <div style="font-size: 11px; color: #718096; background: #e2e8f0; padding: 2px 6px; border-radius: 6px; display: inline-block;">192.168.1.20</div>
                                </div>
                                <div class="sim-device" id="sim-device-192.168.1.30" style="background: #f7fafc; border: 2px solid #5a67d8; border-radius: 10px; padding: 10px; margin-bottom: 10px; text-align: center; transition: all 0.3s; position: relative;">
                                    <div style="font-size: 24px; margin-bottom: 3px;">üì∫</div>
                                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 3px;">Smart Board</div>
                                    <div style="font-size: 11px; color: #718096; background: #e2e8f0; padding: 2px 6px; border-radius: 6px; display: inline-block;">192.168.1.30</div>
                                </div>
                                <div class="sim-switch" id="sim-switch-classroom" style="background: #e6fffa; border: 3px solid #38b2ac; border-radius: 12px; padding: 12px; margin: 15px 0; text-align: center; transition: all 0.3s;">
                                    <div style="font-size: 20px; margin-bottom: 3px;">üîå</div>
                                    <div style="font-weight: bold; font-size: 12px; color: #319795;">Classroom Switch</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="display: flex; flex-direction: column; gap: 20px;">
                            <div style="display: flex; justify-content: center; align-items: center; min-height: 200px; position: relative;">
                                <div class="sim-router" id="sim-router" style="background: #fed7d7; border: 4px solid #fc8181; border-radius: 20px; padding: 25px; text-align: center; box-shadow: 0 10px 30px rgba(252,129,129,0.3); transition: all 0.3s;">
                                    <div style="font-size: 40px; margin-bottom: 10px;">üåê</div>
                                    <div style="font-size: 18px; font-weight: bold; color: #fc8181; margin-bottom: 10px;">SCHOOL ROUTER</div>
                                    <div style="font-size: 11px; text-align: left; color: #333;">
                                        <div><strong>Internet:</strong> 203.0.113.45</div>
                                        <div><strong>Classroom:</strong> 192.168.1.1</div>
                                        <div><strong>Library:</strong> 192.168.2.1</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="background: rgba(255,255,255,0.95); border-radius: 15px; padding: 20px; color: #333; box-shadow: 0 5px 20px rgba(0,0,0,0.2);">
                                <h3 style="color: #fc8181; text-align: center; margin-bottom: 15px; font-size: 18px;">üìã Router's Address Book</h3>
                                <div class="sim-route-item" id="sim-route-classroom" style="background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 8px; padding: 10px; margin-bottom: 8px; font-size: 14px; transition: all 0.3s;">
                                    <span style="font-weight: bold; color: #2d3748; display: block; margin-bottom: 3px;">192.168.1.x</span>
                                    <span style="color: #718096; font-size: 12px;">‚Üí Classroom network</span>
                                </div>
                                <div class="sim-route-item" id="sim-route-library" style="background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 8px; padding: 10px; margin-bottom: 8px; font-size: 14px; transition: all 0.3s;">
                                    <span style="font-weight: bold; color: #2d3748; display: block; margin-bottom: 3px;">192.168.2.x</span>
                                    <span style="color: #718096; font-size: 12px;">‚Üí Library network</span>
                                </div>
                                <div class="sim-route-item" id="sim-route-internet" style="background: #f7fafc; border: 2px solid #e2e8f0; border-radius: 8px; padding: 10px; margin-bottom: 8px; font-size: 14px; transition: all 0.3s;">
                                    <span style="font-weight: bold; color: #2d3748; display: block; margin-bottom: 3px;">Everything else</span>
                                    <span style="color: #718096; font-size: 12px;">‚Üí Internet</span>
                                </div>
                                <div style="margin-top: 15px; padding: 10px; background: #f0f4f8; border-radius: 8px; font-size: 12px; color: #4a5568; text-align: center;">
                                    <strong>üí° Remember:</strong> Switches connect devices in the same room.<br>
                                    The Router connects different rooms and the Internet!
                                </div>
                            </div>
                        </div>
                        
                        <div style="display: flex; flex-direction: column; gap: 20px;">
                            <div style="background: rgba(255,255,255,0.95); border-radius: 15px; padding: 20px; box-shadow: 0 5px 20px rgba(0,0,0,0.2); color: #333;">
                                <div style="font-size: 18px; font-weight: bold; margin-bottom: 15px; text-align: center; color: #5a67d8;">üìñ Library/Office</div>
                                <div class="sim-device" id="sim-device-192.168.2.10" style="background: #f7fafc; border: 2px solid #5a67d8; border-radius: 10px; padding: 10px; margin-bottom: 10px; text-align: center; transition: all 0.3s; position: relative;">
                                    <div style="font-size: 24px; margin-bottom: 3px;">üñ•Ô∏è</div>
                                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 3px;">Library PC</div>
                                    <div style="font-size: 11px; color: #718096; background: #e2e8f0; padding: 2px 6px; border-radius: 6px; display: inline-block;">192.168.2.10</div>
                                </div>
                                <div class="sim-device" id="sim-device-192.168.2.20" style="background: #f7fafc; border: 2px solid #5a67d8; border-radius: 10px; padding: 10px; margin-bottom: 10px; text-align: center; transition: all 0.3s; position: relative;">
                                    <div style="font-size: 24px; margin-bottom: 3px;">üñ•Ô∏è</div>
                                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 3px;">Catalog PC</div>
                                    <div style="font-size: 11px; color: #718096; background: #e2e8f0; padding: 2px 6px; border-radius: 6px; display: inline-block;">192.168.2.20</div>
                                </div>
                                <div class="sim-device" id="sim-device-192.168.2.30" style="background: #f7fafc; border: 2px solid #5a67d8; border-radius: 10px; padding: 10px; margin-bottom: 10px; text-align: center; transition: all 0.3s; position: relative;">
                                    <div style="font-size: 24px; margin-bottom: 3px;">üñ®Ô∏è</div>
                                    <div style="font-weight: bold; font-size: 12px; margin-bottom: 3px;">Office Printer</div>
                                    <div style="font-size: 11px; color: #718096; background: #e2e8f0; padding: 2px 6px; border-radius: 6px; display: inline-block;">192.168.2.30</div>
                                </div>
                                <div class="sim-switch" id="sim-switch-library" style="background: #e6fffa; border: 3px solid #38b2ac; border-radius: 12px; padding: 12px; margin: 15px 0; text-align: center; transition: all 0.3s;">
                                    <div style="font-size: 20px; margin-bottom: 3px;">üîå</div>
                                    <div style="font-weight: bold; font-size: 12px; color: #319795;">Library Switch</div>
                                </div>
                            </div>
                        </div>
                        
                        <div style="grid-column: 1 / -1; background: #bee3f8; border: 3px solid #4299e1; border-radius: 15px; padding: 20px; color: #2b6cb0; box-shadow: 0 5px 20px rgba(0,0,0,0.2);">
                            <div style="font-size: 20px; font-weight: bold; text-align: center; margin-bottom: 15px;">‚òÅÔ∏è The Internet</div>
                            <div style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">
                                <div class="sim-internet-device" id="sim-device-142.250.185.78" style="background: white; border: 2px solid #4299e1; border-radius: 10px; padding: 10px 20px; text-align: center; transition: all 0.3s;">
                                    <div style="font-size: 24px;">üìπ</div>
                                    <div style="font-weight: bold; font-size: 12px;">YouTube</div>
                                    <div style="font-size: 11px; color: #718096;">142.250.185.78</div>
                                </div>
                                <div class="sim-internet-device" id="sim-device-157.240.241.35" style="background: white; border: 2px solid #4299e1; border-radius: 10px; padding: 10px 20px; text-align: center; transition: all 0.3s;">
                                    <div style="font-size: 24px;">üìö</div>
                                    <div style="font-weight: bold; font-size: 12px;">Education Site</div>
                                    <div style="font-size: 11px; color: #718096;">157.240.241.35</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <button class="reset-btn" onclick="simResetSimulation()">Reset Simulation</button>
            </div>
        </div>

        <div class="section" id="section9">
            <div class="card">
                <h2>Practice Exam Questions</h2>
                
                <div class="exam-question">
                    <span class="marks-box">[6 marks]</span>
                    <h4>Question 1</h4>
                    <p>Explain the differences between a switch and a router in a computer network. Include in your answer:</p>
                    <ul>
                        <li>How each device identifies where to send data</li>
                        <li>What type of networks each device connects</li>
                        <li>How they handle data packets differently</li>
                    </ul>
                    
                    <div id="writingScorer">
                        <textarea id="studentAnswer" class="answer-box" rows="8" placeholder="Write your answer here..."></textarea>
                        <input type="hidden" id="keywords" value="switch,router,MAC,address,IP,network,LAN,WAN,packets,destination">
                        <button class="btn" id="analyzeBtn" onclick="analyzeWriting()">Check My Writing</button>
                        
                        <div id="resultsDashboard" style="display: none;">
                            <h3>Your Writing Feedback</h3>
                            <div style="text-align: center;">
                                <p>Overall Score:</p>
                                <div id="scoreCircle">
                                    <span id="scoreValue">0</span>
                                </div>
                            </div>
                            <div>
                                <h4>Successes:</h4>
                                <ul id="successList"></ul>
                                <h4>Areas for Improvement:</h4>
                                <ul id="improvementList"></ul>
                            </div>
                        </div>
                    </div>
                    
                    <button class="btn btn-success" onclick="showMarkScheme('q1')">Show Mark Scheme</button>
                    <div class="mark-scheme" id="markScheme-q1">
                        <h4>Mark Scheme:</h4>
                        <ul>
                            <li><strong>Switch identification (2 marks):</strong>
                                <ul>
                                    <li>Uses MAC addresses (1)</li>
                                    <li>Sends data only to intended recipient (1)</li>
                                </ul>
                            </li>
                            <li><strong>Router identification (2 marks):</strong>
                                <ul>
                                    <li>Uses IP addresses (1)</li>
                                    <li>Routes packets between networks (1)</li>
                                </ul>
                            </li>
                            <li><strong>Network connections (2 marks):</strong>
                                <ul>
                                    <li>Switch connects devices/nodes within a network (1)</li>
                                    <li>Router connects different networks/LAN to WAN (1)</li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="exam-question">
                    <span class="marks-box">[4 marks]</span>
                    <h4>Question 2</h4>
                    <p>A small business is setting up a new network. They need to connect 20 computers in one building and provide internet access. List the network components they will need and explain the purpose of each.</p>
                    
                    <textarea class="answer-box" rows="6" placeholder="List the components and their purposes..."></textarea>
                    
                    <button class="btn btn-success" onclick="showMarkScheme('q2')">Show Mark Scheme</button>
                    <div class="mark-scheme" id="markScheme-q2">
                        <h4>Mark Scheme:</h4>
                        <p>1 mark for each correct component and purpose (max 4):</p>
                        <ul>
                            <li>Router - to connect the LAN to the internet/WAN</li>
                            <li>Switch(es) - to connect all computers together in the network</li>
                            <li>NICs - hardware in each computer to connect to the network</li>
                            <li>Cables/WAP - transmission media to carry the data</li>
                        </ul>
                    </div>
                </div>

                <h3>Workspace for Calculations</h3>
                <div class="canvas-container">
                    <canvas id="drawingCanvas" width="600" height="400"></canvas>
                    <div class="canvas-controls">
                        <button class="btn btn-danger" onclick="clearCanvas()">Clear Canvas</button>
                        <input type="color" id="penColor" value="#000000" onchange="changePenColor()">
                        <input type="range" id="penSize" min="1" max="10" value="2" onchange="changePenSize()">
                    </div>
                </div>
            </div>
        </div>

        <div class="section" id="section10">
            <div class="card">
                <h2>Extension Activities</h2>
                
                <div class="extension-box">
                    <h3>üöÄ Beyond the Specification</h3>
                    <p>Ready to go deeper? Try these challenging activities!</p>
                </div>

                <div class="question">
                    <h4>1. Network Design Challenge</h4>
                    <p>Design a network for a new school building with 3 floors, 30 classrooms, and 1000 devices. Consider:</p>
                    <ul>
                        <li>Network topology and structure</li>
                        <li>Security considerations</li>
                        <li>Redundancy and failover</li>
                        <li>Future expansion</li>
                    </ul>
                    <textarea class="answer-box" rows="8" placeholder="Describe your network design..."></textarea>
                </div>

                <div class="question">
                    <h4>2. Research Task: Software-Defined Networking (SDN)</h4>
                    <p>Research SDN and explain how it's changing traditional networking. What are the advantages and challenges?</p>
                    <textarea class="answer-box" rows="6" placeholder="Your research findings..."></textarea>
                </div>

                <div class="question">
                    <h4>3. Problem Solving: Network Troubleshooting</h4>
                    <p>Users on Floor 2 can't access the internet, but Floor 1 and 3 work fine. All floors can access local network resources. What components would you check and in what order?</p>
                    <textarea class="answer-box" rows="6" placeholder="Your troubleshooting steps..."></textarea>
                </div>
            </div>
        </div>

        <div class="section" id="section11">
            <div class="summary-card">
                <h2>Lesson Summary</h2>
                
                <div class="key-takeaway">
                    <h3>üîë Key Takeaways</h3>
                    <ul>
                        <li><strong>Routers</strong> connect networks using IP addresses</li>
                        <li><strong>Switches</strong> connect devices within a network using MAC addresses</li>
                        <li><strong>Hubs</strong> are "dumb" devices that broadcast to all connected devices</li>
                        <li><strong>NICs</strong> provide the physical connection with unique MAC addresses</li>
                        <li><strong>Fiber optic</strong> offers higher speed but costs more than copper</li>
                        <li><strong>WAPs and Repeaters</strong> extend network coverage</li>
                    </ul>
                </div>

                <h3>Final Assessment</h3>
                <div class="quiz-container">
                    <div class="question">
                        <h4>1. Which device would you use to connect your home network to the internet?</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'f1', 'b')">Switch</div>
                            <div class="option" onclick="selectOption(this, 'f1', 'a')">Router</div>
                            <div class="option" onclick="selectOption(this, 'f1', 'c')">Hub</div>
                            <div class="option" onclick="selectOption(this, 'f1', 'd')">NIC</div>
                        </div>
                    </div>

                    <div class="question">
                        <h4>2. What type of address does a switch use to forward data?</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'f2', 'b')">IP address</div>
                            <div class="option" onclick="selectOption(this, 'f2', 'd')">URL</div>
                            <div class="option" onclick="selectOption(this, 'f2', 'a')">MAC address</div>
                            <div class="option" onclick="selectOption(this, 'f2', 'c')">Port number</div>
                        </div>
                    </div>

                    <div class="question">
                        <h4>3. Which transmission media uses pulses of light?</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'f3', 'b')">Copper cable</div>
                            <div class="option" onclick="selectOption(this, 'f3', 'c')">Wireless</div>
                            <div class="option" onclick="selectOption(this, 'f3', 'd')">Coaxial</div>
                            <div class="option" onclick="selectOption(this, 'f3', 'a')">Fiber optic</div>
                        </div>
                    </div>

                    <div class="question">
                        <h4>4. True or False: A hub creates a list of connected devices using their MAC addresses.</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'f4', 'a')">True</div>
                            <div class="option" onclick="selectOption(this, 'f4', 'b')">False</div>
                        </div>
                    </div>

                    <div class="question">
                        <h4>5. Which component extends the range of a signal?</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'f5', 'b')">Switch</div>
                            <div class="option" onclick="selectOption(this, 'f5', 'a')">Repeater</div>
                            <div class="option" onclick="selectOption(this, 'f5', 'c')">NIC</div>
                            <div class="option" onclick="selectOption(this, 'f5', 'd')">Hub</div>
                        </div>
                    </div>

                    <div class="question">
                        <h4>6. What is the main advantage of fiber optic over copper cables?</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'f6', 'b')">Cheaper to install</div>
                            <div class="option" onclick="selectOption(this, 'f6', 'c')">Easier to work with</div>
                            <div class="option" onclick="selectOption(this, 'f6', 'a')">Higher bandwidth and less interference</div>
                            <div class="option" onclick="selectOption(this, 'f6', 'd')">More flexible</div>
                        </div>
                    </div>

                    <div class="question">
                        <h4>7. Which device can you use to create a WiFi hotspot?</h4>
                        <div class="options">
                            <div class="option" onclick="selectOption(this, 'f7', 'b')">Hub</div>
                            <div class="option" onclick="selectOption(this, 'f7', 'a')">WAP</div>
                            <div class="option" onclick="selectOption(this, 'f7', 'c')">NIC</div>
                            <div class="option" onclick="selectOption(this, 'f7', 'd')">Repeater</div>
                        </div>
                    </div>
                </div>
                <button class="btn btn-success" onclick="checkFinalQuiz()">Check Final Assessment</button>
                <button class="reset-btn" onclick="resetFinalQuiz()">Reset Quiz</button>
            </div>
        </div>

        <div class="section" id="section12">
            <div class="card">
                <h2>Video Resources</h2>
                
                <div class="video-placeholder">
                    <h3>üìπ Video: How Routers Work</h3>
                    <p>Video content will be embedded here</p>
                    <p>Duration: 5 minutes</p>
                </div>

                <div class="video-placeholder">
                    <h3>üìπ Video: Switch vs Hub Demonstration</h3>
                    <p>Video content will be embedded here</p>
                    <p>Duration: 4 minutes</p>
                </div>

                <div class="video-placeholder">
                    <h3>üìπ Video: Fiber Optic Cable Installation</h3>
                    <p>Video content will be embedded here</p>
                    <p>Duration: 6 minutes</p>
                </div>

                <div class="video-placeholder">
                    <h3>üìπ Video: Setting Up a Home Network</h3>
                    <p>Video content will be embedded here</p>
                    <p>Duration: 8 minutes</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentSection = 0;
        let totalSections = 13; // <-- UPDATED
        let xp = 0;
        let level = 0;
        let achievements = new Set();
        let hintUsed = {};
        let fontSize = 16;
        let highContrast = false;
        let dyslexiaFont = false;

        // Answers storage
        const correctAnswers = {
            q1: 'a', q2: 'b', q3: 'a',
            'router-quick': 'a', 'repeater-q': 'b',
            f1: 'a', f2: 'a', f3: 'a', f4: 'b', f5: 'a', f6: 'a', f7: 'a'
        };

        // Switch simulation state
        let switchMACTable = {};
        let currentSwitchPacket = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeDragDrop();
            initializeCanvas();
            preventPaste();
            updateNavigation();
            
            // Mobile swipe support
            let touchStartX = 0;
            document.addEventListener('touchstart', function(e) {
                touchStartX = e.touches[0].clientX;
            });
            
            document.addEventListener('touchend', function(e) {
                let touchEndX = e.changedTouches[0].clientX;
                let diff = touchStartX - touchEndX;
                
                if (Math.abs(diff) > 50) {
                    if (diff > 0) {
                        nextSection();
                    } else {
                        previousSection();
                    }
                }
            });
        });

        // Navigation
        function showSection(index) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById('section' + index).classList.add('active');
            document.querySelectorAll('.nav-btn')[index].classList.add('active');
            
            currentSection = index;
            updateNavigation();
            
            // Initialize router simulation when showing section 2
            if (index === 2) {
                initializeRouterSimulation();
            }
        }

        function nextSection() {
            if (currentSection < totalSections - 1) {
                showSection(currentSection + 1);
            }
        }

        function previousSection() {
            if (currentSection > 0) {
                showSection(currentSection - 1);
            }
        }

        function updateNavigation() {
            document.getElementById('prevBtn').disabled = currentSection === 0;
            document.getElementById('nextBtn').disabled = currentSection === totalSections - 1;
        }

        // XP and Achievements
        function addXP(amount, reason) {
            xp += amount;
            document.getElementById('currentXP').textContent = xp;
            
            // Calculate level (100 XP per level, max level 5)
            let newLevel = Math.min(Math.floor(xp / 100), 5);
            if (newLevel > level) {
                level = newLevel;
                document.getElementById('currentLevel').textContent = level;
                showAchievement('Level Up!', 'You reached Level ' + level + '!');
            }
        }

        function showAchievement(title, description) {
            if (!achievements.has(title)) {
                achievements.add(title);
                const popup = document.getElementById('achievementPopup');
                document.getElementById('achievementText').textContent = description;
                popup.classList.add('show');
                
                setTimeout(() => {
                    popup.classList.remove('show');
                }, 3000);
                
                addXP(50, 'Achievement unlocked');
            }
        }

        // Quiz Functions
        function selectOption(element, question, answer) {
            // Remove previous selection
            element.parentElement.querySelectorAll('.option').forEach(opt => {
                opt.classList.remove('selected');
            });
            element.classList.add('selected');
            element.dataset.answer = answer;
        }

        function checkStarterQuiz() {
            let correct = 0;
            ['q1', 'q2', 'q3'].forEach(q => {
                const selected = document.querySelector(`.option.selected[onclick*="${q}"]`);
                if (selected && selected.dataset.answer === correctAnswers[q]) {
                    selected.classList.add('correct');
                    correct++;
                } else if (selected) {
                    selected.classList.add('incorrect');
                }
            });
            
            addXP(correct * 10, 'Starter quiz');
            if (correct === 3) {
                showAchievement('Perfect Start!', 'Got all starter questions correct!');
            }
        }

        function resetStarterQuiz() {
            document.querySelectorAll('#section0 .option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
        }

        // Router Simulation
        let routerSimInitialized = false;
        let routerSimState = {
            currentStep: 0,
            quizActive: false,
            selectedAnswer: null,
            showFeedback: false,
            score: 0,
            animatePacket: false,
            routingTableVisible: false,
            currentQuestion: 0,
            packetInterval: null
        };

        const routerSteps = [
            {
                title: "Introduction to Routers",
                content: "A router is a networking device that connects different networks together and directs data packets between them.",
                visual: "intro"
            },
            {
                title: "Connecting Networks",
                content: "Routers join two LANs (Local Area Networks) together, or connect a LAN to a WAN (Wide Area Network) like the Internet.",
                visual: "networks"
            },
            {
                title: "Directing Packets",
                content: "Routers use IP addresses to direct data packets to their correct destination. Each packet contains source and destination IP addresses.",
                visual: "packets"
            },
            {
                title: "Internet Connection",
                content: "Routers receive packets from the internet through their WAN port, which has a public IP address assigned by your ISP.",
                visual: "internet"
            },
            {
                title: "Private IP Addresses",
                content: "The router assigns private IP addresses (like 192.168.1.x) to devices on your local network using DHCP.",
                visual: "private"
            },
            {
                title: "Routing Table",
                content: "Routers maintain a routing table that stores information about network paths to identify the most efficient routes for data.",
                visual: "table"
            }
        ];

        const routerQuizQuestions = [
            {
                question: "What types of networks can a router connect?",
                options: [
                    "Only LANs to LANs",
                    "Only LANs to WANs",
                    "Both LANs to LANs and LANs to WANs",
                    "Only computers to the internet"
                ],
                correct: 2,
                explanation: "Routers can connect two LANs together OR connect a LAN to a WAN (like the Internet)."
            },
            {
                question: "What does a router use to direct packets to their destination?",
                options: [
                    "MAC addresses",
                    "IP addresses",
                    "Device names",
                    "Port numbers"
                ],
                correct: 1,
                explanation: "Routers use IP addresses to determine where to send data packets."
            },
            {
                question: "Which IP address type does a router assign to local network devices?",
                options: [
                    "Public IP addresses",
                    "Private IP addresses",
                    "MAC addresses",
                    "DNS addresses"
                ],
                correct: 1,
                explanation: "Routers assign private IP addresses (like 192.168.1.x) to devices on the local network."
            },
            {
                question: "What is the purpose of a routing table?",
                options: [
                    "To store passwords",
                    "To block websites",
                    "To identify efficient routes for data",
                    "To count network devices"
                ],
                correct: 2,
                explanation: "The routing table helps the router identify the most efficient paths for sending data packets."
            }
        ];

        function initializeRouterSimulation() {
            if (routerSimInitialized) return;
            routerSimInitialized = true;
            renderRouterSimulation();
        }

        function renderRouterSimulation() {
            const container = document.getElementById('routerSimulation');
            if (!container) return;

            if (routerSimState.quizActive) {
                renderRouterQuiz(container);
            } else {
                renderRouterTutorial(container);
            }
        }

        function renderRouterTutorial(container) {
            const step = routerSteps[routerSimState.currentStep];
            
            container.innerHTML = `
                <div style="max-width: 800px; margin: 0 auto;">
                    <h1 style="font-size: 28px; font-weight: bold; text-align: center; margin-bottom: 30px;">Router Functions - Interactive Tutorial</h1>
                    
                    <div style="margin-bottom: 30px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h2 style="font-size: 20px; font-weight: 600;">Step ${routerSimState.currentStep + 1} of ${routerSteps.length}</h2>
                            <button onclick="startRouterQuiz()" style="background: #10b981; color: white; padding: 8px 20px; border-radius: 8px; border: none; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                                ‚ñ∂ Take Quiz
                            </button>
                        </div>
                        
                        <div style="width: 100%; background: #e5e7eb; border-radius: 9999px; height: 8px; margin-bottom: 20px;">
                            <div style="background: #3b82f6; height: 8px; border-radius: 9999px; transition: width 0.3s; width: ${((routerSimState.currentStep + 1) / routerSteps.length) * 100}%;"></div>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 30px;">
                        <h3 style="font-size: 24px; font-weight: bold; margin-bottom: 15px;">${step.title}</h3>
                        <p style="font-size: 18px; color: #374151; margin-bottom: 20px;">${step.content}</p>
                        
                        <div id="routerVisual" style="min-height: 300px;">
                            ${renderRouterVisual(step.visual)}
                        </div>
                    </div>
                    
                    <div style="display: flex; justify-content: space-between;">
                        <button 
                            onclick="previousRouterStep()"
                            ${routerSimState.currentStep === 0 ? 'disabled' : ''}
                            style="padding: 10px 24px; border-radius: 8px; border: none; cursor: ${routerSimState.currentStep === 0 ? 'not-allowed' : 'pointer'}; background: ${routerSimState.currentStep === 0 ? '#d1d5db' : '#3b82f6'}; color: ${routerSimState.currentStep === 0 ? '#9ca3af' : 'white'};">
                            Previous
                        </button>
                        
                        <button 
                            onclick="nextRouterStep()"
                            ${routerSimState.currentStep === routerSteps.length - 1 ? 'disabled' : ''}
                            style="padding: 10px 24px; border-radius: 8px; border: none; cursor: ${routerSimState.currentStep === routerSteps.length - 1 ? 'not-allowed' : 'pointer'}; background: ${routerSimState.currentStep === routerSteps.length - 1 ? '#d1d5db' : '#3b82f6'}; color: ${routerSimState.currentStep === routerSteps.length - 1 ? '#9ca3af' : 'white'};">
                            Next
                        </button>
                    </div>
                </div>
            `;

            // Start packet animation if needed
            if (routerSimState.currentStep === 2 || routerSimState.currentStep === 3) {
                startPacketAnimation();
            } else {
                stopPacketAnimation();
            }
        }

        function renderRouterVisual(visual) {
            switch(visual) {
                case "intro":
                    return `
                        <div style="display: flex; justify-content: center; align-items: center; height: 256px; background: linear-gradient(to bottom right, #dbeafe, #e9d5ff); border-radius: 8px;">
                            <div style="position: relative;">
                                <div style="width: 128px; height: 128px; background: #2563eb; border-radius: 8px; display: flex; align-items: center; justify-content: center; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); transform: scale(1); transition: transform 0.3s;">
                                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                        <path d="M5 12.55a11 11 0 0 1 14 0"></path>
                                        <path d="M1.42 9a16 16 0 0 1 21.16 0"></path>
                                        <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                                        <line x1="12" y1="20" x2="12.01" y2="20"></line>
                                    </svg>
                                </div>
                                <div style="position: absolute; top: -8px; right: -8px; background: #10b981; border-radius: 50%; padding: 4px;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3">
                                        <polyline points="20 6 9 17 4 12"></polyline>
                                    </svg>
                                </div>
                            </div>
                        </div>
                    `;
                
                case "networks":
                    return `
                        <div style="display: flex; justify-content: center; align-items: center; height: 256px; background: linear-gradient(to bottom right, #dbeafe, #e9d5ff); border-radius: 8px; padding: 32px;">
                            <div style="display: flex; align-items: center; gap: 32px;">
                                <div style="text-align: center;">
                                    <div style="width: 96px; height: 96px; background: #10b981; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 8px;">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                            <line x1="8" y1="21" x2="16" y2="21"></line>
                                            <line x1="12" y1="17" x2="12" y2="21"></line>
                                        </svg>
                                    </div>
                                    <p style="font-size: 14px; font-weight: 600;">LAN 1</p>
                                </div>
                                <div style="display: flex; flex-direction: column; align-items: center;">
                                    <div style="width: 80px; height: 80px; background: #2563eb; border-radius: 8px; display: flex; align-items: center; justify-content: center;">
                                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                            <path d="M5 12.55a11 11 0 0 1 14 0"></path>
                                            <path d="M1.42 9a16 16 0 0 1 21.16 0"></path>
                                            <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                                            <line x1="12" y1="20" x2="12.01" y2="20"></line>
                                        </svg>
                                    </div>
                                    <p style="font-size: 14px; font-weight: 600; margin-top: 8px;">Router</p>
                                </div>
                                <div style="text-align: center;">
                                    <div style="width: 96px; height: 96px; background: #7c3aed; border-radius: 8px; display: flex; align-items: center; justify-content: center; margin-bottom: 8px;">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <line x1="2" y1="12" x2="22" y2="12"></line>
                                            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                                        </svg>
                                    </div>
                                    <p style="font-size: 14px; font-weight: 600;">WAN/Internet</p>
                                </div>
                            </div>
                        </div>
                    `;
                
                case "packets":
                    return `
                        <div style="display: flex; justify-content: center; align-items: center; height: 256px; background: linear-gradient(to bottom right, #dbeafe, #e9d5ff); border-radius: 8px; padding: 32px;">
                            <div style="position: relative; display: flex; align-items: center; gap: 48px;">
                                <div style="text-align: center;">
                                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#4b5563" stroke-width="2">
                                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                        <line x1="8" y1="21" x2="16" y2="21"></line>
                                        <line x1="12" y1="17" x2="12" y2="21"></line>
                                    </svg>
                                    <p style="font-size: 12px; margin-top: 8px;">192.168.1.10</p>
                                </div>
                                <div style="position: relative;">
                                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#2563eb" stroke-width="2">
                                        <path d="M5 12.55a11 11 0 0 1 14 0"></path>
                                        <path d="M1.42 9a16 16 0 0 1 21.16 0"></path>
                                        <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                                        <line x1="12" y1="20" x2="12.01" y2="20"></line>
                                    </svg>
                                    <div id="animatedPacket" style="position: absolute; top: 50%; transform: translateY(-50%); left: -64px; transition: all 1s; background: #fbbf24; border-radius: 4px; padding: 4px 8px; font-size: 12px; font-weight: bold;">
                                        Packet
                                    </div>
                                </div>
                                <div style="text-align: center;">
                                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="#4b5563" stroke-width="2">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <line x1="2" y1="12" x2="22" y2="12"></line>
                                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                                    </svg>
                                    <p style="font-size: 12px; margin-top: 8px;">8.8.8.8</p>
                                </div>
                            </div>
                        </div>
                    `;
                
                case "internet":
                    return `
                        <div style="display: flex; justify-content: center; align-items: center; height: 256px; background: linear-gradient(to bottom right, #dbeafe, #e9d5ff); border-radius: 8px; padding: 32px;">
                            <div style="text-align: center;">
                                <div style="position: relative;">
                                    <svg width="96" height="96" viewBox="0 0 24 24" fill="none" stroke="#7c3aed" stroke-width="2" style="margin-bottom: 16px;">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <line x1="2" y1="12" x2="22" y2="12"></line>
                                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                                    </svg>
                                    <div id="internetArrow" style="position: absolute; top: 0; right: 0; transition: all 1s; opacity: 0;">
                                        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2" style="transform: rotate(90deg);">
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                            <polyline points="12 5 19 12 12 19"></polyline>
                                        </svg>
                                    </div>
                                </div>
                                <div style="background: #2563eb; border-radius: 8px; padding: 16px; color: white;">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" style="margin: 0 auto 8px;">
                                        <path d="M5 12.55a11 11 0 0 1 14 0"></path>
                                        <path d="M1.42 9a16 16 0 0 1 21.16 0"></path>
                                        <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                                        <line x1="12" y1="20" x2="12.01" y2="20"></line>
                                    </svg>
                                    <p style="font-size: 14px; font-weight: bold;">Public IP: 86.142.78.234</p>
                                </div>
                            </div>
                        </div>
                    `;
                
                case "private":
                    return `
                        <div style="display: flex; flex-direction: column; align-items: center; height: 256px; background: linear-gradient(to bottom right, #dbeafe, #e9d5ff); border-radius: 8px; padding: 32px;">
                            <div style="background: #2563eb; border-radius: 8px; padding: 12px; margin-bottom: 16px;">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                    <path d="M5 12.55a11 11 0 0 1 14 0"></path>
                                    <path d="M1.42 9a16 16 0 0 1 21.16 0"></path>
                                    <path d="M8.53 16.11a6 6 0 0 1 6.95 0"></path>
                                    <line x1="12" y1="20" x2="12.01" y2="20"></line>
                                </svg>
                            </div>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px;">
                                ${['192.168.1.10', '192.168.1.11', '192.168.1.12'].map((ip, index) => `
                                    <div style="text-align: center;">
                                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#4b5563" stroke-width="2" style="margin-bottom: 4px;">
                                            <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                                            <line x1="8" y1="21" x2="16" y2="21"></line>
                                            <line x1="12" y1="17" x2="12" y2="21"></line>
                                        </svg>
                                        <p style="font-size: 12px; background: #bbf7d0; border-radius: 4px; padding: 2px 8px;">${ip}</p>
                                    </div>
                                `).join('')}
                            </div>
                            <p style="font-size: 14px; margin-top: 16px; color: #4b5563;">Router assigns private IPs using DHCP</p>
                        </div>
                    `;
                
                case "table":
                    return `
                        <div style="display: flex; flex-direction: column; align-items: center; height: 256px; background: linear-gradient(to bottom right, #dbeafe, #e9d5ff); border-radius: 8px; padding: 16px;">
                            <button 
                                onclick="toggleRoutingTable()"
                                style="background: #2563eb; color: white; padding: 8px 16px; border-radius: 8px; margin-bottom: 16px; border: none; cursor: pointer;">
                                ${routerSimState.routingTableVisible ? 'Hide' : 'Show'} Routing Table
                            </button>
                            <div id="routingTableContent" style="${routerSimState.routingTableVisible ? '' : 'display: none;'} background: white; border-radius: 8px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); padding: 16px; width: 100%; max-width: 448px;">
                                <h3 style="font-weight: bold; margin-bottom: 8px;">Routing Table</h3>
                                <table style="width: 100%; font-size: 14px;">
                                    <thead>
                                        <tr style="border-bottom: 1px solid #e5e7eb;">
                                            <th style="text-align: left; padding: 4px;">Destination</th>
                                            <th style="text-align: left; padding: 4px;">Next Hop</th>
                                            <th style="text-align: left; padding: 4px;">Interface</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="border-bottom: 1px solid #e5e7eb;">
                                            <td style="padding: 4px;">192.168.1.0</td>
                                            <td style="padding: 4px;">Direct</td>
                                            <td style="padding: 4px;">LAN</td>
                                        </tr>
                                        <tr style="border-bottom: 1px solid #e5e7eb;">
                                            <td style="padding: 4px;">10.0.0.0</td>
                                            <td style="padding: 4px;">192.168.1.254</td>
                                            <td style="padding: 4px;">LAN</td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 4px;">0.0.0.0</td>
                                            <td style="padding: 4px;">86.142.78.1</td>
                                            <td style="padding: 4px;">WAN</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    `;
                
                default:
                    return '';
            }
        }

        function renderRouterQuiz(container) {
            if (routerSimState.currentQuestion >= routerQuizQuestions.length) {
                container.innerHTML = `
                    <div style="max-width: 800px; margin: 0 auto;">
                        <div style="background: white; border-radius: 8px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); padding: 32px; text-align: center;">
                            <h2 style="font-size: 28px; font-weight: bold; margin-bottom: 16px;">Quiz Complete!</h2>
                            <p style="font-size: 20px; margin-bottom: 24px;">Your score: ${routerSimState.score} out of ${routerQuizQuestions.length}</p>
                            <div style="display: flex; justify-content: center; gap: 16px;">
                                <button 
                                    onclick="resetRouterQuiz()"
                                    style="background: #2563eb; color: white; padding: 8px 24px; border-radius: 8px; border: none; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                                    üîÑ Try Again
                                </button>
                                <button 
                                    onclick="backToRouterTutorial()"
                                    style="background: #6b7280; color: white; padding: 8px 24px; border-radius: 8px; border: none; cursor: pointer;">
                                    Back to Tutorial
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                // Award XP for completing quiz
                addXP(routerSimState.score * 10, 'Router quiz score');
                if (routerSimState.score === routerQuizQuestions.length) {
                    showAchievement('Router Master!', 'Perfect score on the router quiz!');
                }
                return;
            }

            const question = routerQuizQuestions[routerSimState.currentQuestion];
            
            container.innerHTML = `
                <div style="max-width: 800px; margin: 0 auto;">
                    <div style="background: white; border-radius: 8px; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); padding: 32px;">
                        <div style="margin-bottom: 24px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                                <h2 style="font-size: 24px; font-weight: bold;">Quiz Time!</h2>
                                <span style="color: #6b7280;">Question ${routerSimState.currentQuestion + 1} of ${routerQuizQuestions.length}</span>
                            </div>
                            <div style="width: 100%; background: #e5e7eb; border-radius: 9999px; height: 8px;">
                                <div style="background: #2563eb; height: 8px; border-radius: 9999px; transition: width 0.3s; width: ${((routerSimState.currentQuestion + 1) / routerQuizQuestions.length) * 100}%;"></div>
                            </div>
                        </div>
                        
                        <h3 style="font-size: 20px; margin-bottom: 24px;">${question.question}</h3>
                        
                        <div style="display: flex; flex-direction: column; gap: 12px; margin-bottom: 24px;">
                            ${question.options.map((option, index) => `
                                <button
                                    onclick="handleRouterAnswer(${index})"
                                    ${routerSimState.showFeedback ? 'disabled' : ''}
                                    style="width: 100%; text-align: left; padding: 16px; border-radius: 8px; border: 2px solid; transition: all 0.3s; cursor: ${routerSimState.showFeedback ? 'not-allowed' : 'pointer'}; 
                                        ${routerSimState.showFeedback
                                            ? index === question.correct
                                                ? 'border-color: #10b981; background: #d1fae5;'
                                                : index === routerSimState.selectedAnswer
                                                ? 'border-color: #ef4444; background: #fee2e2;'
                                                : 'border-color: #d1d5db; background: #f3f4f6;'
                                            : 'border-color: #d1d5db; background: white;'
                                        }">
                                    <div style="display: flex; align-items: center; justify-content: space-between;">
                                        <span>${option}</span>
                                        ${routerSimState.showFeedback && index === question.correct ? '‚úì' : ''}
                                        ${routerSimState.showFeedback && index === routerSimState.selectedAnswer && index !== question.correct ? '‚úó' : ''}
                                    </div>
                                </button>
                            `).join('')}
                        </div>
                        
                        ${routerSimState.showFeedback ? `
                            <div style="padding: 16px; border-radius: 8px; margin-bottom: 16px; background: ${routerSimState.selectedAnswer === question.correct ? '#d1fae5' : '#fef3c7'};">
                                <p style="font-weight: 600; margin-bottom: 4px;">
                                    ${routerSimState.selectedAnswer === question.correct ? 'Correct!' : 'Not quite right.'}
                                </p>
                                <p style="font-size: 14px;">${question.explanation}</p>
                            </div>
                            
                            <button 
                                onclick="nextRouterQuestion()"
                                style="background: #2563eb; color: white; padding: 8px 24px; border-radius: 8px; border: none; cursor: pointer;">
                                ${routerSimState.currentQuestion < routerQuizQuestions.length - 1 ? 'Next Question' : 'See Results'}
                            </button>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        function startPacketAnimation() {
            if (routerSimState.packetInterval) return;
            
            routerSimState.packetInterval = setInterval(() => {
                routerSimState.animatePacket = !routerSimState.animatePacket;
                const packet = document.getElementById('animatedPacket');
                if (packet) {
                    packet.style.left = routerSimState.animatePacket ? '100%' : '-64px';
                }
                const arrow = document.getElementById('internetArrow');
                if (arrow) {
                    arrow.style.opacity = routerSimState.animatePacket ? '1' : '0';
                    arrow.style.transform = `translateY(${routerSimState.animatePacket ? '64px' : '0'})`;
                }
            }, 2000);
        }

        function stopPacketAnimation() {
            if (routerSimState.packetInterval) {
                clearInterval(routerSimState.packetInterval);
                routerSimState.packetInterval = null;
            }
        }

        function previousRouterStep() {
            if (routerSimState.currentStep > 0) {
                routerSimState.currentStep--;
                renderRouterSimulation();
            }
        }

        function nextRouterStep() {
            if (routerSimState.currentStep < routerSteps.length - 1) {
                routerSimState.currentStep++;
                renderRouterSimulation();
            }
        }

        function toggleRoutingTable() {
            routerSimState.routingTableVisible = !routerSimState.routingTableVisible;
            const tableContent = document.getElementById('routingTableContent');
            if (tableContent) {
                tableContent.style.display = routerSimState.routingTableVisible ? 'block' : 'none';
            }
        }

        function startRouterQuiz() {
            routerSimState.quizActive = true;
            routerSimState.currentQuestion = 0;
            routerSimState.score = 0;
            routerSimState.selectedAnswer = null;
            routerSimState.showFeedback = false;
            renderRouterSimulation();
        }

        function handleRouterAnswer(index) {
            if (routerSimState.showFeedback) return;
            
            routerSimState.selectedAnswer = index;
            routerSimState.showFeedback = true;
            if (index === routerQuizQuestions[routerSimState.currentQuestion].correct) {
                routerSimState.score++;
            }
            renderRouterSimulation();
        }

        function nextRouterQuestion() {
            routerSimState.currentQuestion++;
            routerSimState.selectedAnswer = null;
            routerSimState.showFeedback = false;
            renderRouterSimulation();
        }

        function resetRouterQuiz() {
            routerSimState.currentQuestion = 0;
            routerSimState.score = 0;
            routerSimState.selectedAnswer = null;
            routerSimState.showFeedback = false;
            renderRouterSimulation();
        }

        function backToRouterTutorial() {
            routerSimState.quizActive = false;
            routerSimState.currentStep = 0;
            renderRouterSimulation();
        }

        function checkRouterQuickCheck() {
            const selected = document.querySelector('.option.selected[onclick*="router-quick"]');
            if (selected && selected.dataset.answer === correctAnswers['router-quick']) {
                selected.classList.add('correct');
                addXP(15, 'Router quiz correct');
            } else if (selected) {
                selected.classList.add('incorrect');
            }
        }

        function resetRouterSim() {
            stopPacketAnimation();
            routerSimState = {
                currentStep: 0,
                quizActive: false,
                selectedAnswer: null,
                showFeedback: false,
                score: 0,
                animatePacket: false,
                routingTableVisible: false,
                currentQuestion: 0,
                packetInterval: null
            };
            routerSimInitialized = false;
            document.getElementById('routerSimulation').innerHTML = '';
            document.querySelectorAll('#section2 .option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
        }

        function sendSwitchPacket(source) {
            // Clear previous packets
            if (currentSwitchPacket) currentSwitchPacket.remove();
            
            // Update MAC table
            const sourceMAC = {
                'laptop1': 'AA:BB:CC:11',
                'laptop2': 'AA:BB:CC:22',
                'printer': 'AA:BB:CC:33',
                'server': 'AA:BB:CC:44'
            };
            
            switchMACTable[source] = sourceMAC[source];
            updateMACTable();
            
            // Create packet
            const packet = document.createElement('div');
            packet.className = 'data-packet';
            packet.textContent = 'üìß';
            currentSwitchPacket = packet;
            
            const sourceEl = document.getElementById(source);
            const switchEl = document.getElementById('switch-device');
            
            const sourceRect = sourceEl.getBoundingClientRect();
            const containerRect = sourceEl.parentElement.getBoundingClientRect();
            
            // Position packet at center of source device
            packet.style.left = (sourceRect.left - containerRect.left + sourceRect.width/2 - 15) + 'px';
            packet.style.top = (sourceRect.top - containerRect.top + sourceRect.height/2 - 15) + 'px';
            
            sourceEl.parentElement.appendChild(packet);
            
            // Animate to switch
            setTimeout(() => {
                const switchRect = switchEl.getBoundingClientRect();
                packet.style.left = (switchRect.left - containerRect.left + switchRect.width/2 - 15) + 'px';
                packet.style.top = (switchRect.top - containerRect.top + switchRect.height/2 - 15) + 'px';
                
                switchEl.classList.add('active');
                
                // Randomly select destination
                const devices = ['laptop1', 'laptop2', 'printer', 'server'].filter(d => d !== source);
                const destination = devices[Math.floor(Math.random() * devices.length)];
                
                // Animate to destination
                setTimeout(() => {
                    const destEl = document.getElementById(destination);
                    const destRect = destEl.getBoundingClientRect();
                    packet.style.left = (destRect.left - containerRect.left + destRect.width/2 - 15) + 'px';
                    packet.style.top = (destRect.top - containerRect.top + destRect.height/2 - 15) + 'px';
                    
                    destEl.classList.add('active');
                    
                    // Show result
                    setTimeout(() => {
                        packet.remove();
                        switchEl.classList.remove('active');
                        switchEl.style.background = '#e6fffa';
                        switchEl.style.borderColor = '#38b2ac';
                        destEl.classList.remove('active');
                        
                        if (!achievements.has('Switch Master')) {
                            showAchievement('Switch Master!', 'Successfully sent data through a switch!');
                        }
                    }, 1000);
                }, 1000);
            }, 100);
        }

        function updateMACTable() {
            const tableContent = document.getElementById('mac-table-content');
            if (Object.keys(switchMACTable).length === 0) {
                tableContent.innerHTML = '<p style="color: #666;">Click devices to see the switch learn their addresses!</p>';
            } else {
                let html = '<table style="width: 100%; border-collapse: collapse;">';
                html += '<tr><th style="border: 1px solid #ddd; padding: 8px;">Port</th><th style="border: 1px solid #ddd; padding: 8px;">MAC Address</th><th style="border: 1px solid #ddd; padding: 8px;">Device</th></tr>';
                
                let port = 1;
                for (let device in switchMACTable) {
                    html += `<tr><td style="border: 1px solid #ddd; padding: 8px;">${port}</td><td style="border: 1px solid #ddd; padding: 8px;">${switchMACTable[device]}</td><td style="border: 1px solid #ddd; padding: 8px;">${device}</td></tr>`;
                    port++;
                }
                html += '</table>';
                tableContent.innerHTML = html;
            }
        }

        function resetSwitchSim() {
            switchMACTable = {};
            updateMACTable();
            if (currentSwitchPacket) currentSwitchPacket.remove();
            document.querySelectorAll('#section3 .device-icon').forEach(d => {
                d.classList.remove('active');
                // Reset background colors for special devices
                if (d.id === 'switch-device') {
                    d.style.background = '#e6fffa';
                    d.style.borderColor = '#38b2ac';
                }
            });
        }

        // WAP Simulation
        let wapActive = false;

        function toggleWAPCoverage() {
            const coverage = document.getElementById('coverage-circle');
            const wapDevice = document.getElementById('wap-device');
            const infoBox = document.getElementById('wap-info');
            const statusText = document.getElementById('wap-status');
            
            wapActive = !wapActive;
            
            if (wapActive) {
                coverage.style.display = 'block';
                wapDevice.classList.add('active');
                infoBox.style.display = 'block';
                
                // Check which devices are in range
                const inRange = ['phone1', 'laptop-wifi', 'tablet1'];
                const outOfRange = ['phone2'];
                
                inRange.forEach(device => {
                    document.getElementById(device).classList.add('active');
                });
                
                statusText.textContent = `WAP Active: ${inRange.length} devices connected. ${outOfRange.length} device out of range.`;
                
                addXP(15, 'Explored WAP coverage');
            } else {
                coverage.style.display = 'none';
                wapDevice.classList.remove('active');
                wapDevice.style.background = '#e6fffa';
                wapDevice.style.borderColor = '#38b2ac';
                infoBox.style.display = 'none';
                
                document.querySelectorAll('#section6 .device-icon').forEach(d => d.classList.remove('active'));
            }
        }

        function resetWAPSim() {
            wapActive = false;
            document.getElementById('coverage-circle').style.display = 'none';
            document.getElementById('wap-info').style.display = 'none';
            document.querySelectorAll('#section6 .device-icon').forEach(d => {
                d.classList.remove('active');
                // Reset background colors for special devices
                if (d.id === 'wap-device') {
                    d.style.background = '#e6fffa';
                    d.style.borderColor = '#38b2ac';
                }
            });
        }

        // Repeater Quiz
        function checkRepeaterQuiz() {
            const selected = document.querySelector('.option.selected[onclick*="repeater-q"]');
            if (selected && selected.dataset.answer === correctAnswers['repeater-q']) {
                selected.classList.add('correct');
                addXP(15, 'Repeater quiz correct');
            } else if (selected) {
                selected.classList.add('incorrect');
            }
        }

        // Drag and Drop
        function initializeDragDrop() {
            const draggables = document.querySelectorAll('.draggable');
            const dropSlots = document.querySelectorAll('.drop-slot');
            
            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', dragStart);
                draggable.addEventListener('dragend', dragEnd);
                
                // Touch support
                draggable.addEventListener('touchstart', touchStart);
                draggable.addEventListener('touchmove', touchMove);
                draggable.addEventListener('touchend', touchEnd);
            });
            
            dropSlots.forEach(slot => {
                slot.addEventListener('dragover', dragOver);
                slot.addEventListener('drop', dragDrop);
                slot.addEventListener('dragleave', dragLeave);
            });
        }

        let draggedElement = null;

        function dragStart(e) {
            draggedElement = this;
            this.classList.add('dragging');
        }

        function dragEnd(e) {
            this.classList.remove('dragging');
        }

        function dragOver(e) {
            e.preventDefault();
            this.classList.add('drag-over');
        }

        function dragLeave(e) {
            this.classList.remove('drag-over');
        }

        function dragDrop(e) {
            e.preventDefault();
            this.classList.remove('drag-over');
            
            if (this.children.length === 0 && draggedElement) {
                this.appendChild(draggedElement);
                this.classList.add('filled');
            }
        }

        // Touch support for drag and drop
        function touchStart(e) {
            draggedElement = this;
            this.classList.add('dragging');
        }

        function touchMove(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const elementBelow = document.elementFromPoint(touch.clientX, touch.clientY);
            
            if (elementBelow && elementBelow.classList.contains('drop-slot')) {
                elementBelow.classList.add('drag-over');
            }
        }

        function touchEnd(e) {
            const touch = e.changedTouches[0];
            const elementBelow = document.elementFromPoint(touch.clientX, touch.clientY);
            
            if (elementBelow && elementBelow.classList.contains('drop-slot') && elementBelow.children.length === 0) {
                elementBelow.appendChild(draggedElement);
                elementBelow.classList.add('filled');
            }
            
            draggedElement.classList.remove('dragging');
            document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
        }

        function checkDragDrop() {
            let correct = 0;
            document.querySelectorAll('.drop-slot').forEach(slot => {
                const item = slot.querySelector('.draggable');
                if (item && item.dataset.answer === slot.dataset.device) {
                    correct++;
                    slot.style.borderColor = '#4caf50';
                } else if (item) {
                    slot.style.borderColor = '#f44336';
                }
            });
            
            addXP(correct * 5, 'Drag and drop activity');
            if (correct === 6) {
                showAchievement('Sorting Master!', 'Correctly sorted all switch and hub features!');
            }
        }

        function resetDragDrop() {
            const dragSource = document.querySelector('.drag-source');
            document.querySelectorAll('.draggable').forEach(item => {
                dragSource.appendChild(item);
            });
            
            document.querySelectorAll('.drop-slot').forEach(slot => {
                slot.classList.remove('filled');
                slot.style.borderColor = '';
            });
        }

        // Fill in the blanks
        let selectedBlank = null;

        function fillBlank(wordElement, word) {
            if (selectedBlank && !wordElement.classList.contains('used')) {
                selectedBlank.textContent = word;
                selectedBlank.dataset.filled = word;
                wordElement.classList.add('used');
                selectedBlank = null;
            }
        }

        document.querySelectorAll('.fill-blank').forEach(blank => {
            blank.addEventListener('click', function() {
                selectedBlank = this;
                document.querySelectorAll('.fill-blank').forEach(b => b.style.borderColor = '#667eea');
                this.style.borderColor = '#ffd700';
            });
        });

        function checkFillBlanks() {
            let correct = 0;
            document.querySelectorAll('.fill-blank').forEach(blank => {
                if (blank.dataset.filled && blank.dataset.filled.toLowerCase() === blank.dataset.answer.toLowerCase()) {
                    blank.style.backgroundColor = '#e8f5e9';
                    correct++;
                } else {
                    blank.style.backgroundColor = '#ffebee';
                }
            });
            
            addXP(correct * 10, 'Fill in the blanks');
        }

        function resetFillBlanks() {
            document.querySelectorAll('.fill-blank').forEach(blank => {
                blank.textContent = '';
                blank.dataset.filled = '';
                blank.style.backgroundColor = '';
            });
            
            document.querySelectorAll('.word-option').forEach(word => {
                word.classList.remove('used');
            });
        }

        // Cable Comparison functions (removed as now using iframe)
        function resetCablesSim() {
            // Reset the iframe to reload the simulation
            const iframe = document.getElementById('cablesSimulation');
            iframe.srcdoc = iframe.srcdoc;
        }

        // Final Quiz
        function checkFinalQuiz() {
            let correct = 0;
            ['f1', 'f2', 'f3', 'f4', 'f5', 'f6', 'f7'].forEach(q => {
                const selected = document.querySelector(`.option.selected[onclick*="${q}"]`);
                if (selected && selected.dataset.answer === correctAnswers[q]) {
                    selected.classList.add('correct');
                    correct++;
                } else if (selected) {
                    selected.classList.add('incorrect');
                }
            });
            
            addXP(correct * 15, 'Final assessment');
            
            if (correct === 7) {
                showAchievement('Master of Networks!', 'Perfect score on the final assessment!');
            } else if (correct >= 5) {
                showAchievement('Network Expert!', 'Great performance on the final assessment!');
            }
        }

        function resetFinalQuiz() {
            document.querySelectorAll('#section12 .option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });
        }

        // Canvas Drawing
        let canvas, ctx;
        let isDrawing = false;
        let penColor = '#000000';
        let penSize = 2;

        function initializeCanvas() {
            canvas = document.getElementById('drawingCanvas');
            if (!canvas) return;
            
            ctx = canvas.getContext('2d');
            
            // Set canvas size properly
            canvas.width = 600;
            canvas.height = 400;
            
            // Mouse events
            canvas.addEventListener('mousedown', startDrawing);
            canvas.addEventListener('mousemove', draw);
            canvas.addEventListener('mouseup', stopDrawing);
            canvas.addEventListener('mouseout', stopDrawing);
            
            // Touch events for mobile/stylus
            canvas.addEventListener('touchstart', handleTouchStart, {passive: false});
            canvas.addEventListener('touchmove', handleTouchMove, {passive: false});
            canvas.addEventListener('touchend', stopDrawing);
        }

        function startDrawing(e) {
            isDrawing = true;
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) * (canvas.width / rect.width);
            const y = (e.clientY - rect.top) * (canvas.height / rect.height);
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const rect = canvas.getBoundingClientRect();
            const x = (e.clientX - rect.left) * (canvas.width / rect.width);
            const y = (e.clientY - rect.top) * (canvas.height / rect.height);
            
            ctx.lineWidth = penSize;
            ctx.strokeStyle = penColor;
            ctx.lineCap = 'round';
            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        function stopDrawing() {
            if (isDrawing) {
                isDrawing = false;
                ctx.beginPath();
            }
        }

        function handleTouchStart(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousedown', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function handleTouchMove(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const mouseEvent = new MouseEvent('mousemove', {
                clientX: touch.clientX,
                clientY: touch.clientY
            });
            canvas.dispatchEvent(mouseEvent);
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        }

        function changePenColor() {
            penColor = document.getElementById('penColor').value;
        }

        function changePenSize() {
            penSize = document.getElementById('penSize').value;
        }

        // Writing Analyzer
        function analyzeWriting() {
            const text = document.getElementById('studentAnswer').value;
            const keywords = document.getElementById('keywords').value.split(',');
            
            if (!text.trim()) {
                alert('Please enter some text to analyze.');
                return;
            }
            
            let score = 100;
            let successes = [];
            let improvements = [];
            
            // Check first letter capitalization
            if (text.charAt(0) === text.charAt(0).toUpperCase() && isNaN(text.charAt(0))) {
                successes.push('‚úîÔ∏è Started with a capital letter.');
            } else {
                score -= 15;
                improvements.push('‚ùå Your answer should begin with a capital letter.');
            }
            
            // Split into sentences
            const sentences = text.match(/[^.!?]+[.!?]+/g) || [];
            
            sentences.forEach((sentence, index) => {
                // Check sentence capitalization
                const trimmed = sentence.trim();
                if (trimmed.charAt(0) !== trimmed.charAt(0).toUpperCase()) {
                    score -= 5;
                    improvements.push('‚ùå Sentence ' + (index + 1) + ' needs a capital letter.');
                }
                
                // Check punctuation
                const lastChar = trimmed.charAt(trimmed.length - 1);
                if (!['.', '!', '?'].includes(lastChar)) {
                    score -= 10;
                    improvements.push('‚ùå Sentence ' + (index + 1) + ' is missing punctuation.');
                }
                
                // Check sentence length
                const words = trimmed.split(' ').length;
                if (words < 4) {
                    score -= 10;
                    improvements.push('‚ùå Sentence ' + (index + 1) + ' seems too short.');
                }
            });
            
            // Check for "I think"
            if (/i think/i.test(text)) {
                improvements.push('üí° For formal answers, avoid "I think" to sound more confident.');
            }
            
            // Check keywords
            let foundKeywords = [];
            keywords.forEach(keyword => {
                if (text.toLowerCase().includes(keyword.toLowerCase())) {
                    foundKeywords.push(keyword);
                }
            });
            
            if (foundKeywords.length > 0) {
                successes.push('‚úîÔ∏è You included key terms: ' + foundKeywords.join(', '));
                addXP(foundKeywords.length * 5, 'Using keywords');
            }
            
            // Update display
            score = Math.max(0, score);
            document.getElementById('scoreValue').textContent = score;
            
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.className = '';
            if (score > 75) {
                scoreCircle.classList.add('high-score');
            } else if (score > 50) {
                scoreCircle.classList.add('medium-score');
            } else {
                scoreCircle.classList.add('low-score');
            }
            
            // Update lists
            const successList = document.getElementById('successList');
            const improvementList = document.getElementById('improvementList');
            
            successList.innerHTML = '';
            improvementList.innerHTML = '';
            
            successes.forEach(success => {
                const li = document.createElement('li');
                li.textContent = success;
                successList.appendChild(li);
            });
            
            improvements.forEach(improvement => {
                const li = document.createElement('li');
                li.textContent = improvement;
                improvementList.appendChild(li);
            });
            
            if (improvements.length === 0) {
                const li = document.createElement('li');
                li.textContent = '‚úîÔ∏è Great work! No major issues found.';
                improvementList.appendChild(li);
            }
            
            document.getElementById('resultsDashboard').style.display = 'block';
        }

        // Mark Scheme
        function showMarkScheme(questionId) {
            const answerBox = event.target.previousElementSibling.querySelector('.answer-box');
            if (answerBox && answerBox.value.length < 50) {
                alert('Please write a more detailed answer before viewing the mark scheme.');
                return;
            }
            
            document.getElementById('markScheme-' + questionId).style.display = 'block';
        }

        // Hints
        function toggleHint(hintId) {
            const hint = document.getElementById(hintId);
            hint.style.display = hint.style.display === 'none' ? 'block' : 'none';
            
            if (!hintUsed[hintId]) {
                hintUsed[hintId] = true;
                addXP(-5, 'Used hint'); // Reduced XP for using hint
            }
        }

        // Paste Prevention
        function preventPaste() {
            document.addEventListener('paste', function(e) {
                e.preventDefault();
                const warning = document.getElementById('pasteWarning');
                warning.style.display = 'block';
                setTimeout(() => {
                    warning.style.display = 'none';
                }, 2000);
                return false;
            });
            
            // Prevent other paste methods
            document.addEventListener('drop', e => e.preventDefault());
            document.addEventListener('contextmenu', e => e.preventDefault());
        }

        // Feedback System
        function openFeedback() {
            document.getElementById('feedbackModal').style.display = 'flex';
        }

        function closeFeedback() {
            document.getElementById('feedbackModal').style.display = 'none';
        }

        function sendFeedback() {
            const feedbackText = document.getElementById('feedbackText').value;
            const currentPage = document.querySelector('.section.active h2').textContent;
            
            // Simulate sending email
            const emailBody = `Feedback from Network Components Lesson\n\nPage: ${currentPage}\n\nFeedback: ${feedbackText}`;
            
            // In real implementation, this would send to server
            console.log('Sending to millingtond@mgs.org:', emailBody);
            
            alert('Thank you for your feedback! It has been sent.');
            closeFeedback();
            document.getElementById('feedbackText').value = '';
        }

        // Accessibility
        function changeFontSize(delta) {
            fontSize += delta;
            fontSize = Math.max(12, Math.min(24, fontSize));
            document.body.style.fontSize = fontSize + 'px';
        }

        function toggleHighContrast() {
            highContrast = !highContrast;
            document.body.classList.toggle('high-contrast');
        }

        function toggleDyslexiaFont() {
            dyslexiaFont = !dyslexiaFont;
            document.body.classList.toggle('dyslexia-font');
        }

        // Window click to close modals
        window.onclick = function(event) {
            const modal = document.getElementById('feedbackModal');
            if (event.target === modal) {
                closeFeedback();
            }
        }

        // Big Router Simulation Functions
        let simCurrentScenario = null;
        let simCurrentStep = 0;
        let simCurrentPacket = null;
        
        const simScenarios = {
            classroom: {
                title: "Student Visits YouTube",
                steps: [
                    {
                        text: "A student wants to watch an educational video on YouTube. They type youtube.com in their browser.",
                        highlight: ["sim-device-192.168.1.10"],
                        action: null
                    },
                    {
                        text: "The student's laptop creates a packet (like a digital envelope) with the request. It says: 'FROM: 192.168.1.10 TO: 142.250.185.78 (YouTube)'",
                        highlight: ["sim-device-192.168.1.10"],
                        action: "createPacket",
                        packetEmoji: "üìπ"
                    },
                    {
                        text: "First, the packet goes to the Classroom Switch. The switch connects all devices in the classroom together.",
                        highlight: ["sim-device-192.168.1.10", "sim-switch-classroom"],
                        action: "movePacket",
                        from: "sim-device-192.168.1.10",
                        to: "sim-switch-classroom"
                    },
                    {
                        text: "The switch sees this packet is going to an outside address (not in the classroom), so it sends it to the router.",
                        highlight: ["sim-switch-classroom", "sim-router"],
                        action: "movePacket",
                        from: "sim-switch-classroom",
                        to: "sim-router"
                    },
                    {
                        text: "The router receives the packet and reads the destination address: 142.250.185.78. Now it needs to decide where to send it.",
                        highlight: ["sim-router"],
                        action: null
                    },
                    {
                        text: "The router checks its address book (routing table). It sees that 142.250.185.78 is NOT a school address (not 192.168.x.x), so it must be on the Internet!",
                        highlight: ["sim-router", "sim-route-internet"],
                        action: null
                    },
                    {
                        text: "Before sending to the Internet, the router changes the 'FROM' address. It replaces the private school address (192.168.1.10) with the school's public Internet address (203.0.113.45).",
                        highlight: ["sim-router"],
                        action: null
                    },
                    {
                        text: "The router sends the packet out to the Internet! The packet travels to YouTube's servers.",
                        highlight: ["sim-router", "sim-device-142.250.185.78"],
                        action: "movePacket",
                        from: "sim-router",
                        to: "sim-device-142.250.185.78"
                    },
                    {
                        text: "Success! The packet reached YouTube. YouTube will now send the video back using the school's public address (203.0.113.45).",
                        highlight: ["sim-device-142.250.185.78"],
                        action: null
                    }
                ]
            },
            library: {
                title: "Library Prints to Office",
                steps: [
                    {
                        text: "Someone in the library wants to print their homework. They click 'Print' on the library computer.",
                        highlight: ["sim-device-192.168.2.10"],
                        action: null
                    },
                    {
                        text: "The library computer creates a packet with the print job. It says: 'FROM: 192.168.2.10 TO: 192.168.2.30 (Office Printer)'",
                        highlight: ["sim-device-192.168.2.10"],
                        action: "createPacket",
                        packetEmoji: "üìÑ"
                    },
                    {
                        text: "The packet first goes to the Library Switch. The switch connects all devices in the library/office area.",
                        highlight: ["sim-device-192.168.2.10", "sim-switch-library"],
                        action: "movePacket",
                        from: "sim-device-192.168.2.10",
                        to: "sim-switch-library"
                    },
                    {
                        text: "The switch checks the destination (192.168.2.30). It knows the printer is also connected to this same switch! But first, it sends to the router.",
                        highlight: ["sim-switch-library", "sim-router"],
                        action: "movePacket",
                        from: "sim-switch-library",
                        to: "sim-router"
                    },
                    {
                        text: "The router receives the packet and reads the destination: 192.168.2.30. Time to check where this address belongs!",
                        highlight: ["sim-router"],
                        action: null
                    },
                    {
                        text: "The router checks its address book. It sees that 192.168.2.30 starts with 192.168.2, which means it's in the Library/Office network!",
                        highlight: ["sim-router", "sim-route-library"],
                        action: null
                    },
                    {
                        text: "The router sends the packet back to the Library Switch, which then delivers it to the printer.",
                        highlight: ["sim-router", "sim-switch-library"],
                        action: "movePacket",
                        from: "sim-router",
                        to: "sim-switch-library"
                    },
                    {
                        text: "The switch delivers the packet to the printer. Success! The document will start printing!",
                        highlight: ["sim-switch-library", "sim-device-192.168.2.30"],
                        action: "movePacket",
                        from: "sim-switch-library",
                        to: "sim-device-192.168.2.30"
                    }
                ]
            },
            internet: {
                title: "Website Sends Video Back",
                steps: [
                    {
                        text: "An educational website wants to send a video to the teacher's computer. It has the school's public address (203.0.113.45).",
                        highlight: ["sim-device-157.240.241.35"],
                        action: null
                    },
                    {
                        text: "The website creates a packet with the video data. It says: 'FROM: 157.240.241.35 TO: 203.0.113.45 (School's public IP)'",
                        highlight: ["sim-device-157.240.241.35"],
                        action: "createPacket",
                        packetEmoji: "üìä"
                    },
                    {
                        text: "The packet travels through the Internet and arrives at the school router's public address (203.0.113.45).",
                        highlight: ["sim-device-157.240.241.35", "sim-router"],
                        action: "movePacket",
                        from: "sim-device-157.240.241.35",
                        to: "sim-router"
                    },
                    {
                        text: "The router receives the packet but realizes: 'This is addressed to my public IP, but which computer inside the school requested this?'",
                        highlight: ["sim-router"],
                        action: null
                    },
                    {
                        text: "The router remembers: 'The teacher's computer (192.168.1.20) asked for this video earlier!' It needs to deliver it there.",
                        highlight: ["sim-router"],
                        action: null
                    },
                    {
                        text: "The router checks its address book. 192.168.1.20 starts with 192.168.1, so it belongs to the Classroom network!",
                        highlight: ["sim-router", "sim-route-classroom"],
                        action: null
                    },
                    {
                        text: "The router changes the destination from the public IP to the teacher's private IP and sends it to the Classroom Switch.",
                        highlight: ["sim-router", "sim-switch-classroom"],
                        action: "movePacket",
                        from: "sim-router",
                        to: "sim-switch-classroom"
                    },
                    {
                        text: "The Classroom Switch receives the packet and delivers it to the teacher's computer. The video is ready to play!",
                        highlight: ["sim-switch-classroom", "sim-device-192.168.1.20"],
                        action: "movePacket",
                        from: "sim-switch-classroom",
                        to: "sim-device-192.168.1.20"
                    }
                ]
            }
        };
        
        function simClearHighlights() {
            document.querySelectorAll('.sim-device, .sim-internet-device, .sim-router, .sim-route-item, .sim-switch').forEach(el => {
                el.style.background = el.style.background.replace('#fef3c7', el.classList.contains('sim-router') ? '#fed7d7' : 
                                     el.classList.contains('sim-switch') ? '#e6fffa' : 
                                     el.classList.contains('sim-route-item') ? '#f7fafc' : 
                                     el.classList.contains('sim-internet-device') ? 'white' : '#f7fafc');
                el.style.borderColor = el.style.borderColor.replace('#f59e0b', el.classList.contains('sim-router') ? '#fc8181' : 
                                       el.classList.contains('sim-switch') ? '#38b2ac' : 
                                       el.classList.contains('sim-route-item') ? '#e2e8f0' : '#5a67d8');
                el.style.transform = 'scale(1)';
                el.style.boxShadow = el.classList.contains('sim-router') ? '0 10px 30px rgba(252,129,129,0.3)' : '';
            });
        }
        
        function simHighlightElements(ids) {
            simClearHighlights();
            ids.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.style.background = '#fef3c7';
                    el.style.borderColor = '#f59e0b';
                    el.style.transform = 'scale(1.05)';
                    el.style.boxShadow = '0 0 20px rgba(245,158,11,0.5)';
                }
            });
        }
        
        function simUpdateStatus(step, text) {
            document.getElementById('simStatusStep').textContent = step ? 'Step ' + step + ' of ' + simScenarios[simCurrentScenario].steps.length : 'Ready to Learn!';
            document.getElementById('simStatusText').textContent = text;
        }
        
        function simCreatePacket(emoji) {
            if (simCurrentPacket) simCurrentPacket.remove();
            
            const packet = document.createElement('div');
            packet.style.cssText = 'position: absolute; width: 50px; height: 35px; background: #48bb78; border: 3px solid #2d6a4f; border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 20px; z-index: 1000; box-shadow: 0 5px 20px rgba(72,187,120,0.6);';
            packet.textContent = emoji;
            simCurrentPacket = packet;
            
            const step = simScenarios[simCurrentScenario].steps[simCurrentStep];
            const sourceEl = document.getElementById(step.from || step.highlight[0]);
            const rect = sourceEl.getBoundingClientRect();
            
            packet.style.left = rect.left + rect.width / 2 - 25 + 'px';
            packet.style.top = rect.top + rect.height / 2 - 17.5 + 'px';
            
            document.body.appendChild(packet);
        }
        
        function simAnimatePacket(fromId, toId) {
            if (!simCurrentPacket) return Promise.resolve();
            
            return new Promise(resolve => {
                const toEl = document.getElementById(toId);
                const toRect = toEl.getBoundingClientRect();
                
                simCurrentPacket.style.transition = 'all 1.5s ease-in-out';
                simCurrentPacket.style.left = toRect.left + toRect.width / 2 - 25 + 'px';
                simCurrentPacket.style.top = toRect.top + toRect.height / 2 - 17.5 + 'px';
                
                setTimeout(resolve, 1500);
            });
        }
        
        function simStartScenario(scenario) {
            simCurrentScenario = scenario;
            simCurrentStep = 0;
            
            // Hide scenario buttons and show step controls
            document.getElementById('simScenarioButtons').style.display = 'none';
            document.getElementById('simStepControls').style.display = 'flex';
            
            // Show first step
            simShowCurrentStep();
            
            // Award XP for starting simulation
            addXP(10, 'Started router simulation');
        }
        
        async function simShowCurrentStep() {
            const scenario = simScenarios[simCurrentScenario];
            const step = scenario.steps[simCurrentStep];
            
            simUpdateStatus(simCurrentStep + 1, step.text);
            
            if (step.highlight) {
                simHighlightElements(step.highlight);
            }
            
            // Execute action if needed
            if (step.action === 'createPacket') {
                simCreatePacket(step.packetEmoji);
            }
            
            // Check if this is the last step
            const isLastStep = simCurrentStep === scenario.steps.length - 1;
            document.getElementById('simBtnNext').textContent = isLastStep ? 'Finish ‚úì' : 'Next Step ‚Üí';
        }
        
        async function simNextStep() {
            const scenario = simScenarios[simCurrentScenario];
            const step = scenario.steps[simCurrentStep];
            
            // Execute movement action if needed
            if (step.action === 'movePacket' && simCurrentPacket) {
                document.getElementById('simBtnNext').disabled = true;
                await simAnimatePacket(step.from, step.to);
                document.getElementById('simBtnNext').disabled = false;
            }
            
            simCurrentStep++;
            
            if (simCurrentStep >= scenario.steps.length) {
                // Scenario complete
                if (simCurrentPacket) {
                    simCurrentPacket.remove();
                    simCurrentPacket = null;
                }
                simUpdateStatus(null, 'Great job! You\'ve learned how the router handled "' + scenario.title + '". Try another scenario!');
                
                // Award XP and achievement
                addXP(30, 'Completed router scenario');
                if (!achievements.has('Router Expert')) {
                    showAchievement('Router Expert!', 'Completed a router simulation scenario!');
                }
                
                simResetSimulation();
            } else {
                simShowCurrentStep();
            }
        }
        
        function simResetSimulation() {
            simCurrentScenario = null;
            simCurrentStep = 0;
            if (simCurrentPacket) {
                simCurrentPacket.remove();
                simCurrentPacket = null;
            }
            
            simClearHighlights();
            
            // Show scenario buttons and hide step controls
            document.getElementById('simScenarioButtons').style.display = 'block';
            document.getElementById('simStepControls').style.display = 'none';
            
            simUpdateStatus(null, 'Choose a scenario above to see how the router directs information through the school network');
        }
    </script>
</body>
</html>