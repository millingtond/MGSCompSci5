<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lesson 4: Encryption & Cryptography üîê</title>
    <style>
        /* Base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            color: white;
            padding: 1rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Typography */
        h1 {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 1rem;
            text-align: center;
        }

        h2 {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        h3 {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.75rem;
        }

        h4 {
            font-size: 1.25rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        /* Section styles */
        .section {
            background: rgba(55, 65, 81, 0.9);
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(75, 85, 99, 0.5);
        }

        /* Button styles */
        .btn {
            padding: 0.5rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: inline-block;
            text-align: center;
        }
        
        .btn:disabled {
            background-color: #4a5568;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background: #2563eb;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        /* Input styles */
        input[type="text"],
        input[type="number"],
        input[type="password"],
        textarea,
        select {
            width: 100%;
            padding: 0.5rem;
            background: rgba(75, 85, 99, 0.5);
            border: 1px solid rgba(107, 114, 128, 0.5);
            border-radius: 0.375rem;
            color: white;
            margin-bottom: 0.5rem;
        }

        input[type="text"]:focus,
        textarea:focus {
            outline: none;
            border-color: #3b82f6;
        }

        /* Grid layout */
        .grid {
            display: grid;
            gap: 1rem;
        }

        .grid-cols-1 {
            grid-template-columns: repeat(1, 1fr);
        }

        .grid-cols-2 {
            grid-template-columns: repeat(2, 1fr);
        }

        .grid-cols-3 {
            grid-template-columns: repeat(3, 1fr);
        }

        @media (max-width: 768px) {
            .grid-cols-2,
            .grid-cols-3 {
                grid-template-columns: 1fr;
            }
        }

        /* Header styles */
        .header-gradient {
            background: linear-gradient(to right, #10b981, #3b82f6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* XP Bar */
        .xp-container {
            max-width: 500px;
            margin: 2rem auto;
            background: rgba(55, 65, 81, 0.9);
            border-radius: 9999px;
            padding: 0.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(75, 85, 99, 0.5);
        }

        .xp-info {
            display: flex;
            justify-content: space-between;
            padding: 0 1rem;
            margin-bottom: 0.5rem;
        }

        .xp-bar-container {
            background: rgba(75, 85, 99, 0.5);
            border-radius: 9999px;
            height: 12px;
            overflow: hidden;
        }

        .xp-bar {
            background: linear-gradient(to right, #10b981, #3b82f6);
            height: 100%;
            border-radius: 9999px;
            transition: width 0.5s ease;
        }

        /* Flip card styles */
        .flip-card {
            background-color: transparent;
            width: 100%;
            height: 200px;
            perspective: 1000px;
            cursor: pointer;
        }

        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }

        .flip-card.flipped .flip-card-inner {
            transform: rotateY(180deg);
        }

        .flip-card-front, .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .flip-card-front {
            color: white;
        }

        .flip-card-back {
            transform: rotateY(180deg);
            background: #374151;
            color: white;
        }

        .flip-card-red {
            background: linear-gradient(135deg, #dc2626, #ec4899);
        }

        .flip-card-blue {
            background: linear-gradient(135deg, #2563eb, #06b6d4);
        }

        .flip-card-purple {
            background: linear-gradient(135deg, #7c3aed, #6366f1);
        }

        /* Caesar Cipher Wheel */
        .cipher-wheel {
            position: relative;
            width: 300px;
            height: 300px;
            margin: 0 auto;
        }

        .wheel-outer, .wheel-inner {
            position: absolute;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .wheel-outer {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .wheel-inner {
            width: 80%;
            height: 80%;
            left: 10%;
            top: 10%;
            background: white;
            color: #1a1a2e;
            cursor: grab;
            transition: transform 0.3s ease;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
        }

        .wheel-letter {
            position: absolute;
            font-weight: bold;
            font-size: 18px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Achievement styles */
        .achievement {
            background: rgba(55, 65, 81, 0.9);
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
            transition: all 0.3s ease;
            opacity: 0.5;
        }

        .achievement.unlocked {
            opacity: 1;
            animation: achievementPop 0.5s ease-out;
        }

        @keyframes achievementPop {
            0% { transform: scale(0) rotate(0deg); opacity: 0; }
            50% { transform: scale(1.2) rotate(5deg); }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }

        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            color: #1a1a2e;
            padding: 2rem;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
        
        /* Question Box styles */
        .question-box {
            background: rgba(31, 41, 55, 0.8);
            border: 1px solid #4b5563;
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 2rem;
        }

        /* Exam Practice Styles */
        .exam-question {
            background: rgba(31, 41, 55, 0.8);
            border: 1px solid #4b5563;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .exam-question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .mark-scheme {
            background: rgba(75, 85, 99, 0.3);
            border: 1px dashed #6b7280;
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
            display: none; /* Hidden by default */
        }
        .mark-scheme.visible {
            display: block;
        }
        .score-box {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .score-box input {
            width: 50px;
            text-align: center;
            padding: 0.25rem;
            margin: 0;
        }


        /* Utility classes */
        .text-green { color: #10b981; }
        .text-blue { color: #3b82f6; }
        .text-purple { color: #7c3aed; }
        .text-red { color: #ef4444; }
        .text-yellow { color: #f59e0b; }
        .text-gray { color: #9ca3af; }

        .bg-gray-700 { background: rgba(55, 65, 81, 0.9); }
        .bg-gray-600 { background: rgba(75, 85, 99, 0.9); }
        .bg-gray-800 { background: rgba(31, 41, 55, 0.9); }

        .mb-1 { margin-bottom: 0.25rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .mb-3 { margin-bottom: 0.75rem; }
        .mb-4 { margin-bottom: 1rem; }
        .mb-6 { margin-bottom: 1.5rem; }

        .mt-2 { margin-top: 0.5rem; }
        .mt-3 { margin-top: 0.75rem; }
        .mt-4 { margin-top: 1rem; }

        .p-2 { padding: 0.5rem; }
        .p-3 { padding: 0.75rem; }
        .p-4 { padding: 1rem; }

        .rounded { border-radius: 0.375rem; }
        .rounded-lg { border-radius: 0.5rem; }

        .font-mono { font-family: monospace; }
        .text-sm { font-size: 0.875rem; }
        .text-xs { font-size: 0.75rem; }
        .text-center { text-align: center; }

        .flex { display: flex; }
        .items-center { align-items: center; }
        .gap-2 { gap: 0.5rem; }

        /* Password strength meter */
        .strength-meter {
            height: 8px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .strength-weak { background: #ef4444; width: 33%; }
        .strength-medium { background: #f59e0b; width: 66%; }
        .strength-strong { background: #10b981; width: 100%; }

        /* Enigma rotor */
        .rotor {
            width: 80px;
            height: 80px;
            background: rgba(55, 65, 81, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            animation: rotorSpin 3s linear infinite;
        }

        @keyframes rotorSpin {
            from { transform: rotateZ(0deg); }
            to { transform: rotateZ(360deg); }
        }

        /* Disable text selection */
        * {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        input, textarea, select {
            -webkit-user-select: text;
            -moz-user-select: text;
            -ms-user-select: text;
            user-select: text;
        }
    </style>
</head>
<body>
    <!-- Modal -->
    <div id="customModal" class="modal-overlay">
        <div class="modal-content">
            <h3 id="modalTitle" style="font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;">Notification</h3>
            <p id="modalMessage" style="margin-bottom: 1.5rem;">Message content here.</p>
            <button id="modalClose" class="btn btn-primary" style="width: 100%;">
                Close
            </button>
        </div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="text-center mb-6">
            <h1>
                <span class="header-gradient">Encryption & Cryptography</span>
                <span style="font-size: 3rem;">üîê</span>
            </h1>
            <p style="font-size: 1.25rem; color: #d1d5db;">Master the art of secret communication!</p>
            
            <!-- XP Bar -->
            <div class="xp-container">
                <div class="xp-info">
                    <span id="levelDisplay" style="font-size: 0.875rem; font-weight: bold; color: #10b981;">Level 1: Cryptography Rookie</span>
                    <span style="font-size: 0.875rem; font-weight: bold; color: #3b82f6;"><span id="xpPoints">0</span> XP</span>
                </div>
                <div class="xp-bar-container">
                    <div id="xpBar" class="xp-bar" style="width: 0%"></div>
                </div>
            </div>
        </header>

        <!-- Starter Activity -->
        <section class="section">
            <h2 class="text-green flex items-center">
                <span style="font-size: 2rem; margin-right: 0.5rem;">üîç</span>
                Starter: Secret Message Detective
            </h2>
            <p class="text-gray">A mysterious USB drive was found with these messages. Can you identify which ones are encrypted?</p>
            
            <div class="grid grid-cols-3 mb-4">
                <!-- Message 1 -->
                <div class="flip-card" onclick="flipCard(this, 'msg1')">
                    <div class="flip-card-inner">
                        <div class="flip-card-front flip-card-red">
                            <p style="font-size: 2rem; margin-bottom: 0.5rem;">üìÑ</p>
                            <p style="font-weight: bold;">Message 1</p>
                            <p style="font-size: 0.875rem; margin-top: 0.5rem; font-family: monospace;">Hello World!</p>
                        </div>
                        <div class="flip-card-back">
                            <p style="font-size: 0.875rem; font-weight: bold; margin-bottom: 0.5rem;">Analysis:</p>
                            <p style="font-size: 0.75rem;">Plain text - Not encrypted!</p>
                            <p class="text-red" style="font-size: 0.75rem; margin-top: 0.5rem;">‚ùå No protection</p>
                        </div>
                    </div>
                </div>
                
                <!-- Message 2 -->
                <div class="flip-card" onclick="flipCard(this, 'msg2')">
                    <div class="flip-card-inner">
                        <div class="flip-card-front flip-card-blue">
                            <p style="font-size: 2rem; margin-bottom: 0.5rem;">üîê</p>
                            <p style="font-weight: bold;">Message 2</p>
                            <p style="font-size: 0.875rem; margin-top: 0.5rem; font-family: monospace;">Khoor Zruog!</p>
                        </div>
                        <div class="flip-card-back">
                            <p style="font-size: 0.875rem; font-weight: bold; margin-bottom: 0.5rem;">Analysis:</p>
                            <p style="font-size: 0.75rem;">Caesar Cipher (shift 3)</p>
                            <p class="text-green" style="font-size: 0.75rem; margin-top: 0.5rem;">‚úÖ Basic encryption</p>
                        </div>
                    </div>
                </div>
                
                <!-- Message 3 -->
                <div class="flip-card" onclick="flipCard(this, 'msg3')">
                    <div class="flip-card-inner">
                        <div class="flip-card-front flip-card-purple">
                            <p style="font-size: 2rem; margin-bottom: 0.5rem;">üîí</p>
                            <p style="font-weight: bold;">Message 3</p>
                            <p style="font-size: 0.875rem; margin-top: 0.5rem; font-family: monospace;">SGVsbG8gV29ybGQh</p>
                        </div>
                        <div class="flip-card-back">
                            <p style="font-size: 0.875rem; font-weight: bold; margin-bottom: 0.5rem;">Analysis:</p>
                            <p style="font-size: 0.75rem;">Base64 Encoded</p>
                            <p class="text-yellow" style="font-size: 0.75rem; margin-top: 0.5rem;">‚ö†Ô∏è Encoding, not encryption!</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-gray-800 p-4 rounded-lg">
                <h4 class="text-yellow">Encoding vs. Encryption: What's the difference?</h4>
                <p class="text-sm text-gray" style="margin-bottom: 1rem;">It's a common point of confusion, but the distinction is critical!</p>
                <p><strong>Encoding</strong> is about changing data from one format to another. The purpose is to make data usable by different systems (e.g., sending binary data over a text-only channel). Base64 (Message 3) is a perfect example. Anyone can reverse (decode) it because the method is public and requires no secret information.</p>
                <p><strong>Encryption</strong> is about keeping data secret. The purpose is to make data unreadable to anyone without the correct <span class="text-green">secret key</span>. A Caesar cipher (Message 2) is a simple form of encryption. You can only decrypt it if you know the secret key (in this case, the shift number '3'). Without the key, you'd have to guess or 'brute force' it.</p>
            </div>

             <!-- Knowledge Check Question -->
            <div class="question-box">
                <h4>üß† Knowledge Check</h4>
                <p class="text-gray mb-3">In your own words, explain the main difference between encoding and encryption, focusing on their purpose.</p>
                <textarea id="q1-answer" placeholder="Type your answer here..." rows="3"></textarea>
                <button onclick="checkAnswer('q1-answer', ['key', 'secret', 'purpose'], 'q1-feedback')" class="btn btn-primary mt-2">Submit</button>
                <div id="q1-feedback" class="mt-3"></div>
            </div>

        </section>

        <!-- Task 1: Caesar Cipher -->
        <section class="section">
            <h2 class="text-blue">üé° Task 1: Caesar Cipher Challenge</h2>
            <p class="text-gray">The Caesar Cipher shifts each letter by a fixed number. Julius Caesar used a shift of 3!</p>
            
            <div class="grid grid-cols-2" style="gap: 2rem;">
                <!-- Cipher Wheel -->
                <div>
                    <h3 class="text-center">Interactive Cipher Wheel</h3>
                    <div class="cipher-wheel" id="cipherWheel">
                        <div class="wheel-outer" id="outerWheel"></div>
                        <div class="wheel-inner" id="innerWheel">
                            <p style="font-weight: bold;">Shift: <span id="shiftValue">0</span></p>
                        </div>
                    </div>
                    <div style="margin-top: 1rem; text-align: center;">
                        <button onclick="rotateWheel(-1)" class="btn btn-primary" style="border-radius: 0.5rem 0 0 0.5rem;">
                            ‚Üê Shift Left
                        </button>
                        <button onclick="rotateWheel(1)" class="btn btn-primary" style="border-radius: 0 0.5rem 0.5rem 0;">
                            Shift Right ‚Üí
                        </button>
                    </div>
                </div>
                
                <!-- Encoding/Decoding -->
                <div>
                    <div class="bg-gray-700 p-4 rounded-lg mb-4">
                        <h4>Encode a Message</h4>
                        <input type="text" id="plainMessage" placeholder="Enter message to encrypt..." maxlength="50">
                        <div class="flex gap-2">
                            <input type="number" id="encodeShift" placeholder="Shift" min="1" max="25" value="3" style="width: 80px;">
                            <button onclick="encodeCaesar()" class="btn btn-success" style="flex: 1;">
                                Encode ‚Üí
                            </button>
                        </div>
                        <div id="encodedResult" class="mt-3 p-3 bg-gray-800 rounded font-mono text-green"></div>
                    </div>
                    
                    <div class="bg-gray-700 p-4 rounded-lg mb-4">
                        <h4>Decode a Message</h4>
                        <p class="text-sm text-gray mb-2">Try to decode: <span class="font-mono text-yellow">WKLV LV D VHFUHW</span></p>
                        <input type="text" id="decodedAnswer" placeholder="Your decoded message...">
                        <button onclick="checkDecode()" class="btn btn-primary" style="width: 100%;">
                            Check Answer
                        </button>
                        <div id="decodeFeedback" class="mt-2"></div>
                    </div>
                    
                    <div class="bg-gray-700 p-4 rounded-lg">
                        <h4>üî® Brute Force Attack</h4>
                        <p class="text-sm text-gray mb-2">See why Caesar Cipher is weak:</p>
                        <input type="text" id="bruteForceInput" placeholder="Enter encrypted message..." value="WKLV LV D VHFUHW">
                        <button onclick="bruteForceCaesar()" class="btn btn-danger" style="width: 100%;">
                            üîì Brute Force Attack!
                        </button>
                        <div id="bruteForceResults" class="mt-3" style="max-height: 200px; overflow-y: auto;"></div>
                    </div>
                </div>
            </div>

            <!-- Knowledge Check Question -->
            <div class="question-box">
                <h4>üß† Knowledge Check</h4>
                <p class="text-gray mb-3">After using the "Brute Force Attack" tool, explain why the Caesar cipher is considered a weak form of encryption.</p>
                <textarea id="q2-answer" placeholder="Type your answer here..." rows="3"></textarea>
                <button onclick="checkAnswer('q2-answer', ['brute force', '25', 'guess', 'easy', 'simple', 'keys'], 'q2-feedback')" class="btn btn-primary mt-2">Submit</button>
                <div id="q2-feedback" class="mt-3"></div>
            </div>

        </section>

        <!-- Task 2: Frequency Analysis -->
        <section class="section">
            <h2 class="text-purple">üìä Task 2: Frequency Analysis</h2>
            <p class="text-gray">The Caesar cipher is easy to break because there are only 25 possible keys. More complex ciphers, called substitution ciphers, replace letters randomly. To break these, we need a smarter technique: <span class="text-yellow">Frequency Analysis</span>.</p>
            <p class="text-gray">Certain letters appear more often than others in English (like E, T, and A). By counting the letters in an encrypted message, we can guess which encrypted letter corresponds to 'E', and so on.</p>

            <div class="bg-gray-800 p-4 rounded-lg text-center">
                <h3 class="text-yellow">Frequency Analysis Simulation</h3>
                <p class="mb-4">Spend about 10 minutes on the Code.org simulation below to see how frequency analysis works in practice. Click the link to open it in a new tab.</p>
                <a href="https://studio.code.org/courses/frequency-analysis/units/1/lessons/1/levels/1" target="_blank" class="btn btn-primary" style="background: #a855f7; color: white;">
                    Open Frequency Analysis Tool
                </a>
            </div>

             <!-- Knowledge Check Question -->
             <div class="question-box">
                <h4>üß† Knowledge Check</h4>
                <p class="text-gray mb-3">After using the simulation, how does knowing the most common letters in English (like E, T, A) help you crack a substitution cipher?</p>
                <textarea id="q3-answer" placeholder="Type your answer here..." rows="3"></textarea>
                <button onclick="checkAnswer('q3-answer', ['match', 'frequency', 'common', 'count', 'replace', 'guess'], 'q3-feedback')" class="btn btn-primary mt-2">Submit</button>
                <div id="q3-feedback" class="mt-3"></div>
            </div>
        </section>

        <!-- Task 3: Password Security -->
        <section class="section">
            <h2 class="text-yellow">üîë Task 3: Password Security Lab</h2>
            <p class="text-gray">Learn why good passwords matter!</p>
            
            <div class="grid grid-cols-2" style="gap: 2rem;">
                <!-- Password Analyzer -->
                <div class="bg-gray-700 p-4 rounded-lg">
                    <h3>üí™ Password Strength Analyzer</h3>
                    <input type="password" id="passwordInput" placeholder="Enter a password to test..." oninput="analyzePassword()">
                    
                    <div class="mb-3">
                        <p class="text-sm mb-1">Strength:</p>
                        <div class="bg-gray-600 rounded" style="overflow: hidden;">
                            <div id="strengthMeter" class="strength-meter strength-weak"></div>
                        </div>
                    </div>
                    
                    <div id="passwordAnalysis"></div>
                    
                    <div class="mt-4 bg-gray-600 p-3 rounded">
                        <p class="text-sm font-bold mb-2">Time to Crack:</p>
                        <p id="crackTime" style="font-size: 1.5rem; font-family: monospace;" class="text-yellow">Instantly</p>
                    </div>
                </div>
                
                <!-- Hashing Demo -->
                <div class="bg-gray-700 p-4 rounded-lg">
                    <h3>üîê Hashing Demo</h3>
                    
                    <p class="text-sm mb-2">Enter text to hash:</p>
                    <input type="text" id="hashInput" placeholder="Your password..." value="password123">
                    
                    <button onclick="demonstrateHashing()" class="btn btn-primary" style="width: 100%;">
                        Generate Hash ‚Üí
                    </button>
                    
                    <div class="mt-3">
                        <div class="bg-gray-800 p-3 rounded mb-2">
                            <p class="text-xs text-gray">MD5 (Weak - Don't use!):</p>
                            <p id="md5Hash" class="font-mono text-xs text-red" style="word-break: break-all;"></p>
                        </div>
                        <div class="bg-gray-800 p-3 rounded">
                            <p class="text-xs text-gray">SHA-256 (Better):</p>
                            <p id="sha256Hash" class="font-mono text-xs text-green" style="word-break: break-all;"></p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Knowledge Check Question -->
            <div class="question-box">
                <h4>üß† Knowledge Check</h4>
                <p class="text-gray mb-3">Based on the Password Analyzer, list three key principles for creating a strong, secure password.</p>
                <textarea id="q4-answer" placeholder="Type your answer here..." rows="3"></textarea>
                <button onclick="checkAnswer('q4-answer', ['length', 'long', 'mix', 'case', 'number', 'symbol', 'special'], 'q4-feedback')" class="btn btn-primary mt-2">Submit</button>
                <div id="q4-feedback" class="mt-3"></div>
            </div>

        </section>
        
        <!-- Exam Practice -->
        <section class="section">
             <h2>üìù Exam Practice Questions</h2>
             <p class="text-gray">Apply your knowledge. Mark schemes unlock after you type enough!</p>

             <!-- Question 1 -->
             <div class="exam-question">
                <div class="exam-question-header">
                    <p style="font-weight: bold;">1. Explain the difference between symmetric and asymmetric encryption. [2 marks]</p>
                    <div class="score-box">
                        <label for="q1-score" class="text-sm">My Score:</label>
                        <input type="text" id="q1-score">
                    </div>
                </div>
                <textarea id="exam-q1" class="exam-answer" rows="4" placeholder="Your answer..."></textarea>
                <button id="exam-q1-btn" class="btn btn-success mt-2" disabled>Show Mark Scheme</button>
                <div id="exam-q1-ms" class="mark-scheme">
                    <p><strong>Mark Scheme:</strong></p>
                    <ul style="list-style-position: inside; padding-left: 1rem; font-size: 0.875rem;">
                        <li>Symmetric encryption uses the same key for both encryption and decryption. (1 mark)</li>
                        <li>Asymmetric encryption uses two different keys: a public key to encrypt and a private key to decrypt. (1 mark)</li>
                    </ul>
                </div>
             </div>

             <!-- Question 2 -->
             <div class="exam-question">
                <div class="exam-question-header">
                    <p style="font-weight: bold;">2. What is hashing, and why is it useful for storing passwords? [3 marks]</p>
                    <div class="score-box">
                        <label for="q2-score" class="text-sm">My Score:</label>
                        <input type="text" id="q2-score">
                    </div>
                </div>
                <textarea id="exam-q2" class="exam-answer" rows="4" placeholder="Your answer..."></textarea>
                <button id="exam-q2-btn" class="btn btn-success mt-2" disabled>Show Mark Scheme</button>
                 <div id="exam-q2-ms" class="mark-scheme">
                    <p><strong>Mark Scheme:</strong></p>
                    <ul style="list-style-position: inside; padding-left: 1rem; font-size: 0.875rem;">
                         <li>Hashing is a one-way function that turns data into a fixed-size string of characters (a hash). (1 mark)</li>
                         <li>It's not reversible, meaning you can't get the original password from the hash. (1 mark)</li>
                         <li>This is useful because if a database is stolen, the attacker gets the useless hashes, not the actual passwords, making them secure. (1 mark)</li>
                    </ul>
                </div>
             </div>

             <!-- Question 3 -->
             <div class="exam-question">
                <div class="exam-question-header">
                    <p style="font-weight: bold;">3. Describe one weakness of the Caesar cipher. [1 mark]</p>
                     <div class="score-box">
                        <label for="q3-score" class="text-sm">My Score:</label>
                        <input type="text" id="q3-score">
                    </div>
                </div>
                <textarea id="exam-q3" class="exam-answer" rows="4" placeholder="Your answer..."></textarea>
                <button id="exam-q3-btn" class="btn btn-success mt-2" disabled>Show Mark Scheme</button>
                <div id="exam-q3-ms" class="mark-scheme">
                    <p><strong>Mark Scheme:</strong></p>
                     <ul style="list-style-position: inside; padding-left: 1rem; font-size: 0.875rem;">
                        <li>Accept one from: It is vulnerable to a brute-force attack / There are only 25 possible keys to try. OR It is vulnerable to frequency analysis as letter patterns are preserved. (1 mark)</li>
                    </ul>
                </div>
             </div>
        </section>


        <!-- Achievements -->
        <section class="section" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(239, 68, 68, 0.2));">
            <h2 style="color: white;">üèÜ Your Cryptography Achievements</h2>
            <div class="grid" style="grid-template-columns: repeat(5, 1fr); gap: 1rem;">
                <div id="achieve-decoder" class="achievement">
                    <span style="font-size: 2rem;">üîì</span>
                    <p style="font-weight: bold; font-size: 0.875rem; margin-top: 0.5rem;">First Decoder</p>
                    <p class="text-xs text-gray">Caesar cipher</p>
                </div>
                <div id="achieve-breaker" class="achievement">
                    <span style="font-size: 2rem;">üóùÔ∏è</span>
                    <p style="font-weight: bold; font-size: 0.875rem; margin-top: 0.5rem;">Pattern Breaker</p>
                    <p class="text-xs text-gray">Frequency analysis</p>
                </div>
                <div id="achieve-expert" class="achievement">
                    <span style="font-size: 2rem;">üõ°Ô∏è</span>
                    <p style="font-weight: bold; font-size: 0.875rem; margin-top: 0.5rem;">Security Expert</p>
                    <p class="text-xs text-gray">Strong passwords</p>
                </div>
                <div id="achieve-analyst" class="achievement">
                    <span style="font-size: 2rem;">üéØ</span>
                    <p style="font-weight: bold; font-size: 0.875rem; margin-top: 0.5rem;">Cryptanalyst</p>
                    <p class="text-xs text-gray">Multiple ciphers</p>
                </div>
                <div id="achieve-master" class="achievement">
                    <span style="font-size: 2rem;">üèÜ</span>
                    <p style="font-weight: bold; font-size: 0.875rem; margin-top: 0.5rem;">Master</p>
                    <p class="text-xs text-gray">All challenges</p>
                </div>
            </div>
        </section>
    </div>

    <script>
        // Modal functionality
        const modal = document.getElementById('customModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const modalClose = document.getElementById('modalClose');

        function showModal(title, message) {
            modalTitle.textContent = title;
            modalMessage.innerHTML = message;
            modal.classList.add('active');
        }

        modalClose.addEventListener('click', () => {
            modal.classList.remove('active');
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.remove('active');
            }
        });

        // XP System
        let totalXP = 0;
        let achievements = {
            decoder: false,
            breaker: false,
            expert: false,
            analyst: false,
            master: false
        };

        function addXP(points) {
            totalXP += points;
            document.getElementById('xpPoints').textContent = totalXP;
            const xpBar = document.getElementById('xpBar');
            const percentage = Math.min((totalXP / 500) * 100, 100);
            xpBar.style.width = percentage + '%';
            
            // Update level
            const levelDisplay = document.getElementById('levelDisplay');
            if (totalXP >= 400) {
                levelDisplay.textContent = 'Level 5: Master Codebreaker';
            } else if (totalXP >= 300) {
                levelDisplay.textContent = 'Level 4: Expert Cryptographer';
            } else if (totalXP >= 200) {
                levelDisplay.textContent = 'Level 3: Code Specialist';
            } else if (totalXP >= 100) {
                levelDisplay.textContent = 'Level 2: Cipher Apprentice';
            }
            
            checkForMasterAchievement();
        }

        function unlockAchievement(name) {
            if (!achievements[name]) {
                achievements[name] = true;
                const achieveElement = document.getElementById(`achieve-${name}`);
                if (achieveElement) {
                    achieveElement.classList.add('unlocked');
                    const achievementName = achieveElement.querySelector('p').textContent;
                    showModal('Achievement Unlocked!', `You've earned the "${achievementName}" achievement!`);
                    addXP(50);
                }
            }
        }

        function checkForMasterAchievement() {
            const allOthers = ['decoder', 'breaker', 'expert', 'analyst'].every(a => achievements[a]);
            if (allOthers && !achievements.master) {
                unlockAchievement('master');
            }
        }
        
        // Knowledge Check
        function checkAnswer(answerId, keywords, feedbackId) {
             const answer = document.getElementById(answerId).value.toLowerCase();
             const feedbackEl = document.getElementById(feedbackId);
             
             const hasKeyword = keywords.some(kw => answer.includes(kw));
             
             if (answer.length > 10 && hasKeyword) {
                 feedbackEl.innerHTML = `<p class="text-green">‚úÖ Great explanation! You've grasped the key concept.</p>`;
                 addXP(20);
             } else if (answer.length > 5) {
                feedbackEl.innerHTML = `<p class="text-yellow">üí° You're on the right track, but try to be more specific. Think about the keywords: ${keywords.join(', ')}.</p>`;
             } else {
                 feedbackEl.innerHTML = `<p class="text-red">‚ùå Please provide a more detailed answer.</p>`;
             }
        }

        // Flip cards
        const flippedCards = new Set();
        function flipCard(card, id) {
            card.classList.toggle('flipped');
            if (!flippedCards.has(id)) {
                flippedCards.add(id);
                addXP(10);
            }
        }

        // Caesar Cipher
        let currentShift = 0;
        
        function initializeCipherWheel() {
            const outerWheel = document.getElementById('outerWheel');
            const innerWheel = document.getElementById('innerWheel');
            const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            
            // Clear existing
            outerWheel.querySelectorAll('.wheel-letter').forEach(el => el.remove());
            innerWheel.querySelectorAll('.wheel-letter').forEach(el => el.remove());
            
            // Create wheels
            for (let i = 0; i < 26; i++) {
                const angle = (i * 360 / 26) - 90;
                
                // Outer wheel
                const outerLetter = document.createElement('div');
                outerLetter.className = 'wheel-letter';
                outerLetter.style.color = 'white';
                outerLetter.textContent = alphabet[i];
                outerLetter.style.transform = `rotate(${angle}deg) translateY(-120px) rotate(${-angle}deg)`;
                outerWheel.appendChild(outerLetter);
                
                // Inner wheel
                const innerLetter = document.createElement('div');
                innerLetter.className = 'wheel-letter';
                innerLetter.style.color = '#1a1a2e';
                innerLetter.textContent = alphabet[i];
                innerLetter.style.transform = `rotate(${angle}deg) translateY(-80px) rotate(${-angle}deg)`;
                innerWheel.appendChild(innerLetter);
            }
        }

        function rotateWheel(direction) {
            currentShift = (currentShift + direction + 26) % 26;
            const innerWheel = document.getElementById('innerWheel');
            innerWheel.style.transform = `rotate(${currentShift * (360/26)}deg)`;
            document.getElementById('shiftValue').textContent = currentShift;
        }

        function caesarShift(text, shift) {
            return text.toUpperCase().replace(/[A-Z]/g, char => 
                String.fromCharCode((char.charCodeAt(0) - 65 + shift) % 26 + 65)
            );
        }

        function encodeCaesar() {
            const message = document.getElementById('plainMessage').value;
            const shift = parseInt(document.getElementById('encodeShift').value) || 3;
            const encoded = caesarShift(message, shift);
            document.getElementById('encodedResult').textContent = encoded;
            addXP(15);
        }

        function checkDecode() {
            const answer = document.getElementById('decodedAnswer').value.toUpperCase();
            const feedback = document.getElementById('decodeFeedback');
            
            if (answer === 'THIS IS A SECRET') {
                feedback.innerHTML = '<p class="text-green">‚úÖ Correct! You cracked the code!</p>';
                addXP(30);
                unlockAchievement('decoder');
            } else {
                feedback.innerHTML = '<p class="text-red">‚ùå Not quite. Hint: Try shift of 3!</p>';
            }
        }

        function bruteForceCaesar() {
            const encrypted = document.getElementById('bruteForceInput').value;
            const results = document.getElementById('bruteForceResults');
            results.innerHTML = '<p class="text-yellow mb-2">Trying all 25 shifts...</p>';
            
            setTimeout(() => {
                let html = '';
                for (let shift = 1; shift <= 25; shift++) {
                    const decrypted = caesarShift(encrypted, 26 - shift);
                    const isReadable = decrypted.includes('THIS') || decrypted.includes('SECRET');
                    const bgColor = isReadable ? 'rgba(16, 185, 129, 0.2)' : 'rgba(75, 85, 99, 0.5)';
                    const textColor = isReadable ? '#10b981' : '#9ca3af';
                    html += `<div style="padding: 0.5rem; margin-bottom: 0.25rem; background: ${bgColor}; border-radius: 0.25rem;">
                        <span style="font-size: 0.875rem;">Shift ${shift}: </span>
                        <span style="font-family: monospace; color: ${textColor};">${decrypted}</span>
                    </div>`;
                }
                results.innerHTML = html;
                addXP(20);
                unlockAchievement('breaker'); // Unlocks here as it's a form of analysis
            }, 500);
        }

        // Password Analyzer
        function analyzePassword() {
            const password = document.getElementById('passwordInput').value;
            const analysis = document.getElementById('passwordAnalysis');
            const strengthMeter = document.getElementById('strengthMeter');
            const crackTime = document.getElementById('crackTime');
            
            let strength = 0;
            let feedback = [];
            
            // Length check
            if (password.length >= 12) {
                strength += 25;
                feedback.push('<p class="text-green text-sm">‚úÖ Good length (12+ chars)</p>');
            } else if (password.length >= 8) {
                strength += 15;
                feedback.push('<p class="text-yellow text-sm">‚ö†Ô∏è OK length (8+ chars)</p>');
            } else {
                feedback.push('<p class="text-red text-sm">‚ùå Too short (need 8+ chars)</p>');
            }
            
            // Complexity checks
            if (/[a-z]/.test(password)) {
                strength += 15;
                feedback.push('<p class="text-green text-sm">‚úÖ Contains lowercase</p>');
            }
            if (/[A-Z]/.test(password)) {
                strength += 15;
                feedback.push('<p class="text-green text-sm">‚úÖ Contains uppercase</p>');
            }
            if (/[0-9]/.test(password)) {
                strength += 15;
                feedback.push('<p class="text-green text-sm">‚úÖ Contains numbers</p>');
            }
            if (/[^A-Za-z0-9]/.test(password)) {
                strength += 30;
                feedback.push('<p class="text-green text-sm">‚úÖ Contains special characters</p>');
            }
            
            // Update UI
            analysis.innerHTML = feedback.join('');
            
            strengthMeter.className = 'strength-meter ';
            if (strength >= 70) {
                strengthMeter.className += 'strength-strong';
                crackTime.textContent = 'Centuries';
                crackTime.className = 'text-green';
                if (!achievements.expert && password.length > 0) {
                    unlockAchievement('expert');
                }
            } else if (strength >= 40) {
                strengthMeter.className += 'strength-medium';
                crackTime.textContent = 'Months';
                crackTime.className = 'text-yellow';
            } else {
                strengthMeter.className += 'strength-weak';
                crackTime.textContent = 'Minutes';
                crackTime.className = 'text-red';
            }
        }

        // Hashing
        function demonstrateHashing() {
            const input = document.getElementById('hashInput').value;
            if (!input) return;
            
            // Simple hash simulation
            const md5 = simpleHash(input, 'md5');
            const sha256 = simpleHash(input, 'sha256');
            
            document.getElementById('md5Hash').textContent = md5;
            document.getElementById('sha256Hash').textContent = sha256;
            
            addXP(20);
        }
        
        function simpleHash(input, type) {
            let hash = 0;
            const multiplier = type === 'md5' ? 31 : 37;
            
            for (let i = 0; i < input.length; i++) {
                hash = ((hash * multiplier) + input.charCodeAt(i)) % 1000000000;
            }
            
            const hexHash = Math.abs(hash).toString(16).padStart(8, '0');
            return type === 'md5' ? hexHash.repeat(4) : hexHash.repeat(8);
        }

        // Exam Practice Logic
        function setupExamQuestion(textareaId, buttonId, markSchemeId) {
            const textarea = document.getElementById(textareaId);
            const button = document.getElementById(buttonId);
            const markScheme = document.getElementById(markSchemeId);

            textarea.addEventListener('input', () => {
                if (textarea.value.length > 20) { // Unlock after 20 chars
                    button.disabled = false;
                } else {
                    button.disabled = true;
                }
            });

            button.addEventListener('click', () => {
                markScheme.classList.toggle('visible');
                button.textContent = markScheme.classList.contains('visible') ? 'Hide Mark Scheme' : 'Show Mark Scheme';
            });
        }


        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initializeCipherWheel();

            // Setup Exam questions
            setupExamQuestion('exam-q1', 'exam-q1-btn', 'exam-q1-ms');
            setupExamQuestion('exam-q2', 'exam-q2-btn', 'exam-q2-ms');
            setupExamQuestion('exam-q3', 'exam-q3-btn', 'exam-q3-ms');
            
            // Disable context menu
            document.addEventListener('contextmenu', e => {
                e.preventDefault();
                showModal('Right-click Disabled', 'Right-click is disabled for this educational content.');
                return false;
            });
        });
    </script>
</body>
</html>
